<!DOCTYPE html>
<html class="" lang="en-us"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    
        <script>
            if (location.host != new URL("http:\/\/localhost:1313\/").host) location.href = "http:\/\/localhost:1313\/"
        </script>
    
    <meta name="robots" content="noai, noimageai">
    <meta name="viewport" content="width=device-width" />
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=7" />

    <link
    rel="icon"
    href='/favicon.png'
/>
<link
    rel="shortcut icon"
    href='/favicon.ico'
    type="image/x-icon"
/>
<link
    rel="apple-touch-icon"
    href='/apple-touch-icon.png'
/>

    <link
        rel="icon"
        href='/logo.svg'
        type="image/svg+xml"
    />

<title>
        
            HTB Sherlock Jingle Bell  &ndash;
        
        Shakil&#39;s Blog
    </title>

    
    <link href="/symbols-nerd-font/symbols-nerd-font.css" rel="stylesheet" integrity="sha512-lydow8GLOLlYNOtHlksNCmGWWCBsbIEtikXpHzfWqx78HLlyQZHOzyLwPpKol4Th6aCwLUXOfODVYgwrd3nwKQ=="/>
    <link href="/jetbrains-mono/jetbrains-mono.css" rel="stylesheet" integrity="sha512-tJxlgL6v1Y7kFf+qB8SloaAMKnOAw6WouknxXtIjkBux9Y/9aX81EUWOJO8c/3l98DmjG8brr4to7zaez606Fg=="/>

    
    
    <link type="text/css" rel="stylesheet" href=http://localhost:1313/css/styles.1b7aa7dceda65930f08b5d668f6610d8f1bb884e4f133cf45d3cc937d9dfd6e1612b6abaa53857ae709e1dc2fa789675ce5718adeeecf6740e5b7912b04d732a.css integrity="sha512-G3qn3O2mWTDwi11mj2YQ2PG7iE5PEzz0XTzJN9nf1uFhK2q6pThXrnCeHcL6eJZ1zlcYre7s9nQOW3kSsE1zKg==" />
<meta name="author" content="Shakil Hossain" />

    
        <meta name="keywords" content='bell, database, dfir, htb, jingle, notification, push, sherlock, windows, wpndatabase' />
    
    
        <meta name="description" content="cenario Torrin is suspected to be an insider threat in Forela. He is believed to have leaked some data and removed certain applications from their workstation. They managed to bypass some controls and installed unauthorized software." />
    

<meta property="og:site_name"
    content='Shakil&#39;s Blog' />

    <meta property="og:title" content="HTB Sherlock Jingle Bell" />
    <meta property="og:type" content="article" />
    
    <meta
        property="article:author" content="Shakil Hossain" />
    <meta
        property="article:published_time"
        content='2024-05-16T12:54:17Z&#43;0200' />
    
        
            <meta property="article:tag" content="bell" />
        
            <meta property="article:tag" content="database" />
        
            <meta property="article:tag" content="dfir" />
        
            <meta property="article:tag" content="htb" />
        
            <meta property="article:tag" content="jingle" />
        
            <meta property="article:tag" content="notification" />
        
            <meta property="article:tag" content="push" />
        
            <meta property="article:tag" content="sherlock" />
        
            <meta property="article:tag" content="windows" />
        
            <meta property="article:tag" content="wpndatabase" />
        
    
    <meta property="og:url" content="http://localhost:1313/posts/htb-sherlocks/jingle-bell/" />
    
    
    <meta property="og:image"
        content="http://localhost:1313/android-chrome-512x512.png" />
    
        <meta property="og:description" content="Jingle Bell (DFIR) Scenario Torrin is suspected to be an insider threat in Forela. He is believed to have leaked some data and removed certain applications from" />
    

<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:domain"
      content='localhost:1313'
/>
<meta property="twitter:url" content="http://localhost:1313/posts/htb-sherlocks/jingle-bell/" />


    <meta name="twitter:title" content="HTB Sherlock Jingle Bell" />
    
    
    
    <meta name="twitter:image"
        content="http://localhost:1313/android-chrome-512x512.png" />
    
        <meta name="twitter:description" content="Jingle Bell (DFIR) Scenario Torrin is suspected to be an insider threat in Forela. He is believed to have leaked some data and removed certain applications from" />
    

<link rel="manifest" href="/manifest/index.json" />
</head>


<body>
        <div id="baseContainer"><header class="">
<div class="titleAndSearchContainer">
        <div id="titleContainer">
            
                <a class="unstyledLink" href="/">
                    <img src='/logo.svg' alt='Logo'/>
                </a>
            
            <div class="rightOfLogo">
                <div class="titleAndHamburger">
                    <h1>
                        <a class="unstyledLink" href="/">Shakil&#39;s Blog</a>
                        
                    </h1>
                    
                </div>
                <div id="wide_nav"><nav>
    
    <ul id="main-nav">
        <li><a href="/">Home</a></li>
        
            <li><a href="/posts/">Posts</a></li>
        
        
        
        
        
        
        
            <li><a href="/tags/">Tags</a></li>
        
        
    </ul>
</nav>
</div>
            </div>
        </div>
        <div class="search">
    <input id="searchbar" type="text" placeholder='Search' />
    <span class="nerdlink" onclick="newSearch();">&#xf002;</span>
</div>
<script>
    function newSearch() {
        let term = searchbar.value.trim();
        if (!term) return;
        location.href = `/search/?q=${term}`;
    }
    searchbar.onkeyup = (ev) => {if (ev.keyCode == 13) newSearch()};
</script>

    </div>
    <div id="links">
        <a
    
        rel="noreferrer"
    
    target="_blank"
    class="nerdlink"
    href="/index.xml">
    
    
        &#xf09e;
    
    <span>
        RSS
    </span>
</a>

        
        <a
    
        rel="noreferrer"
    
    target="_blank"
    class="nerdlink"
    href="https://github.com/hshakilst">
    
    
        &#xf09b;
    
    <span>
        Github
    </span>
</a>
<a
    
        rel="noreferrer"
    
    target="_blank"
    class="nerdlink"
    href="https://linkedin.com/in/hshakilst">
    
    
        &#xf0e1;
    
    <span>
        LinkedIn
    </span>
</a>
<a
    
        rel="noreferrer"
    
    target="_blank"
    class="nerdlink"
    href="mailto:hshakilst@gmail.com">
    
    
        &#xf6ed;
    
    <span>
        Gmail
    </span>
</a>

    </div>
    

</header>
<div id="contentContainer">
                <div id="content">
                    <main>
<article class="card single">
    
        <h1>HTB Sherlock Jingle Bell</h1>
    
    
        <p class="date">
            <span title='Date'> </span>
    2024-05-16

</p>
    
    
    
    
    <div><h1 id="jingle-bell-dfir">Jingle Bell (DFIR)</h1>
<h3 id="scenario">Scenario</h3>
<p>Torrin is suspected to be an insider threat in Forela. He is believed to have leaked some data and removed certain applications from their workstation. They managed to bypass some controls and installed unauthorized software. Despite the forensic team&rsquo;s efforts, no evidence of data leakage was found. As a senior incident responder, you have been tasked with investigating the incident to determine the conversation between the two parties involved.</p>
<h3 id="forensics">Forensics</h3>
<p>We are given a Windows push notification database file named <code>wpndatabase.db</code>. We can learn more about this database file on:</p>
<ul>
<li><a href="https://www.mdpi.com/2673-6756/2/1/7">A Digital Forensic View of Windows 10 Notifications</a></li>
<li><a href="https://tzworks.com/prototypes/wpn/wpn.users.guide.pdf">Windows Push Notification (wpn) Database Parser Users Guide by TZWorks®</a></li>
</ul>
<p>From reading these articles we discovered that in that db file, there&rsquo;s a table named <code>Notification</code>. It contains the information of the notifications shown by Windows&rsquo;s Notification Manager as <code>XML</code> payload.</p>
<p>Therefore, we used <code>sqlitebrowser</code> and manually dumped the <code>XML</code> data from the <code>Notification</code> table. And saved them in the <a href="https://github.com/hshakilst/DFIR/blob/main/HTB%20Sherlocks/Jingle%20Bell/notifications.xml">notifications.xml</a> file.</p>
<p>We need to analyze this XML file to answer the following questions.</p>
<h3 id="questions-and-answers">Questions and Answers</h3>
<ul>
<li>
<p>Q: Which software/application did Torrin use to leak Forela&rsquo;s secrets?</p>
<ul>
<li>A: Torrin used <code>Slack</code> to leak the secrets. We know this from the notification&rsquo;s <code>&lt;toast launch=&quot;&quot;&gt;</code> section.</li>
</ul>
</li>
<li>
<p>Q: What&rsquo;s the name of the rival company to which Torrin leaked the data?</p>
<ul>
<li>A: The rival company&rsquo;s name is <code>PrimeTech Innovations</code>. We got this information from <code>&lt;header title=&quot;&quot;&gt;</code> section of the notification.</li>
</ul>
</li>
<li>
<p>Q: What is the username of the person from the competitor organization whom Torrin shared information with?</p>
<ul>
<li>A: The username is <code>Cyberjunkie-PrimeTechDev</code>. We get this answer from <code>&lt;binding&gt;</code>&rsquo;s second <code>&lt;text&gt;</code> tag where the attribute <code>hint-style=&quot;bodySubtle&quot;</code> exists.</li>
</ul>
</li>
<li>
<p>Q: What&rsquo;s the channel name in which they conversed with each other?</p>
<ul>
<li>A: The channel name is <code>forela-secrets-leak</code>. We can derive this from <code>&lt;binding&gt;</code>&rsquo;s first <code>&lt;text&gt;</code> tag where the attribute <code>hint-maxLines=&quot;1&quot;</code> exists.</li>
</ul>
</li>
<li>
<p>Q: What was the password for the archive server?</p>
<ul>
<li>A: The password for the archive server is <code>Tobdaf8Qip$re@1</code>. We get this from reading the body of a notification.</li>
</ul>
</li>
<li>
<p>Q: What was the URL provided to Torrin to upload stolen data to?</p>
<ul>
<li>A: The URL is <code>https://drive.google.com/drive/folders/1vW97VBmxDZUIEuEUG64g5DLZvFP-Pdll?usp=sharing</code>.</li>
</ul>
</li>
<li>
<p>Q: When was the above link shared with Torrin?</p>
<ul>
<li>A: When answering this question we faced some difficulties. Two timestamps could be the answer to the question. Firstly, the <code>Notification</code> table has an <code>ArrivalTime</code> timestamp expressed in <code>Microsoft Filetime 64-bit</code> format. When converted to date it gave <code>GMT Thu Apr 20 2023 10:36:08</code>. But it wasn&rsquo;t the answer. Secondly, there was another timestamp embedded inside the <code>&lt;toast launch=&quot;slack://channel?id=C05451QSQM8&amp;amp;message=1681986889.660179&amp;amp;team=T054518ADUJ&amp;amp;origin=notification&quot;&gt;</code> tag of the notification&rsquo;s XML structure. The <code>message=1681986889.660179</code> converts to <code>GMT Thu Apr 20 2023 10:34:49</code>. Turns out the latter one was the correct one. So, the answer is <code>2023-04-20 10:34:49</code>.</li>
</ul>
</li>
<li>
<p>Q: For how much money did Torrin leak Forela&rsquo;s secrets?</p>
<ul>
<li>A: The answer is <code>£10000</code>. We could find it in the <a href="https://github.com/hshakilst/DFIR/blob/main/HTB%20Sherlocks/Jingle%20Bell/notifications.xml">notifications.xml</a> file.</li>
</ul>
</li>
</ul>
</div>
</article>

    <hr />
    <p class="articleTagsContainer">
        <span> </span>
        <strong>Tags:</strong>
        
            <a
                
                href="/tags/bell/">#bell</a>
        
            <a
                
                href="/tags/database/">#database</a>
        
            <a
                
                href="/tags/dfir/">#dfir</a>
        
            <a
                
                href="/tags/htb/">#htb</a>
        
            <a
                
                href="/tags/jingle/">#jingle</a>
        
            <a
                
                href="/tags/notification/">#notification</a>
        
            <a
                
                href="/tags/push/">#push</a>
        
            <a
                
                href="/tags/sherlock/">#sherlock</a>
        
            <a
                
                href="/tags/windows/">#windows</a>
        
            <a
                
                href="/tags/wpndatabase/">#wpndatabase</a>
        
    </p>





    
    
        
        <div class="relatedArticlesContainer">
            <hr />
            <h2>More posts like this</h2>
            <div class="postlist ">
                <article class="card postlistitem">
    <div>
        <h2>
            <a href="http://localhost:1313/posts/htb-sherlocks/noted/">HTB Sherlock Noted</a>
        </h2>
        <p class="date">
            <span title='Date'> </span>
    2024-05-16


                | 
                <span title='Tags'> </span>
                
                    <a href="/tags/dfir">#dfir</a>
                
                    <a href="/tags/file">#file</a>
                
                    <a href="/tags/htb">#htb</a>
                
                    <a href="/tags/noted">#noted</a>
                
                    <a href="/tags/notepad&#43;&#43;">#notepad&#43;&#43;</a>
                
                    <a href="/tags/sherlock">#sherlock</a>
                
                    <a href="/tags/time">#time</a>
                
                    <a href="/tags/windows">#windows</a>
                
            
        </p>
        
            
        
        
            <div class="articlePreview">
                <p>
                    
                        Noted (DFIR) Scenario Simon, a developer working at Forela, notified the CERT team about a note that appeared on his desktop. The note claimed that his system had been compromised and that sensitive data from Simon&rsquo;s workstation had been collected.
                    
                </p>
                <p><a href="http://localhost:1313/posts/htb-sherlocks/noted/">Continue reading </a></p>
            </div>
        
    </div>
    <hr />
</article>
<article class="card postlistitem">
    <div>
        <h2>
            <a href="http://localhost:1313/posts/htb-sherlocks/bft/">HTB Sherlock BFT</a>
        </h2>
        <p class="date">
            <span title='Date'> </span>
    2024-05-16


                | 
                <span title='Tags'> </span>
                
                    <a href="/tags/bft">#bft</a>
                
                    <a href="/tags/dfir">#dfir</a>
                
                    <a href="/tags/file">#file</a>
                
                    <a href="/tags/htb">#htb</a>
                
                    <a href="/tags/master">#master</a>
                
                    <a href="/tags/mft">#mft</a>
                
                    <a href="/tags/sherlock">#sherlock</a>
                
                    <a href="/tags/table">#table</a>
                
                    <a href="/tags/windows">#windows</a>
                
            
        </p>
        
            
        
        
            <div class="articlePreview">
                <p>
                    
                        BFT (DFIR) Scenario In this Sherlock, you will become acquainted with MFT (Master File Table) forensics. You will be introduced to well-known tools and methodologies for analyzing MFT artifacts to identify malicious activity.
                    
                </p>
                <p><a href="http://localhost:1313/posts/htb-sherlocks/bft/">Continue reading </a></p>
            </div>
        
    </div>
    <hr />
</article>

            </div>
        </div>
    


                    </main><footer>
    <hr />

<p><small>
        2024 &copy; Shakil Hossain - All Right Reserved.
    </small></p>
    <p><small>
        <a href='https://gitlab.com/gabmus/hugo-ficurinia'>Ficurinia theme</a> for <a href='https://gohugo.io'>Hugo</a> by <a href='https://gabmus.org'>Gabriele Musco</a>.
    </small></p>
</footer>
</div>
            </div>
        </div>


</body>
</html>
