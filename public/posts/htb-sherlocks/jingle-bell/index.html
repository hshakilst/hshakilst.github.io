<!doctype html><html lang=en-us><head><script>location.host!=new URL("https://hshakilst.github.io/").host&&(location.href="https://hshakilst.github.io/")</script><meta name=robots content="noai, noimageai"><meta name=viewport content="width=device-width"><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=7"><link rel=icon href=/favicon.png><link rel="shortcut icon" href=/favicon.ico type=image/x-icon><link rel=apple-touch-icon href=/apple-touch-icon.png><link rel=icon href=/logo.svg type=image/svg+xml><title>HTB Sherlock Jingle Bell &ndash;
Shakil's Blog
</title><link href=/symbols-nerd-font/symbols-nerd-font.css rel=stylesheet integrity="sha512-lydow8GLOLlYNOtHlksNCmGWWCBsbIEtikXpHzfWqx78HLlyQZHOzyLwPpKol4Th6aCwLUXOfODVYgwrd3nwKQ=="><link href=/jetbrains-mono/jetbrains-mono.css rel=stylesheet integrity="sha512-tJxlgL6v1Y7kFf+qB8SloaAMKnOAw6WouknxXtIjkBux9Y/9aX81EUWOJO8c/3l98DmjG8brr4to7zaez606Fg=="><link type=text/css rel=stylesheet href=https://hshakilst.github.io/css/styles.159e622b5082f31a00ec6f1883bbaf21cb06404f86f78d11446793c0fd5d5060b90e94ef79525a194da08b247c2b8b82413944e9b2af3d2c35c0fa6157961cd6.css integrity="sha512-FZ5iK1CC8xoA7G8Yg7uvIcsGQE+G940RRGeTwP1dUGC5DpTveVJaGU2giyR8K4uCQTlE6bKvPSw1wPphV5Yc1g=="><meta name=author content="Shakil Hossain"><meta name=keywords content='bell,database,dfir,htb,jingle,notification,push,sherlock,windows,wpndatabase'><meta name=description content="cenario Torrin is suspected to be an insider threat in Forela. He is believed to have leaked some data and removed certain applications from their workstation. They managed to bypass some controls and installed unauthorized software."><meta property="og:site_name" content="Shakil's Blog"><meta property="og:title" content="HTB Sherlock Jingle Bell"><meta property="og:type" content="article"><meta property="article:author" content="Shakil Hossain"><meta property="article:published_time" content='2024-05-16T12:54:17Z+0200'><meta property="article:tag" content="bell"><meta property="article:tag" content="database"><meta property="article:tag" content="dfir"><meta property="article:tag" content="htb"><meta property="article:tag" content="jingle"><meta property="article:tag" content="notification"><meta property="article:tag" content="push"><meta property="article:tag" content="sherlock"><meta property="article:tag" content="windows"><meta property="article:tag" content="wpndatabase"><meta property="og:url" content="https://hshakilst.github.io/posts/htb-sherlocks/jingle-bell/"><meta property="og:image" content="https://hshakilst.github.io/android-chrome-512x512.png"><meta property="og:description" content="Jingle Bell (DFIR) Scenario Torrin is suspected to be an insider threat in Forela. He is believed to have leaked some data and removed certain applications from"><meta name=twitter:card content="summary_large_image"><meta property="twitter:domain" content='akilst.github.io'><meta property="twitter:url" content="https://hshakilst.github.io/posts/htb-sherlocks/jingle-bell/"><meta name=twitter:title content="HTB Sherlock Jingle Bell"><meta name=twitter:image content="https://hshakilst.github.io/android-chrome-512x512.png"><meta name=twitter:description content="Jingle Bell (DFIR) Scenario Torrin is suspected to be an insider threat in Forela. He is believed to have leaked some data and removed certain applications from"><link rel=manifest href=/manifest/index.json></head><body><div id=baseContainer><header><div class=titleAndSearchContainer><div id=titleContainer><a class=unstyledLink href=/><img src=/logo.svg alt=Logo></a><div class=rightOfLogo><div class=titleAndHamburger><h1><a class=unstyledLink href=/>Shakil's Blog</a></h1></div><div id=wide_nav><nav><ul id=main-nav><li><a href=/>Home</a></li><li><a href=/posts/>Posts</a></li><li><a href=/tags/>Tags</a></li></ul></nav></div></div></div><div class=search><input id=searchbar type=text placeholder=Search>
<span class=nerdlink onclick=newSearch()>&#xf002;</span></div><script>function newSearch(){let e=searchbar.value.trim();if(!e)return;location.href=`/search/?q=${e}`}searchbar.onkeyup=e=>{e.keyCode==13&&newSearch()}</script></div><div id=links><a rel=noreferrer target=_blank class=nerdlink href=/index.xml>&#xf09e;
<span>RSS
</span></a><a rel=noreferrer target=_blank class=nerdlink href=https://github.com/hshakilst>&#xf09b;
<span>Github
</span></a><a rel=noreferrer target=_blank class=nerdlink href=https://linkedin.com/in/hshakilst>&#xf0e1;
<span>LinkedIn
</span></a><a rel=noreferrer target=_blank class=nerdlink href=mailto:hshakilst@gmail.com>&#xf6ed;
<span>Gmail</span></a></div></header><div id=contentContainer><div id=content><main><article class="card single"><h1>HTB Sherlock Jingle Bell</h1><p class=date><span title=Date> </span>2024-05-16</p><div><h1 id=jingle-bell-dfir>Jingle Bell (DFIR)</h1><h3 id=scenario>Scenario</h3><p>Torrin is suspected to be an insider threat in Forela. He is believed to have leaked some data and removed certain applications from their workstation. They managed to bypass some controls and installed unauthorized software. Despite the forensic team&rsquo;s efforts, no evidence of data leakage was found. As a senior incident responder, you have been tasked with investigating the incident to determine the conversation between the two parties involved.</p><h3 id=forensics>Forensics</h3><p>We are given a Windows push notification database file named <code>wpndatabase.db</code>. We can learn more about this database file on:</p><ul><li><a href=https://www.mdpi.com/2673-6756/2/1/7>A Digital Forensic View of Windows 10 Notifications</a></li><li><a href=https://tzworks.com/prototypes/wpn/wpn.users.guide.pdf>Windows Push Notification (wpn) Database Parser Users Guide by TZWorks®</a></li></ul><p>From reading these articles we discovered that in that db file, there&rsquo;s a table named <code>Notification</code>. It contains the information of the notifications shown by Windows&rsquo;s Notification Manager as <code>XML</code> payload.</p><p>Therefore, we used <code>sqlitebrowser</code> and manually dumped the <code>XML</code> data from the <code>Notification</code> table. And saved them in the <a href=https://github.com/hshakilst/DFIR/blob/main/HTB%20Sherlocks/Jingle%20Bell/notifications.xml>notifications.xml</a> file.</p><p>We need to analyze this XML file to answer the following questions.</p><h3 id=questions-and-answers>Questions and Answers</h3><ul><li><p>Q: Which software/application did Torrin use to leak Forela&rsquo;s secrets?</p><ul><li>A: Torrin used <code>Slack</code> to leak the secrets. We know this from the notification&rsquo;s <code>&lt;toast launch=""></code> section.</li></ul></li><li><p>Q: What&rsquo;s the name of the rival company to which Torrin leaked the data?</p><ul><li>A: The rival company&rsquo;s name is <code>PrimeTech Innovations</code>. We got this information from <code>&lt;header title=""></code> section of the notification.</li></ul></li><li><p>Q: What is the username of the person from the competitor organization whom Torrin shared information with?</p><ul><li>A: The username is <code>Cyberjunkie-PrimeTechDev</code>. We get this answer from <code>&lt;binding></code>&rsquo;s second <code>&lt;text></code> tag where the attribute <code>hint-style="bodySubtle"</code> exists.</li></ul></li><li><p>Q: What&rsquo;s the channel name in which they conversed with each other?</p><ul><li>A: The channel name is <code>forela-secrets-leak</code>. We can derive this from <code>&lt;binding></code>&rsquo;s first <code>&lt;text></code> tag where the attribute <code>hint-maxLines="1"</code> exists.</li></ul></li><li><p>Q: What was the password for the archive server?</p><ul><li>A: The password for the archive server is <code>Tobdaf8Qip$re@1</code>. We get this from reading the body of a notification.</li></ul></li><li><p>Q: What was the URL provided to Torrin to upload stolen data to?</p><ul><li>A: The URL is <code>https://drive.google.com/drive/folders/1vW97VBmxDZUIEuEUG64g5DLZvFP-Pdll?usp=sharing</code>.</li></ul></li><li><p>Q: When was the above link shared with Torrin?</p><ul><li>A: When answering this question we faced some difficulties. Two timestamps could be the answer to the question. Firstly, the <code>Notification</code> table has an <code>ArrivalTime</code> timestamp expressed in <code>Microsoft Filetime 64-bit</code> format. When converted to date it gave <code>GMT Thu Apr 20 2023 10:36:08</code>. But it wasn&rsquo;t the answer. Secondly, there was another timestamp embedded inside the <code>&lt;toast launch="slack://channel?id=C05451QSQM8&amp;amp;message=1681986889.660179&amp;amp;team=T054518ADUJ&amp;amp;origin=notification"></code> tag of the notification&rsquo;s XML structure. The <code>message=1681986889.660179</code> converts to <code>GMT Thu Apr 20 2023 10:34:49</code>. Turns out the latter one was the correct one. So, the answer is <code>2023-04-20 10:34:49</code>.</li></ul></li><li><p>Q: For how much money did Torrin leak Forela&rsquo;s secrets?</p><ul><li>A: The answer is <code>£10000</code>. We could find it in the <a href=https://github.com/hshakilst/DFIR/blob/main/HTB%20Sherlocks/Jingle%20Bell/notifications.xml>notifications.xml</a> file.</li></ul></li></ul></div></article><hr><p class=articleTagsContainer><span> </span><strong>Tags:</strong>
<a href=/tags/bell/>#bell</a>
<a href=/tags/database/>#database</a>
<a href=/tags/dfir/>#dfir</a>
<a href=/tags/htb/>#htb</a>
<a href=/tags/jingle/>#jingle</a>
<a href=/tags/notification/>#notification</a>
<a href=/tags/push/>#push</a>
<a href=/tags/sherlock/>#sherlock</a>
<a href=/tags/windows/>#windows</a>
<a href=/tags/wpndatabase/>#wpndatabase</a></p><div class=relatedArticlesContainer><hr><h2>More posts like this</h2><div class=postlist><article class="card postlistitem"><div><h2><a href=https://hshakilst.github.io/posts/htb-sherlocks/tracer/>HTB Sherlock Tracer</a></h2><p class=date><span title=Date> </span>2025-09-18
|
<span title=Tags> </span><a href=/tags/dfir>#dfir</a>
<a href=/tags/event>#event</a>
<a href=/tags/evtx>#evtx</a>
<a href=/tags/evtxecmd>#evtxecmd</a>
<a href=/tags/htb>#htb</a>
<a href=/tags/jq>#jq</a>
<a href=/tags/log>#log</a>
<a href=/tags/mftecmd>#mftecmd</a>
<a href=/tags/pecmd>#pecmd</a>
<a href=/tags/prefetch>#prefetch</a>
<a href=/tags/sherlock>#sherlock</a>
<a href=/tags/usnjournal>#usnjournal</a>
<a href=/tags/windows>#windows</a>
<a href=/tags/zimmerman-tools>#zimmerman-tools</a></p><div class=articlePreview><p>Tracer - DFIR Scenario A junior SOC analyst on duty has reported multiple alerts indicating the presence of PsExec on a workstation. They verified the alerts and escalated the alerts to tier II.</p><p><a href=https://hshakilst.github.io/posts/htb-sherlocks/tracer/>Continue reading </a></p></div></div><hr></article><article class="card postlistitem"><div><h2><a href=https://hshakilst.github.io/posts/htb-sherlocks/mellitus/>HTB Sherlock Mellitus</a></h2><p class=date><span title=Date> </span>2024-06-21
|
<span title=Tags> </span><a href=/tags/dfir>#dfir</a>
<a href=/tags/dump>#dump</a>
<a href=/tags/event>#event</a>
<a href=/tags/evtx>#evtx</a>
<a href=/tags/evtxecmd>#evtxecmd</a>
<a href=/tags/floss>#floss</a>
<a href=/tags/gimp>#gimp</a>
<a href=/tags/htb>#htb</a>
<a href=/tags/image>#image</a>
<a href=/tags/jq>#jq</a>
<a href=/tags/malware>#malware</a>
<a href=/tags/memory>#memory</a>
<a href=/tags/sherlock>#sherlock</a>
<a href=/tags/volatility>#volatility</a>
<a href=/tags/windows>#windows</a>
<a href=/tags/zimmerman-tools>#zimmerman-tools</a></p><div class=articlePreview><p>Mellitus - DFIR Scenario You’ve been a SOC analyst for the last 4 years but you’ve been honing your incident response skills! It’s about time you bite the bullet and go for your dream job as an Incident Responder as that’s the path you’d like your career to follow.</p><p><a href=https://hshakilst.github.io/posts/htb-sherlocks/mellitus/>Continue reading </a></p></div></div><hr></article></div></div></main><footer><hr><p><small>2025 &copy; Shakil Hossain - All Right Reserved.</small></p><p><small><a href=https://gitlab.com/gabmus/hugo-ficurinia>Ficurinia theme</a> for <a href=https://gohugo.io>Hugo</a> by <a href=https://gabmus.org>Gabriele Musco</a>.</small></p></footer></div></div></div></body></html>